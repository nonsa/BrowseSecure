/**
 * MASKME Copyright (c) 2008-2013 by Abine, Inc. All Rights Reserved.
 *
 * This software is the confidential and proprietary information
 * of Abine, Inc. ("Confidential Information"), subject
 * to the Non-Disclosure Agreement and/or License Agreement you entered
 * into with Abine. You shall use such Confidential Information only
 * in accordance with the terms of said Agreement(s). Abine makes
 * no representations or warranties about the suitability of the
 * software. The software is provided with ABSOLUTELY NO WARRANTY
 * and Abine will NOT BE LIABLE for ANY DAMAGES resulting from
 * the use of the software.
 *
 * Contact license@getabine.com with any license-related questions.
 *
 * https://www.abine.com
 * @license
 *
 */
/**
 * almond 0.0.3 Copyright (c) 2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * @license
 * see: http://github.com/jrburke/almond for details
 */
var ABINEMASKME=ABINEMASKME||{};if(ABINEMASKME.startTime=Date.now(),"undefined"==typeof window){var window=this;ABINEMASKME.fixSetTimeout=!0}window.ABINEMASKME=window.ABINEMASKME||ABINEMASKME,function(e){function t(){}function n(e,t){if(e&&"."===e.charAt(0)&&t){t=t.split("/"),t=t.slice(0,t.length-1),e=t.concat(e.split("/"));var n,i;for(n=0;i=e[n];n++)if("."===i)e.splice(n,1),n-=1;else if(".."===i){if(1===n&&(".."===e[2]||".."===e[0]))break;n>0&&(e.splice(n-1,2),n-=2)}e=e.join("/")}return e}function i(t,n){return function(){return u.apply(e,f.call(arguments,0).concat([t,n]))}}function a(e){return function(t){return n(t,e)}}function s(e){return function(t){h[e]=t}}function r(t){if(p.hasOwnProperty(t)){var n=p[t];delete p[t],d.apply(e,n)}return h[t]}function o(e,t){var i,s,o=e.indexOf("!");return-1!==o?(i=n(e.slice(0,o),t),e=e.slice(o+1),s=r(i),e=s&&s.normalize?s.normalize(e,a(t)):n(e,t)):e=n(e,t),{f:i?i+"!"+e:e,n:e,p:s}}var l=null;if(ABINEMASKME.fixSetTimeout)try{l=function(e,t){var n=Components.classes["@mozilla.org/timer;1"].createInstance(Components.interfaces.nsITimer),i={notify:function(){e(),n.cancel()}};return n.initWithCallback(i,t,Components.interfaces.nsITimer.TYPE_ONE_SHOT),n}}catch(c){}else l=window.setTimeout;var d,u,h={},p={},f=[].slice;"function"!=typeof define&&(d=function(n,a,l,c){t("Define "+n+" depends on "+a);var d,u,f,m,g,b,y=[];if(c||(c=n),"function"==typeof l){for(!a.length&&l.length&&(a=["require","exports","module"]),m=0;a.length>m;m++)if(b=o(a[m],c),f=b.f,"require"===f)y[m]=i(n);else if("exports"===f)y[m]=h[n]={},d=!0;else if("module"===f)u=y[m]={id:n,uri:"",exports:h[n]};else if(h.hasOwnProperty(f)||p.hasOwnProperty(f))y[m]=r(f);else{if(!b.p)throw n+" missing "+f;b.p.load(b.n,i(c,!0),s(f),{}),y[m]=h[f]}g=l.apply(h[n],y),n&&(u&&u.exports!==e?h[n]=u.exports:d||(h[n]=g))}else n&&(h[n]=l)},u=function(n,i,a,s){return t("Require "+n),"string"==typeof n?r(o(n,i).f):(n.splice||(i.splice?(n=i,i=arguments[2]):n=[]),s?d(e,n,i,a):l(function(){d(e,n,i,a)},15),u)},u.config=function(){return u},ABINEMASKME.require=u,ABINEMASKME.define=function(e,t,n){t.splice||(n=t,t=[]),p[e]=[e,t,n]})}(),ABINEMASKME.define("jquery",[],function(){function e(e){return e.abineMaskmejQuery||(Components.classes["@mozilla.org/moz/jssubscript-loader;1"].getService(Components.interfaces.mozIJSSubScriptLoader).loadSubScript("resource://idme/content/vendor/jquery-min.js",{window:e,document:e.document,navigator:e.navigator,location:e.location,setTimeout:e.setTimeout,clearTimeout:e.clearTimeout,setInterval:e.setInterval,clearInterval:e.clearInterval}),e.abineMaskmejQuery=e.jQuery.noConflict(!0)),e.abineMaskmejQuery}function t(t,n){try{var i=null;if(t&&t.jquery)return t;if(n&&n.jquery)return n.find(t);if(n&&(i=(n.ownerDocument||n).defaultView||n),!i&&t&&"string"!=typeof t&&(i=(t.ownerDocument||t).defaultView||t),i&&!i.abineMaskmejQuery&&(i=i.top),i)return i.abineMaskmejQuery||e(i),i.abineMaskmejQuery.apply(i,arguments);to.get=stack.trace}catch(a){if("string"==typeof t){var s="Please use a node/document as context to use jQuery from that window sandbox";throw true&&ABINEMASKME.log.error(s+"\n"+t+"\n"+a.stack),s}throw"Could not get window object from parameters to stub. Node disconnected from DOM?"}}return"undefined"==typeof $?t:$}),ABINEMASKME.define("abine/config",[],function(){var e=ABINEMASKME.config={version:"1.26.315",buildNum:"315.c7faa1ad40dd393051856941ba758f27c03fe94b",appName:"MaskMe",environment:"production",tags:["chromestore"],crypt:!0,silent:!1,payments:!0,browser:"Chrome",serverHost:"mm.abine.com",mappingServerHost:"mapping.abine.com",phoneServerHost:"phone.abine.com",licenseServerHost:"license.abine.com",emailServerHost:"emails.abine.com",disposableDomain:"opayq.com",paymentsServerHost:"payments.abine.com",logLevel:"ERROR",pfVersion:".790 Chrome development",mmVersion:"0.0.1 development"};return e.protocol="production"===ABINEMASKME.config.environment?"https://":"http://",e}),ABINEMASKME.require("abine/config"),ABINEMASKME.define("abine/timer",[],function(){var e=function(e,t){var n=Components.classes["@mozilla.org/timer;1"].createInstance(Components.interfaces.nsITimer),i={notify:function(){e(),n.cancel()}};return n.initWithCallback(i,t,Components.interfaces.nsITimer.TYPE_ONE_SHOT),n},t=function(e){try{e.cancel()}catch(t){}},n=function(e,t){var n=Components.classes["@mozilla.org/timer;1"].createInstance(Components.interfaces.nsITimer),i={notify:function(){e()}};return n.initWithCallback(i,t,Components.interfaces.nsITimer.TYPE_REPEATING_SLACK),n},i=function(e){try{e.cancel()}catch(t){}},a={};return a.setTimeout=window&&"function"==typeof window.setTimeout?function(){return ABINEMASKME.log,window.setTimeout.apply(window,arguments)}:e,a.clearTimeout=window&&"function"==typeof window.clearTimeout?function(){window.clearTimeout.apply(window,arguments)}:t,a.setInterval=window&&"function"==typeof window.setInterval?function(){return window.setInterval.apply(window,arguments)}:n,a.clearInterval=window&&"function"==typeof window.clearInterval?function(){window.clearInterval.apply(window,arguments)}:i,a}),ABINEMASKME.define("abine/intl",[],function(){return{getText:function(e,t){var n=null;e=e.replace(/\./g,"_");try{n=chrome.i18n.getMessage(e,t)}catch(i){}return n&&""!=n||(n="***"+e),n}}}),ABINEMASKME.define("abine/eventLogger",["abine/config"],function(e){function t(t){var n={},i=t&&t.split?t.split("#"):[];return 4==i.length?(n.error_tag=i[0],n.module=i[1],n.method=i[2],n.message=i[3]):(n.error_tag=n.module=n.method="not well-formed",n.message=t+""),n.browser=e.browser,n.build=e.buildNum,n.environment=e.environment,n.build_tag=e.tags[0],n.server_host=e.serverHost,n.mapping_server_host=e.mappingServerHost,n.license_server_host=e.licenseServerHost,n.phone_server_host=e.phoneServerHost,n.crypt=e.crypt,n.version=e.version,n.user_agent=window.navigator.userAgent,n}function n(t){var n={error:t},i=ABINEMASKME.user||ABINEMASKME.contentuser||ABINEMASKME.bguser;i&&(n.email_salt=i.getEmailSalt()),ABINEMASKME.require(["abine/ajax"],function(t){t.ajax({type:"POST",url:e.protocol+e.serverHost+"/api/errors",data:n,success:function(){s.debug("error reporting successful")},error:function(){s.debug("error reporting failed")}})})}function i(){var e=(new Date).toUTCString();if("undefined"!=typeof console)return{finest:function(t){console.debug("[FINEST]["+e+"]: "+t)},debug:function(t){console.debug("[DEBUG]["+e+"]: "+t)},info:function(t){console.info("[INFO]["+e+"]: "+t)},warn:function(t){console.warn("[WARNING]["+e+"]: "+t)},error:function(i){console.error("[ERROR]["+e+"]: "+i);var a=ABINEMASKME.user||ABINEMASKME.contentuser||ABINEMASKME.bguser;a&&a.shouldSendErrorReports()&&n(t(i))}};if("undefined"!=typeof Components){var i=Components.classes["@mozilla.org/consoleservice;1"].getService(Components.interfaces.nsIConsoleService);return{finest:function(t){i.logStringMessage("[FINEST]["+e+"]: "+t),dump("FINEST: "+t+"\n")},debug:function(t){i.logStringMessage("[DEBUG]["+e+"]: "+t),dump("DEBUG: "+t+"\n")},info:function(t){i.logStringMessage("[INFO]["+e+"]: "+t),dump("INFO: "+t+"\n")},warn:function(t){i.logStringMessage("[WARNING]["+e+"]: "+t),dump("WARNING: "+t+"\n")},error:function(a){i.logStringMessage("[ERROR]["+e+"]: "+a),dump("ERROR: "+a+"\n");var s=ABINEMASKME.user||ABINEMASKME.contentuser||ABINEMASKME.bguser;s&&s.shouldSendErrorReports()&&n(t(a))}}}}var a=function(){},s=i();switch(s.dumpObj=function(e){var t=typeof e;if("object"!=t||null===e)return"string"==t&&(e='"'+e+'"'),String(e);var n,i,a=[],r=e&&e.constructor==Array;for(n in e)i=e[n],t=typeof i,"string"==t?i='"'+i+'"':"object"==t&&null!==i&&(i=s.dumpObj(i)),a.push((r?"":'"'+n+'":')+String(i));return(r?"[":"{")+String(a)+(r?"]":"}")},e.logLevel){case"NONE":s.error=a;case"ERROR":s.warn=a;case"WARN":s.info=a;case"INFO":s.debug=a;case"DEBUG":s.finest=a}return s.info("Log level set to "+e.logLevel),ABINEMASKME.log=s,s}),ABINEMASKME.define("documentcloud/underscore",["abine/timer"],function(e){var t=e.setTimeout,n=e.clearTimeout;e.setInterval,e.clearInterval;var i=this,a=i._,s={},r=Array.prototype,o=Object.prototype,l=Function.prototype,c=r.push,d=r.slice,u=r.concat,h=o.toString,p=o.hasOwnProperty,f=r.forEach,m=r.map,g=r.reduce,b=r.reduceRight,y=r.filter,v=r.every,A=r.some,E=r.indexOf,M=r.lastIndexOf,_=Array.isArray,w=Object.keys,S=l.bind,k=function(e){return e instanceof k?e:this instanceof k?(this._wrapped=e,void 0):new k(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=k),exports._=k):i._=k,k.VERSION="1.4.4";var I=k.each=k.forEach=function(e,t,n){if(null!=e)if(f&&e.forEach===f)e.forEach(t,n);else if(e.length===+e.length){for(var i=0,a=e.length;a>i;i++)if(t.call(n,e[i],i,e)===s)return}else for(var r in e)if(k.has(e,r)&&t.call(n,e[r],r,e)===s)return};k.map=k.collect=function(e,t,n){var i=[];return null==e?i:m&&e.map===m?e.map(t,n):(I(e,function(e,a,s){i[i.length]=t.call(n,e,a,s)}),i)};var N="Reduce of empty array with no initial value";k.reduce=k.foldl=k.inject=function(e,t,n,i){var a=arguments.length>2;if(null==e&&(e=[]),g&&e.reduce===g)return i&&(t=k.bind(t,i)),a?e.reduce(t,n):e.reduce(t);if(I(e,function(e,s,r){a?n=t.call(i,n,e,s,r):(n=e,a=!0)}),!a)throw new TypeError(N);return n},k.reduceRight=k.foldr=function(e,t,n,i){var a=arguments.length>2;if(null==e&&(e=[]),b&&e.reduceRight===b)return i&&(t=k.bind(t,i)),a?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var r=k.keys(e);s=r.length}if(I(e,function(o,l,c){l=r?r[--s]:--s,a?n=t.call(i,n,e[l],l,c):(n=e[l],a=!0)}),!a)throw new TypeError(N);return n},k.find=k.detect=function(e,t,n){var i;return T(e,function(e,a,s){return t.call(n,e,a,s)?(i=e,!0):void 0}),i},k.filter=k.select=function(e,t,n){var i=[];return null==e?i:y&&e.filter===y?e.filter(t,n):(I(e,function(e,a,s){t.call(n,e,a,s)&&(i[i.length]=e)}),i)},k.reject=function(e,t,n){return k.filter(e,function(e,i,a){return!t.call(n,e,i,a)},n)},k.every=k.all=function(e,t,n){t||(t=k.identity);var i=!0;return null==e?i:v&&e.every===v?e.every(t,n):(I(e,function(e,a,r){return(i=i&&t.call(n,e,a,r))?void 0:s}),!!i)};var T=k.some=k.any=function(e,t,n){t||(t=k.identity);var i=!1;return null==e?i:A&&e.some===A?e.some(t,n):(I(e,function(e,a,r){return i||(i=t.call(n,e,a,r))?s:void 0}),!!i)};k.contains=k.include=function(e,t){return null==e?!1:E&&e.indexOf===E?-1!=e.indexOf(t):T(e,function(e){return e===t})},k.invoke=function(e,t){var n=d.call(arguments,2),i=k.isFunction(t);return k.map(e,function(e){return(i?t:e[t]).apply(e,n)})},k.pluck=function(e,t){return k.map(e,function(e){return e[t]})},k.where=function(e,t,n){return k.isEmpty(t)?n?null:[]:k[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},k.findWhere=function(e,t){return k.where(e,t,!0)},k.max=function(e,t,n){if(!t&&k.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.max.apply(Math,e);if(!t&&k.isEmpty(e))return-1/0;var i={computed:-1/0,value:-1/0};return I(e,function(e,a,s){var r=t?t.call(n,e,a,s):e;r>=i.computed&&(i={value:e,computed:r})}),i.value},k.min=function(e,t,n){if(!t&&k.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.min.apply(Math,e);if(!t&&k.isEmpty(e))return 1/0;var i={computed:1/0,value:1/0};return I(e,function(e,a,s){var r=t?t.call(n,e,a,s):e;i.computed>r&&(i={value:e,computed:r})}),i.value},k.shuffle=function(e){var t,n=0,i=[];return I(e,function(e){t=k.random(n++),i[n-1]=i[t],i[t]=e}),i};var C=function(e){return k.isFunction(e)?e:function(t){return t[e]}};k.sortBy=function(e,t,n){var i=C(t);return k.pluck(k.map(e,function(e,t,a){return{value:e,index:t,criteria:i.call(n,e,t,a)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return e.index<t.index?-1:1}),"value")};var B=function(e,t,n,i){var a={},s=C(t||k.identity);return I(e,function(t,r){var o=s.call(n,t,r,e);i(a,o,t)}),a};k.groupBy=function(e,t,n){return B(e,t,n,function(e,t,n){(k.has(e,t)?e[t]:e[t]=[]).push(n)})},k.countBy=function(e,t,n){return B(e,t,n,function(e,t){k.has(e,t)||(e[t]=0),e[t]++})},k.sortedIndex=function(e,t,n,i){n=null==n?k.identity:C(n);for(var a=n.call(i,t),s=0,r=e.length;r>s;){var o=s+r>>>1;a>n.call(i,e[o])?s=o+1:r=o}return s},k.toArray=function(e){return e?k.isArray(e)?d.call(e):e.length===+e.length?k.map(e,k.identity):k.values(e):[]},k.size=function(e){return null==e?0:e.length===+e.length?e.length:k.keys(e).length},k.first=k.head=k.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:d.call(e,0,t)},k.initial=function(e,t,n){return d.call(e,0,e.length-(null==t||n?1:t))},k.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:d.call(e,Math.max(e.length-t,0))},k.rest=k.tail=k.drop=function(e,t,n){return d.call(e,null==t||n?1:t)},k.compact=function(e){return k.filter(e,k.identity)};var P=function(e,t,n){return I(e,function(e){k.isArray(e)?t?c.apply(n,e):P(e,t,n):n.push(e)}),n};k.flatten=function(e,t){return P(e,t,[])},k.without=function(e){return k.difference(e,d.call(arguments,1))},k.uniq=k.unique=function(e,t,n,i){k.isFunction(t)&&(i=n,n=t,t=!1);var a=n?k.map(e,n,i):e,s=[],r=[];return I(a,function(n,i){(t?i&&r[r.length-1]===n:k.contains(r,n))||(r.push(n),s.push(e[i]))}),s},k.union=function(){return k.uniq(u.apply(r,arguments))},k.intersection=function(e){var t=d.call(arguments,1);return k.filter(k.uniq(e),function(e){return k.every(t,function(t){return k.indexOf(t,e)>=0})})},k.difference=function(e){var t=u.apply(r,d.call(arguments,1));return k.filter(e,function(e){return!k.contains(t,e)})},k.zip=function(){for(var e=d.call(arguments),t=k.max(k.pluck(e,"length")),n=new Array(t),i=0;t>i;i++)n[i]=k.pluck(e,""+i);return n},k.object=function(e,t){if(null==e)return{};for(var n={},i=0,a=e.length;a>i;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n},k.indexOf=function(e,t,n){if(null==e)return-1;var i=0,a=e.length;if(n){if("number"!=typeof n)return i=k.sortedIndex(e,t),e[i]===t?i:-1;i=0>n?Math.max(0,a+n):n}if(E&&e.indexOf===E)return e.indexOf(t,n);for(;a>i;i++)if(e[i]===t)return i;return-1},k.lastIndexOf=function(e,t,n){if(null==e)return-1;var i=null!=n;if(M&&e.lastIndexOf===M)return i?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var a=i?n:e.length;a--;)if(e[a]===t)return a;return-1},k.range=function(e,t,n){1>=arguments.length&&(t=e||0,e=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((t-e)/n),0),a=0,s=new Array(i);i>a;)s[a++]=e,e+=n;return s},k.bind=function(e,t){if(e.bind===S&&S)return S.apply(e,d.call(arguments,1));var n=d.call(arguments,2);return function(){return e.apply(t,n.concat(d.call(arguments)))}},k.partial=function(e){var t=d.call(arguments,1);return function(){return e.apply(this,t.concat(d.call(arguments)))}},k.bindAll=function(e){var t=d.call(arguments,1);return 0===t.length&&(t=k.functions(e)),I(t,function(t){e[t]=k.bind(e[t],e)}),e},k.memoize=function(e,t){var n={};return t||(t=k.identity),function(){var i=t.apply(this,arguments);return k.has(n,i)?n[i]:n[i]=e.apply(this,arguments)}},k.delay=function(e,n){var i=d.call(arguments,2);return t(function(){return e.apply(null,i)},n)},k.defer=function(e){return k.delay.apply(k,[e,1].concat(d.call(arguments,1)))},k.throttle=function(e,i){var a,s,r,o,l=0,c=function(){l=new Date,r=null,o=e.apply(a,s)};return function(){var d=new Date,u=i-(d-l);return a=this,s=arguments,0>=u?(n(r),r=null,l=d,o=e.apply(a,s)):r||(r=t(c,u)),o}},k.debounce=function(e,i,a){var s,r;return function(){var o=this,l=arguments,c=function(){s=null,a||(r=e.apply(o,l))},d=a&&!s;return n(s),s=t(c,i),d&&(r=e.apply(o,l)),r}},k.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},k.wrap=function(e,t){return function(){var n=[e];return c.apply(n,arguments),t.apply(this,n)}},k.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},k.after=function(e,t){return 0>=e?t():function(){return 1>--e?t.apply(this,arguments):void 0}},k.keys=w||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)k.has(e,n)&&(t[t.length]=n);return t},k.values=function(e){var t=[];for(var n in e)k.has(e,n)&&t.push(e[n]);return t},k.pairs=function(e){var t=[];for(var n in e)k.has(e,n)&&t.push([n,e[n]]);return t},k.invert=function(e){var t={};for(var n in e)k.has(e,n)&&(t[e[n]]=n);return t},k.functions=k.methods=function(e){var t=[];for(var n in e)k.isFunction(e[n])&&t.push(n);return t.sort()},k.extend=function(e){return I(d.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},k.pick=function(e){var t={},n=u.apply(r,d.call(arguments,1));return I(n,function(n){n in e&&(t[n]=e[n])}),t},k.omit=function(e){var t={},n=u.apply(r,d.call(arguments,1));for(var i in e)k.contains(n,i)||(t[i]=e[i]);return t},k.defaults=function(e){return I(d.call(arguments,1),function(t){if(t)for(var n in t)null==e[n]&&(e[n]=t[n])}),e},k.clone=function(e){return k.isObject(e)?k.isArray(e)?e.slice():k.extend({},e):e},k.tap=function(e,t){return t(e),e};var D=function(e,t,n,i){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof k&&(e=e._wrapped),t instanceof k&&(t=t._wrapped);var a=h.call(e);if(a!=h.call(t))return!1;switch(a){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var s=n.length;s--;)if(n[s]==e)return i[s]==t;n.push(e),i.push(t);var r=0,o=!0;if("[object Array]"==a){if(r=e.length,o=r==t.length)for(;r--&&(o=D(e[r],t[r],n,i)););}else{var l=e.constructor,c=t.constructor;if(l!==c&&!(k.isFunction(l)&&l instanceof l&&k.isFunction(c)&&c instanceof c))return!1;for(var d in e)if(k.has(e,d)&&(r++,!(o=k.has(t,d)&&D(e[d],t[d],n,i))))break;if(o){for(d in t)if(k.has(t,d)&&!r--)break;o=!r}}return n.pop(),i.pop(),o};k.isEqual=function(e,t){return D(e,t,[],[])},k.isEmpty=function(e){if(null==e)return!0;if(k.isArray(e)||k.isString(e))return 0===e.length;for(var t in e)if(k.has(e,t))return!1;return!0},k.isElement=function(e){return!(!e||1!==e.nodeType)},k.isArray=_||function(e){return"[object Array]"==h.call(e)},k.isObject=function(e){return e===Object(e)},I(["Arguments","Function","String","Number","Date","RegExp"],function(e){k["is"+e]=function(t){return h.call(t)=="[object "+e+"]"}}),k.isArguments(arguments)||(k.isArguments=function(e){return!(!e||!k.has(e,"callee"))}),k.isFunction=function(e){return"function"==typeof e},k.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},k.isNaN=function(e){return k.isNumber(e)&&e!=+e},k.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==h.call(e)},k.isNull=function(e){return null===e},k.isUndefined=function(e){return void 0===e},k.has=function(e,t){return p.call(e,t)},k.noConflict=function(){return i._=a,this},k.identity=function(e){return e},k.times=function(e,t,n){for(var i=Array(e),a=0;e>a;a++)i[a]=t.call(n,a);return i},k.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var x={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};x.unescape=k.invert(x.escape);var F={escape:new RegExp("["+k.keys(x.escape).join("")+"]","g"),unescape:new RegExp("("+k.keys(x.unescape).join("|")+")","g")};k.each(["escape","unescape"],function(e){k[e]=function(t){return null==t?"":(""+t).replace(F[e],function(t){return x[e][t]})}}),k.result=function(e,t){if(null==e)return null;var n=e[t];return k.isFunction(n)?n.call(e):n},k.mixin=function(e){I(k.functions(e),function(t){var n=k[t]=e[t];k.prototype[t]=function(){var e=[this._wrapped];return c.apply(e,arguments),L.call(this,n.apply(k,e))}})};var K=0;k.uniqueId=function(e){var t=++K+"";return e?e+t:t},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var O=/(.)^/,R={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},H=/\\|'|\r|\n|\t|\u2028|\u2029/g;k.template=function(e,t,n){var i;n=k.defaults({},n,k.templateSettings);var a=new RegExp([(n.escape||O).source,(n.interpolate||O).source,(n.evaluate||O).source].join("|")+"|$","g"),s=0,r="__p+='";e.replace(a,function(t,n,i,a,o){return r+=e.slice(s,o).replace(H,function(e){return"\\"+R[e]}),n&&(r+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(r+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),a&&(r+="';\n"+a+"\n__p+='"),s=o+t.length,t}),r+="';\n",n.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{i=new Function(n.variable||"obj","_",r)}catch(o){throw o.source=r,o}if(t)return i(t,k);var l=function(e){return i.call(this,e,k)};return l.source="function("+(n.variable||"obj")+"){\n"+r+"}",l},k.chain=function(e){return k(e).chain()};var L=function(e){return this._chain?k(e).chain():e};k.mixin(k),I(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];k.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],L.call(this,n)}}),I(["concat","join","slice"],function(e){var t=r[e];k.prototype[e]=function(){return L.call(this,t.apply(this._wrapped,arguments))}}),k.extend(k.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}});var U={},q=k,V=k.async;q.async=U,U.noConflict=function(){return q.async=V,U};var j=function(e,t){if(e.forEach)return e.forEach(t);for(var n=0;e.length>n;n+=1)t(e[n],n,e)},z=function(e,t){if(e.map)return e.map(t);var n=[];return j(e,function(e,i,a){n.push(t(e,i,a))}),n},W=function(e,t,n){return e.reduce?e.reduce(t,n):(j(e,function(e,i,a){n=t(n,e,i,a)}),n)},G=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};U.nextTick="undefined"!=typeof process&&process.nextTick?process.nextTick:function(e){t(e,0)},U.forEach=function(e,t,n){if(n=n||function(){},!e.length)return n();var i=0;j(e,function(a){t(a,function(t){t?(n(t),n=function(){}):(i+=1,i===e.length&&n(null))})})},U.forEachSeries=function(e,t,n){if(n=n||function(){},!e.length)return n();var i=0,a=function(){t(e[i],function(t){t?(n(t),n=function(){}):(i+=1,i===e.length?n(null):a())})};a()},U.forEachLimit=function(e,t,n,i){if(i=i||function(){},!e.length||0>=t)return i();var a=0,s=0,r=0;(function o(){if(a===e.length)return i();for(;t>r&&e.length>s;)s+=1,r+=1,n(e[s-1],function(t){t?(i(t),i=function(){}):(a+=1,r-=1,a===e.length?i():o())})})()};var J=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[U.forEach].concat(t))}},$=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[U.forEachSeries].concat(t))}},Q=function(e,t,n,i){var a=[];t=z(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n,i){a[e.index]=i,t(n)})},function(e){i(e,a)})};U.map=J(Q),U.mapSeries=$(Q),U.reduce=function(e,t,n,i){U.forEachSeries(e,function(e,i){n(t,e,function(e,n){t=n,i(e)})},function(e){i(e,t)})},U.inject=U.reduce,U.foldl=U.reduce,U.reduceRight=function(e,t,n,i){var a=z(e,function(e){return e}).reverse();U.reduce(a,t,n,i)},U.foldr=U.reduceRight;var X=function(e,t,n,i){var a=[];t=z(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n){n&&a.push(e),t()})},function(){i(z(a.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};U.filter=J(X),U.filterSeries=$(X),U.select=U.filter,U.selectSeries=U.filterSeries;var Y=function(e,t,n,i){var a=[];t=z(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n){n||a.push(e),t()})},function(){i(z(a.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};U.reject=J(Y),U.rejectSeries=$(Y);var Z=function(e,t,n,i){e(t,function(e,t){n(e,function(n){n?(i(e),i=function(){}):t()})},function(){i()})};U.detect=J(Z),U.detectSeries=$(Z),U.some=function(e,t,n){U.forEach(e,function(e,i){t(e,function(e){e&&(n(!0),n=function(){}),i()})},function(){n(!1)})},U.any=U.some,U.every=function(e,t,n){U.forEach(e,function(e,i){t(e,function(e){e||(n(!1),n=function(){}),i()})},function(){n(!0)})},U.all=U.every,U.sortBy=function(e,t,n){U.map(e,function(e,n){t(e,function(t,i){t?n(t):n(null,{value:e,criteria:i})})},function(e,t){if(e)return n(e);var i=function(e,t){var n=e.criteria,i=t.criteria;return i>n?-1:n>i?1:0};n(null,z(t.sort(i),function(e){return e.value}))})},U.auto=function(e,t){t=t||function(){};var n=G(e);if(!n.length)return t(null);var i={},a=[],s=function(e){a.unshift(e)},r=function(e){for(var t=0;a.length>t;t+=1)if(a[t]===e)return a.splice(t,1),void 0},o=function(){j(a.slice(0),function(e){e()})};s(function(){G(i).length===n.length&&(t(null,i),t=function(){})}),j(n,function(n){var a=e[n]instanceof Function?[e[n]]:e[n],l=function(e){if(e)t(e),t=function(){};else{var a=Array.prototype.slice.call(arguments,1);1>=a.length&&(a=a[0]),i[n]=a,o()}},c=a.slice(0,Math.abs(a.length-1))||[],d=function(){return W(c,function(e,t){return e&&i.hasOwnProperty(t)},!0)&&!i.hasOwnProperty(n)};if(d())a[a.length-1](l,i);else{var u=function(){d()&&(r(u),a[a.length-1](l,i))};s(u)}})},U.waterfall=function(e,t){if(t=t||function(){},!e.length)return t();var n=function(e){return function(i){if(i)t(i),t=function(){};else{var a=Array.prototype.slice.call(arguments,1),s=e.next();s?a.push(n(s)):a.push(t),U.nextTick(function(){e.apply(null,a)})}}};n(U.iterator(e))()},U.parallel=function(e,t){if(t=t||function(){},e.constructor===Array)U.map(e,function(e,t){e&&e(function(e){var n=Array.prototype.slice.call(arguments,1);1>=n.length&&(n=n[0]),t.call(null,e,n)})},t);else{var n={};U.forEach(G(e),function(t,i){e[t](function(e){var a=Array.prototype.slice.call(arguments,1);1>=a.length&&(a=a[0]),n[t]=a,i(e)})},function(e){t(e,n)})}},U.series=function(e,t){if(t=t||function(){},e.constructor===Array)U.mapSeries(e,function(e,t){e&&e(function(e){var n=Array.prototype.slice.call(arguments,1);1>=n.length&&(n=n[0]),t.call(null,e,n)})},t);else{var n={};U.forEachSeries(G(e),function(t,i){e[t](function(e){var a=Array.prototype.slice.call(arguments,1);1>=a.length&&(a=a[0]),n[t]=a,i(e)})},function(e){t(e,n)})}},U.iterator=function(e){var t=function(n){var i=function(){return e.length&&e[n].apply(null,arguments),i.next()};return i.next=function(){return e.length-1>n?t(n+1):null},i};return t(0)},U.apply=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var et=function(e,t,n,i){var a=[];e(t,function(e,t){n(e,function(e,n){a=a.concat(n||[]),t(e)})},function(e){i(e,a)})};U.concat=J(et),U.concatSeries=$(et),U.whilst=function(e,t,n){e()?t(function(i){return i?n(i):(U.whilst(e,t,n),void 0)}):n()},U.until=function(e,t,n){e()?n():t(function(i){return i?n(i):(U.until(e,t,n),void 0)})},U.queue=function(e,t){var n=0,i={tasks:[],concurrency:t,saturated:null,empty:null,drain:null,push:function(e,n){e.constructor!==Array&&(e=[e]),j(e,function(e){i.tasks.push({data:e,callback:"function"==typeof n?n:null}),i.saturated&&i.tasks.length==t&&i.saturated(),U.nextTick(i.process)})},process:function(){if(i.concurrency>n&&i.tasks.length){var t=i.tasks.shift();i.empty&&0==i.tasks.length&&i.empty(),n+=1,e(t.data,function(){n-=1,t.callback&&t.callback.apply(t,arguments),i.drain&&0==i.tasks.length+n&&i.drain(),i.process()})}},length:function(){return i.tasks.length},running:function(){return n}};return i};var tt=function(e){return function(t){var n=Array.prototype.slice.call(arguments,1);t.apply(null,n.concat([function(t){var n=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(t?console.error&&console.error(t):console[e]&&j(n,function(t){console[e](t)}))}]))}};return U.log=tt("log"),U.dir=tt("dir"),U.memoize=function(e,t){var n={},i={};t=t||function(e){return e};var a=function(){var a=Array.prototype.slice.call(arguments),s=a.pop(),r=t.apply(null,a);r in n?s.apply(null,n[r]):r in i?i[r].push(s):(i[r]=[s],e.apply(null,a.concat([function(){n[r]=arguments;var e=i[r];delete i[r];for(var t=0,a=e.length;a>t;t++)e[t].apply(null,arguments)}])))};return a.unmemoized=e,a},U.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},k}),ABINEMASKME.define("abine/backgroundEventLogger",["abine/config","storage","persistence","documentcloud/underscore"],function(e,t,n,i){function a(t){var n={},i=t?t.split("#"):[];return 4==i.length?(n.error_tag=i[0],n.module=i[1],n.method=i[2],n.message=i[3]):(n.error_tag=n.module=n.method="not well-formed",n.message=t),n.browser=e.browser,n.build=e.buildNum,n.environment=e.environment,n.build_tag=e.tags[0],n.server_host=e.serverHost,n.mapping_server_host=e.mappingServerHost,n.license_server_host=e.licenseServerHost,n.phone_server_host=e.phoneServerHost,n.crypt=e.crypt,n.version=e.version,n.user_agent=window.navigator.userAgent,n}function s(n){var a={error:n},s=function(t){t&&(a.email_salt=t),ABINEMASKME.require(["abine/ajax"],function(t){t.ajax({type:"POST",url:e.protocol+e.serverHost+"/api/errors",data:a,success:function(){l.debug("error reporting successful")},error:function(){l.debug("error reporting failed")}})})};t.Preference?t.Preference.findBy("key","Salt.ShieldedEmail",i.bind(function(e){s(e.value)},this)):s()}function r(){var e=(new Date).toUTCString();if("undefined"!=typeof console)return{finest:function(t){console.debug("[FINEST]["+e+"]: "+t)},debug:function(t){console.debug("[DEBUG]["+e+"]: "+t)},info:function(t){console.info("[INFO]["+e+"]: "+t)},warn:function(t){console.warn("[WARNING]["+e+"]: "+t)},error:function(n){console.error("[ERROR]["+e+"]: "+n),t.Preference&&t.Preference.findBy("key","shouldSendErrorReports",function(e){e.isTrue()&&s(a(n))})}};if("undefined"!=typeof Components){var n=Components.classes["@mozilla.org/consoleservice;1"].getService(Components.interfaces.nsIConsoleService);return{finest:function(t){n.logStringMessage("[FINEST]["+e+"]: "+t),dump("FINEST: "+t+"\n")},debug:function(t){n.logStringMessage("[DEBUG]["+e+"]: "+t),dump("DEBUG: "+t+"\n")},info:function(t){n.logStringMessage("[INFO]["+e+"]: "+t),dump("INFO: "+t+"\n")},warn:function(t){n.logStringMessage("[WARNING]["+e+"]: "+t),dump("WARNING: "+t+"\n")},error:function(i){n.logStringMessage("[ERROR]["+e+"]: "+i),dump("ERROR: "+i+"\n"),t.Preference&&t.Preference.findBy("key","shouldSendErrorReports",function(e){e&&e.isTrue()&&s(a(i))})}}}}var o=function(){},l=r();switch(l.dumpObj=function(e){var t=typeof e;if("object"!=t||null===e)return"string"==t&&(e='"'+e+'"'),String(e);var n,i,a=[],s=e&&e.constructor==Array;for(n in e)i=e[n],t=typeof i,"string"==t?i='"'+i+'"':"object"==t&&null!==i&&(i=l.dumpObj(i)),a.push((s?"":'"'+n+'":')+String(i));return(s?"[":"{")+String(a)+(s?"]":"}")},e.logLevel){case"NONE":l.error=o;case"ERROR":l.warn=o;case"WARN":l.info=o;case"INFO":l.debug=o;case"DEBUG":l.finest=o}return l.info("Log level set to "+e.logLevel),ABINEMASKME.log=l,l}),ABINEMASKME.define("abine/backgroundInit",["abine/storageRouter","abine/storage/registry","abine/formSubmitDetector","abine/saveForms","abine/window","storage","abine/securityManager","abine/stubs","abine/toolbar","abine/timer","abine/ajax","abine/config","abine/pageEvents","abine/tabs","persistence","abine/mappingServer","modules","documentcloud/underscore","abine/browserSyncStorage"],function(e,t,n,i,a,s,r,o,l,c,d,u,h,p,f,m,g,b,y){function v(a){if(!S){S=!0,b.each(b.values(g),function(e){e.setMessenger&&e.setMessenger(a)}),n.formSubmitDetector.init(a),p.tabHelper.init(a);var s=new e.StorageRouter({messenger:a,noMigrations:!1,ready:function(){A(a)}});t.registerStorageEntities(s),i.init(a),h.initialize(a),o.start(a),w(a)}}function A(e){r.load(e),g.criticalProcess.setMessenger(e),_(function(e){e?c.setTimeout(b.bind(function(){g.mappingsModule.startDailyMappingCheck(function(){g.panelsModule.ensureDynamicPanels()})},this),36e5):g.mappingsModule.startDailyMappingCheck(function(){g.panelsModule.ensureDynamicPanels(function(){})})})}function E(e){e=e||k,s.Preference.findOrCreate({key:"installUserAgent",value:navigator.userAgent},function(){s.Preference.findOrCreate({key:"installVersion",value:u.version},function(){s.Preference.findOrCreate({key:"installTags",value:u.tags[0]},function(){f.flush(function(){e()})})})})}function M(e){e=e||k,d.ajax({url:"https://www.abine.com/maskme/v2/tag.php?currentTag="+u.tags[0],success:function(t){t=JSON.parse(t),t&&""!=t&&t.abineMaskMeTag&&""!=t.abineMaskMeTag?(u.tags.unshift(t.abineMaskMeTag),s.Preference.createOrModify({key:"dynamicTag",value:t.abineMaskMeTag},function(){e()})):e()},error:function(){e()}})}function _(e){e=e||k,s.Preference.findBy("key","autoOpenEditUser",function(t){if(!t||"false"===t.value)return s.Preference.findBy("key","dynamicTag",function(t){t&&u.tags.unshift(t.value),g.licenseModule.startDailyTouch(function(){e()
})}),void 0;var n=!0;t.value="false",l.freshInstall(),E(function(){M(function(){y.get("hasRegistered",function(t){var i=t.hasRegistered?"pages/index.html#userLogin":"pages/index.html#userRegistration";t.hasRegistered||g.licenseModule.autoRegister(),g.licenseModule.startDailyTouch(function(){u.silent||a.createTab({localUrl:i}),e(n)})})})})})}function w(e){e.on("window:createTab",function(e){e.panelData&&(ABINEMASKME.lastPanel||(ABINEMASKME.lastPanel={}),ABINEMASKME.lastPanel[e.panelData.action]=e.panelData.type),a.createTab(e)})}var S=!1,k=function(){};return ABINEMASKME.bguser={shouldSendErrorReports:function(){var e=s.Preference.getSync("shouldSendErrorReports");return e&&e.isTrue()},getEmailSalt:function(){var e=s.Preference.getSync("Salt.ShieldedEmail");return e&&e.value}},{initialize:v}}),ABINEMASKME.define("abine/contentManager",["documentcloud/underscore","jquery","abine/core","abine/contentMessenger","abine/window","abine/timer","abine/formAnalyzer","abine/formStrategy","models","abine/config","abine/url","abine/proxies","abine/views/unlockPanel","abine/views/notificationPanel","abine/assets","abine/views/paymentHelperPanel"],function(e,t,n,i,a,s,r,o,l,c,d,u,h,p,f,m){function g(e){var t=0,n=0;if(e.ownerDocument,e.offsetParent)do t+=e.offsetLeft,n+=e.offsetTop;while(e=e.offsetParent);return{left:t,top:n}}var b={zIndex:"2147483647",position:"absolute",top:"20px",right:"20px",overflow:"hidden",borderWidth:"0px",background:"transparent",backgroundColor:"transparent"};allowedHostsRegex="development"==c.environment?/(^(.+\.)?abine\.com$)|(^(.+\.)?idme\.dev$)|(^(.+\.)?license-platform\.dev$)|(^(.+\.)?idme-platform\.dev$)|(^localhost(:[0-9]+)?$)/i:/^(.+\.)?abine\.com$/i;var y=n.BaseClass.extend({initialize:function(n){return this.document=n.document,this.href=this.document.location?this.document.location.href:null,this.domain=n.domain||(this.href?d.getTLD(this.href):null),n.force||this.document.defaultView==this.document.defaultView.top?(this.messenger=new i.ContentMessenger({eventAggregator:n.eventAggregator,document:n.document}),this.document.defaultView&&this.document.defaultView==this.document.defaultView.top&&(this.messenger.on("background:saveForm:notification",e.bind(this.showNotification,this)),this.messenger.on("contentManager:processNewFrame",e.bind(function(e){var t=this.document.getElementById(e);if(t){var n=t.contentWindow||t.contentDocument;n&&(n.document&&(n=n.document),this.setupFormsInFrame(n,t))}},this))),t(this.document).ready(e.bind(this.hookDocumentEventHandlers,this,this.document)),this.messenger.on("background:failedSubmitDetector:recheckForms",e.bind(function(){this.startFormHelpers()},this)),"Firefox"==ABINEMASKME.config.browser?u.connect(null):u.connect(this.messenger),this.lockedCB=e.bind(this.locked,this),this.unlockedCB=e.bind(this.unlocked,this),u.securityManager.on("background:securityManager:locked",this.lockedCB),u.securityManager.on("background:securityManager:unlocked",this.unlockedCB),this._locked=null,u.securityManager.isLocked(e.bind(function(e){this._locked=e},this)),this.domain&&this.messenger.send("contentscript:contextmenu:refresh",{domain:this.domain}),t(this.document).bind("contextmenu",e.bind(this.trackLastElementClicked,this)),this.messenger.on("background:contextmenu:fill",e.bind(this.fillField,this)),this.messenger.on("background:contextmenu:maskcard",e.bind(this.maskCardContextMenu,this)),this.messenger.on("broadcast:preference:reload",e.bind(function(){this.loadUserPreferences()},this)),ABINEMASKME.contentuser={shouldSendErrorReports:e.bind(function(){return this.preferences&&this.preferences.isPrefTrue("shouldSendErrorReports")},this),getEmailSalt:e.bind(function(){return this.preferences?this.preferences.getPref("Salt.ShieldedEmail"):"NULL PREFERENCES"},this),hasRegEmail:e.bind(function(){return this.preferences?this.preferences.hasPref("regEmail"):!1},this),shieldedEmails:new l.ShieldedEmailCollection},ABINEMASKME.contentuser.shieldedEmails.fetchAll(),this.notifyInit(),void 0):(this.messenger={send:function(){}},void 0)},triggerKeyboardEvent:function(e,t){var n=this.document.createEvent("KeyboardEvent");n.initKeyboardEvent?n.initKeyboardEvent(e,!0,!0,null,!1,!1,!1,!1,9,0):n.initKeyEvent&&n.initKeyEvent(e,!0,!0,null,!1,!1,!1,!1,9,0),t.dispatchEvent(n)},maskCardContextMenu:function(){if(this.lastElementClicked){var n={element:this.lastElementClicked,dataType:"/financial/creditcard/number"};this.createPanel({style:{},secured:!0,panelWidth:400,field:n,ready:e.bind(function(e){var i=new m({field:n,formEl:this.lastElementClicked.parentNode,contentManager:this,fromContextMenu:!0,authToken:this.preferences.getPref("authToken"),beginnerMode:this.preferences.getPref("beginnerMode"),hasRegistered:this.preferences.isPrefTrue("hasRegistered"),entitledToPayments:this.preferences.isPrefTrue("entitledToPayments"),hasEnabledPayments:this.preferences.isPrefTrue("hasEnabledPayments"),dynamicPanel:null,dynamicPanelsJSON:"",fields:[n],domain:this.domain,el:t("<div></div>",e).get(0)});i.bind("remove",function(){try{i.remove()}catch(e){}this.removePanels()},this),i.bind("render",function(){this.autoResizePanels()},this),t("body",e).append(i.el)},this)})}},fillField:function(e){var n=e.element||this.lastElementClicked;if(n){"/password"==e.dataType&&(!this.generatedPassword&&e.generatedNow?this.generatedPassword=e.value:this.generatedPassword&&e.generatedNow&&(e.value=this.generatedPassword)),t(n).val(e.value),e.name=n.getAttribute("name"),e.id=n.getAttribute("id"),this.contextForm||(this.contextForm=t("<form maskMeFilled='yes'></form>",this.document));var i=t(n).clone();i.attr("abinedatatype",e.dataType),this.contextForm.append(i),t(this.contextForm.get(0)).data("mmFields",null),this.messenger.send("panel:fill",{fieldData:e,formData:r.getFormData(this.contextForm.get(0),this.domain)})}},trackLastElementClicked:function(e){("input"==e.target.localName||"textarea"==e.target.localName)&&(this.lastElementClicked=e.target)},isLocked:function(){return this._locked},locked:function(){this._locked=!0,this.trigger("locked"),this.domain&&this.messenger.send("contentscript:contextmenu:refresh",{domain:this.domain})},unlocked:function(){this._locked=!1,this.trigger("unlocked"),this.domain&&this.messenger.send("contentscript:contextmenu:refresh",{domain:this.domain})},notifyInit:function(){if(this.href){var e={url:this.href,domain:this.domain};this.messenger.send("contentManager:init",e),this.trigger("contentManager:init",e)}},start:function(){return null===this._locked?(s.setTimeout(e.bind(function(){this.start()},this),100),void 0):(this.blacklistedSites?this.loadUserPreferences(e.bind(this.startFormHelpers,this)):(this.blacklistedSites=new l.BlacklistedSiteCollection,this.blacklistedSites.loadBlacklistedForDomain(this.domain,e.bind(function(t){this.blacklisted=t,this.loadUserPreferences(e.bind(this.startFormHelpers,this))},this))),void 0)},loadUserPreferences:function(t){t=t||function(){},this.preferences=new l.PreferenceCollection({}),this.preferences.bind("sync:success",e.once(e.bind(function(){t.call(this)},this))),this.preferences.bind("sync:error",e.bind(function(){t.call(this)},this)),this.preferences.fetchAll()},arrayFromNodeList:function(e){return Array.prototype.slice.call(e)},hookForUserIntent:function(){this.userIntent=!0},hookNewFormsOnClick:function(n){if(!this.blacklisted){this.formHelpers=this.formHelpers||[];var i=n.target;if("input"===i.nodeName.toLowerCase()){var a=i.form||t(i).closest("form").get(0),o=null;a?(o=e(this.formHelpers).find(function(e){return e.formEl==a?!0:void 0}),o&&r.hasFormChanged(a)&&(o.cleanup(),this.formHelpers=e(this.formHelpers).filter(function(e){return e!=o}),o=null,r.clearFormCache(a)),o||this.setupFormHelperForFormEl(a,[],function(){s.setTimeout(function(){t(i).trigger("focus")},50)})):(o=e(this.formHelpers).find(function(e){for(var t=i.parentNode;t&&t!=e.formEl;)t=t.parentNode;return e.formEl==t?!0:void 0}),o?s.setTimeout(function(){t(i).trigger("focus")},50):this.startFormHelpers(function(){o=e(this.formHelpers).find(function(e){for(var t=i.parentNode;t&&t!=e.formEl;)t=t.parentNode;return e.formEl==t?!0:void 0}),s.setTimeout(function(){t(i).trigger("focus")},50)}))}}},setupFormHelperForFormEl:function(t,n,i){var a=null,s=null;if(this.domain&&this.domain.match(allowedHostsRegex)&&t.hasAttribute("datatype-ignore"))return i(),void 0;var c=r.getFormSignature(this.domain,t),d=null;if(this.formMappings&&(d=this.formMappings.find(function(e){return e.get("signature")==c?!0:!1})),s=d?d.get("formType"):r.getFormType(t),s==r.LOGIN_FORM?a=o.LoginHelper:s==r.REGISTRATION_FORM?a=o.RegistrationHelper:s==r.OTHER_FORM?a=o.OtherHelper:s==r.CHANGEPASSWORD_FORM?a=o.ChangePasswordHelper:s==r.LOGIN_REGISTRATION_FORM?a="loginRegisterHelper":s==r.CHECKOUT_FORM&&(a=o.CheckoutHelper),a){var u={};if(t.elements)for(var h=0;t.elements.length>h;h++)t.elements[h].name&&(u[t.elements[h].name]=1);var p=t.hasAttribute("action")?t.getAttribute("action"):"";n.push({url:p,type:s,fields:u});var f,m;if(d&&(m={},e.each(d.fields.models,function(e){m[e.get("signature")]=e.get("dataType")})),"loginRegisterHelper"==a||a==o.LoginHelper){var g=new l.Site({domain:this.domain}),b=e.bind(function(e){e&&true&&ABINEMASKME.log.error("[ERROR CALLBACK]#[abine/common/content_manager]#[setupFormHelperForFormEl]# error while loading accounts for site"),a=e||!g.accounts||0==g.accounts.length?"loginRegisterHelper"==a?o.RegistrationHelper:a:o.LoginHelper,f=new a({el:t,mappedFields:m,contentManager:this,preferences:this.preferences,site:g}),this.formHelpers.push(f),i()},this);this.domain?g.loadAccounts(!1,b):b()}else f=new a({el:t,mappedFields:m,contentManager:this,preferences:this.preferences}),this.formHelpers.push(f),i()}},hookDocumentEventHandlers:function(n){this.userIntentHandler?(t(n).off("keydown",this.userIntentHandler),t(n).off("mousedown",this.userIntentHandler),t(n).off("mousedown",this.hookNewFormsOnClickHandler)):(this.userIntentHandler=e.bind(this.hookForUserIntent,this),this.hookNewFormsOnClickHandler=e.bind(this.hookNewFormsOnClick,this)),t(n).on("keydown",this.userIntentHandler),t(n).on("mousedown",this.userIntentHandler),t(n).on("mousedown",this.hookNewFormsOnClickHandler)},startFormHelpers:function(t){if(this.blacklisted)return t&&t(),void 0;this.hookDocumentEventHandlers(this.document);var n=Date.now();this.formHelpers=this.formHelpers||[],this.innerFrames=this.innerFrames||{};var i=this.arrayFromNodeList(this.document.getElementsByTagName("form")),a=this.arrayFromNodeList(this.document.getElementsByTagName("iframe"));if(e(a).each(function(t){try{var n=t.contentWindow||t.contentDocument;if(n){n.document&&(n=n.document),n.documentElement.mmFormsProcessed=!0;var a=this.arrayFromNodeList(n.getElementsByTagName("form"));if(a.length>0){var s="iframe."+Math.random();this.innerFrames[s]=t,e(a).each(function(e){e.setAttribute("abFrameId",s)}),i=i.concat(a)}}}catch(r){}},this),i=i.concat(r.getFieldGroupsWithoutForm(this.document)),i=e(i).filter(e.bind(function(e){for(var t=0;this.formHelpers.length>t;t++)if(this.formHelpers[t].formEl==e)return!1;return!0},this)),this.formsData=this.formsData||[],0==i.length)return t&&t(),void 0;var s=e.bind(function(){e.async.forEachSeries(i,e.bind(function(e,t){this.setupFormHelperForFormEl(e,this.formsData,t)},this),e.bind(function(e){e&&true&&ABINEMASKME.log.error("[ERROR CALLBACK]#[abine/common/content_manager]#[startFormHandlers]# error event in setupFormHelperForFormEl while doing formElements async.forEach"),this.messenger.send("contentManager:formsInitialized",{forms:this.formsData,domain:this.domain}),this.trigger("contentManager:formsInitialized",{forms:this.formsData,domain:this.domain});{Date.now()-n}t&&t()},this))},this);!this.formMappings&&0!==i.length&&this.domain?(this.formMappings=new l.MappedFormCollection({}),this.formMappings.fetchAllByDomain(this.domain,e.bind(function(){s()},this))):s()},stopFormHelpers:function(){e(this.formHelpers).each(function(e){e.cleanup()}),this.formHelpers=[],this.formData=[],this.innerFrames=[]},setupFormsInFrame:function(n,i){if(n.documentElement&&!n.documentElement.mmFormsProcessed&&!this.blacklisted){this.hookDocumentEventHandlers(n),this.formHelpers=this.formHelpers||[],this.innerFrames=this.innerFrames||{},this.formsData=this.formsData||[];var a=null;!i&&n.defaultView&&n.defaultView.frameElement&&(i=n.defaultView.frameElement),i&&(a="iframe."+Math.random(),this.innerFrames[a]=i),n.documentElement.mmFormsProcessed=!0,t(n).bind("click",e.bind(this.hookNewFormsOnClick,this));var s=this.arrayFromNodeList(n.getElementsByTagName("form"));s=s.concat(r.getFieldGroupsWithoutForm(n));var o=[];e.async.forEachSeries(s,e.bind(function(e,t){a&&e.setAttribute("abFrameId",a),this.setupFormHelperForFormEl(e,o,t)},this),e.bind(function(e){e&&true&&ABINEMASKME.log.error("[ERROR CALLBACK]#[abine/common/content_manager]#[setupFormsInFrame]# error in setupFormHelperForFormEl while doing formElements async.forEach"),this.formsData=this.formsData.concat(o),this.messenger.send("contentManager:formsInitialized",{forms:o,domain:this.domain}),this.trigger("contentManager:formsInitialized",{forms:o,domain:this.domain})},this))}},triggerFocusOnElement:function(e){t(e).trigger("focus")},getPanelForDataType:function(t,n){var i=e.find(t,function(e){return e.field_type==n});return i?i:!1},createPanel:function(t){if(t.style=e.extend({},b,t.style),t.document=this.document,t.field){var n=this.innerFrames;t.ready=e.wrap(t.ready,function(e,i,a){v(i,a.parentElement,t.field.element,n),e(i,a)}),this._currentPanelField=t.field}return t.secured&&this.isLocked()&&this.createLoginPanel(t),t.panelWidth||(t.panelWidth=350),a.createPanel(t)},/**
       * @license
       * Array Remove Copyright (c) John Resig (MIT Licensed)
       */
removeFromArray:function(e,t,n){var i=e.slice((n||t)+1||e.length);return e.length=0>t?e.length+t:t,e.push.apply(e,i)},showNotification:function(n){if(this.preferences.getPref("showNotifications")&&n){var i=parseInt(this.preferences.getPref("countNotifications"))+1;this.preferences.setPref("countNotifications",i);var a=i>10?3e3:1e4;n.height=n.height?n.height:35,this.createPanel({className:"abineNotificationPanel",panelWidth:n.panelWidth,panelHeight:n.height,style:{borderRadius:"8px",height:n.height+"px",position:"Firefox"==ABINEMASKME.config.browser?"absolute":"fixed"},ready:e.bind(function(i,s){var r=p.NotificationPanelView;n.neverFade&&(r=p.CardNotificationPanelView);var o=new r({notification:n,domain:this.domain,el:t("<div></div>",i).get(0),timeout:a});this.notificationViews||(this.notificationViews=[]),this.notificationViews.unshift(s),o.bind("hide",function(){var t=e.find(this.notificationViews,function(e){return e==s});t&&(t.style.display="none")},this),o.bind("remove",function(){for(var e=0,n=0;this.notificationViews.length>n;n++)this.notificationViews[n]==s&&(e=n);if(this.removeFromArray(this.notificationViews,e),o.remove(),t(s.parentElement).remove(),this.notificationViews.length>0)for(var i=10,n=this.notificationViews.length-1;n>=0;n--)this.notificationViews[n].parentElement.style.top=i+"px",i+=this.notificationViews[n].parentElement.offsetHeight+5},this);var l=10;e.each(this.notificationViews,function(e){l+=e.parentElement.offsetHeight+5}),s.parentElement.style.top=l+"px",o.bind("render",function(){this.autoResizePanels()},this),t("body",i).append(o.el)},this)})}},createLoginPanel:function(n){n.contentManager=this,n.ready=e.bind(function(e,i){var a=this.innerFrames;v(e,i.parentElement,n.field.element,a);var s=new h({field:n.field,contentManager:n.contentManager,preferences:n.contentManager.preferences,el:t("<div></div>",e).get(0),doc:e});s.bind("remove",function(){s.remove(),this.removePanels()},this),s.bind("render",function(){this.autoResizePanels()},this),t("body",e).append(s.el)},this)},isPanelShown:function(e){return this._currentPanelField&&this._currentPanelField==e},autoResizePanels:function(){a.autoResizePanels({document:this.document})},removePanels:function(e){a.removePanels({document:this.document,cb:e})},destroy:function(){u.securityManager.off("background:securityManager:locked",this.lockedCB),u.securityManager.off("background:securityManager:unlocked",this.unlockedCB),"Firefox"!=ABINEMASKME.config.browser&&u.disconnect(),this.stopFormHelpers(),this.messenger.send("contentManager:destroy"),this.messenger.destroy(),delete this.messenger}}),v=function(e,n,i,a){function s(){var e=null;if(i.form){var n=i.form.getAttribute("abFrameId");n&&n in a&&(e=a[n])}if(!e)try{e=i.ownerDocument.defaultView.frameElement}catch(s){}if(e){var o;try{o=t(e).offset()}catch(s){o=g(e)}r.top+=o.top+1-i.ownerDocument.body.scrollTop,r.left+=o.left-i.ownerDocument.body.scrollLeft}}var r;try{try{r=t(i).offset();try{i.ownerDocument!=n.ownerDocument&&s()}catch(o){}}catch(o){r=g(i),s()}r.top+=t(i,e).outerHeight()}catch(o){r={top:0,left:0}}n.style.top=r.top+"px",n.style.left=r.left+"px"};return{ContentManager:y}}),ABINEMASKME.define("abine/contextHelper",["documentcloud/underscore","abine/window","storage","abine/password","abine/config"],function(e,t,n,i,a){return{onClick:function(s,r,o,l,c){if(r.indexOf("abine_maskme_accountfield_")>=0){var d=r.split("accountfield_")[1];n.AccountField.load(d,e.bind(function(e){this.fillFieldInTab(s,o,{element:c,value:e.value,dataType:e.dataType,origin:e.origin})},this))}else switch(r){case"abine_maskme_email_mask":n.ShieldedEmail.index(null,e.bind(function(t){n.DisposableEmail.createOnServer({sender:o,payload:{targetGuid:t[0].guid,label:l}},e.bind(function(e){this.fillFieldInTab(s,o,{element:c,value:e.getAddress(),dataType:"/contact/email",origin:"disposable",disposableGUID:e.guid})},this))},this));break;case"abine_maskme_email_disclose":n.Preference.findBy("key","regEmail",e.bind(function(i){i?t.createTab({localUrl:"pages/index.html#editUser/email"}):n.ShieldedEmail.index(null,e.bind(function(e){this.fillFieldInTab(s,o,{element:c,value:e[0].email,dataType:"/contact/email",origin:""})},this))},this));break;case"abine_maskme_phone_mask":n.DisposablePhone.index(null,e.bind(function(e){this.fillFieldInTab(s,o,{element:c,value:e[0].getPrettyNumber(),origin:"disposable",disposableGUID:e[0].id,dataType:"/contact/phone"})},this));break;case"abine_maskme_phone_disclose":n.ShieldedPhone.index(null,e.bind(function(e){this.fillFieldInTab(s,o,{element:c,value:e[0].getPrettyNumber(),origin:"",dataType:"/contact/phone"})},this));break;case"abine_maskme_card_mask":this.triggerCreditCardPanelInTab(s,o,{});break;case"abine_maskme_activate_card":t.createTab({localUrl:"pages/index.html#payments"});break;case"abine_maskme_password_mask":this.fillFieldInTab(s,o,{element:c,value:i.generateRandomPassword(),origin:"strong",generatedNow:!0,dataType:"/password"});break;case"abine_maskme_unlock":t.createTab({forceReload:!0,localUrl:"pages/index.html#unlock"});break;case"abine_maskme_setup_phone":var u=function(){t.createTab({forceReload:!0,localUrl:"pages/index.html#userInfo"})};n.Preference.batchFindBy([{by:"key",value:"entitledToPhone"},{by:"key",value:"authToken"},{by:"key",value:"regEmail"},{by:"key",value:"regPassword"}],function(e){var i=e.entitledToPhone,s=e.authToken,r=e.regEmail,o=e.regPassword;!i||i.isFalse()?s&&s.value&&""!=s.value?n.ShieldedEmail.getDefault({},function(e){if(e&&""!=e.email){var n=a.protocol+a.licenseServerHost+"/subscriptions/id_me?auth_token="+s.value+"&email="+e.email+"&feature=phone";(r||o)&&(n+="&notsetup=true"),t.createTab({force:!0,url:n})}else u()}):u():t.createTab({localUrl:"pages/index.html#editUser/phone"})});break;case"abine_maskme_blacklisted":t.createTab({localUrl:"pages/index.html#blacklist"})}},fillFieldInTab:function(e,t,n){e.send("background:contextmenu:fill",n,t)},triggerCreditCardPanelInTab:function(e,t,n){e.send("background:contextmenu:maskcard",n,t)}}}),ABINEMASKME.define("abine/core",["documentcloud/underscore"],function(e){Events={on:function(e,t,n){var i=this._callbacks||(this._callbacks={}),a=i[e]||(i[e]={}),s=a.tail||(a.tail=a.next={});return s.callback=t,s.context=n,a.tail=s.next={},this},off:function(e,t){var n,i,a;if(e){if(n=this._callbacks)if(t){if(i=n[e])for(;(a=i)&&(i=i.next);)if(i.callback===t){a.next=i.next,i.context=i.callback=null;break}}else n[e]={}}else this._callbacks=null;return this},trigger:function(e){var t,n,i,a,s,r=["all",e];if(!(n=this._callbacks))return this;for(;s=r.pop();)if(t=n[s])for(a="all"==s?arguments:Array.prototype.slice.call(arguments,1);t=t.next;)(i=t.callback)&&i.apply(t.context||this,a);return this},once:function(e,t,n){function i(){return a.off(e,i),t.apply(this,arguments)}var a=this;return this.on(e,i,n)},onceAny:function(){function e(){for(var n=0;t.length>n;n++)this.off.apply(this,[t[n][0],e]),this.off.apply(this,t[n])}for(var t=arguments,n=0;arguments.length>n;n++)this.on.apply(this,arguments[n]),this.on.apply(this,[arguments[n][0],e]);return this}};var t=function(){},n=function(n,i,a){var s;return s=i&&i.hasOwnProperty("constructor")?i.constructor:function(){return n.apply(this,arguments)},e.extend(s,n),t.prototype=n.prototype,s.prototype=new t,i&&e.extend(s.prototype,i),a&&e.extend(s,a),s.prototype.constructor=s,s.__super__=n.prototype,s},i=function(e,t){var i=n(this,e,t);return i.extend=this.extend,i},a=function a(){this.initialize.apply(this,arguments)};return e.extend(a.prototype,Events,{initialize:function(){}}),a.extend=i,{BaseClass:a,Events:Events}}),ABINEMASKME.define("abine/emailServer",["documentcloud/underscore","abine/ajax","abine/config","abine/server","abine/core"],function(e,t,n,i,a){var s=n.protocol+n.emailServerHost,r=s+"/api/v2/disableDisposable",o=s+"/api/v2/enableDisposable",l=s+"/api/v2/readDisposables",c=s+"/api/v2/readTarget",d=s+"/api/v2/generateDisposable",u=s+"/api/v2/disposableDomains",h=s+"/api/v2/disableAndDeleteDisposable",p=s+"/api/v2/webmail",f=a.BaseClass.extend({initialize:function(e){this.options=this.options||e||{},this.server=this.options.server||new i.server},getInbox:function(e,t){this.server.makeRequest({server:"email",action:"getInbox",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:p,type:"GET"})},getMail:function(e,t){this.server.makeRequest({server:"email",action:"getMail",defaults:{},required:["mid"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:p+"/"+e.mid,type:"GET"})},getDisposableDomains:function(e,t){this.server.makeRequest({server:"email",action:"getDisposableDomains",defaults:{},required:["guid"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:u,type:"GET"})},disableDisposable:function(e,t){this.server.makeRequest({server:"email",action:"disableDisposable",defaults:{},required:["guid"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:r,type:"PUT"})},disableAndDeleteDisposable:function(e,t){this.server.makeRequest({server:"email",action:"disableAndDeleteDisposable",defaults:{},required:["guid"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:h,type:"DELETE"})},enableDisposable:function(e,t){this.server.makeRequest({server:"email",action:"enableDisposable",defaults:{},required:["guid"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:o,type:"PUT"})},readDisposables:function(e,t){this.server.makeRequest({server:"email",action:"readDisposables",defaults:{},required:["guid"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:l,type:"GET"})},readTarget:function(e,t){this.server.makeRequest({server:"email",action:"readTarget",defaults:{},required:["target_email"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:c,type:"GET"})},generateDisposable:function(e,t){this.server.makeRequest({server:"email",action:"generateDisposable",defaults:{domain:n.disposableDomain},required:["guid","domain"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:d,type:"POST"})}});return f}),ABINEMASKME.define("abine/failedSubmitDetector",["documentcloud/underscore","abine/core","storage","abine/timer","persistence","abine/url"],function(e,t,n,i,a,s){function r(t,n,i,a){if(u(n),n in y){var s=y[n],r=s.submitData;if(delete y[n],i)return o(s,a),void 0;var l=!1;e.each(t.forms,function(t){if(t.type==r.type&&t.fields){var n=0,i=0;e.each(r.data,function(e){e.name in t.fields?n++:i++}),n>=2&&n>i&&(l=!0)}}),l&&o(s,a),l||A.trigger("background:saveForm:retained",{type:s.type,formType:s.submitData.type,accountId:s.accountId,tabId:n,insuranceSubmit:s.submitData.insuranceSubmit,noPassword:s.submitData.noPassword,accountType:s.accountType})}else A.trigger("background:saveForm:retained",null),a&&a()}function o(t,i){var s=t.submitData,r=function(){A.trigger("background:saveForm:rollback",{accountId:t.accountId}),i&&i()};t.type==h||t.type==f?n.AccountActivity.all().filter("accountId","=",t.accountId).destroyAll(function(){n.Account.load(t.accountId,function(t){var i=function(e){return e.siteId==t.siteId};n.Account.listCached(i,function(i){var s=e.find(i,function(e){return"fill"==e.type&&e.id!=t.id});s?n.AccountField.getLatestForAccountId(s.id,function(e){n.AccountField.getLatestForAccountId(t.id,function(n){for(var i=0;n.length>i;i++){for(var o=!1,l=0;e.length>l;l++)n[i].dataType==e[l].dataType&&(o=!0,n[i].value==e[l].value&&(e[l].origin=n[i].origin));o?a.remove(n[i]):n[i].accountId=s.id}a.remove(t),a.flush(r)})}):(t.type="fill",a.flush(r))})})}):t.type==m?l(t.accountId,s.data,r):t.type!=g&&c(t.accountId,s.data,r)}function l(t,i,s){function r(e){return e.accountId==t&&1==e.latest&&"/password"==e.dataType}n.AccountField.listCached(r,function(i){e.async.forEach(i,function(e,i){n.AccountField.rollbackVersioned({payload:{name:e.name,value:e.value,dataType:e.dataType,accountId:t,modifiedAt:new Date}},function(){i()})},function(i){i&&true&&ABINEMASKME.log.error("[ERROR CALLBACK]#[abine/common/failed_submit_detector]#[rollbackAccountPassword]# error while rolling back password fields"),n.AccountActivity.all().filter("accountId","=",t).list(function(t){var n=null;e(t).each(function(e){n||"update password"!=e.activityType||(n=e)}),a.remove(n),a.flush(s)})})})}function c(t,i,a){var s=0,r=e.size(i),o=function(){s++,s==r&&a()};e.each(i,function(e){n.AccountField.rollbackVersioned({payload:{name:e.name,value:e.value,dataType:e.dataType,accountId:t,modifiedAt:new Date}},o)})}function d(t){u(t),y[t].failureTimer=i.setTimeout(e.bind(function(){t in y&&y[t].failureTimer&&(u(t),A.trigger("submitFailureDetector:recheckForms",t))},this),b)}function u(e){e in y&&y[e].failureTimer&&(i.clearTimeout(y[e].failureTimer),delete y[e].failureTimer)}var h=1,p=2,f=3,m=4,g=5,b=8e3,y={},v=t.BaseClass.extend({saveInProgress:!1,formsInitialized:function(t,n){this.saveInProgress?i.setTimeout(e.bind(function(){this.formsInitialized(t,n)},this),250):r(t,n)},contentManagerInit:function(t,n){this.saveInProgress?i.setTimeout(e.bind(function(){this.contentManagerInit(t,n)},this),250):u(n)},init:function(t){this.backgroundMessenger=t,t.on("contentManager:formsInitialized",this.formsInitialized),t.on("contentManager:init",this.contentManagerInit),this.on("submitFailureDetector:recheckForms",e.bind(function(e){t.send("background:failedSubmitDetector:recheckForms",{},e)},this)),this.on("background:saveForm:rollback",e.bind(function(){t.send("broadcast:saveForm:rollback")},this)),this.on("background:saveForm:retained",e.bind(function(e){if(e&&e.accountId){var a;if(e.type==h){if("passwordless"==e.accountType)return;e.msg="MaskMe will help you login here in the future.",a=340}else if(e.type==p)e.msg="MaskMe has saved the changes to your account.",a=340;else if(e.type==m)e.msg="MaskMe has updated this account's password",a=340;else if(e.type==g)return;n.Preference.findBy("key","helpMeLogin",function(n){(n&&"false"!==n.value||"loginForm"!=e.formType)&&(e.noPassword||e.insuranceSubmit||i.setTimeout(function(){t.send("background:saveForm:notification",{msg:e.msg,targetUrl:"pages/index.html#sites",panelWidth:a},e.tabId)},2e3))})}},this))},monitor:function(e,t,n,i,a){var s={fill:f,"new":h,changepass:m,update:p,login:g};n=s[n],y[e]={submitData:t,accountId:i,type:n,accountType:a},d(e)},rollbackPending:function(e,t){r([],e,!0,t)},setTimeout:function(e){b=e}}),A=new v;return A}),ABINEMASKME.define("abine/formAnalyzer",["documentcloud/underscore","jquery","pidcrypt","abine/phoneHeuristics","abine/paymentHeuristics","abine/url"],function(e,t,n,i,a){var s="loginForm",r="registrationForm",o="checkoutForm",l="changepasswordForm",c="otherForm",d="loginRegistrationForm",u="emailField",h="passwordField",p="phoneField",f="usernameField",m="paymentField",g={checkbox:1,radio:1,hidden:1,button:1,submit:1,file:1,image:1},b={LOGIN_FORM:s,REGISTRATION_FORM:r,CHECKOUT_FORM:o,CHANGEPASSWORD_FORM:l,OTHER_FORM:c,LOGIN_REGISTRATION_FORM:d,EMAIL_FIELD:u,PASSWORD_FIELD:h,PHONE_FIELD:p,USERNAME_FIELD:f,PAYMENT_FIELD:m,getFormType:function(t){var n=b.getFields(t),i=0,a=0,d=0,u=0,h={},p=0;e(n).each(function(e){"/ignore"!=e.dataType&&("password"==e.fieldType||"/password"==e.dataType||"/passwordold"==e.dataType?(i++,h[e.fieldType]||(h[e.fieldType]=0),h[e.fieldType]++):(e.fieldType in{text:1,email:1,tel:1}&&a++,"/contact/email"==e.dataType?d++:"/nameperson/friendly"==e.dataType&&u++,e.dataType&&e.dataType.indexOf("financial")>=0&&p++))}),h.text&&h.password&&(i-=h.text);var f=c;return 0===i?d>=1?f=r:1===u&&(f=s):1===i?f=a>1?r:s:2===i?f=r:3===i&&(f=l),p>0&&(f=o),f},hasFormChanged:function(e){for(var n=t(e).find("input, textarea").toArray(),i=0;n.length>i;i++)if(!t(n[i]).data("mmProcessed"))return!0;var a=this.getFields(e);for(var i in a)if(!a[i].element.parentNode)return!0;return!1},clearFormCache:function(e){t.removeData(e,"mmSignature"),t.removeData(e,"mmFields")},getFormSignature:function(e,i){var a,s,r,o={},l=t(i).find("input, textarea").toArray(),c=t(i).data("mmSignature");if(c)return c;c="",c+=e;for(var d=[],u=0;l.length>u;u++)if(r=l[u],!(r.hasAttribute("type")&&r.getAttribute("type").toLowerCase()in g||r.hasAttribute("readonly"))){if(s=r.nodeName.toLowerCase(),a=r.name||r.id||s,o[a]){for(var h=2;o[a+h];)h++;a+=h}d.push(a),o[a]=1}d.sort();for(var u=0;d.length>u;u++)c+=d[u]+"_";return c=n.SHA1(c),t(i).data("mmSignature",c),c},getFields:function(e,n){var s,r,o,l,c,d,u,h,p=[],f=0,m=0,y=t(e).data("mmFields");if(y)return y;y={},t(e).data("mmFields",y);for(var A=t(e).find("input, textarea, select").toArray(),E=b.getLabelMapFor(e),M=0;A.length>M;M++)if(d=A[M],t(d).data("mmProcessed",1),!(d.hasAttribute("type")&&d.getAttribute("type").toLowerCase()in g||d.hasAttribute("readonly"))){if(f+=1,r=d.nodeName.toLowerCase(),s=d.name||d.id||r,y[s]){for(var _=2;y[s+_];)_++;s+=_}c=E[d.id||d.name]?E[d.id||d.name].text:null,null==c&&d.hasAttribute("placeholder")&&(c=d.getAttribute("placeholder")),""==c&&(c=null),"select"==r?u="select":"textarea"==r?u="textarea":"input"==r&&(u=d.getAttribute("type")?d.getAttribute("type").toLowerCase():"text"),"email"==u?l="/contact/email":"tel"==u?l="/contact/phone":(h=d.name||v(d.id)||d.className||"",l=b.getDataTypeByRegExRules(h,c,u,d.innerHTML),"password"!=u||"/passwordold"==l||l&&-1!=l.indexOf("/financial")||(l="/password"),"/password"==l&&(m++,o||(o=s))),n&&n[s]&&(l=n[s]),d.hasAttribute("abinedatatype")&&(l=d.getAttribute("abinedatatype")),y[s]={position:f,element:d,fieldType:u,id:d.id,className:d.className,name:d.name,dataType:l,label:c,signature:s,maxlength:d.hasAttribute("maxlength")?parseInt(d.getAttribute("maxlength")):null,size:d.size?d.size:null},p[f]=y[s],p[f].key=s}return n||(3==m&&(y[o].dataType="/passwordold"),i.apply(y,p),a.apply(y,p)),y},getFormData:function(n,i){var a=n.hasAttribute("action")?n.getAttribute("action"):i,s=b.getFields(n),r=b.getFormType(n),o=b.getFormSignature(i,n),l={url:a,type:r,data:[],pageUrl:i,formSignature:o};return"yes"===t(n).attr("maskMeFilled")&&(l.origin="MaskMe"),e.each(s,function(e){-1=="submit.image.button".indexOf(e.fieldType)&&(-1=="checkbox.radio".indexOf(e.fieldType)||e.element.checked)&&l.data.push({name:e.name,id:e.id,dataType:e.dataType,value:t(e.element).val()||""})}),l},getFieldType:function(e){var t=e.nodeName.toLowerCase();if("select"==t)return"select";if("textarea"==t)return"textarea";if("input"==t){var n=e.getAttribute("type");return n?n.toLowerCase():"text"}},getLabelMapFor:function(e){var n,i={};return t(e).find("label").each(function(e,a){if(n=a.getAttribute("for"))i[n]||(i[n]={element:a,text:t(a).text()||a.name||a.id});else{var s=a.nextSibling;for(s||(s=a.parentNode.nextSibling);s&&1!=s.nodeType;)s=s.nextSibling;if(s&&!s.form&&s.firstChild)for(s=s.firstChild;s&&1!=s.nodeType;)s=s.nextSibling;s&&s.form&&(s.id||s.name)&&(i[s.id||s.name]={element:a,text:t(a).text()||a.name||a.id})}}),i},getLabelFor:function(e,n){var i=e.id||e.name;return i?t(n).find('label[for="'+i+'"]').get(0):null},getDataTypeByRegExRules:function(t,n,i,a){var s=t&&t.length>0,r=n&&n.length>0,o=s?t.replace(A.nonAlphanumeric,""):null,l=r?n.replace(A.nonAlphanumeric,""):null;o==t&&(alternameName=null),l==n&&(alternameLabel=null);var c=n+t,d=l+o,u=y[i];if(!u)return null;for(var h=[],p=0;u.length>p;p++){var f=u[p],m="undefined"!=typeof f.label,g="undefined"!=typeof f.name;if(!f.negative||!(t&&t.match(f.negative)||n&&n.match(f.negative))){if(r&&!m&&g&&n.match(f.name)||r&&m&&n.match(f.label)||s&&g&&t.match(f.name)||l&&!m&&g&&l.match(f.name)||l&&m&&l.match(f.label)||o&&g&&o.match(f.name)){if(f.options&&a&&!a.match(f.options))continue;h.push(f.data_type);break}if(f.label_name&&r&&s&&(!m&&g&&c.match(f.name)||m&&c.match(f.label)||g&&c.match(f.name)||d&&!m&&g&&d.match(f.name)||d&&m&&d.match(f.label)||d&&g&&d.match(f.name))){h.push(f.data_type);break}if(f.matchByOptions&&f.options&&a&&a.match(f.options)){h.push(f.data_type);break}}}if(1==h.length)return h[0];if(h.length>1){var b=e(h).find(function(e){return"/contact/email"==e?!0:void 0});return b?b:h[0]}return null},getFieldGroupsWithoutForm:function(t){for(var n={text:1,password:1,email:1,tel:1},i=t.getElementsByTagName("input"),a=(e(i).filter(function(e){if(e.form)return!1;var t=e.type?e.type.toLowerCase():"text";return t in n},this)),s=[],r=[],o=[1],l={},c=0;a.length>c;c++){for(var d=a[c].parentNode,u={},h=0,p=!1;d&&3>h;){if(d.id=d.id||"abId"+Math.random(),c>0&&d.id in r[c-1]){o[c]=o[c-1],u=r[c-1],(!(o[c-1]in l)||h>l[o[c-1]].depth)&&(l[o[c-1]]={lca:d,depth:h}),p=!0;break}u[d.id]=1,d=d.parentNode,h++}r.push(u),p||(o[c]=0==c?1:o[c-1]+1,l[o[c]]={lca:a[c].parentNode,depth:0})}var f={};for(var m in l)l[m].lca.id in f||(f[l[m].lca.id]=1,s.push(l[m].lca));return s.length>0,s}},y={text:[{name:/.*captcha.*/i,data_type:"/ignore"},{name:/^q$|find|search|terms/i,data_type:"/ignore"},{name:/hint/i,data_type:"/ignore"},{name:/email|e\-mail/i,label:/windowsliveid|email|e\-mail/i,negative:/search|friend|reference|recipient|reference|receiver/i,data_type:"/contact/email"},{name:/user|userid|alias|login|uname|yahooid|onlineid|session_key|(?:(?:nick|screen|member|usr|user|account|login|display).*(name|id))/i,label:/alias|shortname|login|handle|display.*name|user[\s]*(name|id)/i,negative:/credit|password|full/i,data_type:"/nameperson/friendly"},{name:/(?:title|salutation)/i,data_type:"/nameperson/prefix"},{name:/(?:lname|last|sur).*(?:name)?/i,label:/last.*name/i,data_type:"/nameperson/last",negative:/full/i},{name:/(?:fname|first).*(?:name)?/i,label:/first.*name/i,data_type:"/nameperson/first",negative:/full/i},{name:/(?:.*(?:full|invoice|real|bill|(?:ship.*to)).*name)|(?:^name$)/i,negative:/holder|credit/i,data_type:"/nameperson/full"},{label:/(?:middle|middleinitial)/i,data_type:"/nameperson/middle"},{label:/(?:suffix)/i,data_type:"/nameperson/suffix"},{name:/(?:(?:confirm|new|create|re\-enter)[\s]*)?password(?:(?:confirm|new|create|re\-enter)[\s]*)?/i,label:/(?:(?:confirm|new|create|re\-enter)[\s]*)?password/i,negative:/hint|old|current/i,data_type:"/password"},{name:/(?:old|current)[\s]*(?:pass|pwd)/i,label:/[\s]*(?:(?:current|old)[\s]*)password/i,data_type:"/passwordold"},{label:/.*twitter.*/i,data_type:"/contact/im/twitter"},{label:/.*linkedin.*/i,data_type:"/contact/web/linkedin"},{label:/.*blog.*/i,data_type:"/contact/web/blog"},{label:/.*aim/i,data_type:"/contact/IM/aim"},{label:/.*icq.*/i,data_type:"/contact/IM/icq"},{label:/.*msn(?:m)?/i,data_type:"/contact/IM/msn"},{label:/.*jabber/i,data_type:"/contact/IM/jabber"},{label:/.*skypq/i,data_type:"/contact/IM/skype"},{label:/.*(?:yim|yahoo)/i,data_type:"/contact/IM/yahoo"},{name:/(?:home).*phone.*(?:num|number)/i,label:/even.*phone/,negative:/gift|loyalty/i,data_type:"/contact/phone"},{name:/.*(?:cell|mob(?:ile)?).*/i,data_type:"/contact/phone/mobile"},{name:/.*fax.*/i,data_type:"/contact/phone/fax"},{name:/(?:day|daytime|work|business).*phone/i,label:/(?:day|daytime|work|business).*phone/,data_type:"/contact/phone/work"},{name:/(?:night|nighttime|home).*phone/i,label:/(?:night|nighttime|home).*phone/,data_type:"/contact/phone/home"},{name:/area.*code.*/i,data_type:"/contact/phone/areacode",negative:/zip/i},{name:/(?:phone.*(?:area|1).*)/i,data_type:"/contact/phone/areacode",negative:/zip/i},{name:/(?:phone.*(?:exch|prefix|first|2).*)|(?:exchange)/i,data_type:"/contact/phone/exchange"},{name:/phone.*(?:suffix|end|last|3).*/i,data_type:"/contact/phone/local",negative:/zip/i},{name:/phone.*(?:country|countrycode).*/i,label:/\+1/,data_type:"/contact/phone/countrycode"},{name:/home.*(?:exch|prefix).*/i,data_type:"/contact/phone/exchange"},{name:/home.*area.*/i,data_type:"/contact/phone/areacode",negative:/zip/i},{name:/home.*(?:num|suffix|end).*/i,data_type:"/contact/phone/local"},{name:/home.*(?:country|countrycode).*/i,data_type:"/contact/phone/countrycode"},{name:/area.*code/i,data_type:"/contact/phone/areacode",negative:/zip/i},{name:/exchange/i,data_type:"/contact/phone/exchange"},{name:/local/i,data_type:"/contact/phone/local"},{name:/phone.*(?:ext|extension)/i,data_type:"/contact/phone/extension",negative:/text/i},{name:/extension/i,data_type:"/contact/phone/extension"},{name:/phone/i,label:/phone/i,data_type:"/contact/phone"},{name:/(?:bill|b).*(?:zip|postal|post)(?:.*code)?/i,data_type:"/contact/postalcode/billing"},{name:/.*(?:zip|postal|post)(?:.*code)?/i,data_type:"/contact/postalcode"},{name:/bill.*city/i,data_type:"/contact/city/billing"},{name:/business.*city/i,data_type:"/contact/city/business"},{name:/home.*city/i,data_type:"/contact/city/home"},{name:/city/i,data_type:"/contact/city"},{name:/bill.*country/i,data_type:"/contact/country/billing"},{name:/business.*country/i,data_type:"/contact/country/business"},{name:/home.*country/i,data_type:"/contact/country/home"},{name:/country/i,data_type:"/contact/country"},{name:/bill.*state/i,data_type:"/contact/state/billing"},{name:/business.*state/i,data_type:"/contact/state/business"},{name:/home.*state/i,data_type:"/contact/state/home"},{name:/state/i,data_type:"/contact/state"},{name:/bill.*addr.*2/i,data_type:"/contact/postaladdressAdditional/billing"},{name:/home.*addr.*2/i,data_type:"/contact/postaladdressAdditional/home"},{name:/(?:addr.*2)|(?:(?:ad.*)?line.*2)/i,label:/.*address.*(?:line)?.*2.*/,data_type:"/contact/postaladdressAdditional"},{name:/bill.*addr.*3/i,data_type:"/contact/postaladdress3/billing"},{name:/home.*addr.*3/i,data_type:"/contact/postaladdress3/home"},{name:/(?:addr.*3)|(?:(?:ad.*)?line.*3)/i,label:/.*address.*(?:line)?.*3.*/,data_type:"/contact/postaladdress3"},{name:/bill.*addr/i,data_type:"/contact/postaladdress/billing"},{name:/home.*addr/i,data_type:"/contact/postaladdress/home"},{name:/(?:addr.*1?)|(?:(?:ad.*)?line.*1?)/i,label:/.*address.*(?:line1?)?.*/,negative:/type/i,data_type:"/contact/postaladdress"},{name:/.*(?:comment|message).*/i,data_type:"/message"},{name:/.*(?:(?:(?:cc|card)?.*(?:(?:holder|owner).*)))|(?:name.*on.*card)|(?:issued.*to)|(?:(?:card|cc|payment).*name)/i,label:/(?:issued.*to)|(?:name.*on.*card)|(?:card.*name)|(?:card.*holder)/i,negative:/gift|placeholder|account|acct|first|last|num|cvv/i,data_type:"/financial/creditcard/issuedto"},{name:/.*(?:cc|card|credit.*card)?(?:(?:cvv|cvc|ccv|cv|cid|verify|verif.*(?:code|num)|verification|sec.*code|card.*sec.*num)|cvv).*/i,negative:/gift/i,data_type:"/financial/creditcard/verification"},{name:/.*(?:cc|card|credit.*card|payment).*(?:num|number|no)|ccard/i,label:/card.*number/i,negative:/gift|account|reward|acct|issue/i,data_type:"/financial/creditcard/number"},{name:/.*(?:cc|card|credit.*card).*(?:type|issuer)/i,negative:/gift/i,data_type:"/financial/creditcard/type"},{name:/.*(?:(?:(?:cc|card|billing)?.*(?:exp.*))|(?:(?:cc|card).*(?:exp.*)))(?:date.*)?(?:[m]{2}|mo|mon|month|mn)/i,negative:/gift|start|valid|birth/i,data_type:"/financial/creditcard/expirymonth"},{name:/.*(?:(?:(?:cc|card|billing)?.*(?:exp.*))|(?:(?:cc|card).*(?:exp.*)))(?:date.*)?(?:[y]{2,4}|yr|year)/i,negative:/gift|start|valid|birth/i,data_type:"/financial/creditcard/expiryyear"},{name:/.*(?:(?:(?:cc|card|billing)?.*(?:exp.*))|(?:(?:cc|card).*(?:exp.*))|expiration)/i,negative:/gift|year|yr|mon|mm|yy|start|valid|birth/i,data_type:"/financial/creditcard/expiry"},{name:/(?:birth.*year)|(?:dob[y]+)|(?:(?:dob|date).*year.*)|(?:year.*(?:born|birth))|(?:birthday[y]+r?)/i,negative:/exp/i,data_type:"/birthdate/birthyear"},{name:/(?:birth.*mon(?:th)?)|(?:dob[m]+)|(?:(?:dob|date).*mon(?:th)?.*)|(?:month.*(?:born|birth))|(?:birthday[m]+)/i,negative:/exp/i,data_type:"/birthdate/birthmonth"},{name:/(?:birth.*day)|(?:dob[d]+)|(?:(?:dob|date).*(?:day|date).*)|(?:day.*(?:born|birth))|(?:birthday[d]+)/i,data_type:"/birthdate/birthday"},{name:/(?:b|birth|dob)(?:day|date)/i,data_type:"/birthdate"},{name:/.*(?:co|comp|company|business)(?:name)/i,label:/(?:company|business|organization)(?:\s+name)?/i,data_type:"/company/name"},{name:/.*(?:customer).*(?:company).*/i,data_type:"/company/name"},{name:/^pin$/i,label:/^pin$/i,data_type:"/pin"}],password:[{name:/.*(?:cc|card|credit.*card)?(?:cvv|cvc|ccv|id|verify|verif.*(?:code|num)|verification|security.*code|card.*sec.*num).*/i,negative:/gift|password|pass/i,data_type:"/financial/creditcard/verification"},{name:/pin/i,label:/pin/i,data_type:"/pin"},{name:/(?:(?:confirm|new|create|re\-enter|verify)[\s]*)?password(?:(?:confirm|new|create|re\-enter)[\s]*)?/i,label:/(?:(?:confirm|new|create|re\-enter)[\s]*)?password/i,negative:/hint|old|current/i,data_type:"/password"},{name:/(?:old|current)[\s]*(?:pass|pwd)/i,label:/[\s]*(?:(?:current|old)[\s]*)password/i,data_type:"/passwordold"}],select:[{name:/(?:title|salutation)/i,data_type:"/nameperson/prefix"},{name:/.*(?:cc|card|credit.*card|payment).*(?:type|issuer)/i,negative:/gift/i,data_type:"/financial/creditcard/type",options:/visa|diner|amex|american[^<]*express/i,matchByOptions:!0},{name:/.*(?:(?:(?:cc|card|billing|payment)?.*(?:exp.*))|(?:(?:cc|card).*(?:exp.*)?)|exp.*)(?:date.*)?(?:[m]{2}|mo|mon|month|mn)/i,negative:/gift|start|valid|birth/i,data_type:"/financial/creditcard/expirymonth",options:/12|jan|feb/i},{name:/.*(?:(?:(?:cc|card|billing|payment)?.*(?:exp.*))|(?:(?:cc|card).*(?:exp.*)?)|exp.*)(?:date.*)?(?:[y]{2,4}|yr|year)/i,negative:/gift|start|valid|birth/i,data_type:"/financial/creditcard/expiryyear",options:/20[0-9]{2}/i},{name:/(?:birth.*year)|(?:dob[y]+)|(?:(?:dob|date).*year.*)|(?:year.*(?:born|birth))|(?:birthday[y]+r?)/i,negative:/exp/i,data_type:"/birthdate/birthyear"},{name:/(?:birth.*mon(?:th)?)|(?:dob[m]+)|(?:(?:dob|date).*mon(?:th)?.*)|(?:month.*(?:born|birth))|(?:birthday[m]+)/i,negative:/exp/i,data_type:"/birthdate/birthmonth"},{name:/(?:birth.*day)|(?:dob[d]+)|(?:(?:dob|date).*(?:day|date).*)|(?:day.*(?:born|birth))|(?:birthday[d]+)/i,data_type:"/birthdate/birthday"},{name:/(?:b|birth|dob)(?:day|date)/i,data_type:"/birthdate"},{name:/gender|sex/i,data_type:"/person/gender"},{name:/phone.*(?:country|countrycode).*/i,data_type:"/contact/phone/countrycode"},{name:/home.*(?:country|countrycode).*/i,data_type:"/contact/phone/home/countrycode"},{name:/bill.*country/i,data_type:"/contact/country/billing"},{name:/business.*country/i,data_type:"/contact/country/business"},{name:/home.*country/i,data_type:"/contact/country/home"},{name:/country/i,data_type:"/contact/country"},{name:/bill.*state/i,data_type:"/contact/state/billing"},{name:/business.*state/i,data_type:"/contact/state/business"},{name:/home.*state/i,data_type:"/contact/state/home"},{name:/state/i,data_type:"/contact/state"}],checkbox:[{name:/agree|tos|terms|service/i,data_type:"/agreetos"},{name:/(?:accept|agree|terms|(?:read)?rules|conditions|privacypolicy).*/i,data_type:"/agreetos"},{name:/.*(?:remember|persistent).*/i,label:/keepmesignedin/i,data_type:"/rememberme"}],radio:[{name:/gender|sex/i,label:/^(?:male|female)$/i,data_type:"/person/gender"}]},v=function(e){var t=e.match(/^user\[(.*)\]$/);return t?t[1]:e},A={nonAlphanumeric:/[^a-z0-9]+/gim,nonAlpha:/[^a-z]+/gim,spaces:/[\s]+/gim,startsWithDot:/^\./,trimSepartor:/(^\|\|)|(\|\|$)/g,textOrSelect:/text|select/i,email:/^(?:[a-z0-9!#$%&'*+\/=?^_`{|}~\-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~\-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9\-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i};return b}),ABINEMASKME.define("abine/formObserver",["documentcloud/underscore","jquery","abine/core","abine/contentMessenger","abine/formAnalyzer"],function(e,t,n,i,a){var s={"/contact/email":a.EMAIL_FIELD,"/password":a.PASSWORD_FIELD,"/contact/phone":a.PHONE_FIELD,"/contact/phone/countrycode":a.PHONE_FIELD,"/contact/phone/areacode":a.PHONE_FIELD,"/contact/phone/exchange":a.PHONE_FIELD,"/contact/phone/local":a.PHONE_FIELD,"/contact/phone/number":a.PHONE_FIELD,"/contact/phone/extension":a.PHONE_FIELD,"/nameperson/friendly":a.USERNAME_FIELD,"/financial/creditcard/number":a.PAYMENT_FIELD,"/financial/creditcard/number/part1":a.PAYMENT_FIELD,"/financial/creditcard/number/part2":a.PAYMENT_FIELD,"/financial/creditcard/number/part3":a.PAYMENT_FIELD,"/financial/creditcard/number/part4":a.PAYMENT_FIELD,"/financial/creditcard/type":a.PAYMENT_FIELD,"/financial/creditcard/issuedto":a.PAYMENT_FIELD,"/financial/creditcard/expiry":a.PAYMENT_FIELD,"/financial/creditcard/expiryyear":a.PAYMENT_FIELD,"/financial/creditcard/expirymonth":a.PAYMENT_FIELD,"/financial/creditcard/verification":a.PAYMENT_FIELD},r=["change.mm","focus.mm","blur.mm","click.mm","keydown.mm"],o=n.BaseClass.extend({initialize:function(t){if(this.id=e.uniqueId(),this.el=t.el,this.mappedFields=t.mappedFields,this.messenger=t.messenger||this,this.contentManager=t.contentManager,!this.el)throw"Error: FormObserver initialized without a form element.";
this.triggerFormPresent(),this.bindToFormEvents()},getType:function(){return this.formType?this.formType:(this.formType=a.getFormType(this.el),this.formType)},getFields:function(){return this.fields?this.fields:(this.fields=a.getFields(this.el,this.mappedFields),this.fields)},triggerFormPresent:function(){formType=this.getType(),formType==a.LOGIN_FORM?this.trigger("loginFormPresent",{formObserver:this,fields:this.getFields()}):formType==a.REGISTRATION_FORM?this.trigger("registrationFormPresent",{formObserver:this,fields:this.getFields()}):formType==a.CHECKOUT_FORM&&this.trigger("checkoutFormPresent",{formObserver:this,fields:this.getFields()})},bindToFormEvents:function(){var n,i=this.getFields();e(i).each(function(i){i.dataType&&s[i.dataType]&&(i.element.hasAttribute("autocomplete")&&!i.element.hasAttribute("oldautocomplete")?i.element.setAttribute("oldautocomplete",i.element.getAttribute("autocomplete")):i.element.hasAttribute("autocomplete")||i.element.setAttribute("oldautocomplete","remove"),i.element.setAttribute("autocomplete","off"),t(i.element).bind(r.join(" "),e.bind(function(e){if(!this.contentManager||this.contentManager.userIntent){var t=s[i.dataType];t&&(n=l(t,e.type)),n&&("keydown"===e.type?this.trigger(n,{formObserver:this,field:i,keyCode:e.keyCode}):this.trigger(n,{formObserver:this,field:i}))}},this)))},this)},unbindFormEvents:function(){var n=this.getFields();e(n).each(function(e){e.dataType&&s[e.dataType]&&t(e.element).unbind(r.join(" "))})}}),l=function(e,t){return e==a.EMAIL_FIELD?eventName="emailField":e==a.PHONE_FIELD?eventName="phoneField":e==a.PASSWORD_FIELD?eventName="passwordField":e==a.USERNAME_FIELD?eventName="usernameField":e==a.PAYMENT_FIELD&&(eventName="paymentField"),"change"==t?eventName+="Changed":"focus"==t?eventName+="Focused":"blur"==t?eventName+="Blurred":"click"==t?eventName+="Clicked":"keydown"==t&&(eventName+="Keydown"),eventName};return{FormObserver:o,LOGIN_FORM:a.LOGIN_FORM,REGISTRATION_FORM:a.REGISTRATION_FORM,CHECKOUT_FORM:a.CHECKOUT_FORM,OTHER_FORM:a.OTHER_FORM}}),ABINEMASKME.define("abine/formStrategy",["jquery","documentcloud/underscore","abine/core","abine/formObserver","abine/timer","abine/formAnalyzer","abine/views/emailHelperPanel","abine/views/passwordHelperPanel","abine/views/phoneHelperPanel","abine/views/loginHelperPanel","abine/views/paymentHelperPanel","models","abine/config"],function(e,t,n,i,a,s,r,o,l,c,d,u){var h={bindFieldChangeObserver:function(){this.formObserver=this.formObserver||new i.FormObserver({el:this.formEl,mappedFields:this.mappedFields,contentManager:this.contentManager}),this.formObserver.on("emailFieldChanged",this.onFieldChanged,this),this.formObserver.on("usernameFieldChanged",this.onFieldChanged,this),this.formObserver.on("passwordFieldChanged",this.onFieldChanged,this),this.formObserver.on("phoneFieldChanged",this.onFieldChanged,this),this.formObserver.on("paymentFieldChanged",this.onFieldChanged,this)},onFieldChanged:function(e){var t=e.field;t.origin="change";var n={name:t.name,origin:t.origin,dataType:t.dataType,value:t.value};this.contentManager.messenger.send("contentManager:formFieldChanged",{fieldData:n,formData:s.getFormData(this.formEl,this.contentManager.href)})}},p={bindFormObserver:function(){this.formObserver=this.formObserver||new i.FormObserver({el:this.formEl,mappedFields:this.mappedFields,contentManager:this.contentManager}),this.formObserver.on("emailFieldFocused",this.onEmailFieldActivity,this),this.formObserver.on("emailFieldClicked",this.onEmailFieldActivity,this),this.formObserver.on("passwordFieldFocused",this.onPasswordFieldActivity,this),this.formObserver.on("passwordFieldClicked",this.onPasswordFieldActivity,this),this.formObserver.on("phoneFieldFocused",this.onPhoneFieldActivity,this),this.formObserver.on("phoneFieldClicked",this.onPhoneFieldActivity,this),this.formObserver.on("paymentFieldFocused",this.onPaymentFieldActivity,this),this.formObserver.on("paymentFieldClicked",this.onPaymentFieldActivity,this)},cleanup:function(){this.formObserver&&(this.formObserver.unbindFormEvents(),this.formObserver.off())},processDynamicPanelForField:function(e){var t=this.contentManager.preferences.getPref("dynamicPanels"),n=t?JSON.parse(t):"",i=!1;if(n&&n.panels&&(i=this.contentManager.getPanelForDataType(n.panels,e))){parseInt(i.masked_emails)>0&&(i.dontShow=!0);var a=parseFloat(i.show_rate),s=Math.random();s>a&&(i.dontShow=!0)}return{json:n,dynamicPanel:i}},onEmailFieldActivity:function(n){if(!this.contentManager.isPanelShown(n.field)&&this.contentManager.preferences.getPref("suggestProtectedEmail")&&(!this.contentManager.preferences.getPref("hasRegistered")||this.contentManager.preferences.getPref("authToken"))){var i=this.formObserver,a=n.field.element;if(a.hasAttribute("autocomplete")&&!a.hasAttribute("oldautocomplete")?a.setAttribute("oldautocomplete",a.getAttribute("autocomplete")):a.hasAttribute("autocomplete")||a.setAttribute("oldautocomplete","remove"),a.setAttribute("autocomplete","off"),!a.hasAttribute("mmautofilling")&&!a.hasAttribute("mmclosedfield")){var s=this.processDynamicPanelForField("/contact/email");if(s.dynamicPanel&&s.dynamicPanel.dontShow&&!this.contentManager.preferences.isPrefTrue("hasRegistered"))return!1;this.contentManager.createPanel({style:{},secured:!0,field:n.field,ready:t.bind(function(t){var a=new r({field:n.field,formEl:this.formEl,contentManager:this.contentManager,fields:i.getFields(),dynamicPanel:s.dynamicPanel,dynamicPanelsJSON:s.json,hasRegistered:this.contentManager.preferences.isPrefTrue("hasRegistered"),domain:this.contentManager.domain,el:e("<div></div>",t).get(0)});a.bind("remove",function(){try{a.remove()}catch(e){}this.contentManager.removePanels()},this),a.bind("render",function(){this.contentManager.autoResizePanels()},this),e("body",t).append(a.el)},this)})}}},onPasswordFieldActivity:function(n){if(!this.contentManager.isPanelShown(n.field)&&(!this.contentManager.preferences.getPref("hasRegistered")||this.contentManager.preferences.getPref("authToken"))){var i=n.field.element;if("text"!=i.getAttribute("type")&&(!this.contentManager.preferences.getPref("hasRegistered")||this.contentManager.preferences.getPref("suggestStrongPassword"))){var a=this.formObserver;if(i.hasAttribute("autocomplete")&&!i.hasAttribute("oldautocomplete")?i.setAttribute("oldautocomplete",i.getAttribute("autocomplete")):i.hasAttribute("autocomplete")||i.setAttribute("oldautocomplete","remove"),i.setAttribute("autocomplete","off"),!i.hasAttribute("mmautofilling")&&!i.hasAttribute("mmclosedfield")){var s=this.processDynamicPanelForField("/password");if(s.dynamicPanel&&s.dynamicPanel.dontShow&&!this.contentManager.preferences.isPrefTrue("hasRegistered"))return!1;this.contentManager.createPanel({style:{},secured:!0,field:n.field,ready:t.bind(function(t){var i=new o({field:n.field,formEl:this.formEl,contentManager:this.contentManager,fields:a.getFields(),dynamicPanel:s.dynamicPanel,dynamicPanelsJSON:s.json,hasRegistered:this.contentManager.preferences.isPrefTrue("hasRegistered"),domain:this.contentManager.domain,el:e("<div></div>",t).get(0)});i.bind("remove",function(){try{i.remove()}catch(e){}this.contentManager.removePanels()},this),i.bind("render",function(){this.contentManager.autoResizePanels()},this),e("body",t).append(i.el)},this)})}}}},onPhoneFieldActivity:function(n){if(!this.contentManager.isPanelShown(n.field)&&this.contentManager.preferences.getPref("suggestProtectedPhone")&&(!this.contentManager.preferences.getPref("hasRegistered")||this.contentManager.preferences.getPref("authToken"))){var i=this.formObserver,a=n.field.element;if(a.hasAttribute("autocomplete")&&!a.hasAttribute("oldautocomplete")?a.setAttribute("oldautocomplete",a.getAttribute("autocomplete")):a.hasAttribute("autocomplete")||a.setAttribute("oldautocomplete","remove"),a.setAttribute("autocomplete","off"),!a.hasAttribute("mmautofilling")&&!a.hasAttribute("mmclosedfield")){var s=this.processDynamicPanelForField("/contact/phone");if(s.dynamicPanel&&s.dynamicPanel.dontShow&&!this.contentManager.preferences.isPrefTrue("entitledToPhone"))return!1;this.contentManager.createPanel({style:{},secured:!0,field:n.field,ready:t.bind(function(t){var a=new l({field:n.field,formEl:this.formEl,contentManager:this.contentManager,dynamicPanel:s.dynamicPanel,dynamicPanelsJSON:s.json,entitledToPhone:this.contentManager.preferences.isPrefTrue("entitledToPhone"),hasRegistered:this.contentManager.preferences.isPrefTrue("hasRegistered"),fields:i.getFields(),domain:this.contentManager.domain,el:e("<div></div>",t).get(0)});a.bind("remove",function(){try{a.remove()}catch(e){}this.contentManager.removePanels()},this),a.bind("render",function(){this.contentManager.autoResizePanels()},this),e("body",t).append(a.el)},this)})}}},onPaymentFieldActivity:function(n){if(!this.contentManager.isPanelShown(n.field)&&"select"!=n.field.fieldType&&this.contentManager.preferences.getPref("suggestProtectedCard")&&(!this.contentManager.preferences.getPref("hasRegistered")||this.contentManager.preferences.getPref("authToken"))){var i=this.formObserver;if(n.field.element.hasAttribute("autocomplete")&&!n.field.element.hasAttribute("oldautocomplete")?n.field.element.setAttribute("oldautocomplete",n.field.element.getAttribute("autocomplete")):n.field.element.hasAttribute("autocomplete")||n.field.element.setAttribute("oldautocomplete","remove"),n.field.element.setAttribute("autocomplete","off"),!n.field.element.hasAttribute("mmautofilling")&&!n.field.element.hasAttribute("mmclosedfield")){var a=this.processDynamicPanelForField("/creditcard");if(a.dynamicPanel&&a.dynamicPanel.dontShow&&!this.contentManager.preferences.isPrefTrue("hasEnabledPayments"))return!1;this.contentManager.createPanel({style:{},secured:!0,panelWidth:400,field:n.field,ready:t.bind(function(s){var r=new d({field:n.field,formEl:this.formEl,contentManager:this.contentManager,authToken:this.contentManager.preferences.getPref("authToken"),beginnerMode:this.contentManager.preferences.getPref("beginnerMode"),hasRegistered:this.contentManager.preferences.isPrefTrue("hasRegistered"),entitledToPayments:this.contentManager.preferences.isPrefTrue("entitledToPayments"),hasEnabledPayments:this.contentManager.preferences.isPrefTrue("hasEnabledPayments"),dynamicPanel:a.dynamicPanel,dynamicPanelsJSON:a.json,fields:i.getFields(),domain:this.contentManager.domain,el:e("<div></div>",s).get(0)});r.bind("remove",function(){try{r.remove()}catch(e){}this.contentManager.removePanels()},this),r.bind("render",function(){this.contentManager.autoResizePanels()},this),this.contentManager.notificationViews&&t.each(this.contentManager.notificationViews,function(e){e.style.display="block"}),e("body",s).append(r.el)},this)})}}}},f=n.BaseClass.extend({initialize:function(e){if(!e.el)throw"RegistrationFormHelper expects a form element";this.formEl=e.el,this.contentManager=e.contentManager,this.preferences=e.preferences,this.mappedFields=e.mappedFields,this.bindFormObserver(),this.bindFieldChangeObserver()},bindFieldChangeObserver:function(){},bindFormObserver:function(){}});t.extend(f.prototype,p,h);var m=n.BaseClass.extend({initialize:function(e){if(!e.el)throw"ChangePasswordHelper expects a form element";this.formEl=e.el,this.contentManager=e.contentManager,this.preferences=e.preferences,this.bindFormObserver(),this.bindFieldChangeObserver(),this.tryToAutoFillOldPassword()},bindFieldChangeObserver:function(){},bindFormObserver:function(){},tryToAutoFillOldPassword:function(){if(this.contentManager.domain){var n=this.formObserver.getFields(),i=new u.Site({domain:this.contentManager.domain});i.loadAccounts(!1,t.bind(function(a){if(!a&&i.accounts&&i.accounts.length>0){var s=t.filter(n,function(e){return e.dataType&&"/passwordold"==e.dataType?!0:!1}),r=i.accounts.at(0),o=r.accountFields.find(function(e){return e.has("dataType")&&"/password"==e.get("dataType")?!0:!1});t.each(s,function(t){o&&e(t.element).focus().val(o.get("value")).blur()})}},this))}}});t.extend(m.prototype,p,h);var g=n.BaseClass.extend({initialize:function(e){if(!e.el)throw"LoginHelper expects a form element";this.formEl=e.el,this.contentManager=e.contentManager,this.preferences=e.preferences,this.mappedFields=e.mappedFields,this.site=e.site,this.bindFieldChangeObserver(),this.formObserver.on("passwordFieldFocused",this.onPasswordFieldActivity,this),this.formObserver.on("passwordFieldBlurred",this.onPasswordFieldActivity,this),this.contentManager.preferences.getPref("helpMeLogin")&&this.tryToAutoFillLogins()},cleanup:function(){this.formObserver&&(this.formObserver.unbindFormEvents(),this.formObserver.off())},bindFieldChangeObserver:function(){},onPasswordFieldActivity:function(){this.autofilled&&this.autofilled--},onEmailFieldActivity:function(n){if(this.autofilled)return this.autofilled--,void 0;if(!this.contentManager.isPanelShown(n.field)){var i=this.formObserver,a=n.field.element;a.hasAttribute("autocomplete")&&!a.hasAttribute("oldautocomplete")?a.setAttribute("oldautocomplete",a.getAttribute("autocomplete")):a.hasAttribute("autocomplete")||a.setAttribute("oldautocomplete","remove"),a.setAttribute("autocomplete","off"),a.hasAttribute("mmautofilling")||a.hasAttribute("mmclosedfield")||this.contentManager.createPanel({style:{},field:n.field,ready:t.bind(function(t){var a=new c({field:n.field,formEl:this.formEl,fields:i.getFields(),contentManager:this.contentManager,domain:this.contentManager.domain,el:e("<div></div>",t).get(0)});a.bind("remove",function(){try{a.remove()}catch(e){}this.contentManager.removePanels()},this),a.bind("render",function(){this.contentManager.autoResizePanels()},this),e("body",t).append(a.el)},this)})}},removeAutoCompleteFromFields:function(e){t.each(e,t.bind(function(e){this.removeAutoCompleteFromField(e.element)},this))},removeAutoCompleteFromField:function(e){e.hasAttribute("oldautocomplete")&&"remove"!=e.getAttribute("oldautocomplete")?e.setAttribute("autocomplete",e.getAttribute("oldautocomplete")):e.removeAttribute("autocomplete"),e.removeAttribute("oldautocomplete")},tryToAutoFillLogins:function(){var n=this.formObserver.getFields();if(!this.contentManager.domain||this.contentManager.isLocked())return this.removeAutoCompleteFromFields(n),void 0;var i=this.site;if(!(i.accounts&&i.accounts.length>0))return this.removeAutoCompleteFromFields(n),void 0;if(!this.contentManager.preferences.getPref("helpMeLogin")){var s=[];i.accounts.forEach(function(e){"login"==e.get("type")&&s.push(e)}),i.accounts.remove(s)}var r=t.find(i.accounts.models,function(e){return e.getLoginForAccount()?!0:void 0});r&&(this.contentManager.userIntent&&(this.autofilled=2),this.formObserver.on("emailFieldFocused",this.onEmailFieldActivity,this),this.formObserver.on("emailFieldClicked",this.onEmailFieldActivity,this),this.formObserver.on("usernameFieldClicked",this.onEmailFieldActivity,this),this.formObserver.on("usernameFieldFocused",this.onEmailFieldActivity,this));var o={};t.each(n,t.bind(function(e){e.dataType&&(o[e.dataType]=e),r||this.removeAutoCompleteFromField(e.element)},this));var l=i.accounts.at(0),c={};l.accountFields.each(function(e){e.has("dataType")&&(c[e.get("dataType")]=e.get("value"))}),t.each(t.keys(o),t.bind(function(n){n in c?"/password"===n&&"text"===o[n].element.type?(e(o[n].element).focus(),a.setTimeout(t.bind(function(){e("[type='password']",this.formEl).val(c[n]).blur()},this),100)):o[n].element.value=c[n]:("/contact/email"==n&&"/nameperson/friendly"in c&&(o[n].element.value=c["/nameperson/friendly"]),"/nameperson/friendly"==n&&"/contact/email"in c&&(o[n].element.value=c["/contact/email"])),this.contentManager.triggerKeyboardEvent("keydown",e(o[n].element)[0]),this.contentManager.triggerKeyboardEvent("keyup",e(o[n].element)[0]),this.contentManager.triggerKeyboardEvent("keypress",e(o[n].element)[0])},this))}});t.extend(g.prototype,h);var b=n.BaseClass.extend({initialize:function(e){if(!e.el)throw"OtherHelper expects a form element";this.formEl=e.el,this.contentManager=e.contentManager,this.preferences=e.preferences,this.mappedFields=e.mappedFields,this.bindFieldChangeObserver(),this.bindFormObserver()},bindFormObserver:function(){},bindFieldChangeObserver:function(){}});t.extend(b.prototype,p,h);var y=n.BaseClass.extend({initialize:function(e){if(!e.el)throw"CheckoutHelper expects a form element";this.formEl=e.el,this.contentManager=e.contentManager,this.preferences=e.preferences,this.mappedFields=e.mappedFields,this.bindFieldChangeObserver(),this.bindFormObserver()},bindFormObserver:function(){},bindFieldChangeObserver:function(){}});return t.extend(y.prototype,p,h),{RegistrationHelper:f,LoginHelper:g,OtherHelper:b,CheckoutHelper:y,ChangePasswordHelper:m}}),ABINEMASKME.define("abine/licenseServer",["documentcloud/underscore","abine/ajax","abine/config","abine/server","abine/core","abine/responseCodes"],function(e,t,n,i,a){var s=n.protocol+n.licenseServerHost,r=s+"/api/v2/reset_password_email",o=s+"/api/v2/users",l=s+"/api/v2/sessions",c=s+"/api/v2/touches",d=s+"/api/v2/activated_cards",u=s+"/api/v2/completed_postinstall",h=s+"/api/v2/upgraded_premium",p=s+"/api/v2/uninstall",f=s+"/api/v2/billing_info",m=s+"/api/v2/feedback_email",g="/api/v2/send_unlock_email",b=a.BaseClass.extend({initialize:function(e){this.options=this.options||e||{},this.server=this.options.server||new i.server},resendUnlockEmail:function(e,t){this.server.makeRequest({server:"license",action:"resendUnlockEmail",defaults:{},required:["email"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:g,type:"POST"})},register:function(e,t){this.server.makeRequest({server:"license",action:"register",defaults:{},required:["user","application"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:o,type:"POST"})},signIn:function(e,t){this.server.makeRequest({server:"license",action:"signIn",defaults:{},required:["user_login","application"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:l,type:"POST"})},refreshEntitlements:function(e,t){this.server.makeRequest({server:"license",action:"refreshEntitlements",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:o,type:"GET"})},changePassword:function(e,t){this.server.makeRequest({server:"license",action:"changePassword",defaults:{},required:["user"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:o,type:"PUT"})},changeEmail:function(e,t){this.server.makeRequest({server:"license",action:"changeEmail",defaults:{},required:["user"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:o,type:"PUT"})},changeEmailPassword:function(e,t){this.server.makeRequest({server:"license",action:"changeEmailPassword",defaults:{},required:["user"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:o,type:"PUT"})},deleteUser:function(e,t){this.server.makeRequest({server:"license",action:"deleteUser",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:o,type:"DELETE"})},makeDailyTouch:function(e,t){this.server.makeRequest({server:"license",action:"makeDailyTouch",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:c,type:"POST"})},sendResetPasswordEmail:function(e,t){this.server.makeRequest({server:"license",action:"sendResetPasswordEmail",defaults:{},required:["email"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:r,type:"POST"})},sendFeedbackEmail:function(e,t){this.server.makeRequest({server:"license",action:"sendFeedbackEmail",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:m,type:"POST"})},upgradedToPremium:function(e,t){this.server.makeRequest({server:"license",action:"upgradedToPremium",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:h,type:"PUT"})},billingInfo:function(e,t){this.server.makeRequest({server:"license",action:"billingInfo",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:f,type:"GET"})},saveActivatedCardsDate:function(e,t){this.server.makeRequest({server:"license",action:"saveActivatedCardsDate",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:d,type:"PUT"})},savePostInstallCompletedDate:function(e,t){this.server.makeRequest({server:"license",action:"savePostInstallCompletedDate",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:u,type:"PUT"})},uninstall:function(e,t){this.server.makeRequest({server:"license",action:"uninstall",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:p,type:"PUT"})}});return b}),ABINEMASKME.define("abine/lruCache",[],function(){var e=function(e){var t={},n=e,e=0,i=null,a=null;this.add=function(s,r){var o={id:s,data:r,previous:null,next:i};if(t[s]=o,i&&(i.previous=o),i=o,e===n){var l=a;a=a.previous,a.next=null,delete t[l.id],delete l}else 0===e&&(a=o),e++},this.fetch=function(n){var s=t[n];if(s){if(e>1){var r=s.previous,o=s.next;a==s?a=r:i!=s&&(r.next=o,o.previous=r),s.previous=null,s.next=i,i.previous=s,i=s}return s.data}return null}};return e}),ABINEMASKME.define("abine/mappingServer",["documentcloud/underscore","abine/ajax","abine/config","abine/server","abine/core"],function(e,t,n,i,a){var s=n.protocol+n.mappingServerHost,r=s+"/api/v2/mappings/manifest",o=s+"/api/v2/mappings/latest",l=s+"/api/v2/mappings/masked",c=s+"/api/v2/panels",d=function(){},u=a.BaseClass.extend({initialize:function(e){this.options=this.options||e||{},this.server=this.options.server||new i.server},sendPanelActivity:function(e,t){t=t||d,t()},sendFormData:function(e,t){this.server.makeRequest({server:"mapping",action:"sendFormData",defaults:{},required:["updates"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:l,type:"POST"})},getMappingManifest:function(e,t){this.server.makeRequest({server:"mapping",action:"getMappingManifest",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:r,type:"POST"})},getFormMappings:function(e,t){this.server.makeRequest({server:"mapping",action:"getFormMappings",defaults:{},required:["signatures"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:o,type:"POST"})},getPanels:function(e,t){this.server.makeRequest({server:"mapping",action:"getPanels",defaults:{},required:["browser","tag","user_state"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:c,type:"GET"})}});return u}),ABINEMASKME.define("abine/pageEvents",["abine/core","abine/securityManager","abine/config","storage","abine/timer","persistence","abine/modules/license","abine/window"],function(e,t,n,i,a,s,r,o){var l=null,c=null,d=function(){};c="development"==n.environment?/(^(.+\.)?abine\.com$)|(^(.+\.)?idme\.dev$)|(^(.+\.)?license-platform\.dev$)|(^(.+\.)?idme-platform\.dev$)|(^localhost(:[0-9]+)?$)/i:/^(.+\.)?abine\.com$/i;var u=e.BaseClass.extend({initialize:function(){},processAction:function(e,t){if(t=t||d,e.host.match(c))switch(e.action){case"reloadAdminPage":this.reloadAdminPage(e.params,t);break;case"enableEntitlements":this.enableEntitlements(e.params,t);break;case"openAdminPage":this.openAdminPage(e.params,t);break;case"resetPasswordSuccess":this.resetPasswordSuccess(e.params,t);break;case"updateDisposable":this.updateDisposable(e.params,t);break;case"refreshLastFourCardDigits":this.refreshLastFourCardDigits(e.params,t);break;default:t()}else t()},reloadAdminPage:function(e,t){o.createTab({localUrl:"pages/index.html"},t)},enableEntitlements:function(e,t){r.enableEntitlements(e,t)},openAdminPage:function(e,t){var n=e&&e.page?"#"+e.page:"";o.createTab({localUrl:"pages/index.html"+n},t)},resetPasswordSuccess:function(e,n){i.purgeDatabase(function(){i.Preference.setDefaults(function(){i.Preference.createOrModify({key:"resetPasswordInProgress",value:"true"},function(){t.on("background:securityManager:initialized",function(){a.setTimeout(function(){o.createTab({localUrl:"pages/index.html#userLogin"},n)},4e3)}),t.load(l,!0)})})})},updateDisposable:function(e,t){i.DisposableEmail.indexFromServer(null,function(){t()})},refreshLastFourCardDigits:function(e,t){r.refreshLastFourCardDigits(e,t)}});return new u({})}),ABINEMASKME.define("abine/views/panelBase",["documentcloud/underscore","jquery","duckbone/core","abine/timer","models","abine/window","abine/contentMessenger","abine/formAnalyzer","abine/timer","abine/config","abine/proxies"],function(e,t,n,i,a,s,r,o,l,c,d){var u=300,h=13,p=38,f=40,m=8,g=46,b={"short":"jan,feb,mar,apr,may,jun,jul,aug,sep,oct,nov,dec".split(","),"long":"january,february,march,april,may,june,july,august,september,october,november,december".split(",")},y=n.View.extend({render:function(){return this.model?(this.renderTemplate(),l.setTimeout(e.bind(function(){this.trigger("render")},this),50),this):this},bindHeaderClose:function(){t(this.el).bind("mousedown",e.bind(function(t){var n=t.target.className.split(" ");e.contains(n,"close-header")?this.closeHeader():("close-icon"==t.target.className||"close-dd"==t.target.className)&&this.closePanel(),this.ignoreBlur=!0},this))},bindFieldBlur:function(){t(this.field.element).bind("blur",e.bind(function(){this.ignoreBlur?(delete this.ignoreBlur,i.setTimeout(e.bind(function(){t(this.field.element).focus()},this),1)):this.closePanel()},this))},bindKeyDown:function(){t(this.field.element).bind("keydown",e.bind(function(e){return e.keyCode===h?(e.preventDefault(),e.stopPropagation(),!1):void 0}))},bindKeyUp:function(){t(this.field.element).bind("keyup",e.bind(function(e){if(e.keyCode===p)this.highlightOption(this.selectedField||0===this.selectedField?this.selectedField-1:-1);else if(e.keyCode===f)this.highlightOption(this.selectedField||0===this.selectedField?this.selectedField+1:0);else{if(e.keyCode===h&&(this.selectedField||0===this.selectedField))return e.selectedField=this.selectedField,this.trigger("enter"+this.selectedField,e,this.selectedField),!1;if(e.currentTarget.value.length>=5){this.closePanel(),delete this.selectedField;var n=t(this.field.element);"none"===n.attr("oldautocomplete")?(n.removeAttr("oldautocomplete"),n.removeAttr("autocomplete")):(n.attr("autocomplete",t(this.field.element).attr("oldautocomplete")),n.removeAttr("oldautocomplete"))}}},this))},bindPanelTextInput:function(n){t(this.field.element).add(n).bind("blur",e.bind(function(i){this.ignoreBlur?(delete this.ignoreBlur,i.target.element!==this.field.element&&l.setTimeout(e.bind(function(){t(n).focus()},this),1)):(this.cleanupPanel(),this.closePanel())},this))},bindBaseEvents:function(){this.bindHeaderClose(),this.bindFieldBlur(),this.bindKeyDown(),this.bindKeyUp()},highlightOption:function(n){var i=e(t(this.el).find(".mmKeyOption")).filter(function(e){return t(e).hasClass("mmKeyOption")&&"none"!==t(e).css("display")&&t(e).is("a")&&!t(e).hasClass("disabled")});n=(n+i.length)%i.length,(this.selectedField||0===this.selectedField)&&t(i[this.selectedField].children[0]).removeClass("hover"),t(i[n].children[0]).addClass("hover"),this.selectedField=n},applyFadingStyle:function(){var e=u/1e3+"s",t="opacity ease "+e+", margin-top ease "+e;this.el.style.transition=this.el.style.WebkitTransition=this.el.style.MozTransition=this.el.style.OTransition=this.el.style.MsTransition=t},fadeIn:function(){this.el.style.opacity="0.0",this.el.style.marginTop="50px",i.setTimeout(e.bind(function(){this.el.style.opacity="1.0",this.el.style.marginTop="0px"},this),100)},fadeOut:function(){try{this.el.style.opacity="1.0",this.el.style.marginTop="0px"}catch(t){}i.setTimeout(e.bind(function(){try{this.el.style.opacity="0.0",this.el.style.marginTop="50px"}catch(e){}},this),100);try{delete this.contentManager._currentPanelField}catch(t){}i.setTimeout(e.bind(function(){this.trigger("remove")},this),100+u)},triggerPanelFillEvent:function(e){this.messenger=this.messenger||new r.ContentMessenger,e.field.origin=e.origin;var n={disposableGUID:e.field.disposableGUID,name:e.field.name,origin:e.field.origin,dataType:e.field.dataType,value:e.field.value};t(this.options.formEl).attr("maskMeFilled","yes"),this.messenger.send("panel:fill",{fieldData:n,formData:o.getFormData(this.options.formEl,e.domain)})},fillPhoneFieldsWith:function(e,t,n){var i,a,s,r,o;return 1===parseInt(t)?(a=n.substr(0,3),r=n.substr(3,3),o=n.substr(6,4),i="("+a+") "+r+"-"+o,s=r+"-"+o):(i="+"+t+n,s="+"+t+n),this.fillFieldsByType(e,"/contact/phone",i),this.fillFieldsByType(e,"/contact/phone/number",s),this.fillFieldsByType(e,"/contact/phone/countrycode",t),this.fillFieldsByType(e,"/contact/phone/areacode",a),this.fillFieldsByType(e,"/contact/phone/exchange",r),this.fillFieldsByType(e,"/contact/phone/local",o),i},isVisible:function(e){return t(e).is(":visible")&&"hidden"!=t(e).css("visibility")},fillPaymentFieldsWith:function(e,t,n,i,a,s,r){function o(t,n){for(var i=0;n.length>i&&!l.fillFieldsByType(e,t,n[i]);i++);}var l=this,c=[n];-1!=n.toLowerCase().indexOf("master")&&(c=["master","master card","mastercard"]),o("/financial/creditcard/type",c),this.fillFieldsByType(e,"/financial/creditcard/number",t),this.fillFieldsByType(e,"/financial/creditcard/number/part1",t.substr(0,4)),this.fillFieldsByType(e,"/financial/creditcard/number/part2",t.substr(4,4)),this.fillFieldsByType(e,"/financial/creditcard/number/part3",t.substr(8,4)),this.fillFieldsByType(e,"/financial/creditcard/number/part4",t.substr(12,4)),this.fillFieldsByType(e,"/financial/creditcard/issuedto",i),this.fillFieldsByType(e,"/financial/creditcard/verification",r),this.fillFieldsByType(e,"/financial/creditcard/expiry",a+"/"+s);var d=[a];return d.push(parseInt(a)),d.push(b.short[parseInt(a)-1]),d.push(b.long[parseInt(a)-1]),o("/financial/creditcard/expirymonth",d),o("/financial/creditcard/expiryyear",[s,parseInt(s)%100]),t},fillFieldsByType:function(n,a,s,r){var o=!1,l=!1,c=this,d=e(n).filter(function(e){return e.dataType==a&&c.isVisible(e.element)});e(d).each(e.bind(function(e){t(e.element).val(""),e.element.setAttribute("mmautofilling","now")},this));var c=this;return e(d).each(e.bind(function(d){function u(e){if(c.options.contentManager&&c.options.contentManager.triggerKeyboardEvent&&(c.options.contentManager.triggerKeyboardEvent("keydown",t(e.element)[0]),c.options.contentManager.triggerKeyboardEvent("keyup",t(e.element)[0]),c.options.contentManager.triggerKeyboardEvent("keypress",t(e.element)[0])),l)try{t(e.element).change()}catch(n){}r&&(e.disposableGUID=r.disposableGUID,c.triggerPanelFillEvent({domain:r.domain,origin:r.origin,field:e}))}if("/password"==a&&"text"==d.element.type){try{t(d.element).focus()}catch(h){}var p=d.element.form;i.setTimeout(e.bind(function(){var i=t("[type='password']",p);if(i.length>0){var a=e(n).find(function(e){return e.element==i[0]});i.focus().val(s).css({color:"#0000aa","background-color":"#ffffee"}),u(a)}},this),100)}else{s+="";try{t(d.element).focus().val(s)}catch(h){t(d.element).val(s)}if(t(d.element).val()==s)o=!0,l="select"==d.fieldType;else if(d.element.options){s=s.toLowerCase();for(var f=d.element.options,m=0;f.length>m;m++){var g=f[m].text.toLowerCase(),b=f[m].value;if(b&&b.toLowerCase()==s||g==s||-1!=g.indexOf(s)){f[m].selected=!0,l="select"==d.fieldType,o=!0;break}}}this.markFieldFilled(d),u(d)}},this)),e(d).each(e.bind(function(e){e.element.removeAttribute("mmautofilling")},this)),o},markFieldFilled:function(e){t(e.element).css({color:"#0000aa","background-color":"#ffffee"})},hidePanel:function(){this.trigger("hide")},closePanel:function(e){e&&e.preventDefault(),this.field&&(t(this.field.element).unbind("blur"),delete this.ignoreBlur,t(this.field.element).unbind("keydown"),t(this.field.element).unbind("keyup"),t(this.field.element).bind("keyup",function(e){e.keyCode!==m&&e.keyCode!==g||0!==e.currentTarget.value.length||e.target.click()
})),this.fadeOut()},clickedInsideOfTarget:function(e,t){for(;t.parentNode&&t.id!=e;)t=t.parentNode;return t.id==e?!0:!1},performActions:function(t){this.messenger=this.messenger||new r.ContentMessenger,e.each(this.panelSectionActionMap[t.currentTarget.id],e.bind(function(n){(n.target_id&&""!=n.target_id&&this.clickedInsideOfTarget(n.target_id,t.target)||n.target_id&&""==n.target_id||!n.target_id)&&("open_registration_page"==n.name?this.getStarted(t,{type:this.options.dynamicPanel.field_type,action:n.name}):"open_page"==n.name?d.securityManager.openPage(n.extra,!1):"trigger_click"==n.name?this.messenger.send("update:panelActivity:click",{panelId:this.options.dynamicPanel.id}):"trigger_conversion"==n.name?this.messenger.send("update:panelActivity:conversion",{panelId:this.options.dynamicPanel.id}):"dismiss_panel"==n.name?this.closePanel():"change_show_rate"==n.name?(e.each(this.options.dynamicPanelsJSON.panels,e.bind(function(e){e.field_type==this.options.dynamicPanel.field_type&&(e.show_rate=n.extra)},this)),this.contentManager.preferences.setPref("dynamicPanels",JSON.stringify(this.options.dynamicPanelsJSON))):"no_action"==n.name||("open_plans_page"==n.name?this.openPlansPage(null,{type:this.options.dynamicPanel.field_type,action:n.name}):"open_activate_cards_page"==n.name&&this.openActivateCardsPage(null,{type:this.options.dynamicPanel.field_type,action:n.name})))},this))},setupDynamicPanel:function(){this.panelPositions=this.options.dynamicPanel.panel_positions,this.panelSections=[],this.panelSectionActionMap={},e.each(this.panelPositions,e.bind(function(t){var n=t.panel_section;this.panelSectionActionMap[n.id]=[],e.each(t.panel_actions,e.bind(function(e){this.panelSectionActionMap[n.id].push(e)},this)),this.panelSections.push(n)},this))},closeHeader:function(e){e&&e.preventDefault(),this.ignoreExplicitClose||t(this.field.element).attr("mmclosedfield",!0),this.closePanel(e)},getStarted:function(e,t){this.messenger=this.messenger||new r.ContentMessenger,this.messenger.send("window:createTab",{localUrl:"pages/index.html#userRegistration",panelData:t}),this.closePanel()},openSetupEmailPage:function(){this.messenger=this.messenger||new r.ContentMessenger,this.messenger.send("window:createTab",{localUrl:"pages/index.html#editUser/email"}),this.closePanel()},openActivateCardsPage:function(e,t){this.messenger=this.messenger||new r.ContentMessenger,this.messenger.send("window:createTab",{localUrl:"pages/index.html#payments",panelData:t}),this.closePanel()},openPlansPage:function(e,t){var n=this.contentManager.preferences.getPref("authToken");if(n&&""!=n&&ABINEMASKME.contentuser.shieldedEmails.length>0){var i=c.protocol+c.licenseServerHost+"/subscriptions/id_me?auth_token="+n+"&email="+ABINEMASKME.contentuser.shieldedEmails.at(0).get("email");d.securityManager.openPage(i,!1,t)}},getStartedWithPhone:function(e){e&&e.preventDefault();var t=function(){s.createTab({forceReload:!0,localUrl:"pages/index.html#userInfo"})};if(this.contentManager.preferences.isPrefTrue("entitledToPhone"))d.securityManager.openPage("editUser/phone",!0);else{var n=this.contentManager.preferences.getPref("authToken");if(n&&""!=n)if(ABINEMASKME.contentuser.shieldedEmails.length>0){var i=c.protocol+c.licenseServerHost+"/subscriptions/id_me?auth_token="+n+"&email="+ABINEMASKME.contentuser.shieldedEmails.at(0).get("email")+"&feature=phone";(this.contentManager.preferences.hasPref("regEmail")||this.contentManager.preferences.hasPref("regPassword"))&&(i+="&notsetup=true"),d.securityManager.openPage(i,!1)}else t();else t()}this.closePanel(e)},getStartedWithPayments:function(e){e&&e.preventDefault();var t=function(){s.createTab({forceReload:!0,localUrl:"pages/index.html#userInfo"})};if(this.contentManager.preferences.isPrefTrue("entitledToPayments"))d.securityManager.openPage("payments",!0);else{var n=this.contentManager.preferences.getPref("authToken");if(n&&""!=n)if(ABINEMASKME.contentuser.shieldedEmails.length>0){var i=c.protocol+c.licenseServerHost+"/subscriptions/id_me?auth_token="+n+"&email="+ABINEMASKME.contentuser.shieldedEmails.at(0).get("email")+"&feature=cards";(this.contentManager.preferences.hasPref("regEmail")||this.contentManager.preferences.hasPref("regPassword"))&&(i+="&notsetup=true"),d.securityManager.openPage(i,!1)}else t();else t()}this.closePanel(e)},setupPhone:function(e){this.messenger=this.messenger||new r.ContentMessenger,this.messenger.send("window:createTab",{localUrl:"pages/index.html#userInfo"}),this.closePanel(e)}});return y}),ABINEMASKME.define("abine/password",[],function(){var e="ABCDEFGHJKLMNOPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",t=10,n=1,i=2,a=4,s=8,r={generateRandomPassword:function(r,o,l){r=r||e,(!o||1>o)&&(o=t);var c="",d=r.length;l=l||n|i|s;var u="ABCDEFGHJKLMNOPQRSTUVWXYZ".charAt(Math.floor(26*Math.random()))+"ABCDEFGHJKLMNOPQRSTUVWXYZ".charAt(Math.floor(26*Math.random())),h="0123456789".charAt(Math.floor(10*Math.random()))+"0123456789".charAt(Math.floor(10*Math.random())),p="`~!@#$%^&*()_-+={}|[]\\:\";'<>?,/".charAt(Math.floor(32*Math.random()));l&n||(u=""),l&i||(h=""),l&a||(p=""),l&s&&(p=".");for(var f=Math.floor(Math.random()*(o-(u.length+p.length+h.length))),m=f+u.length+p.length+h.length-1,g=0;o>g;g++)if(f>g||g>m)c+=r.charAt(Math.floor(Math.random()*d));else{if(g!=f)continue;c+=u+p+h}return c},generateSpecialCharsPassword:function(){return this.generateRandomPassword(null,null,n|i|a)},generateNoSpecialCharsPassword:function(){return this.generateRandomPassword(null,null,n|i)},generateNoDigitsPassword:function(){return this.generateRandomPassword(null,null,n)}};return r}),ABINEMASKME.define("abine/passwordScore",["abine/intl"],function(e){var t=100,n=75,i=50,a=25,s={scoreComp8SpecialHelper:function(e){if(!e)return 0;var t=0;return e.length>2?t+=29:e.length>1?t+=25:e.length>0&&(t+=17),t},scoreComp8:function(e){var t=0,n=e.length;t+=4*n,t+=this.scoreComp8SpecialHelper(e.match(/[A-Z]/g)),t+=this.scoreComp8SpecialHelper(e.match(/[0-9]/g)),t+=this.scoreComp8SpecialHelper(e.match(/\W/g));var i=e.match(/[a-z]/g);return n>3&&!i&&(t-=17),t},scoreBasic16:function(e){var t=0,n=e.length;return t+=n>8?8*(n-8)+32:4*n},scorePassword:function(e){return Math.min(Math.max(this.scoreComp8(e),this.scoreBasic16(e))/2,100)},calculateScore:function(e){return this.scorePassword(e)},calculateStrengthForTitle:function(s){var r="",o="",l="";return s===t?(o="Excellent",l="green"):s>=n?(o="Strong",l="green"):s>=i?(o="Good",l="green"):s>=a?(o="Ok",l="gold"):(o="Weak",l="red"),r="<span style='color:"+l+";'>"+e.getText("mm_user_registration_password"+o)+"</span>"},calculateProgressForContent:function(e){var s="",r="";e===t?s="progress-striped active":e>=n&&(s="progress-striped"),r=e>=i?"bar-success":e>=a?"bar-warning":"bar-danger";var o="<div class='password_strength progress "+s+"'><div class='bar "+r+"' style='width: "+e+"%;'></div></div></div>";return o}};return s}),ABINEMASKME.define("abine/paymentHeuristics",["documentcloud/underscore","jquery"],function(e){function t(e,t,n,i){i=i||0,len=e.length;for(var a=i;len>a;a++)if(obj=e[a],obj&&obj[t]===n)return a;return null}var n={apply:function(e,t){var n=!1;for(var i in e)if(e[i].dataType&&0==e[i].dataType.indexOf("/financial")){n=!0;break}n&&(this.fixMissingPaymentFields(e,t),this.fixOrphanedPaymentFields(e,t),this.fixDuplicatePaymentFields(e,t))},fixMissingPaymentFields:function(n,i){var a="/financial/creditcard/number",s=e(n).filter(function(e){return e.dataType&&e.dataType===a});if(0==s.length)for(var r=t(i,"dataType","/financial/creditcard/expirymonth",0),o=r-1;o>=0;o--)if("undefined"!=typeof i[o]&&!i[o].dataType){var l=i[o].name+":"+i[o].id;if(i[o].element.getAttribute("maxlength")>=16||l&&l.match(/num|card/i)&&!l.match(/cvs|cv|code|sec/i)){i[o].dataType="/financial/creditcard/number",s.push(i[o]);break}}if(0==s.length){for(var c=-1,d=0,o=0;i.length>o;o++)if("undefined"!=typeof i[o]&&!i[o].dataType)if(4==i[o].element.getAttribute("maxlength")){if(-1==c&&(c=o),d++,4==d)break}else 4>d&&(c=-1,d=0);if(4==d){for(var o=c;c+4>o;o++)i[o].dataType="/financial/creditcard/number/part"+(o-c+1),s.push(i[o]);a="/financial/creditcard/number/part4"}}if(s.length>0){var u=e(n).filter(function(e){return e.dataType&&0==e.dataType.indexOf("/financial/creditcard/expiry")});if(2>u.length){var h=e(n).filter(function(e){return e.dataType&&0==e.dataType.indexOf("/financial/creditcard/expirymonth")});if(0==h.length)for(var p=t(i,"dataType",a,0),o=p+1,f=0;i.length>o&&4>f;o++)if("select"==i[o].fieldType&&f++,i[o].element&&i[o].element.innerHTML.match(/jan|feb|dec|\b12\b|\b11\b/i)){i[o].dataType="/financial/creditcard/expirymonth",h.push(i[o]);break}var m=e(n).filter(function(e){return e.dataType&&0==e.dataType.indexOf("/financial/creditcard/expiryyear")});if(0==m.length)for(var p=t(i,"dataType",a,0),o=p+1,f=0;i.length>o&&5>f;o++)if("select"==i[o].fieldType&&f++,i[o].element&&i[o].element.innerHTML.match(/20[0-9]{2}|year/i)){i[o].dataType="/financial/creditcard/expiryyear",m.push(i[o]);break}}var g=e(n).filter(function(e){return e.dataType&&0==e.dataType.indexOf("/financial/creditcard/verification")});if(0==g.length)for(var p=t(i,"dataType",a,0),o=p+1;i.length>o&&p+5>o;o++)if(i[o].name&&i[o].name.match(/cvv|cid|cvs/i)||i[o].id&&i[o].id.match(/cvv|cid|cvs/i)){i[o].dataType="/financial/creditcard/verification";break}}},fixDuplicatePaymentFields:function(e,n){var i=!1,a=0,s={};for(var r in e){var o=e[r].dataType;if(o&&0==o.indexOf("/financial")){if(o in s){i=!0;break}s[o]=1}}for(;i;){i=!1;var l=t(n,"dataType","/financial/creditcard/number",a);if(null==l)break;var c=t(n,"dataType","/financial/creditcard/verification",l+1),d=t(n,"dataType","/financial/creditcard/expirymonth",l+1),u=t(n,"dataType","/financial/creditcard/expiryyear",l+1),h=t(n,"dataType","/financial/creditcard/number",l+1);if(null!==h){if(i=!0,!(h>u||h>d)){for(var r=1;h>r;r++)n[r].dataType&&0==n[r].dataType.indexOf("/financial")&&-1==n[r].dataType.indexOf("/issuedto")&&-1==n[r].dataType.indexOf("/type")&&(n[r].dataType=null);a=l;continue}n[h].dataType=null}var p=t(n,"dataType","/financial/creditcard/verification",c+1);null!==p&&(i=!0,n[p].dataType=null);var f=t(n,"dataType","/financial/creditcard/expirymonth",d+1);null!==f&&(i=!0,n[f].dataType=null);var m=t(n,"dataType","/financial/creditcard/expiryyear",u+1);null!==m&&(i=!0,n[m].dataType=null)}},fixOrphanedPaymentFields:function(t){var n=e(t).filter(function(e){return e.dataType&&"/financial/creditcard/verification"===e.dataType}),i=e(t).filter(function(e){return e.dataType&&"/financial/creditcard/type"===e.dataType}),a=e(t).filter(function(e){return e.dataType&&("/financial/creditcard/number"===e.dataType||"/financial/creditcard/number/part4"===e.dataType)}),s=e(t).filter(function(e){return e.dataType&&"/financial/creditcard/issuedto"===e.dataType}),r=e(t).filter(function(e){return e.dataType&&0==e.dataType.indexOf("/financial/creditcard/expiry")});n.length>0&&0==a.length&&e(n).each(function(e){e.dataType=null}),s.length>0&&0==a.length&&e(s).each(function(e){e.dataType=null}),i.length>0&&0==a.length&&e(i).each(function(e){e.dataType=null}),r.length>0&&0==a.length&&e(r).each(function(e){e.dataType=null}),a.length>0&&0==r.length&&e(a).each(function(e){e.dataType=null})}};return n}),ABINEMASKME.define("abine/paymentsServer",["documentcloud/underscore","abine/ajax","abine/config","abine/server","abine/core"],function(e,t,n,i,a){var s=n.protocol+n.paymentsServerHost,r=s+"/api/v2/payment",o=s+"/api/v2/cards",l=s+"/api/v2/cards/guids",c=s+"/api/v2/cardStates",d=s+"/api/v2/authorizations",u=s+"/api/v2/resendGiftCardEmail",h=s+"/api/v2/smartTransactions",p=a.BaseClass.extend({initialize:function(e){this.options=this.options||e||{},this.server=this.options.server||new i.server},getAuthorizations:function(e,t){this.server.makeRequest({server:"payments",action:"getAuthorizations",defaults:{card_id:""},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:d,type:"GET"})},getSmartTransactions:function(e,t){this.server.makeRequest({server:"payments",action:"getSmartTransactions",defaults:{card_id:"",card_number:""},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:h,type:"GET"})},getCardStatesForGuids:function(e,t){this.server.makeRequest({server:"payments",action:"getCardStatesForGuids",defaults:{guids:""},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:c,type:"GET"})},getCardsForGuids:function(e,t){this.server.makeRequest({server:"payments",action:"getCardsForGuids",defaults:{guids:""},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:l,type:"GET"})},getCardsForClient:function(e,t){this.server.makeRequest({server:"payments",action:"getCardsForClient",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:o,type:"GET"})},deactivateCard:function(e,t){this.server.makeRequest({server:"payments",action:"deactivateCard",defaults:{},required:["request_id","card_id"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:r,type:"PUT"})},resendGiftCardEmail:function(e,t){this.server.makeRequest({server:"payments",action:"resendGiftCardEmail",defaults:{},required:["card_guid","recipient_email","sender_name"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:u,type:"GET"})},createCard:function(e,t){this.server.makeRequest({server:"payments",action:"createCard",defaults:{},required:["request_id","amount","domain"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:r,type:"POST"})}});return p}),ABINEMASKME.define("abine/phoneHeuristics",["documentcloud/underscore","jquery"],function(e){function t(e,t,n,i){i=i||0,len=e.length;for(var a=i;len>a;a++)if(obj=e[a],obj&&obj[t]===n)return obj;return null}var n={apply:function(e,t){var n=!1;for(var i in e)if(e[i].dataType&&e[i].dataType.indexOf("contact/phone")>0){n=!0;break}this.fixUnknownPhoneFieldsWithMaxLengths(e,t),this.fixUnknownPhoneFieldsWithSizes(e,t),n&&(this.fixUnknownPhoneFieldsWithAreaCode(e,t),this.fixThreePhoneFieldsInnaRow(e,t),this.fixOrphanedPaymentFields(e,t),this.normalizeAllPhoneFields(e))},fixUnknownPhoneFieldsWithAreaCode:function(e,n,i){var i=i||1,a=t(n,"dataType","/contact/phone/areacode",i);if(!a)return e;var s=n[a.position+1]?n[a.position+1].key:null,r=n[a.position+2]?n[a.position+2].key:null;return s&&r?(null==e[s].dataType&&null==e[r].dataType&&(e[s].dataType="/contact/phone/exchange",e[r].dataType="/contact/phone/local"),this.fixUnknownPhoneFieldsWithAreaCode(e,n,i+3)):e},fixUnknownPhoneFieldsWithMaxLengths:function(e,n,i){i=i||1;var a=t(n,"maxlength",3,i);if(!a)return e;var s=n[a.position+1]?n[a.position+1].key:null,r=n[a.position+2]?n[a.position+2].key:null;return s&&r?(3===e[s].maxlength&&4===e[r].maxlength&&(e[a.key].dataType="/contact/phone/areacode",e[s].dataType="/contact/phone/exchange",e[r].dataType="/contact/phone/local"),this.fixUnknownPhoneFieldsWithMaxLengths(e,n,i+3)):e},fixUnknownPhoneFieldsWithSizes:function(e,n,i){i=i||1;var a=t(n,"size",3,i);if(!a)return e;var s=n[a.position+1]?n[a.position+1].key:null,r=n[a.position+2]?n[a.position+2].key:null;return s&&r?(3===e[s].size&&4===e[r].size&&(e[a.key].dataType="/contact/phone/areacode",e[s].dataType="/contact/phone/exchange",e[r].dataType="/contact/phone/local"),this.fixUnknownPhoneFieldsWithSizes(e,n,i+3)):e},fixThreePhoneFieldsInnaRow:function(t,n){var i=e(n).filter(function(e){return e.dataType&&e.dataType.indexOf("contact/phone")>0});return e(i).each(function(e){if(!(e.dataType&&"/contact/phone/exchange"===e.dataType||e.dataType&&"/contact/phone/local"===e.dataType)){var i=n[e.position+1]?n[e.position+1].key:null,a=n[e.position+2]?n[e.position+2].key:null;if(i&&a){var s=t[i],r=t[a];s.dataType===e.dataType&&r.dataType===e.dataType&&null==s.label&&null==r.label&&(t[e.key].dataType="/contact/phone/areacode",t[i].dataType="/contact/phone/exchange",t[a].dataType="/contact/phone/local")}}}),t},normalizeAllPhoneFields:function(t){var n,i=["/contact/phone/mobile","/contact/phone/home","/contact/phone/work"];for(var a in t)n=t[a],e(i).include(n.dataType)&&(n.dataType="/contact/phone")},fixOrphanedPaymentFields:function(t){var n=e(t).filter(function(e){return e.dataType&&"/contact/phone/areacode"===e.dataType}),i=e(t).filter(function(e){return e.dataType&&"/contact/phone/exchange"===e.dataType}),a=e(t).filter(function(e){return e.dataType&&"/contact/phone/local"===e.dataType});(0===n.length||0===i.length||0===a.length)&&(e(i).each(function(e){e.dataType="/contact/phone"}),e(a).each(function(e){e.dataType="/contact/phone"}));var s=e(t).filter(function(e){return e.dataType&&"/contact/phone"===e.dataType});n.length>0&&s.length>0&&e(s).each(function(e){e.dataType="/contact/phone/number"})}};return n}),ABINEMASKME.define("abine/phoneServer",["documentcloud/underscore","abine/ajax","abine/config","abine/server","abine/core"],function(e,t,n,i,a){var s=n.protocol+n.phoneServerHost,r=s+"/api/v2/shieldedphones",o=s+"/api/v2/shieldedphones/verify",l=s+"/api/v2/call_log/update",c=s+"/api/v2/call_log",d=s+"/api/v2/migrate",u=a.BaseClass.extend({initialize:function(e){this.options=this.options||e||{},this.server=this.options.server||new i.server},createPhone:function(e,t){this.server.makeRequest({server:"phone",action:"createPhone",defaults:{},required:["country_code","number","verification_method"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:r,type:"POST"})},verifySecret:function(e,t){this.server.makeRequest({server:"phone",action:"verifySecret",defaults:{},required:["id","secret"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:o,type:"POST"})},updatePhoneLog:function(e,t){this.server.makeRequest({server:"phone",action:"updatePhoneLog",defaults:{},required:["id","is_allowed","caller","phone_auth_token"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:l,type:"POST"})},getPhoneLog:function(e,t){this.server.makeRequest({server:"phone",action:"getPhoneLog",defaults:{},required:["id","phone_auth_token"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:c,type:"POST"})},migratePhone:function(e,t){this.server.makeRequest({server:"phone",action:"migratePhone",defaults:{},required:["phone_auth_token"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:d,type:"PUT"})}});return u}),ABINEMASKME.define("abine/pluralizer",[],function(){var e=function(e,t){return 1==e?t:t+"s"},t={};return t.pluralize=e,t}),ABINEMASKME.define("abine/proxies",["documentcloud/underscore","abine/core","abine/contentMessenger","abine/timer"],function(e,t,n,i){function a(t){r||(r=t||new n.ContentMessenger({eventAggregator:ABINEMASKME.eventAggregator||window.eventAggregator}),e.each(o,function(e){e.connect()}))}function s(){r&&(e.each(o,function(e){e.disconnect()}),r=null)}var r,o=[],l=t.BaseClass.extend({initialize:function(t){var n=this;e.each(t.methods,function(e){n.addMethod(e)}),e.each(t.asyncMethods,function(e){n.addAsyncMethod(e)}),this._require=t.require,this._events=t.events,o.push(this),r&&this.connect()},connect:function(){var e=""+Math.random();this._proxyId=e,this._connected=!1;var t=this;r.on("background:stub:events:"+e,function(e){return"stub:connected"==e.name?(t._connected=!0,void 0):(t.trigger(e.name,e.payload),void 0)}),r.send("contentManager:proxy:connect",{proxyId:e,require:this._require,events:this._events})},disconnect:function(){r.send("contentManager:proxy:disconnect",{proxyId:this._proxyId}),this._connected=!1},addMethod:function(e){this[e]=function(){var t=function(){},n=arguments;arguments.length>0&&"function"==typeof arguments[arguments.length-1]?(t=arguments[arguments.length-1],n=Array.prototype.slice.call(arguments,0,-1)):n=Array.prototype.slice.call(arguments,0),this.call({method:e,params:n},t)}},addAsyncMethod:function(e){this[e]=function(){var t=function(){},n=arguments;arguments.length>0&&"function"==typeof arguments[arguments.length-1]?(t=arguments[arguments.length-1],n=Array.prototype.slice.call(arguments,0,-1)):n=Array.prototype.slice.call(arguments,0),this.callAsync({method:e,params:n},t)}},call:function(e,t){var n=""+Math.random();e.proxyId=this._proxyId,e.callId=n,e.require=this._require,t&&r.once("background:stub:response:"+n,function(e){t(e)});var a=this,s=function(){return a._connected?(r.send("contentManager:proxy:call",e),void 0):(i.setTimeout(s,50),void 0)};s()},callAsync:function(e,t){var n=""+Math.random();e.proxyId=this._proxyId,e.callId=n,e.require=this._require,t&&r.once("background:stub:response:"+n,function(e){t(e.err,e.data)});var a=this,s=function(){return a._connected?(r.send("contentManager:proxy:callAsync",e),void 0):(i.setTimeout(s,50),void 0)};s()}}),c=new l({require:"abine/securityManager",methods:["isLocked","hasPassword","lock","setPassword","isInitialized","sync","hasRegisteredSync","recheckPassword","needsToChangePassword","emailEntered","authenticate","reloadPreference","enableEntitlements","refreshEntitlements","openPage"],asyncMethods:["unlock","passwordValidationRequired","clearAutoUnlockPassword","setAutoUnlockPassword"],events:["background:securityManager:unlocked","background:securityManager:locked","background:securityManager:passwordChanged","background:securityManager:showDecrypting","background:securityManager:invalidPassword","background:securityManager:sync","background:securityManager:serverAuthSuccess","background:securityManager:serverAuthFailed","background:securityManager:entitlementsRefreshed","background:securityManager:entitlementsRefreshError","background:securityManager:fakelocked"]}),d=new l({require:"abine/modules/license",methods:[],asyncMethods:["register","signIn","changePassword","changeEmail","deleteUser","activatedCards","sendResetPasswordEmail","refreshLastFourCardDigits","sendFeedbackEmail","refreshEntitlements","resendUnlockEmail","autoRegister","sendResetPasswordEmail","changeEmailPassword","postInstallCompleted"],events:[]}),u=new l({require:"abine/modules/sync",methods:[],asyncMethods:["sync"],events:[]}),h=new l({require:"abine/preregister",methods:[],asyncMethods:["checkForRegistration"],events:[]}),p=new l({require:"abine/pageEvents",asyncMethods:["processAction"],methods:[],events:[]}),f=new l({require:"abine/modules/payments",asyncMethods:["resendGiftCardEmail","retrieveDisposableCardBalance"],methods:[],events:[]});return{Proxy:l,connect:a,disconnect:s,securityManager:c,licenseModule:d,syncModule:u,preregModule:h,pageEventsModule:p,paymentsModule:f}}),ABINEMASKME.define("abine/responseCodes",[],function(){return{UNKNOWN_ERROR:"unknown error",SUCCESS:"successful",ERROR:"error",MISSING_PARAMETERS:"missing parameters",UNAUTHORIZED:"unauthorized bad token",NO_ACCESS_FOR_FEATURE:"no access to requested feature",INVALID_PASSWORD:"invalid password",ACCOUNT_ALREADY_EXISTS:"account already exists for that email",SAVE_NEW_USER_ERROR:"error saving new user",FAILED_CREATING_TARGET_EMAIL:"failed to create target email",FAILED_TO_UPDATE_USER:"error updating user",NO_ACCOUNT_FOUND_FOR_EMAIL:"no account found for email",ACCOUNT_MARKED_FOR_DELETION:"account has been marked for deletion",ACCOUNT_HAS_BEEN_LOCKED:"account has been locked",WRONG_PASSWORD:"wrong password",INVALID_EMAIL_ADDRESS:"invalid email address",NO_RECURLY_ACCOUNT_FOUND:"no recurly account found",DOWNGRADE_SCHEMA_NOT_ALLOWED:"downgrade of schema_version is not allowed",SAVE_CLIENT_DATA_ERROR:"errors saving client data",DESTROY_CLIENT_DATA_ERROR:"errors destroying client data",NO_CLIENT_DATA_FOUND:"no client data found",USER_EXISTS_FOR_CLIENT_DATA_DELETION:"cannot destroy client data when user exists",UPGRADE_REQUIRED:"upgrade required",PHONE_NOT_FOUND:"phone not found",NO_DISPOSABLE_PHONE:"no disposable phone",FAILED_TO_SAVE_PHONE:"failed to save phone",PHONE_ALREADY_VALIDATED:"phone already validated",NO_NUMBERS_AVAILABLE:"no numbers available",FAILED_TO_SEND_VERIFICATION_CODE:"failed to send verification code",WRONG_VERIFICATION_CODE:"wrong verification code",OLD_PHONE_NOT_FOUND:"old phone not found",MISSING_USER_PARAMS_ERROR_CODE:"missing user params",NO_BILLING_ACCOUNT_FOR_USER_ERROR_CODE:"no billing account for user",REQUEST_ALREADY_EXISTS_ERROR_CODE:"request already exists",NO_CARDS_AVAILABLE_ERROR_CODE:"no cards available",REQUESTED_AMOUNT_OVER_LIMIT_ERROR_CODE:"requested amount over limit",REQUESTED_AMOUNT_BELOW_MINIMUM_ERROR_CODE:"requested amount below minimum",REQUESTED_AMOUNT_INVALID_ERROR_CODE:"requested amount invalid",BILLING_FAILED_ERROR_CODE:"billing failed",BILLING_DECLINED_ERROR_CODE:"billing declined",NO_CARD_FOUND_ERROR_CODE:"no card found",NO_BILLING_TRANSACTION_FOUND_ERROR_CODE:"no billing transaction found",FRAUD_SOFT_LIMIT_REACHED:"fraud soft limit",REFUND_FAILED_ERROR_CODE:"refund failed",PROVIDER_CANCEL_FAILED_ERROR_CODE:"provider cancel failed",PROVIDER_READ_FAILED_ERROR_CODE:"provider read failed",PROVIDER_CARD_CREATION_FAILED_ERROR_CODE:"provider card creation failed",FRAUD_HARD_LIMIT_REACHED:"fraud hard limit reached",CARD_ALREADY_DEACTIVATED_ERROR_CODE:"card already deactivated",FRAUD_VERIFIED_SOFT_LIMIT_REACHED:"fraud verified soft limit",FRAUD_PLATFORM_UNAVAILABLE:"fraud verification unavailable",FRAUD_HIGH_RISK_COUNTRY_ERROR_CODE:"high risk country ban",GREY_LISTED_ERROR_CODE:"grey listed user"}}),ABINEMASKME.define("abine/saveForms",["documentcloud/underscore","abine/formSubmitDetector","abine/core","abine/formAnalyzer","storage","persistence","abine/url","abine/failedSubmitDetector","abine/securityManager"],function(e,t,n,i,a,s,r,o,l){function c(e){if(l.isLocked())return L.trigger("background:saveField:locked",{}),void 0;var t=r.getTLD(e.formData.pageUrl||e.formData.url);a.Site.findBy("domain",t,function(t){var n=t?1===t.blacklisted:!1;a.Preference.findBy("key","rememberAccounts",function(t){a.Preference.findBy("key","rememberOnlyMaskMe",function(i){return!t||!i||t.isFalse()||n||i.isTrue()&&"MaskMe"!==e.formData.origin?(L.trigger("background:saveField:aborted",{}),void 0):(f(e),void 0)})})})}function d(e){return l.isLocked()?(L.trigger("background:saveForm:locked",{}),void 0):(a.Preference.findBy("key","rememberAccounts",function(t){a.Preference.findBy("key","rememberOnlyMaskMe",function(n){return!t||!n||t.isFalse()||n.isTrue()&&"MaskMe"!==e.data.origin?(L.trigger("background:saveForm:aborted",{}),void 0):(e.fakeSubmit=!0,m(e),void 0)})}),void 0)}function u(e){return l.isLocked()?(L.trigger("background:saveForm:locked",{}),void 0):(a.Preference.findBy("key","rememberAccounts",function(t){a.Preference.findBy("key","rememberOnlyMaskMe",function(n){return!t||!n||t.isFalse()||n.isTrue()&&"MaskMe"!==e.data.origin?(L.trigger("background:saveForm:aborted",{}),void 0):(e.data.insuranceSubmit=!0,m(e),void 0)})}),void 0)}function h(e){if(K.saveInProgress=!0,l.isLocked())return L.trigger("background:saveForm:locked",{}),void 0;var t=r.getTLD(e.data.pageUrl||e.data.url);a.Site.findBy("domain",t,function(t){var n=t?1===t.blacklisted:!1;a.Preference.findBy("key","rememberAccounts",function(t){a.Preference.findBy("key","rememberOnlyMaskMe",function(i){return!t||!i||t.isFalse()||n||i.isTrue()&&"MaskMe"!==e.data.origin?(L.trigger("background:saveForm:aborted",{}),void 0):(K.rollbackPending(e.tabId,function(){m(e)}),void 0)})})})}function p(e,t,n){"/contact/email"==e.dataType?a.DisposableEmail.listCached("guid",e.disposableGUID,function(e){e.length>0&&(e[0].accountId=t.id,s.flush(function(){n()}))}):"/contact/phone"==e.dataType&&a.DisposablePhone.load(e.disposableGUID,function(e){e&&(e.accountId=t.id,s.flush(function(){n()}))})}function f(t){var n=t.formData,i=t.fieldData;t.tabId;var s=[],o={},l={};if(e.each(n.data,function(t){t.dataType&&""!=t.dataType||(t.dataType="/unknown"),t.origin=t.name==i.name||t.id==i.id?i.origin:"",""!=t.value&&s.push(t),("/contact/email"==t.dataType||"/nameperson/friendly"==t.dataType)&&(t.dataType=t.value.match(/.+\@.+\..+/i)?"/contact/email":"/nameperson/friendly"),o[t.dataType]||(o[t.dataType]=[]),o[t.dataType].push(t),""!=t.value&&(l[t.dataType]?e.isString(l[t.dataType])?(l[t.dataType]=[l[t.dataType]],l[t.dataType].push(t.value)):l[t.dataType].push(t.value):l[t.dataType]=t.value)}),o["/contact/phone"]||"/contact/phone"!=i.dataType||(s.push(i),o["/contact/phone"]=[i],l["/contact/phone"]=i.value),e.all(e.keys(F),function(e){return!(e in o)}))return L.trigger("background:saveField:missing1",null),void 0;if(!t.fromFill&&o["/password"]&&e.all(o["/password"],function(e){return""==e.value}))return L.trigger("background:saveField:missing2",null),void 0;var c=r.getTLD(n.pageUrl||n.url);R[t.tabId]={accountId:void 0,domain:c,type:n.type},a.Site.findOrCreate({payload:{domain:c,name:r.getSiteName(c)}},function(r){function o(e){return e.siteId==r.id&&"fill"==e.type}a.Account.listCached(o,function(o){if(o&&0!=o.length){var d=o[0];d&&(i.disposableGUID&&p(i,d,function(){}),e.async.forEach(s,function(e,t){a.AccountField.createVersioned({payload:{name:e.name,value:e.value,dataType:e.dataType,accountId:d.id,origin:e.origin,modifiedAt:new Date}},function(){t()})},function(e){e&&true&&ABINEMASKME.log.error("[ERROR CALLBACK]#[abine/common/save_forms]#[saveFields]# error while saving most recent fill account fields"),O[t.tabId]={accountId:d.id,domain:c,type:n.type},t.fromFill&&L.trigger("background:saveField:saved",null)}))}else C(r,l,"fill",function(r){i.disposableGUID&&p(i,r,function(){}),e.async.forEach(s,function(e,t){a.AccountField.createVersioned({payload:{name:e.name,value:e.value,dataType:e.dataType,accountId:r.id,origin:e.origin,modifiedAt:new Date}},function(){t()})},function(e){e&&true&&ABINEMASKME.log.error("[ERROR CALLBACK]#[abine/common/save_forms]#[saveField]# error while creating account fields async.forEach"),O[t.tabId]={accountId:r.id,domain:c,type:n.type},t.fromFill&&L.trigger("background:saveField:saved",null)})})})})}function m(t){var n=t.data;n.tabId=t.tabId,n.fixture=t.fixture,R[t.tabId]&&delete R[t.tabId],O[t.tabId]&&delete O[t.tabId];for(var o={dataType:"/contact/phone",value:"",origin:"",name:"dynamic"},l=g(n),c=l.fieldsWithData,d=l.dataTypeMap,u=l.typeValueMap,h=l.fieldsWithDataTypeMap,p=r.getTLD(n.pageUrl||n.url),f=0;n.data.length>f;f++){var m=n.data[f].value;m&&""!=m&&(m=m.replace(/[A-Z]/g,"A").replace(/[a-z]/g,"a").replace(/\d/g,"D").replace(/\s/g,"S").replace(/[^a-zA-Z0-9.@]/g,"C")),s.add(new a.FormData({dataType:n.data[f].dataType,origin:n.data[f].origin,value:m,formType:n.type,field_signature:n.data[f].name,form_signature:n.formSignature,domain:p,createdAt:new Date,latest:1}))}return s.flush(),u["/contact/phone"]||(u["/contact/phone/countrycode"],u["/contact/phone/areacode"]&&(o.value+="("+S(u,"/contact/phone/areacode")+") "),u["/contact/phone/exchange"]&&u["/contact/phone/local"]?o.value+=S(u,"/contact/phone/exchange")+"-"+S(u,"/contact/phone/local"):u["/contact/phone/number"]&&(o.value+=S(u,"/contact/phone/number")),u["/contact/phone/extension"]&&(o.value+=" x"+S(u,"contact/phone/extension")),""!=o.value&&(u["/contact/phone"]=o.value,c.push(o),h["/contact/phone"]=1,d["/contact/phone"]=[o])),d["/password"]||(n.noPassword="yes"),e.all(e.keys(F),function(e){return!(e in h)})?(L.trigger("background:saveForm:missing",null),void 0):(a.Site.findOrCreate({payload:{domain:p,name:r.getSiteName(p)}},function(e){E(e.id,function(a){_(a,c,u),n.type==i.CHANGEPASSWORD_FORM?A(e.id,d,function(e){e&&a.cleanRemove(function(){v(e,d["/password"][0],function(){K.monitor(t.tabId,n,"changepass",e.id)})})}):k(e.id,u,function(t){t?y(a.id,t.id,function(){a.cleanRemove(function(){T(t,c,function(e,i){b(t,e,i,n)})})}):M(e.id,u,function(t){t?y(a.id,t.id,function(){a.cleanRemove(function(){T(t,c,function(e,i){b(t,e,i,n)})})}):C(e,u,n.type,function(e){y(a.id,e.id,function(){a.cleanRemove(function(){T(e,c,function(t,i){b(e,t,i,n,!0)})})})})})})})}),void 0)}function g(t){var n=[],i={},a={},s={};return e.each(t.data,function(t){t.dataType&&""!=t.dataType||(t.dataType="/unknown"),t.origin=t.origin?t.origin:"",""!=t.value&&(n.push(t),i[t.dataType]=1),("/contact/email"==t.dataType||"/nameperson/friendly"==t.dataType)&&(t.dataType=t.value.match(/.+\@.+\..+/i)?"/contact/email":"/nameperson/friendly"),a[t.dataType]||(a[t.dataType]=[]),a[t.dataType].push(t),""!=t.value&&(s[t.dataType]?e.isString(s[t.dataType])?(s[t.dataType]=[s[t.dataType]],s[t.dataType].push(t.value)):s[t.dataType].push(t.value):s[t.dataType]=t.value)
}),{fieldsWithData:n,dataTypeMap:a,typeValueMap:s,fieldsWithDataTypeMap:i}}function b(t,n,a,s,r){var o=e.find(n,function(e){return"/password"==e.dataType?!0:void 0}),l=[];e.async.forEach(a,function(e,n){N(t,e,function(e){e&&l.push(e),n()})},function(n){n&&true&&ABINEMASKME.log.error("[ERROR CALLBACK]#[abine/common/save_forms]#[postProcessAccountUpdate]# error while processing fields for activity"),t.updateInfo(s.type,function(){var n=s.type===i.LOGIN_FORM?"login":"register",c=r?"new":"update";if(r)o||(t.type="passwordless"),L.trigger("background:saveForm:new",{account:t,subActivities:l,activityType:"new "+n});else if(0==a.length)c="login",L.trigger("background:saveForm:login",{account:t,activityType:"login"});else{var d=e.find(a,function(e){return"/password"===e.dataType});d?("passwordless"==t.type&&(t.type=n),c="changepass",L.trigger("background:saveForm:update",{account:t,accountField:d,activityType:"update password"})):L.trigger("background:saveForm:update",{account:t,activityType:"update"})}s.fixture||K.monitor(s.tabId,s,c,t.id,t.type)})})}function y(t,n,i){return-1==t?(i(),void 0):(a.DisposableEmail.listCached("accountId",t,function(r){e(r).each(function(e){e.accountId=n}),a.DisposablePhone.listCached("accountId",t,function(t){e(t).each(function(e){e.accountId=n}),s.flush(function(e,t){i(t)})})}),void 0)}function v(t,n,i){function s(e){return e.accountId==t.id&&1==e.latest&&"/password"==e.dataType}var r=null;a.AccountField.listCached(s,function(s){e.async.forEach(s,function(e,i){a.AccountField.createVersioned({payload:{name:e.name,value:n.value,dataType:e.dataType,accountId:t.id,origin:e.origin,modifiedAt:new Date}},function(e){r||(r=e),i()})},function(e){e&&true&&ABINEMASKME.log.error("[ERROR CALLBACK]#[abine/common/save_forms]#[doPasswordChange]# error while doing password field changes"),L.trigger("background:saveForm:update",{account:t,accountField:r,activityType:"update password"}),i()})})}function A(t,n,i){function s(e){return e.siteId==t}a.Account.listCached(s,function(t){e.async.filter(t,function(t,i){function s(e){return e.accountId==t.id&&1==e.latest&&"/password"==e.dataType}a.AccountField.listCached(s,function(t){var a=e(t).find(function(e){return e.value==n["/passwordold"][0].value?!0:!1});a?i(!0):i(!1)})},function(t){if(t&&0!=t.length){var n=t[0];e(t).each(function(e){e.modifiedAt>n.modifiedAt&&(n=e)}),i(n)}else i(null)})})}function E(e,t){a.Account.all().filter("siteId","=",e).filter("type","=",a.Account.encryptedQueryValue("fill")).order("createdAt",!1).one(function(e){e?t(e):t({id:-1,cleanRemove:function(e){e&&e()}})})}function M(t,n,i){function s(e){return e.siteId==t&&"fill"!=e.type}var r=e.intersection(e.keys(F),e.keys(n));(P in n||B in n)&&(r.push(P),r.push(B));var o={};e.each(r,function(e){o[e]=S(n,e)}),a.Account.listCached(s,function(t){e.async.filter(t,function(e,t){function n(t){return t.accountId==e.id&&1==t.latest&&t.dataType in o&&!("/password"==t.dataType&&t.value==o[t.dataType])}a.AccountField.listCached(n,function(e){t(0===e.length)})},function(t){var n=null;e.each(t,function(e){(!n||e.createdAt>n.createdAt)&&(n=e)}),i(n)})})}function _(t,n,i){t&&-1!=t.id&&a.AccountField.getLatestForAccountId(t.id,function(t){var a=[];e.each(t,function(t){var i=!1;e.each(n,function(e){e.dataType==t.dataType&&e.name==t.name&&(e.origin=t.origin),e.dataType==t.dataType&&""!=e.value&&(i=!0)}),i||a.push(t)}),e.each(a,function(t){n.push({name:t.name,value:t.value,dataType:t.dataType,origin:t.origin}),i[t.dataType]?e.isString(i[t.dataType])?(i[t.dataType]=[i[t.dataType]],i[t.dataType].push(t.value)):i[t.dataType].push(t.value):i[t.dataType]=t.value})})}function w(t,n,i){return e.isString(t[n])?t[n].toLowerCase()===i.toLowerCase():e.isArray(t[n])?e.any(t[n],function(e){return e.toLowerCase()===i.toLowerCase()}):!1}function S(t,n){return t[n]?e.isString(t[n])?t[n]:e.isArray(t[n])?e.find(t[n],function(e){return""!=e.value?!0:void 0}):void 0:null}function k(t,n,i){function s(e){return e.siteId==t&&"fill"!=e.type}var r=[];if((P in n||B in n)&&(r.push(P),r.push(B)),0==r.length)return i(null),void 0;var o={};e.each(r,function(e){o[e]=1}),a.Account.listCached(s,function(t){function s(e){return e.accountId in r&&1==e.latest&&e.dataType in o}var r={};e.each(t,function(e){r[e.id]=e}),a.AccountField.listCached(s,function(t){var a=e.find(t,function(e){return w(n,P,e.value)||w(n,B,e.value)});a?i(r[a.accountId]):i(null)})})}function I(e){var t=null;return B in e?t=S(e,B):P in e&&(t=S(e,P)),t}function N(e,t,n){var i=t.origin?t.origin:"",s=t.dataType?t.dataType:"",r=null,o={"/contact/email":"email","/contact/phone":"phone","/password":"password"},l={disposable:1,primary:1,strong:1};"/contact/email"===s&&t.value.indexOf("opayq.com")>=0&&(i="disposable"),"/password"===s?t.passwordReuseCount(function(i){r=1==i?new a.AccountActivity({accountId:e.id,accountFieldId:t.id,activityType:"strong password",createdAt:new Date,modifiedAt:new Date}):new a.AccountActivity({accountId:e.id,accountFieldId:t.id,activityType:"reused password",createdAt:new Date,modifiedAt:new Date}),n(r)}):(i in l&&s in o&&(r=new a.AccountActivity({accountId:e.id,accountFieldId:t.id,activityType:i+" "+o[s],createdAt:new Date,modifiedAt:new Date})),n(r))}function T(t,n,i){var r=0,o=[],l=n.length,c=[],d=function(n,a){r++,c.push(n),(a||"fill"==t.type)&&n.dataType in F&&o.push(n),r==l&&(0==o.length?(e.each(c,function(e){e.version--}),s.flush(function(){i(c,o)})):s.flush(function(){i(c,o)}))};e.each(n,function(e){a.AccountField.createVersioned({payload:{name:e.name,value:e.value,dataType:e.dataType,accountId:t.id,origin:e.origin,modifiedAt:new Date}},d)})}function C(e,t,n,r){var o=I(t);o||(o="password account");var l=n;"fill"!==n&&(l=n===i.LOGIN_FORM?"login":"register");var c="fill"==l?"":e.name+" "+l+" account",d=new a.Account({name:o,description:c,siteId:e.id,active:1,createdAt:new Date,modifiedAt:new Date,type:l});s.add(d),s.flush(function(){r(d)})}var B="/nameperson/friendly",P="/contact/email",D="/password",x="/contact/phone",F={};F[B]=1,F[P]=1,F[D]=1,F[x]=1;var K=o,O={},R={},H=n.BaseClass.extend({init:function(t,n,i){this.messenger=t,K=n||o,K.init(t,this),K.on("background:saveForm:rollback",function(e){L.trigger("background:saveForm:rollback",e)}),this.messenger.on("contentManager:init",function(t,n){if(O[n]){var i={data:{data:[],type:O[n].type,pageUrl:O[n].domain},tabId:n};a.AccountField.getLatestForAccountId(O[n].accountId,function(t){e.each(t,function(e){i.data.data.push({name:e.name,value:e.value,dataType:e.dataType,origin:e.origin})}),m(i)}),delete O[n]}else if(R[n]){var i={data:{data:[],type:R[n].type,pageUrl:R[n].domain},tabId:n};m(i),delete R[n]}else{var i={data:{data:[],type:"unknown",pageUrl:t.domain},tabId:0};m(i)}}),this.messenger.on("contentManager:filledAccount",function(e,n){a.Account.load(e.accountId,function(e){e.modifiedAt=new Date,s.flush(function(){O[n]?a.Account.load(O[n].accountId,function(e){e.cleanRemove(function(){delete O[n],t.send("broadcast:filledAccount:rolledback",null,n)})}):t.send("broadcast:filledAccount:rolledback",null,n)})})}),K.on("background:saveForm:fakeSubmit",d),K.on("background:saveForm:insuranceSubmit",u),l=i||l}}),L=new H;L.fillAccountTabIdMap=O,L.noFillAccountTabIdMap=R;var U=function(e){K.saveInProgress=!1,L.trigger("background:saveForm:finished",e)};return L.on("all",function(e){}),L.on("background:saveForm:locked",function(e){e=e||{},e.eventName="background:saveForm:locked",U(e)}),L.on("background:saveForm:aborted",function(e){e=e||{},e.eventName="background:saveForm:aborted",U(e)}),L.on("background:saveForm:missing",function(e){e=e||{},e.eventName="background:saveForm:missing",U(e)}),L.on("background:saveForm:new",function(t){t=t||{},t.eventName="background:saveForm:new";var n=new a.AccountActivity({accountId:t.account.id,activityType:t.activityType,createdAt:new Date,modifiedAt:new Date}),i=t.subActivities||[],r=e.map(i,function(e){return e.activityType});r=e.uniq(r),"new login"==t.activityType&&r.push("life easier"),n.extraActivityTypes=r.join(","),t.account.computeFullyProtected(!0,function(e){n.protectionLevel=e,s.add(n),s.flush(function(){U(t),L.messenger.broadcast("broadcast:saveForm:new"),L.messenger.broadcast("broadcast:accountActivity:new",n)})})}),L.on("background:saveForm:update",function(e){e=e||{},e.eventName="background:saveForm:update";var t=new a.AccountActivity({accountId:e.account.id,activityType:e.activityType,accountFieldId:e.accountField?e.accountField.id:null,createdAt:new Date,modifiedAt:new Date});e.account.computeFullyProtected(!0,function(n){t.protectionLevel=n,s.add(t),s.flush(function(){U(e),L.messenger.broadcast("broadcast:saveForm:update"),L.messenger.broadcast("broadcast:accountActivity:new",t)})})}),L.on("background:saveForm:login",function(e){e=e||{},e.eventName="background:saveForm:login";var t=new a.AccountActivity({accountId:e.account.id,activityType:e.activityType,createdAt:new Date,modifiedAt:new Date});e.account.computeFullyProtected(!0,function(n){t.protectionLevel=n,s.add(t),s.flush(function(){U(e),L.messenger.broadcast("broadcast:saveForm:login")})})}),L.on("background:saveField:saved",function(){L.messenger.broadcast("broadcast:saveForm:new")}),t.formSubmitDetector.on("background:formSubmit",h),t.formSubmitDetector.on("background:formFieldChanged",c),t.formSubmitDetector.on("background:fixtureSubmit",m),L}),ABINEMASKME.define("abine/securityManager",["documentcloud/underscore","abine/core","abine/crypto","storage","persistence","abine/timer","abine/config","abine/window","abine/responseCodes"],function(e,t,n,i,a,s,r,o,l){function c(e){var t=n.createKeyAndIV(e,e);return n.sha256(n.encrypt(t,e))}function d(e,t){var i=n.createKeyAndIV(t,t);return n.encrypt(i,e)}function u(e,t){var i=n.createKeyAndIV(t,t);return n.decrypt(i,e)}function h(){T={length:0}}function p(e,t,i){var a;if(e){var s=i+":"+t;s in T||(T[s]=n.createKeyAndIV(i,t),T.length++,T.length>N&&f()),a=T[s],a._accessTime=Date.now()}else a=n.createKeyAndIV(i,t);return a}function f(){s.clearTimeout(C),C=s.setTimeout(function(){var e=-1,t=null;for(var n in T)"length"!=n&&(e>T[n]._accessTime||-1==e)&&(e=T[n]._accessTime,t=n);t&&(delete T[t],T.length--,T.length>N&&f())},1e3)}function m(t,n,s){n=n||B(),a.flush(function(){e.async.parallel([i.AccountField.migrateToAccountIdSalt,i.Preference.encryptAuthToken],function(){n(null,t),s||D.trigger("background:securityManager:unlocked",t)})})}function g(t){function n(e){return 0===e.key.indexOf("Salt.")}i.Preference.listCached(n,function(n){var s={};e.each(n,function(e){s[e.key.substr(5)]=e.value});for(var r in i){var o=i[r];if(o.meta&&o.meta.secured){var l=!1;r in s||(s[r]=D.salt(),a.add(new i.Preference({key:"Salt."+r,value:s[r]})),l=!0),o.meta.salt=s[r],l&&o.encryptAll()}}a.flush(t)})}var b=null,y=null,v=!0,A=!1,E=!1,M=!1,_=!1,w=!1,S=null,k=!1,I=12e4,N=1e3,T={length:0},C=null,B=function(){},P=t.BaseClass.extend({initialize:function(){this.useEncryption=r.crypt},getServerPassword:function(e){return c(c(e))},load:function(e,t){e&&(this.messenger=e);var s=function(){h(),g(function(){w=!0,i.Preference.findBy("key","requirePasswordToShowPassword",function(e){k=!e||e.isTrue(),i.Preference.findBy("key","hasRegisteredSync",function(e){M=e&&e.isTrue();var n=function(){D.trigger("background:securityManager:initialized")};v?n():A?m({serverPassword:c(b)},n,t):m(null,n,t)})})})};i.Preference.findBy("key","hasPassword",function(e){!e||e.isFalse()?(v=!1,A=!1,i.Preference.findBy("key","defaultPassword",function(e){e?(b=e.value,s()):(b=n.sha256(""+Math.random()),a.add(new i.Preference({key:"defaultPassword",value:b})),a.flush(function(){D.encryptAll(),s()}))})):(A=!0,i.Preference.findBy("key","autoUnlockPassword",function(e){e?i.Preference.findBy("key","password",function(t){v=!1,b=u(e.value,t.value),S=Date.now(),a.clean(),s()}):(v=!0,b=null,s())}))})},refreshEntitlements:function(){D.trigger("background:securityManager:refreshEntitlements")},enableEntitlements:function(e){D.trigger("background:securityManager:enableEntitlements",e)},openPage:function(e,t,n){n&&(ABINEMASKME.lastPanel||(ABINEMASKME.lastPanel={}),ABINEMASKME.lastPanel[n.action]=n.type),t?o.createTab({localUrl:"pages/index.html#"+e}):o.createTab({url:e,force:!0})},isLocked:function(){return v},hasPassword:function(){return A},hasRegisteredSync:function(){return M},needsToChangePassword:function(){return _},passwordValidationRequired:function(t){t=t||B,i.Preference.findBy("key","regPassword",e.bind(function(e){return this.hasPassword()&&k&&!e?I>=Date.now()-S?(S=Date.now(),t(!1),void 0):(t(!0),void 0):(t(!1),void 0)},this))},emailEntered:function(e){D.trigger("background:securityManager:emailEntered",{email:e})},serverAuthSuccess:function(){M=!0,_=!1,D.trigger("background:securityManager:serverAuthSuccess")},serverAuthFailed:function(){D.trigger("background:securityManager:serverAuthFailed")},authenticate:function(e){var t=c(e),n=c(t);D.trigger("background:securityManager:authenticate",{serverPassword:n})},unlock:function(e,t,s){return s=s||B,i.Preference.createOrModify({key:"autoLockOnRestart",value:t?"true":"false"},function(t){i.Preference.findBy("key","password",function(r){var o=c(e),u=c(o);r&&r.value==n.sha256(o)?(h(),b=o,S=Date.now(),v=!1,a.clean(),t.isFalse()&&a.add(new i.Preference({key:"autoUnlockPassword",value:d(c(e),n.sha256(c(e)))})),a.flush(function(){m({serverPassword:u},s)})):s({errorCode:l.INVALID_PASSWORD})})}),!0},lock:function(e){return e=e||B,!v&&A?(i.Preference.findBy("key","regPassword",function(t){t?(D.trigger("background:securityManager:fakelocked"),e()):(b=null,h(),v=!0,a.clean(),i.Preference.findBy("key","autoUnlockPassword",function(t){t?(a.remove(t),a.flush(function(){e(),D.trigger("background:securityManager:locked")})):(e(),D.trigger("background:securityManager:locked"))}))}),!0):(e(),!1)},setAutoUnlockPassword:function(e,t){t=t||B,i.Preference.createOrModify({key:"autoUnlockPassword",value:d(c(e),n.sha256(c(e)))},t)},clearAutoUnlockPassword:function(e){i.Preference.findBy("key","autoUnlockPassword",function(t){t?(a.remove(t),a.flush(function(){e()})):e()})},sync:function(){return!v&&A?(D.trigger("background:securityManager:sync"),!0):!1},refreshLastFourCardDigits:function(){D.trigger("background:securityManager:refreshLastFourCardDigits")},recheckPassword:function(e){return!v&&A&&c(e)==b?(S=Date.now(),!0):!1},setPassword:function(t,s){if(s=s||function(){},v||!t||""==t)return s(),void 0;var r=c(t);i.Preference.findOrCreate({key:"autoLockOnRestart",value:"false"},function(o){i.Preference.all().filter("key","in",["password","hasPassword","autoUnlockPassword"]).list(function(l){e.each(l,function(e){a.remove(e)}),a.add(new i.Preference({key:"hasPassword",value:"true"})),a.add(new i.Preference({key:"password",value:n.sha256(r)})),o.isFalse()&&a.add(new i.Preference({key:"autoUnlockPassword",value:d(r,n.sha256(r))})),a.flush(function(){E=!0,h(),y=r,D.encryptAll(function(){h(),E=!1,b=r,y=null,A=!0;var e=c(r);D.trigger("background:securityManager:passwordChanged",{password:t,serverPassword:e}),s()})})})})},salt:function(){return n.salt()},encrypt:function(e,t,i){if(!b||!this.useEncryption)return t;var a=p(i,e,y||b);return n.encrypt(a,t)},decrypt:function(e,t,i){if(!b||!this.useEncryption)return t;var a=p(i,e,b);return n.decrypt(a,t)},isInitialized:function(){return w},reloadPreference:function(){i.Preference.findOrCreate({key:"autoLockOnRestart",value:"true"},function(e){e.isFalse()?i.Preference.createOrModify({key:"autoUnlockPassword",value:d(b,n.sha256(b))},function(){}):i.Preference.findBy("key","autoUnlockPassword",function(e){e&&(a.remove(e),a.flush())})}),i.Preference.findBy("key","requirePasswordToShowPassword",function(e){k=!e||e.isTrue()})},encryptAll:function(t){if(!w)return s.setTimeout(e.bind(this.encryptAll,this),10),void 0;var n=null,a=0;t&&(n=function(){a--,0>=a&&t()});for(var r in i){var o=i[r];o.meta&&o.meta.secured&&(a++,o.encryptAll(n))}}}),D=new P;return D}),ABINEMASKME.define("abine/server",["documentcloud/underscore","abine/ajax","abine/config","storage","abine/core","abine/responseCodes","abine/window","persistence","abine/timer","abine/securityManager"],function(e,t,n,i,a,s,r,o){var l=function(){},c=function(e,t){i.Preference.findBy("key","authToken",function(n){i.Preference.findBy("key","installAuthToken",function(i){var a=!n||n.isEmpty()||n.isEncrypted()?null:n.value,s=!i||i.isEmpty()?null:i.value;a&&(e.data.auth_token=a),s&&(e.data.install_auth_token=s),t.call(this,e)})})},d=function(e,t){e.data.client_application.version=n.version,e.data.client_application.environment=n.environment,e.data.client_application.tag=n.tags[0],e.data.client_application.browser=n.browser,e.data.client_application.build_num=n.buildNum,e.data.client_application.user_agent=window.navigator.userAgent,t.call(this,e)},u=a.BaseClass.extend({makeRequest:function(n){n.defaults=n.defaults||{},n.required=n.required||[],n.data=e.defaults(n.data||{},n.defaults),n.type=n.type||"POST",n.dataType=n.dataType||"json";var a=n.success||l,u=n.error||l;return n.data.client_application||(n.data.client_application={}),n.success=function(e,t,n){var i=n.status,s=e.data;a(s,i)},n.error=function(t){var a=t.status,l={error_code:s.UNKNOWN_ERROR};try{l=JSON.parse(t.responseText)}catch(c){}var d=l.error_code;500==a&&(d=s.UNKNOWN_ERROR),d==s.UNAUTHORIZED&&i.Preference.findBy("key","authToken",function(t){t&&!t.isEncrypted()&&(t.value="",o.flush(),"refreshEntitlements"!=n.action&&"signIn"!=n.action&&e.debounce(function(){r.createTab({doNotOpenNewTab:!0,localUrl:"pages/index.html#userLogin"})},3500))}),u(a,d,l)},this.hasRequiredParams(n.required,n.data)?(c(n,function(e){d(e,function(e){t.ajax(e)})}),void 0):(true&&ABINEMASKME.log.error("[ERROR HANDLER]#["+n.server+"]#["+n.action+"]# client missing required parameters"),u(422,s.MISSING_PARAMETERS,{}),void 0)},hasRequiredParams:function(t,n){var i=!0;return e.each(t,e.bind(function(t){(!e.has(n,t)||this.isEmpty(n[t]))&&(i=!1)},this)),i},isEmpty:function(e){return null===e||void 0===e||0/0===e||""===e}}),h=u.extend({makeRequest:function(e){if(!e.url)throw"server calls must have a url";e.data=e.data||{},e.type=e.type||"POST",e.dataType=e.dataType||"json";var t=e.success||l,n=e.error||l;e.success=function(e,n,i){var a=i.status,s=e.data;t(s,a,this)},e.error=function(e){var t=e.status,i={error_code:s.UNKNOWN_ERROR};try{i=JSON.parse(e.responseText)}catch(a){}var r=i.error_code;500==t&&(r=s.UNKNOWN_ERROR),n(t,r,i)},e.data.client_application||(e.data.client_application={}),this.lastRequest=e,this.tokenSet=!1;var i=this;c(e,function(e){d(e,function(){i.tokenSet=!0,i.waitingRequest&&(i.waitingRequest(),delete i.waitingRequest)})}),this.trigger("request:made")},respondWithSuccess:function(t,n,i){return this.tokenSet?(this.lastRequest.success.call(this.lastRequest,t,n,i),delete this.lastRequest,void 0):(this.waitingRequest=e.bind(this.respondWithSuccess,this,t,n,i),void 0)},respondWithError:function(t,n,i){return this.tokenSet?(this.lastRequest.error=!0,this.lastRequest.error.call(this.lastRequest,t,n,i),delete this.lastRequest,void 0):(this.waitingRequest=e.bind(this.respondWithError,this,t,n,i),void 0)}});return{server:u,mock:h}}),ABINEMASKME.define("abine/storageMixins",["documentcloud/underscore","persistence"],function(e,t){var n={index:function(e,n){var i=this;if(i.meta.cached&&i.cached){var a=t.getCachedEntities(i);i.respondWithEntities(a,e,n)}else i.cachingQueryInProgress?i.waitingCallbacks.push({req:e,cb:n}):(i.cachingQueryInProgress=!0,i.waitingCallbacks=[],this.all().list(null,function(a){i.meta.cached&&(i.cached=!0);var s=i.waitingCallbacks;delete i.cachingQueryInProgress,delete i.waitingCallbacks;try{i.respondWithEntities(a,e,n)}catch(r){true&&ABINEMASKME.log.error(r)}for(var o=0;s.length>o;o++)try{a=t.getCachedEntities(i),i.respondWithEntities(a,s[o].req,s[o].cb)}catch(r){true&&ABINEMASKME.log.error(r)}}))},isCached:function(){return this.meta.cached&&this.cached},show:function(e,t){var n=e.params[0];this.load(n,function(n){t?t.call(this,n):e.returnEntities&&e.returnEntities(n)})},create:function(e,n){var i=this;e.payload.createdAt=new Date,e.payload.modifiedAt=new Date;var a=new i(e.payload);t.add(a),t.flush(null,function(){n?n.call(this,a):e.returnEntities&&e.returnEntities(a)})},update:function(n,i){var a=n.params[0];n.payload.modifiedAt=new Date,this.load(a,function(a){e.extend(a,n.payload),t.flush(null,function(){i?i.call(this,a):n.returnEntities&&n.returnEntities(a)})})},destroy:function(e,n){var i=e.params[0];this.load(i,function(i){t.remove(i),t.flush(null,function(){n?n.call():e.returnStatus&&e.returnStatus("ok")})})},respondWithEntities:function(e,t,n){n?n.call(this,e):t&&t.returnEntities&&t.returnEntities(e)},respondWithJSON:function(e,t,n){n?n.call(null,e):t.returnJSON&&t.returnJSON(e)},listCached:function(t,n,i,a){if(!this.meta.cached)throw"listCached cannot be used with entities that do not have caching enabled.";"function"==typeof t?(i=t,a=n,t=null):a||(a=i,i=null),this.index(null,function(s){var r=[];e.each(s,function(e){t&&e[t]!=n||i&&!i(e)||r.push(e)}),a&&a(r)})},initCache:function(e){this.meta.cached&&!this.cached?this.index(null,function(){e()}):e()},updatePushVersion:function(t,n){this.meta.cached?this.listCached("pushVersion",0,function(i){e.each(i,function(e){e.pushVersion=t}),n()}):this.all().filter("pushVersion","=",0).list(function(i){e.each(i,function(e){e.pushVersion=t}),n()})}};return{DefaultActions:n}}),ABINEMASKME.define("abine/storageRouter",["documentcloud/underscore","persistence","abine/core","abine/fixtures","abine/backgroundMessenger"],function(e,t,n,i,a){var s={dbName:"idme_data",dbDescription:"Storage for the idme extension",dbSizeInBytes:5242880},r=/:([\w\d]+)/g,o=/\*([\w\d]+)/g,l=/[-[\]{}()+?.,\\^$|#\s]/g,c=n.BaseClass.extend({initialize:function(t){t=t||{};var n=this,i=t.ready||function(){};this.routes=[],this.storage={},e.defaults(t,s),this.messenger=t.messenger||new a.BackgroundMessenger,c.initialized?(n.startListener(),i.call()):(t.ready=function(){n.startListener(),i.call()},c.initializeWebSQLStorage(t))},initializeMemoryStorage:function(e){t.store.memory.config(t),e.call(this)},startListener:function(){this.messenger.on("all",this.messageHandler,this)},registerEntity:function(t,n){this.storage[n]=t,e(t.routes).each(function(t,i){if(!t||!i)throw"Bad routes on entity "+n;if(e.isRegExp(i)||(i=i.replace(l,"\\$&").replace(r,"([^/]*)").replace(o,"(.*?)"),i=new RegExp("^"+i+"$","i")),!i)throw"Bad route for "+t;this.routes.push([i,n,t])},this)},messageHandler:function(t,n,i){var a=t.split(":")[0];if(e(["create","read","update","delete"]).include(a)){var s=t.replace(/\:/g,"/");s=s.replace(/\/\//g,":");var r=e(this.routes).find(function(e){return s.match(e[0])}),o=this.storage[r[1]],l=r[2],c=r[0].exec(s).slice(1),u=new d({entityName:r[1],route:t,payload:n,sender:i,params:c,messenger:this.messenger});return o[l].call(o,u),u}},send:function(){return this.messageHandler.apply(this,arguments)}});c.initializeWebSQLStorage=function(e){var n=e.ready||function(){};if(c.initialized)return n(),void 0;if(t.store.websql.config(t,e.dbName,e.dbDescription,e.dbSizeInBytes),e.noMigrations)e.fixtures?i.createFixtures(function(){n()}):n();else{var a=(Date.now(),function(){n()});t.migrations.init(function(){t.migrate(function(){e.fixtures?i.createFixtures(a):a()})})}c.initialized=!0};var d=n.BaseClass.extend({initialize:function(e){e=e||{},this.route=e.route,this.params=e.params,this.entityName=e.entityName,this.sender=e.sender||"background",this.messenger=e.messenger,this.payload=e.payload},getReturnRoute:function(){var e=this.route.split(":");return e[0]="response",e.join(":")},getReturnErrorRoute:function(){var e=this.route.split(":");return e[0]="error",e.join(":")},returnErrObj:function(e){return e=e||{},this.messenger.send(this.getReturnErrorRoute(this.route),e,this.sender),!0},returnError:function(e,t){t=t||500,e=e||"Server error";var n={error:!0,message:e,status:t};return this.messenger.send(this.getReturnErrorRoute(this.route),n,this.sender),!0},returnStatus:function(e){var t={status:e};return this.messenger.send(this.getReturnRoute(this.route),t,this.sender),!0},returnEntities:function(t){var n;t&&0!=t.length?e.isArray(t)&&1==t.length?n=t[0].toJSON():e.isArray(t)&&t.length>1?n=e(t).map(function(e){return e.toJSON()}):e.isObject(t)&&(n=t.toJSON()):n=[],this.messenger.send(this.getReturnRoute(this.route),n,this.sender)},returnJSON:function(e){this.messenger.send(this.getReturnRoute(this.route),e,this.sender)}});return{StorageRouter:c,StorageRequest:d}}),ABINEMASKME.define("abine/stubs",["documentcloud/underscore","abine/core"],function(e,t){function n(e,t){ABINEMASKME.require([e.require],function(n){t in l&&e.require in l[t]?l[t][e.require].addProxy(e.proxyId):(l[t]||(l[t]={}),l[t][e.require]||(l[t][e.require]=new d(n,e,t)),c++),o.send("background:stub:events:"+e.proxyId,{name:"stub:connected",payload:null},t)})}function i(t,n){n in l&&(e.each(e.keys(l[n]),function(e){c--,l[n][e].cleanup(),delete l[n][e]}),delete l[n])}function a(e){o=e,e.on("contentManager:proxy:connect",n),e.on("contentManager:proxy:disconnect",i),e.on("contentManager:proxy:call",function(e,t){t in l&&e.require in l[t]&&l[t][e.require].call(e,t)}),e.on("contentManager:proxy:callAsync",function(e,t){t in l&&e.require in l[t]&&l[t][e.require].callAsync(e,t)})}function s(e){i(null,e)}function r(){o&&(o.off("contentManager:proxy:connect"),o.off("contentManager:proxy:disconnect"),o.off("contentManager:proxy:call"),o.off("contentManager:proxy:callAsync"),o=null);for(var e in l)l[e].cleanup();l={}}var o,l={},c=0,d=t.BaseClass.extend({initialize:function(t,n,i){this.realObj=t,this._proxyIds=[n.proxyId],this._events={};var a=this;e.each(n.events,function(n){a._events[n]=function(t){e.each(a._proxyIds,function(e){o.send("background:stub:events:"+e,{name:n,payload:t},i)})},t.on(n,a._events[n])})},addProxy:function(e){this._proxyIds.push(e)},call:function(e,t){var n=e.callId,i=this.realObj[e.method].apply(this.realObj,e.params);o.send("background:stub:response:"+n,i,t)},callAsync:function(e,t){var n=e.callId,i=function(e,i){o.send("background:stub:response:"+n,{err:e,data:i},t)};e.params=e.params||[],e.params.push(i),this.realObj[e.method].apply(this.realObj,e.params)},cleanup:function(){var t=this.realObj;e.each(this._events,function(e,n){t.off(n,e)})}});return{tabClosed:s,start:a,stop:r}}),ABINEMASKME.define("abine/syncMerge",["documentcloud/underscore","abine/core","storage","persistence","abine/sync/preference","abine/sync/site","abine/sync/shielded_email","abine/sync/shielded_phone","abine/sync/account","abine/sync/disposableEmail","abine/sync/disposablePhone","abine/sync/disposableCard","abine/sync/shieldedCard"],function(e,t,n,i,a,s,r,o,l,c,d,u,h){var p=t.BaseClass.extend({initialize:function(){},migrateServerData:function(e,t){if(ABINEMASKME.schemaVersion>e){for(var n=i.migrations.Migrator.migrations,a=[],s=e+1;ABINEMASKME.schemaVersion>=s;s++)a.unshift(n[s]);for(;a.length>0;){var r=a.pop();r.body.upForSync&&r.body.upForSync(t)}}},mergeClientData:function(t,p,f,m){this.migrateServerData(f,t),e.defer(function(){n.Preference.findBy("key","lastSync",function(e){var f=0;e&&e.value&&(f=parseInt(e.value)),f=new Date(f),n.Preference.findBy("key","lastDataVersion",function(e){var n=0;e&&e.value&&(n=parseInt(e.value)),i.flush(function(){i.clean(),new a(t,f,n,p).merge(function(){new s(t,f,n,p).merge(function(){new h(t,f,n,p).merge(function(){new r(t,f,n,p).merge(function(){new o(t,f,n,p).merge(function(){new l(t,f,n,p).merge(function(){new u(t,f,n,p).merge(function(){new c(t,f,n,p).mergeSpareEmails(function(){new d(t,f,n,p).mergeSparePhones(function(){i.flush(function(){m.call()})})})})})})})})})})})})})})}});return{SyncMerge:p}}),ABINEMASKME.define("abine/syncServer",["documentcloud/underscore","abine/ajax","abine/config","abine/server","abine/core"],function(e,t,n,i,a){var s=n.protocol+n.serverHost,r=s+"/api/v2/client_data",o=a.BaseClass.extend({initialize:function(e){this.options=this.options||e||{},this.server=this.options.server||new i.server},getClientDataHeaderFromServer:function(e,t){this.server.makeRequest({server:"sync",action:"getClientDataHeaderFromServer",defaults:{},required:["schema_version"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:r,type:"GET"})},getClientDataFromServer:function(e,t){this.server.makeRequest({server:"sync",action:"getClientDataFromServer",defaults:{},required:["id"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:r+"/"+e.id,type:"GET"})},pushClientDataToServer:function(e,t){this.server.makeRequest({server:"sync",action:"pushClientDataToServer",defaults:{},required:["client_data"],success:function(e){t.call(this,null,e)},error:function(e,n,i){t.call(this,{status:e,errorCode:n,responseJSON:i})},data:e,url:r,type:"POST"})}});return o}),ABINEMASKME.define("abine/url",function(){function e(e){return e?e.toLowerCase().replace(/\w+/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1)}):e}function t(e){var t=e.match(r);return t&&t.length>1?t[1].toString():e}function n(e){var n=t(e);if(n.match(o))return n;var i=n.split(".");if(2>i.length)return null;var r=i.pop(),l=i.pop(),c=l+"."+r;if(a.test(c)&&i.length>0&&(r=c,l=i.pop(),c=l+"."+r),s.test(c)&&i.length>0){var d=i.pop();c=d+"."+c}return c}function i(t){if(t=n(t),t.match(o))return t;var i=t.split(".");if(i.length>2){var r=i.pop(),l=i.pop(),t=l+"."+r;if(a.test(t)&&i.length>0&&(r=t,l=i.pop(),t=l+"."+r),s.test(t)&&i.length>0){var c=i.pop();return e(l+" "+c)}return e(l)}return e(i[0])}var a=/^(((co|ac|go|ed|ga|mn|nj|nc|or|ne|in|gr|ca|on|pa|qc|bc|sh|at|va|us|il|tv|me|lg|at|ny|gv|com|edu|org|net|gov|mil|biz)\...)|(163\.com)|(kiev\.ua)|(gob\.pe)|(gen\.tr)|(waw.pl)|(jus.br))$/,s=/^(((go|typepad|tumblr|blogspot|squarespace|wordpress|myshopify|blogfa|blog|blogs|blinkweb|ning|posterous|over-blog|mihanblog|appspot|webs|weebly|onsugar|ucoz|uk|pch|ecwid)(\.com|\.in))|(nic\.in)|((ucoz|spb|narod)\.ru)|(blog\.163\.com)|((gouv|free)\.fr)|(uol\.com\.br)|(web\.id)|(gob\.mx)|(blogg\.se)|(home.pl))$/,r=/^http(?:s)?\:\/\/([^/]+)/im,o=/^[0-9\.]+(:[0-9]+)?$/;return{getHostname:t,getTLD:n,getSiteName:i}}),ABINEMASKME.define("abine/window",["documentcloud/underscore","abine/timer","jquery"],function(e,t,n){APPLICATION_CSS="pages/application.css";var i=function(){},a=function(e,n){e.documentElement?e.documentElement.appendChild(n):t.setTimeout(function(){a(e,n)},100)},s=function(e){var t,i=e.getElementsByTagName("head")[0];i&&(t=e.createElement("link"),t.setAttribute("rel","stylesheet"),t.setAttribute("href",chrome.extension.getURL(APPLICATION_CSS)),i.appendChild(t)),n("body",e).css("backgroundColor","transparent")};return{createTab:function(e,t){function n(i){return 1>i.length&&-1==s.indexOf("?")?(s+="?",chrome.tabs.query({url:s},n),void 0):(1>i.length&&!e.doNotOpenNewTab?(chrome.tabs.create({active:!0,url:a}),t()):(chrome.tabs.update(i[0].id,{active:!0,url:a}),chrome.windows.get(i[0].windowId,function(e){"minimized"==e.state&&chrome.windows.update(e.id,{state:"normal"}),t()})),void 0)}t=t||i;var a=e.localUrl?chrome.extension.getURL(e.localUrl):e.url;if(e.force)return chrome.tabs.create({active:!0,url:a}),t(),void 0;var s=a.split("#")[0];chrome.tabs.query({url:s},n)},createPanel:function(t){var n=t.localUrl?chrome.extension.getURL(t.localUrl):t.url,i=t.document||document||window.document,r=t.panelWidth?t.panelWidth:368;if(!i)throw"Error. abine/window createPanel called without a document context.";var o=i.createElement("div");o.className=t.className||"abineContentPanel",e.extend(o.style,{background:"transparent"},t.style);var l=i.createElement("iframe");return e.extend(l,{className:"abineContentFrame",width:r+"px",allowTransparency:"true",frameborder:0,height:t.panelHeight+"px",scrolling:"no",src:n?n:""}),e.extend(l.style,{background:"transparent",borderWidth:"0px",opacity:1,margin:"0",padding:"0",height:t.panelHeight+"px",width:r+"px"}),o.appendChild(l),l.onload=function(){s(l.contentDocument),t.ready&&t.ready.call(l,l.contentDocument,l)},a(i,o,l),l},autoResizePanels:function(t){var i=t.document||document||window.document;i.getElementsByTagName("body")[0];var a=i.getElementsByClassName("abineContentPanel");e(a).each(function(e){var t=n("iframe",e)[0];t.scrolling="no";var i=t.contentDocument.body.offsetHeight,a=n(t).width();n(t).height(i),e.style.width=a+"px",e.style.height=i+"px";try{var s=parseInt(e.style.left),r=s+e.offsetWidth,o=e.ownerDocument.defaultView.innerWidth,l=e.ownerDocument.documentElement.scrollLeft+o;if(r>l){var c=r-l;if(s-c>0)e.style.left=s-c+"px";else if(e.style.left="0px",r-s>o){var d=Math.round(100*(o/(r-s)));d-=1,80>d&&(d=80),t.style.zoom=d+"%",t.contentDocument.body.style.zoom=d+"%"}}}catch(u){}})
},removePanels:function(t){var n=t.document||document||window.document,i=n.getElementsByClassName("abineContentPanel");e(i).each(function(e){e&&e.parentNode&&e.parentNode.removeChild(e)})}}}),ABINEMASKME.define("abine/contentMessenger",["documentcloud/underscore","abine/core"],function(e,t){var n=function n(e){this.trigger(e.eventName,e.payload)},i=function(){throw"Error. Attempt to call destroyed ContentMessenger."},a=t.BaseClass.extend({initialize:function(){this.listener=e.bind(n,this),chrome.extension.onRequest.addListener(this.listener)},send:function(e,t){this.trigger(e,t),chrome&&chrome.extension&&chrome.extension.sendRequest({eventName:e,payload:"undefined"==typeof t?{}:t})},destroy:function(){this.off(),chrome.extension.onRequest.removeListener(n),this.on=this.off=this.trigger=i}});return{ContentMessenger:a}}),ABINEMASKME.define("abine/formSubmitDetector",["documentcloud/underscore","jquery","abine/formAnalyzer","abine/core","abine/eventLogger"],function(e,t,n,i,a){var s=i.BaseClass.extend({init:function(e,t){var n=this,i={};e.on("contentManager:formSubmit",function(e,t){"clear"===e?t in i&&delete i[t]:i[t]=e}),e.on("contentManager:formFieldChanged",function(e,t){n.trigger("background:formFieldChanged",{formData:e.formData,fieldData:e.fieldData,tabId:t})}),e.on("panel:fill",function(e,t){n.trigger("background:formFieldChanged",{fromFill:!0,formData:e.formData,fieldData:e.fieldData,tabId:t})}),t=t||chrome.webRequest.onBeforeRequest,t.addListener(function(e){var t=e.tabId;if(t in i){var a=i[t],s=e.url;if(a.url&&""!=a.url&&(0===a.url.indexOf(s)||0===s.indexOf(a.url)))return n.trigger("background:formSubmit",{data:a,tabId:t}),delete i[t],void 0;a.url=s,n.trigger("background:formSubmit",{data:a,tabId:t}),delete i[t]}},{urls:["<all_urls>"],types:["main_frame","sub_frame","xmlhttprequest","script"]},[])}}),r=i.BaseClass.extend({initialize:function(e,t){function i(i){var a=i.target;"FORM"===a.nodeName&&e.send("contentManager:formSubmit",n.getFormData(a,t.location.href))}t=t||window,t.addEventListener("submit",i),t.addEventListener("abinemaskmesubmit",i),e.send("contentManager:formSubmit","clear")}});return{formSubmitDetector:new s,FormSubmitContentHelper:r}}),ABINEMASKME.define("abine/pageEventsImpl",["abine/core","abine/proxies"],function(e,t){function n(e){var n=e.target,i=n.ownerDocument,a=n.getAttribute("action"),r=n.getAttribute("params");if(n.parentNode.removeChild(n),r)try{r=JSON.parse(r)}catch(o){r={}}else r={};if("mm_ping"==a){var l=i.createEvent("Event");l.initEvent("mm_pong",!0,!0),i.dispatchEvent(l)}else{var c=i.createEvent("Event");c.initEvent("received:"+a,!0,!0),i.dispatchEvent(c)}s.processedEvent=s.processedEvent||{};var d=s.processedEvent[a]||0,u=(new Date).getTime();u-15e3>d&&(s.processedEvent[a]=u,t.pageEventsModule.processAction({action:a,host:i.location.host,params:r},function(){}))}var i,a=e.BaseClass.extend({startup:function(e,t){i=e,t.addEventListener("MMPageEvent",n,!0)},shutdown:function(e){e.removeEventListener("MMPageEvent",n,!0)}}),s=new a;return s}),ABINEMASKME.define("abine/assets",["wycats/handlebars"],function(e){function t(e){return chrome.extension.getURL(e)}return e.registerHelper("assetUrl",t),{assetUrl:t}}),ABINEMASKME.define("abine/browserSyncStorage",["documentcloud/underscore","abine/core"],function(e,t){var n;n=chrome&&chrome.storage&&chrome.storage.sync?t.BaseClass.extend({initialize:function(){},set:function(e,t){chrome.storage.sync.set(e,t)},remove:function(e,t){chrome.storage.sync.remove(e,t)},get:function(e,t){chrome.storage.sync.get(e,t)},clear:function(e){chrome.storage.sync.clear(e)}}):t.BaseClass.extend({initialize:function(){this.storage={}},set:function(t,n){e.extend(this.storage,t),n&&n()},remove:function(t,n){t="string"==typeof t?[t]:t,e.each(t,e.bind(function(e){delete this.storage[e]},this)),n&&n()},get:function(t,n){t="string"==typeof t?[t]:t,n&&n(e.pick(this.storage,t))},clear:function(e){this.storage={},e&&e()}});var i=new n({});return i}),ABINEMASKME.define("documentcloud/backbone",["documentcloud/underscore","jquery"],function(e,t){var n,i=this,a=i.Backbone,s=Array.prototype.slice,r=Array.prototype.splice;n="undefined"!=typeof exports?exports:i.Backbone={},n.VERSION="0.9.2",n.setDomLibrary=function(e){t=e},n.noConflict=function(){return i.Backbone=a,this},n.emulateHTTP=!1,n.emulateJSON=!1;var o=/\s+/,l=n.Events={on:function(e,t,n){var i,a,s,r,l;if(!t)return this;for(e=e.split(o),i=this._callbacks||(this._callbacks={});a=e.shift();)l=i[a],s=l?l.tail:{},s.next=r={},s.context=n,s.callback=t,i[a]={tail:r,next:l?l.next:s};return this},off:function(t,n,i){var a,s,r,l,c,d;if(s=this._callbacks){if(!(t||n||i))return delete this._callbacks,this;for(t=t?t.split(o):e.keys(s);a=t.shift();)if(r=s[a],delete s[a],r&&(n||i))for(l=r.tail;(r=r.next)!==l;)c=r.callback,d=r.context,(n&&c!==n||i&&d!==i)&&this.on(a,c,d);return this}},trigger:function(e){var t,n,i,a,r,l,c;if(!(i=this._callbacks))return this;for(l=i.all,e=e.split(o),c=s.call(arguments,1);t=e.shift();){if(n=i[t])for(a=n.tail;(n=n.next)!==a;)n.callback.apply(n.context||this,c);if(n=l)for(a=n.tail,r=[t].concat(c);(n=n.next)!==a;)n.callback.apply(n.context||this,r)}return this}};l.bind=l.on,l.unbind=l.off;var c=n.Model=function(t,n){var i;t||(t={}),n&&n.parse&&(t=this.parse(t)),(i=k(this,"defaults"))&&(t=e.extend({},i,t)),n&&n.collection&&(this.collection=n.collection),this.attributes={},this._escapedAttributes={},this.cid=e.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(t,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=e.clone(this.attributes),this.initialize.apply(this,arguments)};e.extend(c.prototype,l,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(){return e.clone(this.attributes)},get:function(e){return this.attributes[e]},escape:function(t){var n;if(n=this._escapedAttributes[t])return n;var i=this.get(t);return this._escapedAttributes[t]=e.escape(null==i?"":""+i)},has:function(e){return null!=this.get(e)},set:function(t,n,i){var a,s,r;if(e.isObject(t)||null==t?(a=t,i=n):(a={},a[t]=n),i||(i={}),!a)return this;if(a instanceof c&&(a=a.attributes),i.unset)for(s in a)a[s]=void 0;if(!this._validate(a,i))return!1;this.idAttribute in a&&(this.id=a[this.idAttribute]);var o=i.changes={},l=this.attributes,d=this._escapedAttributes,u=this._previousAttributes||{};for(s in a)r=a[s],(!e.isEqual(l[s],r)||i.unset&&e.has(l,s))&&(delete d[s],(i.silent?this._silent:o)[s]=!0),i.unset?delete l[s]:l[s]=r,e.isEqual(u[s],r)&&e.has(l,s)==e.has(u,s)?(delete this.changed[s],delete this._pending[s]):(this.changed[s]=r,i.silent||(this._pending[s]=!0));return i.silent||this.change(i),this},unset:function(e,t){return(t||(t={})).unset=!0,this.set(e,null,t)},clear:function(t){return(t||(t={})).unset=!0,this.set(e.clone(this.attributes),t)},fetch:function(t){t=t?e.clone(t):{};var i=this,a=t.success;return t.success=function(e,n,s){return i.set(i.parse(e,s),t)?(a&&a(i,e),void 0):!1},t.error=n.wrapError(t.error,i,t),(this.sync||n.sync).call(this,"read",this,t)},save:function(t,i,a){var s,r;if(e.isObject(t)||null==t?(s=t,a=i):(s={},s[t]=i),a=a?e.clone(a):{},a.wait){if(!this._validate(s,a))return!1;r=e.clone(this.attributes)}var o=e.extend({},a,{silent:!0});if(s&&!this.set(s,a.wait?o:a))return!1;var l=this,c=a.success;a.success=function(t,n,i){var r=l.parse(t,i);return a.wait&&(delete a.wait,r=e.extend(s||{},r)),l.set(r,a)?(c?c(l,t):l.trigger("sync",l,t,a),void 0):!1},a.error=n.wrapError(a.error,l,a);var d=this.isNew()?"create":"update",u=(this.sync||n.sync).call(this,d,this,a);return a.wait&&this.set(r,o),u},destroy:function(t){t=t?e.clone(t):{};var i=this,a=t.success,s=function(){i.trigger("destroy",i,i.collection,t)};if(this.isNew())return s(),!1;t.success=function(e){t.wait&&s(),a?a(i,e):i.trigger("sync",i,e,t)},t.error=n.wrapError(t.error,i,t);var r=(this.sync||n.sync).call(this,"delete",this,t);return t.wait||s(),r},url:function(){var e=k(this,"urlRoot")||k(this.collection,"url")||I();return this.isNew()?e:e+("/"==e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(t){t||(t={});var n=this._changing;this._changing=!0;for(var i in this._silent)this._pending[i]=!0;var a=e.extend({},t.changes,this._silent);this._silent={};for(var i in a)this.trigger("change:"+i,this,this.get(i),t);if(n)return this;for(;!e.isEmpty(this._pending);){this._pending={},this.trigger("change",this,t);for(var i in this.changed)this._pending[i]||this._silent[i]||delete this.changed[i];this._previousAttributes=e.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(t){return arguments.length?e.has(this.changed,t):!e.isEmpty(this.changed)},changedAttributes:function(t){if(!t)return this.hasChanged()?e.clone(this.changed):!1;var n,i=!1,a=this._previousAttributes;for(var s in t)e.isEqual(a[s],n=t[s])||((i||(i={}))[s]=n);return i},previous:function(e){return arguments.length&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return e.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(t,n){if(n.silent||!this.validate)return!0;t=e.extend({},this.attributes,t);var i=this.validate(t,n);return i?(n&&n.error?n.error(this,i,n):this.trigger("error",this,i,n),!1):!0}});var d=n.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,{silent:!0,parse:t.parse})};e.extend(d.prototype,l,{model:c,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},add:function(t,n){var i,a,s,o,l,c,d={},u={},h=[];for(n||(n={}),t=e.isArray(t)?t.slice():[t],i=0,s=t.length;s>i;i++){if(!(o=t[i]=this._prepareModel(t[i],n)))throw new Error("Can't add an invalid model to a collection");l=o.cid,c=o.id,d[l]||this._byCid[l]||null!=c&&(u[c]||this._byId[c])?h.push(i):d[l]=u[c]=o}for(i=h.length;i--;)t.splice(h[i],1);for(i=0,s=t.length;s>i;i++)(o=t[i]).on("all",this._onModelEvent,this),this._byCid[o.cid]=o,null!=o.id&&(this._byId[o.id]=o);if(this.length+=s,a=null!=n.at?n.at:this.models.length,r.apply(this.models,[a,0].concat(t)),this.comparator&&this.sort({silent:!0}),n.silent)return this;for(i=0,s=this.models.length;s>i;i++)d[(o=this.models[i]).cid]&&(n.index=i,o.trigger("add",o,this,n));return this},remove:function(t,n){var i,a,s,r;for(n||(n={}),t=e.isArray(t)?t.slice():[t],i=0,a=t.length;a>i;i++)r=this.getByCid(t[i])||this.get(t[i]),r&&(delete this._byId[r.id],delete this._byCid[r.cid],s=this.indexOf(r),this.models.splice(s,1),this.length--,n.silent||(n.index=s,r.trigger("remove",r,this,n)),this._removeReference(r));return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,t),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(t,n){return t=this._prepareModel(t,n),this.add(t,e.extend({at:0},n)),t},shift:function(e){var t=this.at(0);return this.remove(t,e),t},get:function(e){return null==e?void 0:this._byId[null!=e.id?e.id:e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},where:function(t){return e.isEmpty(t)?[]:this.filter(function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},sort:function(t){if(t||(t={}),!this.comparator)throw new Error("Cannot sort a set without a comparator");var n=e.bind(this.comparator,this);return 1==this.comparator.length?this.models=this.sortBy(n):this.models.sort(n),t.silent||this.trigger("reset",this,t),this},pluck:function(t){return e.map(this.models,function(e){return e.get(t)})},reset:function(t,n){t||(t=[]),n||(n={});for(var i=0,a=this.models.length;a>i;i++)this._removeReference(this.models[i]);return this._reset(),this.add(t,e.extend({silent:!0},n)),n.silent||this.trigger("reset",this,n),this},fetch:function(t){t=t?e.clone(t):{},void 0===t.parse&&(t.parse=!0);var i=this,a=t.success;return t.success=function(e,n,s){i[t.add?"add":"reset"](i.parse(e,s),t),a&&a(i,e)},t.error=n.wrapError(t.error,i,t),(this.sync||n.sync).call(this,"read",this,t)},create:function(t,n){var i=this;if(n=n?e.clone(n):{},t=this._prepareModel(t,n),!t)return!1;n.wait||i.add(t,n);var a=n.success;return n.success=function(e,s){n.wait&&i.add(e,n),a?a(e,s):e.trigger("sync",t,s,n)},t.save(null,n),t},parse:function(e){return e},chain:function(){return e(this.models).chain()},_reset:function(){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(e,t){if(t||(t={}),e instanceof c)e.collection||(e.collection=this);else{var n=e;t.collection=this,e=new this.model(n,t),e._validate(e.attributes,t)||(e=!1)}return e},_removeReference:function(e){this==e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){("add"!=e&&"remove"!=e||n==this)&&("destroy"==e&&this.remove(t,i),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],this._byId[t.id]=t),this.trigger.apply(this,arguments))}});var u=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];e.each(u,function(t){d.prototype[t]=function(){return e[t].apply(e,[this.models].concat(e.toArray(arguments)))}});var h=n.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},p=/:\w+/g,f=/\*\w+/g,m=/[-[\]{}()+?.,\\^$|#\s]/g;e.extend(h.prototype,l,{initialize:function(){},route:function(t,i,a){return n.history||(n.history=new g),e.isRegExp(t)||(t=this._routeToRegExp(t)),a||(a=this[i]),n.history.route(t,e.bind(function(e){var s=this._extractParameters(t,e);a&&a.apply(this,s),this.trigger.apply(this,["route:"+i].concat(s)),n.history.trigger("route",this,i,s)},this)),this},navigate:function(e,t){n.history.navigate(e,t)},_bindRoutes:function(){if(this.routes){var e=[];for(var t in this.routes)e.unshift([t,this.routes[t]]);for(var n=0,i=e.length;i>n;n++)this.route(e[n][0],e[n][1],this[e[n][1]])}},_routeToRegExp:function(e){return e=e.replace(m,"\\$&").replace(p,"([^/]+)").replace(f,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var g=n.History=function(){this.handlers=[],e.bindAll(this,"checkUrl")},b=/^[#\/]/,y=/msie [\w.]+/;g.started=!1,e.extend(g.prototype,l,{interval:50,getHash:function(e){var t=e?e.location:window.location,n=t.href.match(/#(.*)$/);return n?n[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||t){e=window.location.pathname;var n=window.location.search;n&&(e+=n)}else e=this.getHash();return e.indexOf(this.options.root)||(e=e.substr(this.options.root.length)),e.replace(b,"")},start:function(n){if(g.started)throw new Error("Backbone.history has already been started");g.started=!0,this.options=e.extend({},{root:"/"},this.options,n),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var i=this.getFragment(),a=document.documentMode,s=y.exec(navigator.userAgent.toLowerCase())&&(!a||7>=a);s&&(this.iframe=t('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(i)),this._hasPushState?t(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?t(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var r=window.location,o=r.pathname==this.options.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!o?(this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&o&&r.hash&&(this.fragment=this.getHash().replace(b,""),window.history.replaceState({},document.title,r.protocol+"//"+r.host+this.options.root+this.fragment)),this.options.silent?void 0:this.loadUrl())},stop:function(){t(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),g.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e==this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e==this.fragment?!1:(this.iframe&&this.navigate(e),this.loadUrl()||this.loadUrl(this.getHash()),void 0)},loadUrl:function(t){var n=this.fragment=this.getFragment(t),i=e.any(this.handlers,function(e){return e.route.test(n)?(e.callback(n),!0):void 0});return i},navigate:function(e,t){if(!g.started)return!1;t&&t!==!0||(t={trigger:t});var n=(e||"").replace(b,"");this.fragment!=n&&(this._hasPushState?(0!=n.indexOf(this.options.root)&&(n=this.options.root+n),this.fragment=n,window.history[t.replace?"replaceState":"pushState"]({},document.title,n)):this._wantsHashChange?(this.fragment=n,this._updateHash(window.location,n,t.replace),this.iframe&&n!=this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,n,t.replace))):window.location.assign(this.options.root+e),t.trigger&&this.loadUrl(e))},_updateHash:function(e,t,n){n?e.replace(e.toString().replace(/(javascript:|#).*$/,"")+"#"+t):e.hash=t}});var v=n.View=function(t){this.cid=e.uniqueId("view"),this._configure(t||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},A=/^(\S+)\s*(.*)$/,E=["model","collection","el","id","attributes","className","tagName"];e.extend(v.prototype,l,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(e,n,i){var a=document.createElement(e);return n&&t(a).attr(n),i&&t(a).html(i),a},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t?e:t(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(t||(t=k(this,"events"))){this.undelegateEvents();for(var n in t){var i=t[n];if(e.isFunction(i)||(i=this[t[n]]),!i)throw new Error('Method "'+t[n]+'" does not exist');var a=n.match(A),s=a[1],r=a[2];i=e.bind(i,this),s+=".delegateEvents"+this.cid,""===r?this.$el.bind(s,i):this.$el.delegate(r,s,i)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(t){this.options&&(t=e.extend({},this.options,t));for(var n=0,i=E.length;i>n;n++){var a=E[n];t[a]&&(this[a]=t[a])}this.options=t},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var e=k(this,"attributes")||{};this.id&&(e.id=this.id),this.className&&(e["class"]=this.className),this.setElement(this.make(this.tagName,e),!1)}}});var M=function(e,t){var n=S(this,e,t);return n.extend=this.extend,n};c.extend=d.extend=h.extend=v.extend=M;var _={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};n.sync=function(i,a,s){var r=_[i];s||(s={});var o={type:r,dataType:"json"};return s.url||(o.url=k(a,"url")||I()),s.data||!a||"create"!=i&&"update"!=i||(o.contentType="application/json",o.data=JSON.stringify(a.toJSON())),n.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),n.emulateHTTP&&("PUT"===r||"DELETE"===r)&&(n.emulateJSON&&(o.data._method=r),o.type="POST",o.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r)}),"GET"===o.type||n.emulateJSON||(o.processData=!1),t.ajax(e.extend(o,s))},n.wrapError=function(e,t,n){return function(i,a){a=i===t?a:i,e?e(t,a,n):t.trigger("error",t,a,n)}};var w=function(){},S=function(t,n,i){var a;return a=n&&n.hasOwnProperty("constructor")?n.constructor:function(){t.apply(this,arguments)},e.extend(a,t),w.prototype=t.prototype,a.prototype=new w,n&&e.extend(a.prototype,n),i&&e.extend(a,i),a.prototype.constructor=a,a.__super__=t.prototype,a},k=function(t,n){return t&&t[n]?e.isFunction(t[n])?t[n]():t[n]:null},I=function(){throw new Error('A "url" property or function must be specified')};return n}),ABINEMASKME.define("wycats/handlebars",[],function(){var e={};e.VERSION="1.0.beta.6",e.helpers={},e.partials={},e.registerHelper=function(e,t,n){n&&(t.not=n),this.helpers[e]=t},e.registerPartial=function(e,t){this.partials[e]=t},e.registerHelper("helperMissing",function(e){if(2===arguments.length)return void 0;throw new Error("Could not find property '"+e+"'")});var t=Object.prototype.toString,n="[object Function]";return e.registerHelper("blockHelperMissing",function(e,i){var a=i.inverse||function(){},s=i.fn,r="",o=t.call(e);if(o===n&&(e=e.call(this)),e===!0)return s(this);if(e===!1||null==e)return a(this);if("[object Array]"===o){if(e.length>0)for(var l=0,c=e.length;c>l;l++)r+=s(e[l]);else r=a(this);return r}return s(e)}),e.registerHelper("each",function(e,t){var n=t.fn,i=t.inverse,a="";if(e&&e.length>0)for(var s=0,r=e.length;r>s;s++)a+=n(e[s]);else a=i(this);return a}),e.registerHelper("if",function(i,a){var s=t.call(i);return s===n&&(i=i.call(this)),!i||e.Utils.isEmpty(i)?a.inverse(this):a.fn(this)}),e.registerHelper("unless",function(t,n){var i=n.fn,a=n.inverse;return n.fn=a,n.inverse=i,e.helpers["if"].call(this,t,n)}),e.registerHelper("with",function(e,t){return t.fn(e)}),e.registerHelper("log",function(t){e.log(t)}),e.Exception=function(){var e=Error.prototype.constructor.apply(this,arguments);for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);this.message=e.message},e.Exception.prototype=new Error,e.SafeString=function(e){this.string=e},e.SafeString.prototype.toString=function(){return this.string.toString()},function(){var t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},n=/&(?!\w+;)|[<>"'`]/g,i=/[&<>"'`]/,a=function(e){return t[e]||"&amp;"};e.Utils={escapeExpression:function(t){return t instanceof e.SafeString?t.toString():null==t||t===!1?"":i.test(t)?t.replace(n,a):t},isEmpty:function(e){return"undefined"==typeof e?!0:null===e?!0:e===!1?!0:"[object Array]"===Object.prototype.toString.call(e)&&0===e.length?!0:!1}}}(),e.VM={template:function(t){var n={escapeExpression:e.Utils.escapeExpression,invokePartial:e.VM.invokePartial,programs:[],program:function(t,n,i){var a=this.programs[t];return i?e.VM.program(n,i):a?a:a=this.programs[t]=e.VM.program(n)},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop};return function(i,a){return a=a||{},t.call(n,e,i,a.helpers,a.partials,a.data)}},programWithDepth:function(e,t){var n=Array.prototype.slice.call(arguments,2);return function(i,a){return a=a||{},e.apply(this,[i,a.data||t].concat(n))}},program:function(e,t){return function(n,i){return i=i||{},e(n,i.data||t)}},noop:function(){return""},invokePartial:function(t,n,i,a,s,r){if(options={helpers:a,partials:s,data:r},void 0===t)throw new e.Exception("The partial "+n+" could not be found");if(t instanceof Function)return t(i,options);if(e.compile)return s[n]=e.compile(t),s[n](i,options);throw new e.Exception("The partial "+n+" could not be compiled when running in runtime-only mode")}},e.template=e.VM.template,e}),ABINEMASKME.define("duckbone/core",["documentcloud/underscore","documentcloud/backbone","wycats/handlebars"],function(e,t){var n={};return n.helpers=n.helpers||{},n.forms=n.forms||{},n.TemplatesData=n.TemplatesData||{},n.PartialsData=n.PartialsData||{},e.extend(n,t.Events),e.extend(n,{serverError:function(t){e.log("500 Server Error"),t&&e.log(t)},fileNotFound:function(t){e.log("404 File Not Found"),t&&e.log(t)},register:function(t,i){i=i||!1;var a=e.uniqueId("regfunc");return e.isUndefined(n.registeredFunctions)&&(n.registeredFunctions={}),i&&(t=e.wrap(t,function(e){e(arguments),delete n.registeredFunctions[a]})),n.registeredFunctions[a]=t,"Duckbone.registeredFunctions."+a},wrapMethods:function(t,n){var i=Array.prototype.slice.call(arguments,2);e.isArray(i[0])&&(i=i[0]),e.each(i,function(e){var i=t[e];t[e]=function(){var e=[i].concat(Array.prototype.slice.call(arguments));return n.apply(t,e)}})},log:function(e){window.console&&console.log&&console.log(e)},include:function(t){if("undefined"==typeof t)throw"Attempt to include into undefined object.";return e.each(e.toArray(arguments).slice(1),function(e){if("undefined"==typeof e)throw"Attempt to include undefined object.";for(var n in e)"included"!=n&&void 0!==e[n]&&(t.hasOwnProperty(n)||(t[n]=e[n]));"function"==typeof e.included&&e.included.call(t)}),t}}),e.extend(n.helpers,{dateToPrettyTimeAgo:function(e){var t=Math.floor(((new Date).getTime()-e.getTime())/6e4);0>t&&(t=0);var n,i,a,s=t||0;return 0===s?"just now":(s>=1440?(i=Math.floor(s/1440),s-=1440*i,n=i,n+=i>1?" days":" day"):s>=60?(a=Math.floor(s/60),s-=60*a,n=a,n+=a>1?" hours":" hour"):s>0&&(n=s,n+=s>1?" minutes":" minute"),n+" ago")}}),e.mixin({log:n.log}),n}),ABINEMASKME.define("duckbone/model",["documentcloud/underscore","documentcloud/backbone","wycats/handlebars","duckbone/core","abine/eventLogger"],function(e,t,n,i,a){function s(n,i,s,r){var l=c("set_"+i),d=c(i),u=function(e,i){if(e instanceof t.Model){if(e===n[d])return e;n[d]&&(n.trigger("remove:"+d),r&&(n[d][r]=null)),n[d]=e,r&&o(n,n[d],r,i),n.trigger("add:"+d)}else if(e)if(n[d]){var a=function(){n.trigger("change:"+d)};n[d].on("change",a),n[d].set(e),n[d].off("change",a)}else n[d]=new s(e),r&&o(n,n[d],r,i),n.trigger("add:"+d);else n[d]&&(n.trigger("remove:"+d),r&&(n[d][r]=null)),n[d]=null;return e};try{u.call(n,n.get(i),!0)}catch(h){a.error("Error creating association for "+i+":\n"+h)}delete n.attributes[i],n[l]=e.bind(u,n)}function r(e,t,n,i){try{var s=c(t),r=e.get(t),l=e[s]=new n(r);delete e.attributes[t],i&&(l[i]=e,l.each(function(t){o(e,t,i)}),l.on("add",function(t){o(e,t,i)}),l.on("remove",function(e){e[i]=null}),l.on("reset",function(t){t.each(function(t){o(e,t,i)})}))}catch(d){a.error("Error creating association for "+t+":\n"+d)}}function o(e,t,n,i){var s="set"+n.slice(0,1).toUpperCase()+n.slice(1);"function"==typeof t[s]?t[s].call(t,e,i):i?t[n]=e:a.error("To use belongsTo, model must define hasOne for "+n)}function l(n,i){var a={};return n instanceof t.Model||!this._associations?a=n:e(n).each(function(e,t){var n=this._associations[t];if("hasOne"==n){var i=c("set_"+t);this[i](e)}else if("hasMany"==n){var s=c(t);"function"==typeof this[s].freshen?this[s].freshen(e):this[s].reset(e)}else a[t]=e},this),this.setWithoutAssociations.call(this,a,i)}function c(e){return e.replace(/(\_[a-z])/g,function(e){return e.toUpperCase().replace("_","")})}function d(e){return e.replace(/^\w/,function(e){return e.toUpperCase()})}i.AssociableModel={isAssociableModel:!0,included:function(){this.setWithoutAssociations||(this.setWithoutAssociations=this.set,this.set=l)},hasOne:function(t){e.each(t,function(e,t){this._associations=this._associations||{},this._associations[t]="hasOne",s(this,t,e.model,e.belongsTo)},this)},hasMany:function(t){e.each(t,function(e,t){this._associations=this._associations||{},this._associations[t]="hasMany",r(this,t,e.collection,e.belongsTo)},this)}},i.ModelHelpers={simpleSave:function(e){var t={};this.id&&(e.id=this.id),this.paramRoot?t[this.paramRoot]=e:t=e;var n=JSON.stringify(t);return this.save({},{contentType:"application/json",data:n})},url:function(){var e="function"==typeof this.urlRoot?this.urlRoot():this.urlRoot,t=u(this.collection)||e||urlError();return this.isNew()?t:t+("/"==t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},setOne:function(e,t,n){var i={};return i[e]=t,this.set(i,n)},createGetters:function(){var t=this,n=arguments,i={};e.each(n,function(e){getterFuncName=c(e),getterFuncName="get"+d(getterFuncName),t[getterFuncName]||(i[getterFuncName]=function(){return this.get(e)})}),e.extend(this,i)},isValidAttribute:function(t){return!e.isNaN(t)&&!e.isUndefined(t)}};var u=function(t){return t&&t.url?e.isFunction(t.url)?t.url():t.url:null}}),ABINEMASKME.define("duckbone/syncable",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,i,a){function s(t){return t&&t.url?e.isFunction(t.url)?t.url():t.url:null}function r(){throw new Error("A 'url' property or function must be specified")}function o(e){var t,n,i,a,s,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o="",l="",c="",d=0;do t=e.charCodeAt(d++),n=e.charCodeAt(d++),l=e.charCodeAt(d++),i=t>>2,a=(3&t)<<4|n>>4,s=(15&n)<<2|l>>6,c=63&l,isNaN(n)?s=c=64:isNaN(l)&&(c=64),o=o+r.charAt(i)+r.charAt(a)+r.charAt(s)+r.charAt(c),t=n=l="",i=a=s=c="";while(e.length>d);return o}a.Syncable={isSyncable:!0,sync:function(n,i,d){var u,h=c[n],p=i.defaultSyncOptions||{},f=e.extend({type:h,dataType:"json",beforeSend:function(e){var n=t('meta[name="csrf-token"]').attr("content");n&&e.setRequestHeader("X-CSRF-Token",n)}},p,d);if(t.browser.msie&&(f.cache=!1),f.url||(f.url=s(i)||r()),!f.data&&i&&("create"==n||"update"==n)){f.contentType="application/json";var m={};i.paramRoot?m[i.paramRoot]=i.toJSON():m=i.toJSON(),f.data=JSON.stringify(m)}return"GET"!==f.type&&(f.processData=!1),l.username&&(f.username=l.username,f.password=l.password,f.headers=f.headers||{},f.headers.Authorization="Basic "+o(f.username+":"+f.password)),u=t.ajax(f),u.params=f,i.trigger("sync:"+n.toLowerCase()),u.complete(function(){i.trigger("sync:complete",u)}),u.success(function(){delete i.errors,i.trigger("sync:success",u)}),u.error(function(e){e.status>=400&&a.trigger("sync:"+e.status,u)}),u.error(function(e){if(422==e.status){var t=JSON.parse(e.responseText);i.errors=t.errors?t.errors:t,i.trigger("sync:invalid",u)}else i.trigger("sync:error",u)}),u}},a.setAuthenticatedUser=function(e,t){l.username=e,l.password=t},a.removeAuthenticatedUser=function(){delete l.username,delete l.password};var l={},c={create:"POST",update:"PUT","delete":"DELETE",read:"GET"}}),ABINEMASKME.define("duckbone/collection",["documentcloud/underscore","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,i){i.CollectionHelpers={hasDuckboneCollectionHelpers:!0,slice:function(){return this.models.slice(arguments)},toSelectOptions:function(e,t){var n={};return e=e||"title",t&&(n[" "]=" "),this.each(function(t){n[t.id]=t.get(e)}),n},freshen:function(t){var n;this.each(function(e){e._remove=!0}),e(t).each(function(e){n=this.get(e.id),n?(n.set(e),delete n._remove):this.add(e)},this);var i=this.filter(function(e){return e._remove});e(i).each(function(e){this.remove(e)},this),this.trigger("freshen",this)},fetch:function(e){e||(e={});var n=this,i=e.success;e.success=function(t,a,s){n[e.add?"add":e.freshen?"freshen":"reset"](n.parse(t,s),e),n.trigger("sync"),i&&i(n,t)};var a=e.error;return e.error=function(t){a?a(n,t,e):n.trigger("error",n,t,e)},(this.sync||t.sync).call(this,"read",this,e)}}}),ABINEMASKME.define("duckbone/routeable_application",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,i,a){a.RouteableApplication={isRouteableApplication:!0,setContainer:function(e){this.mainContainer=e},mapRoutes:function(t){e.each(e.keys(t),function(n){try{var i=t[n].routeName||t[n].prototype.templateName;if(!i)throw"Missing or bad routeName for "+n;if("function"!=typeof t[n].routeAction)throw"Missing or bad routeAction for "+n;this.route(n,i,t[n].routeAction),this.route(n+"?*params",i,function(){var i=e.toArray(arguments),a=i.pop(),s=e(a.split("&")).reduce(function(e,t){return e[t.split("=")[0]]=t.split("=")[1],e},{});return t[n].routeAction.apply(this,i.concat(s))})}catch(a){throw e.log(a),"Bad route for "+n}},this)},loadView:function(e,n){return void 0===n&&(n={}),this._removableFlashes&&(this._removableFlashes.remove(),delete this._removableFlashes),this.mainView&&this.mainView.remove(),n.application=this,this.mainView=new e(n),t(this.mainView.el).appendTo(this.mainContainer),this.mainView},navigate:function(e,t){this.isFlashableView&&(this._removableFlashes=this.activeFlashes()),n.history.navigate(e,t)},bindNavigationBars:function(){this.on("all",function(e){if("route"==e.split(":")[0]){var n=e.split(":")[1];t("nav ul li").removeClass("active"),t("nav ul li."+n).addClass("active")}})}}}),ABINEMASKME.define("duckbone/view_lifecycle_extensions",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,i,a){a.ViewLifecycleExtensions={hasViewLifecycleExtensions:!0,initialize:function(){this.application=this.options.application,this.isEditableView&&(s(this,"beforeClone"),this.cloneModelForEditing(),s(this,"afterClone")),this.render(),this.isStylizeableView&&this.applyStyles(),this.isBindableView&&this.bindAttributes(),this.isEditableView&&(this.bindModelSyncEvents(),this.createForm(),s(this,"afterCreateForm")),s(this,"afterInitialize")
},render:function(){return this.isTemplateableView&&this.renderTemplate(),this.isStylizeableView&&this.applyStyles(),this},remove:function(){return this.isEditableView&&this.expireClone(),s(this,"beforeRemove"),this.removeWeakBindings(),this.isNestableView&&this.removeNestedViews(),n.View.prototype.remove.call(this),s(this,"afterRemove"),this},weakBindToModel:function(e,t,n){this.weakBindTo(this.model,e,t,n)},weakBindTo:function(t,n,i){this._weakBindings=this._weakBindings||[],this._weakBindings.push([t,n,i]),t.bind.apply(t,e.toArray(arguments).slice(1))},removeWeakBindings:function(){e.each(this._weakBindings,function(e){e[0].unbind(e[1],e[2])}),delete this._weakBindings,this.isBindableView&&this.unbindLiveTimestamps()}};var s=function(e,t){e[t]&&e[t].call(e)}}),ABINEMASKME.define("duckbone/handlebars_extensions",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,i,a){ABINEMASKME.Duckbone=a,a.Handlebars=i,i.getAttr=function(e,t){return/^[0-9]+$/.test(t)?e[parseInt(t)]:void 0!=e[t]?"function"==typeof e[t]?e[t].call(e):e[t]:e.get?e.get(t):void 0}}),ABINEMASKME.define("duckbone/idme_template_registry",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,i,a){function s(t){t.templatesCompiled||(e.each(e.keys(ABINEMASKME.CompiledTemplates),function(e){var n=e.replace("views/","").replace("/","_");t.compiledTemplates[n]=ABINEMASKME.CompiledTemplates[e]}),t.templatesCompiled=!0)}a.TemplateRegistry=function(e){e=e||{},this.compiledTemplates={},this.templatesCompiled=!1,this.partialsCompiled=!1},e.extend(a.TemplateRegistry.prototype,{refresh:function(){},compile:function(){s(this)},get:function(e){return s(this),this.compiledTemplates[e]}})}),ABINEMASKME.define("duckbone/nestable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,i,a){a.NestableView={isNestableView:!0,setupNestedViews:function(){this.createChildren&&(this.children=this.createChildren())},removeNestedViews:function(){this.children&&(e.each(this.children,function(e){e.remove()}),delete this.children)}}}),ABINEMASKME.define("duckbone/templateable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core","abine/eventLogger"],function(e,t,n,i,a,s){var r=new a.TemplateRegistry;i&&(i.helpers.oldIf=i.helpers["if"],i.registerHelper("if",function(e,t,n){var a="function"==typeof e?e.call(this):e;return i.helpers.oldIf.call(this,a,t,n)}),i.registerHelper("attr",function(e){return new i.SafeString('<span data-bind="attr_'+i.Utils.escapeExpression(e)+'">'+i.Utils.escapeExpression(this.get(e))+"</span>")}),i.registerHelper("child",function(t,n){return n=e.isObject(n)?"div":n,new i.SafeString("<"+n+' data-child-view="'+i.Utils.escapeExpression(t)+'"></'+n+">")}),i.helpers.oldEach=i.helpers.each,i.registerHelper("each",function(e,t,n){return e.models&&(e=e.models),i.helpers.oldEach.call(this,e,t,n)})),a.TemplateableView={isTemplateableView:!0,included:function(){this.hasViewLifecycleExtensions||a.include(this,a.ViewLifecycleExtensions),this.isNestableView||a.include(this,a.NestableView)},templateRegistry:r,getTemplate:function(e,t){if(this.templateData=this.options.templateData||this.templateData||null,this.templateData)throw s.error("Cannot compile template."),"Cannot compile template";return e=e||this.options.templateName||this.templateName||"",this.template=this.templateRegistry.get(e),this.template||t||(this.template=a.Handlebars.compile('<div>Missing Template "'+e+'"</div>')),this.template},renderTemplate:function(i){var i=i||this.model||{};if(e.isFunction(this.options.template)?this.template=this.options.template:this.template||this.getTemplate(),!this.template)throw"renderTemplate called without a template.";this.removeNestedViews(),this.isBindableView&&this.unbindAttributes();try{t(this.el).empty().html(this.template(i))}catch(a){s.error("Handlebars threw an exception rendering your template:"),s.error(a.message),s.error("Context:"),s.error(i),t(this.el).html('<div class="duckbone_error">Handlebars exception: '+a.message+"</div>")}return this.isBindableView&&i instanceof n.Model&&t(this.el).find("span[data-bind]").each(e.bind(function(e,n){var a=t(n).attr("data-bind").slice(5),s='span[data-bind="attr_'+a+'"]';this.bindAttribute(i,a,s)},this)),this.setupNestedViews(),t(this.el).find("*[data-child-view]").each(e.bind(function(e,i){var a=t(i).attr("data-child-view"),r=this.children[a];r instanceof n.View?(t(i).replaceWith(r.el),t(r.el).attr({"data-child-view":a}),r.delegateEvents()):s.error("Unknown child view "+a)},this)),this.options.templateName||this.templateName,this.templateName&&t(this.el).addClass(this.templateName),this.templateRendered=!0,this},renderTemplateOnce:function(e){return this.templateRendered||this.renderTemplate(e),this}}}),ABINEMASKME.define("duckbone/stylizeable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,i,a){a.StylizeableView={isStylizeableView:!0,included:function(){this.hasViewLifecycleExtensions||a.include(this,a.ViewLifecycleExtensions)},applyStyles:function(e){e=e||this.styles||{};var n,i;for(var a in e)n=a.split(".")[0],i=a.split(".")[1],"el"==a?t(this.el).css(e.el):"el"==n&&i&&t(this.el).hasClass(i)?t(this.el).css(e[a]):t(this.el).find(a).css(e[a])}}}),ABINEMASKME.define("duckbone/pageable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,i,a){a.PageableView={isPageableView:!0,included:function(){this.isTemplateableView||a.include(this,a.TemplateableView)},getTemplate:function(e){a.TemplateableView.getTemplate.call(this,e,!0),this.template=this.template||a.Handlebars.compile('{{child "list"}}{{child "pager"}}')},createChildren:function(){var t=this.createListView(),n=this.createPagerView();return this.application=this.options.application||this.application,this.application&&this.collection.on("pageChange",function(t,n){var i=window.location.hash.split("?")[0]+"?",a=e(e.keys(n)).map(function(e){return e+"="+n[e]}).join("&");i+=a,this.application.navigate(i,!1)},this),{list:t,pager:n}},createListView:function(){return new a.ListView({viewClass:this.viewClass,pageableView:this,tagName:"ul",className:"listable_view",collection:this.collection})},createPagerView:function(){var e=this.options.pagerClass||this.pagerClass||Pager;return new e({collection:this.collection,pageableView:this})},showPage:function(e){e=parseInt(e)||1,this.collection.setPage(e)},showNextPage:function(){this.showPage(this.collection.currentPage+1)},showPreviousPage:function(){this.showPage(this.collection.currentPage-1)},scrollToTopOfList:function(){var e=t(this.children.list.el).offset().top-20;t("html body").animate({scrollTop:e},400,"swing")}};var s='<div class="pager">&nbsp;<br/>    {{#if showPrevious}}      <a href="#" class="previous_link">&laquo;&nbsp;Previous</a>&nbsp;    {{else}}      <span class="inactive">&laquo;&nbsp;Previous</span>&nbsp;    {{/if}}    {{#each pages}}      {{#if currentPage}}        <span class="current">{{title}}</span>&nbsp;      {{else}}        <a href="#" class="page_link" data-page="{{id}}">{{title}}</a>&nbsp;      {{/if}}    {{/each}}    {{#if showNext}}      <a href="#" class="next_link">Next&nbsp;&raquo;</a>    {{else}}      <span class="inactive">Next&nbsp;&raquo;</span>    {{/if}}  </div>';Pager=n.View.extend({el:'<div class="pager_view"></div>',templateData:s,events:{"click a.previous_link":"showPreviousPage","click a.next_link":"showNextPage","click a.page_link":"showPage"},initialize:function(){this.render(),this.collection.on("all",this.render,this)},render:function(){return this.collection.numPages&&this.renderTemplate(this.paginationData()),this.collection.numPages>1?t(this.el).show():t(this.el).hide(),this},paginationData:function(){var t=this.collection.numPages,n={showPrevious:this.collection.currentPage>1,numPages:t,showNext:this.collection.currentPage<this.collection.numPages,pages:e(e.range(1,t+1)).map(function(e){return{id:e,title:""+e,currentPage:e==this.collection.currentPage}},this)};return n},showPage:function(e){e.preventDefault();var n=parseInt(t(e.target).data("page"));return this.options.pageableView.showPage(n),this.options.pageableView.scrollToTopOfList(),!1},showPreviousPage:function(e){return e.preventDefault(),this.options.pageableView.showPreviousPage(),this.options.pageableView.scrollToTopOfList(),!1},showNextPage:function(e){return e.preventDefault(),this.options.pageableView.showNextPage(),this.options.pageableView.scrollToTopOfList(),!1}}),a.include(Pager.prototype,a.TemplateableView)}),ABINEMASKME.define("duckbone/pageable_collection",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,i,a){function s(e,t){t=t||{};var n="function"==typeof e.url?e.url():e.url;0>n.indexOf("?")&&(n+="?");for(var i in t)n+=i+"="+t[i]+"&";return n}a.PageableCollection={isPageableCollection:!0,parse:function(e){return this.numPages=e.num_pages,this.limitValue=e.limit_value,this.currentPage=e.current_page,this.totalCount=e.total_count,e.records},fetch:function(){this.fetchPage(1)},fetchPage:function(t,i){return t=t||1,i=i||e.clone(this.params)||{},n.Collection.prototype.fetch.call(this,{url:s(this,e.extend(i,{page:t})),success:function(e){e.trigger("pageChange",e.currentPage,i)}})},setParam:function(e,t){this.params=this.params||{},this.params[e]=t},setPage:function(e){return e!=this.currentPage&&e>0&&this.numPages>=e?this.fetchPage(e):void 0},nextPage:function(){return this.fetchPage(this.currentPage+1)},prevPage:function(){return this.fetchPage(this.currentPage-1)},updateTotalCountOnCollectionEvents:function(){this.on("add",function(){this.totalCount&&(this.totalCount+=1)},this),this.on("remove",function(){this.totalCount&&(this.totalCount-=1)},this)}}}),ABINEMASKME.define("duckbone/bindable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,i,a){a.BindableView={isBindableView:!0,included:function(){this.hasViewLifecycleExtensions||a.include(this,a.ViewLifecycleExtensions)},bindAttributes:function(e){if(this.attributeChanges){e=e||this.model||new n.Model;for(var t in this.attributeChanges)this.bindAttribute(e,t,this.attributeChanges[t])}},bindAttribute:function(e,a,s){e=e||this.model||new n.Model;var r,o=i.Utils.escapeExpression(e.get(a));"function"==typeof s?(s.call(this,o),r=function(){s.call(this,i.Utils.escapeExpression(e.get(a)))}):"string"==typeof s&&(t(this.el).find(s).html(o),r=function(){t(this.el).find(s).html(i.Utils.escapeExpression(e.get(a)))}),this._attributeBindings=this._attributeBindings||[];var l="change:"+a;this._attributeBindings.push([e,l,r]),this.weakBindTo(e,l,r,this)},unbindAttributes:function(){this._attributeBindings&&(e(this._attributeBindings).each(function(e){e[0].unbind(e[1],e[2])}),delete this._attributeBindings)},bindLiveTimestamps:function(e){return},unbindLiveTimestamps:function(){}},i&&i.registerHelper("live_timestamp",function(e){var t=a.Handlebars.getAttr(this,e);if(!t)return"";var n=new Date(t);return n?new i.SafeString('<span data-live-timestamp="'+n.getTime()+'">'+a.helpers.dateToPrettyTimeAgo(n)+"</span>"):""})}),ABINEMASKME.define("duckbone/listable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,i,a){function s(e){e.viewClass=e.options.viewClass||e.viewClass||new n.View}function r(e){e.collection=e.options.collection||e.collection||new n.Collection}a.ListableView={isListableView:!0,tagName:"ul",className:"listable_view",included:function(){this.hasViewLifecycleExtensions||a.include(this,a.ViewLifecycleExtensions),this.isBindableView||a.include(this,a.BindableView),this.isNestableView||a.include(this,a.NestableView)},render:function(e){return(!this._viewsRendered||e)&&(this.renderItems(),this.collectionEventsBound||(this.bindCollectionEvents(),this.collectionEventsBound=!0),this._viewsRendered=!0),this},createChildren:function(){return e.reduce(this.collection.models,function(e,t){return e[t.cid]=new this.viewClass({model:t,doc:this.doc}),e},{},this)},renderItems:function(){s(this),r(this),this.setupNestedViews();var t=document.createDocumentFragment();e.each(this.children,function(e){t.appendChild(e.el)}),this.el.appendChild(t)},bindCollectionEvents:function(e){var t;r(this),e=e||this.collectionEvents||o;for(var n in e){if(t=e[n],"string"==typeof t&&(t=this[t]),"function"!=typeof t)throw"Duckbone.ListableView.bindCollectionEvents() called with bad handler for "+n;this.weakBindTo(this.collection,n,t,this)}},refresh:function(e){e=e||{},this.empty(),this.collection.fetch()},getViewByModel:function(e){return this.children[e.cid]},collectionReset:function(){this.removeNestedViews(),this.render(!0)},collectionAdd:function(n){var i=new this.viewClass({model:n,doc:this.doc});this.children[n.cid]=i;var a=e(this.collection.models).indexOf(n);if(0==a)t(this.el).prepend(i.el);else{var s=t(this.el).children().eq(a-1);t(s).after(i.el)}},collectionRemove:function(e){this.children[e.cid].remove(),delete this.children[e.cid]}};var o={reset:"collectionReset",add:"collectionAdd",remove:"collectionRemove"}}),ABINEMASKME.define("duckbone/flashable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,i,a){a.FlashableView={isFlashableView:!0,configureFlash:function(t){if(!t.container)throw"configureFlash called without a container";var n={noticeDuration:1e4,fadeDuration:300};this.flashOptions=e.extend(n,t),s.fadeDuration=this.flashOptions.fadeDuration,t.noticeTemplate&&"string"==typeof t.noticeTemplate?o.prototype.templateData=t.noticeTemplate:"function"==typeof t.noticeTemplate&&(o.prototype.template=t.noticeTemplate),t.errorTemplate&&"string"==typeof t.errorTemplate?FlashErrorView.prototype.templateData=t.errorTemplate:"function"==typeof t.errorTemplate&&(FlashErrorView.prototype.template=t.errorTemplate)},flashNotice:function(e,n){n=n||1e4;var i=new o({model:{message:e},duration:n});return t(this.flashOptions.container).append(i.el),t(i.el).hide().slideDown(300),i},flashAlert:function(e){var n=new l({model:{message:e}});return t(this.flashOptions.container).append(n.el),t(n.el).hide().slideDown(300),n},activeFlashes:function(){return t(this.flashOptions.container).find("div.flash_notice, div.flash_alert")},clearFlashes:function(e){if(this.flashOptions){var t=this.activeFlashes();e?t.remove():t.fadeOut(this.flashOptions.fadeDuration)}}};var s=n.View.extend({events:{"click a.close":"dismiss"},fadeDuration:300,dismiss:function(n){return n&&n.preventDefault(),t(this.el).fadeOut(this.fadeDuration),e.delay(e.bind(this.remove,this),this.fadeDuration),!1}});a.include(s.prototype,a.TemplateableView);var r='<div class="message">{{{message}}}</div>     <div class="close"><a href="#" class="close">X</a></div>',o=s.extend({className:"flash_notice",templateData:r,afterInitialize:function(){this.options.duration&&e.delay(e.bind(this.dismiss,this),this.options.duration)}}),l=s.extend({className:"flash_alert",templateData:r})}),ABINEMASKME.define("duckbone/bindable_field",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,i,a){function s(e,t,n,i){i=i||!1,"undefined"==typeof n&&(n=null),a.ModelHelpers.setOne.call(e,t,n,{silent:i})}a.BindableField={isBindableField:!0,get:function(){var e=this.domToModelTransform(t(this.el).val());return this.stripWhitespace&&this.options.stripWhitespace!==!1&&(e=e.replace(/^\s+|\s+$/g,"")),e},set:function(e){t(this.el).val(this.modelToDomTransform(e))},modelToDomTransform:function(e){return void 0!==e||0/0!==e?e:""},domToModelTransform:function(e){return e},bindToModel:function(e){if(e=e||this.options.modelAttribute||this.modelAttribute||this.options.name||this.name,!e)throw"Duckbone.BindableField.bindToModel() called without a modelAttribute";this.modelAttribute=e;var t=this,n=this.model,i="change:"+e;t.form.view.weakBindToModel(i,function(){var i=n.get(e);i!==t.get()&&a.ModelHelpers.isValidAttribute(i)&&t.set(i)}),t.set(n.get(e))},bindToDOM:function(e,n,i){if(e=e||this.options.modelAttribute||this.modelAttribute||this.options.name||this.name,!e)throw"Duckbone.BindableField.bindToDOM() called without a modelAttribute";this.modelAttribute=e;var n=this.options.changeEvent||this.changeEvent||"change";i=i||this.el;var a=this,r=this.model;t(i).bind(n,function(){s(r,e,a.get())}),s(r,e,a.get())}}}),ABINEMASKME.define("duckbone/validateable_field",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,i,a){a.ValidateableField={isValidateableField:!0,bindValidation:function(e,n){var i=this.options.validate||this.options.required;if(i){var a=this;e=e||this.options.validateEvent||"change",n=n||this.el;var s=t(window),r=null,o=function(){r=new Date},l=function(){s.unbind("mouseup",l),a.validate()};this.form.view&&this.form.view.isBindableView?this.form.view.weakBindTo(s,"mousedown",o):s.bind("mousedown",o),t(n).bind(e,function(){r&&10>new Date-r?s.bind("mouseup",l):a.validate()})}},validate:function(e,t){if(t=t||!1,t||this.clearErrors(),this.valid=!0,!this.options.validate&&this.options.required&&(this.options.validate="required",this.options.invalidMessage=this.options.invalidMessage||"Required"),e=e||this.options.validate,"string"==typeof e&&(e=a.forms.validators[e]),!e)return!0;var n=this.options.invalidMessage||"Invalid";if(0==e.call(this,this.get())&&(this.valid=!1),this.valid||t){var i=this.get();a.ModelHelpers.isValidAttribute(i)&&this.set(i)}else this.addError(n);return this.valid},addError:function(e){if(!this.errorList){this.errorList=t("<ul>").addClass("error");var n=t(this.el).parents("form").find("div."+this.name+"_errors").get(0);n?t(n).append(this.errorList):t(this.el).after(this.errorList)}this.errorList.append(t("<li>").html(e))},clearErrors:function(){this.errorList&&(this.errorList.remove(),this.errorList=null)}}}),ABINEMASKME.define("duckbone/form_fields",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core","abine/intl"],function(e,t,n,i,a,s){i.registerHelper("form",function(e,t){var n=e;return n=n.replace(/^(new_)(.*)/,"$2").replace(/^(edit_)(.*)/,"$2"),n!=e&&(n+=" "+e),'<form action="#" name="'+e+'" class="'+n+'">\n'+t(this)+"\n</form>"}),i.registerHelper("form_error_banner",function(e){return e="string"==typeof e?e:"mm_duckbone_default_form_error",e=s.getText(e),new i.SafeString('<div class="error_banner alert alert-error" style="display: none">'+i.Utils.escapeExpression(e)+"</div>")}),i.registerHelper("form_error",function(e){return new i.SafeString('<div class="'+i.Utils.escapeExpression(e)+'_errors"></div>')}),i.registerHelper("form_label",function(e,t){var n;return"object"==typeof t?(n=e,n=n.replace(/^(.)/,function(e){return e.toUpperCase()}),n=n.replace(/(\_[a-z])/g,function(e){return e.toUpperCase().replace("_"," ")})):n="function"==typeof t?new i.SafeString(t(this)):s.getText(t),new i.SafeString('<label data-field-name="'+i.Utils.escapeExpression(e)+'">'+i.Utils.escapeExpression(n)+"</label>")}),i.registerHelper("form_text",function(e){return new i.SafeString('<input class="form_text" type="text" name="'+i.Utils.escapeExpression(e)+'"/>')}),i.registerHelper("form_select",function(e){return new i.SafeString('<select class="form_select" name="'+i.Utils.escapeExpression(e)+'"></select>')}),i.registerHelper("form_radio_set",function(e){return new i.SafeString('<div class="form_radio_set" name="'+i.Utils.escapeExpression(e)+'"></div>')}),i.registerHelper("form_checkbox",function(e){return new i.SafeString('<input class="form_checkbox" type="checkbox" name="'+i.Utils.escapeExpression(e)+'"/>')}),i.registerHelper("form_textarea",function(e){return new i.SafeString('<textarea class="form_textarea" name="'+i.Utils.escapeExpression(e)+'"></textarea>')}),i.registerHelper("form_password",function(e){return new i.SafeString('<input class="form_password" type="password" name="'+i.Utils.escapeExpression(e)+'"></input>')}),i.registerHelper("form_submit",function(e,t){return"undefined"==typeof t&&(t="mm_duckbone_default_form_submit_text"),"object"==typeof t&&(t="mm_duckbone_default_form_submit_text"),t=s.getText(t),new i.SafeString('<button class="form_submit" name="'+i.Utils.escapeExpression(e)+'">'+i.Utils.escapeExpression(t)+"</button>")}),i.registerHelper("form_submit_with_spinner",function(e,t,n){n="object"==typeof n?"/pages/images/ajax_loader.gif":n,"undefined"==typeof t&&(t="mm_duckbone_default_form_submit_text"),"object"==typeof t&&(t="mm_duckbone_default_form_submit_text"),t=s.getText(t);var a='<button class="form_submit" name="'+i.Utils.escapeExpression(e)+'">'+i.Utils.escapeExpression(t)+"</button>";return a+='<img src="'+i.Utils.escapeExpression(n)+'" class="ajax_loading '+i.Utils.escapeExpression(e)+'_loading" style="display: none"/>',new i.SafeString(a)}),a.FormFieldBase=n.View.extend(),e.extend(a.FormFieldBase.prototype,a.BindableField,a.ValidateableField,{initialize:function(e){this.name=this.options.name||t(this.el).attr("name"),this.form=this.options.form,e.elAttributes&&t(this.el).attr(e.elAttributes),this.afterInitialize(e),this.createChildren(),this.bindToModel(),this.bindToDOM(),this.bindValidation()},afterInitialize:function(){},createChildren:function(){}}),a.TextFormField=a.FormFieldBase.extend({type:"text",stripWhitespace:!0}),a.SelectFormField=a.FormFieldBase.extend({type:"select",createChildren:function(){var e=this.options.selectOptions,n="function"==typeof e?e.call(this):e;for(var a in n){var s=t("<option></option>").attr({value:a});s.html(i.Utils.escapeExpression(n[a])),t(this.el).append(s)}}}),a.RadioSetFormField=a.FormFieldBase.extend({type:"radio_set",createChildren:function(){var e=this.options.selectOptions,n="function"==typeof e?e.call(this):e;for(var a in n){var s=this.form.name+"_"+this.name+"_"+a,r=t('<div><input type="radio"/><label for="'+s+'" class="radio_label"></label></div>');t(r).find("input").attr({id:s,name:this.name,value:a}),t(r).find("label").html(i.Utils.escapeExpression(this.options.selectOptions[a])),t(this.el).append(r)}var o=this.el;t(this.el).find("input").bind("change",function(){t(o).trigger("change")})},get:function(){return t(this.el).find("input:checked").attr("value")},set:function(e){var n=t(this.el).find("input:checked").get(0);n&&(n.checked=!1);var i=t(this.el).find('input[value="'+e+'"]').get(0);i&&(i.checked=!0)}}),a.CheckboxFormField=a.FormFieldBase.extend({type:"checkbox",get:function(){return t(this.el).is(":checked")},set:function(e){t(this.el).attr({checked:e})}}),a.TextAreaFormField=a.FormFieldBase.extend({type:"textarea",stripWhitespace:!0}),a.PasswordFormField=a.FormFieldBase.extend({type:"password"}),a.SubmitFormField=n.View.extend(),e.extend(a.SubmitFormField.prototype,a.BindableField,{type:"submit",initialize:function(n){this.form=n.form,this.name=n.name,this.spinnerEl=t(this.el).next("img.ajax_loading"),t(this.el).bind("click",e.bind(this.bindDisableAndSpin,this)),this.submitForm="undefined"==typeof n.submitForm?!0:n.submitForm},bindDisableAndSpin:function(e){e.preventDefault(),this.form.model.off("sync:create",this.disableAndSpin),this.form.model.off("sync:update",this.disableAndSpin),this.form.model.on("sync:create",this.disableAndSpin,this),this.form.model.on("sync:update",this.disableAndSpin,this),this.submitForm&&this.form.submit()},disableAndSpin:function(){this.form.model.off("sync:create",this.disableAndSpin),this.form.model.off("sync:update",this.disableAndSpin),this.spinnerEl&&t(this.spinnerEl).fadeIn(),t(this.el).addClass("loading"),t(this.el).unbind("click"),t(this.el).bind("click",this.stealClick),this.form.model.on("sync:complete",this.syncComplete,this)},stealClick:function(e){return e.preventDefault(),!1},syncComplete:function(){t(this.el).unbind("click"),t(this.el).removeClass("loading"),this.spinnerEl&&t(this.spinnerEl).fadeOut(),t(this.el).bind("click",e.bind(this.bindDisableAndSpin,this))}}),a.forms.fieldTypes={text:a.TextFormField,select:a.SelectFormField,radio_set:a.RadioSetFormField,checkbox:a.CheckboxFormField,textarea:a.TextAreaFormField,password:a.PasswordFormField,submit:a.SubmitFormField}}),ABINEMASKME.define("duckbone/editable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,i,a){function s(e,t){for(var n in t){var i=e[t[n]];"function"==typeof i&&e.weakBindToModel(n,i,e)}}function r(e,t){return e.name+"_"+t.name}function o(e){return"[name="+e+"]"}function l(e){var n=/^form_(.*)/.exec(t(e).attr("class"))[1];return a.forms.fieldTypes[n]}function c(e){var n=t(e).offset().top;n=n>f?n-f:0,t("html body").animate({scrollTop:n},h,p)}a.EditableView={isEditableView:!0,included:function(){this.hasViewLifecycleExtensions||a.include(this,a.ViewLifecycleExtensions)},createForm:function(e){e=e||{};var i=e.el||t(this.el).find("form").get(0)||t(this.el).get(0),s=e.fields||this.options.fields||this.fields,r=e.model||this.model,o=new a.FormManager({el:i,fields:s,model:r||new n.Model,view:this});return this.form=this.form||o,o},bindModelSyncEvents:function(){s(this,u),this.modelSyncEvents&&s(this,this.modelSyncEvents)},cloneModelForEditing:function(){if(!this.model)throw"Found not, has your model been. Cloned, it can not be.";this.originalModel=this.model,this.model=this.originalModel.clone(),this.weakBindToModel("sync:success",function(){var t=e.clone(this.model.attributes);e(this.form.fields).each(function(e){e.options.temporary&&delete t[e.modelAttribute]}),this.originalModel.set(t),d.call(this)},this)},expireClone:function(){if(this.originalModel){this.model.clear({silent:!0});var e=function(){throw"Attempted get/set on expired clone from Duckbone.EditableView. Use original model instead."};this.model.set=e,this.model.get=e,this.model=this.originalModel,delete this.originalModel}},resetModel:function(){if(!this.originalModel)throw"Cloned not, has your model been. Reset, we can not do.";this.model.set(this.originalModel.attributes)},defaultModelSyncSavingHandler:function(){t(this.el).find("div.error_banner").hide(),e.each(this.form.fields,function(e){e.isValidateableField&&e.clearErrors()},this)},defaultModelSyncInvalidHandler:function(){t(this.el).find("div.error_banner").show(),e.each(this.model.errors,function(t,n){var i=this.form.getFieldForModelAttribute(n);e.each(this.model.errors[n],function(t){i&&i.isValidateableField?i.addError(t):e.log("Cannot add error for field "+n+": "+t)},this)},this),t(this.el).find("div.error_banner").show(),c(this.el)},defaultModelSyncSuccessHandler:function(){},defaultModelSyncErrorHandler:function(){},defaultModelSyncCompleteHandler:function(){}},a.FormManager=function(i){this.el=i.el||t('<form action="#"></form>').get(0),this.fieldOptions=e.clone(i.fields)||{},this.model=i.model||new n.Model({}),this.view=i.view,this.name=t(this.el).attr("name")||"untitled_form",this.createFields()},e.extend(a.FormManager.prototype,n.Events),e.extend(a.FormManager.prototype,{createFields:function(){var e,n,i=this;for(n in this.fieldOptions)e=this.createField(n,this.fieldOptions[n]);t(this.el).find("button.form_submit").each(function(){n=t(this).attr("name"),i.fields[n]||(e=new a.forms.fieldTypes.submit({name:n,el:this,form:i}),i.fields[e.name]=e)}),t(this.el).find("label").each(function(){var e=t(this).attr("data-field-name");e&&i.fields[e]&&t(this).attr("for",r(i,i.fields[e]))})},createField:function(n,i){this.fields=this.fields||{};var s,c,d;if(s=t(this.el).find(o(n)).get(0),!s)throw"Form field "+n+" defined in view, missing in template";if(c=i.type?a.forms.fieldTypes[i.type]:l(s),!c)throw"Bad form field type "+n;return d=new c(e.extend(i,{el:s,model:this.model,form:this,name:n})),d.name=n,t(d.el).attr("id",r(this,d)),this.fields[n]=d,d},getField:function(e){return this.fields[e]},getFieldForModelAttribute:function(t){return e.detect(this.fields,function(e){return e.modelAttribute==t},this)},validate:function(){this.isValid=!0;var e;for(var t in this.fields)e=this.fields[t].validate?this.fields[t].validate():!0,e||(this.isValid=!1);return this.isValid},submit:function(n){this.validate()?(n=e.clone(n)||{},e.each(["success","error"],function(t){if("function"==typeof n[t]){var i=n[t];n[t]=function(t,n){e.defer(e.bind(i,t,t,n))}}},this),this.model.save(null,n)):(e.log("Form is invalid."),t(this.el).find("div.error_banner").show(),c(this.el))}});var d=function(){var t=this.options.afterSaveDestination||this.afterSaveDestination;t&&(t instanceof Array||(t=[t]),e.each(t,function(e){if(e.collection)e.collection.add(this.originalModel);else{var t="set"+e.association.slice(0,1).toUpperCase()+e.association.slice(1);e.model[t].call(e.model,this.originalModel)}},this))},u={"sync:create":"defaultModelSyncSavingHandler","sync:update":"defaultModelSyncSavingHandler","sync:success":"defaultModelSyncSuccessHandler","sync:invalid":"defaultModelSyncInvalidHandler","sync:error":"defaultModelSyncErrorHandler","sync:complete":"defaultModelSyncCompleteHandler"},h=400,p="swing",f=100}),ABINEMASKME.define("duckbone/form_validations",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,i,a){a.forms=a.forms||{},a.forms.validators=a.forms.validators||{},e.extend(a.forms.validators,{required:function(e){return!(void 0==e||null==e||""==e)},USPhone:function(e){return/^\(?(\d{3})\)?[\- ]?\d{3}[\- ]?\d{4}$/.test(e)},date:function(e){return/^(?:0?[1-9]|1[0-2])\/(?:0?[1-9]|[12][0-9]|3[01])\/\d{2}?\d{2}$/.test(e)},email:function(e){return/^([A-Za-z0-9\._%\+\-]+)@([A-Za-z0-9\-]+\.)+([A-Za-z]{2,})$/.test(e)},numeric:function(e){return 0/0!=parseFloat(e)}})}),ABINEMASKME.define("duckbone/remoteable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,i,a){a.RemoteableView={debounceRequest:500,initialize:function(){this.render=e.debounce(e.bind(this.serverSideRender,this),this.debounceRequest),this.model&&this.model.on("change",this.render),this.render()},serverSideRender:function(){if(!this.url)throw"Set url property on RemoteView to enable server-side rendering.";return"string"==typeof this.loading&&t(this.el).html(this.loading),t.ajax({url:this.url,dataType:"html",context:this,success:function(e){t(this.el).empty(),t(this.el).html(e)},error:function(){t(this.el).html("Error rendering from "+this.url)}}),this}}}),ABINEMASKME.define("duckbone/simple_queue",["documentcloud/underscore","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,i){i.SimpleQueue=function(e){this.interval=e.interval||400,this.elements=[],this.callback=e.callback,this.running=!1},e.extend(i.SimpleQueue.prototype,{push:function(t){this.elements.push(t),this.comparator&&e(this.elements).sortBy(this.comparator),this.running||(this.running=!0,this.timer=setInterval(e.bind(this.shift,this),this.interval))},shift:function(){if(0==this.elements.length)this.running=!1,clearInterval(this.timer);else{var e=this.elements.shift();this.callback.call(e,e,this)}}})}),ABINEMASKME.define("duckbone/base_classes",["documentcloud/underscore","documentcloud/backbone","wycats/handlebars","duckbone/core","duckbone/security"],function(e,t,n,i){i.Model=t.Model.extend(),i.include(i.Model.prototype,i.AssociableModel,i.ModelHelpers,i.Syncable),i.Collection=t.Collection.extend(),i.include(i.Collection.prototype,i.CollectionHelpers,i.Syncable),i.View=t.View.extend(),i.include(i.View.prototype,i.TemplateableView,i.BindableView),i.FormView=i.View.extend(),i.include(i.FormView.prototype,i.EditableView),i.ListView=t.View.extend(),i.include(i.ListView.prototype,i.ListableView,i.BindableView),i.Application=t.Router.extend(),i.include(i.Application.prototype,i.RouteableApplication,i.FlashableView)}),ABINEMASKME.define("duckbone/security",["documentcloud/underscore","jquery","duckbone/core"],function(e,t,n){function i(e,t,n){if(!e._unlockHooked){e._unlockHooked=!0;var i=function(){a(e,t,n)};ABINEMASKME.App.on("unlocked",i),t.prototype._oldBeforeRemove=t.prototype.beforeRemove,t.prototype.beforeRemove=function(){t.prototype.beforeRemove=t.prototype._oldBeforeRemove,t.prototype.beforeRemove&&t.prototype.beforeRemove.apply(e,arguments),e._unlockHooked=!1,ABINEMASKME.App.off("unlocked",i)}}}function a(e,t,n){return ABINEMASKME.App.isLocked()?(i(e,t,n),e):(t.prototype._oldRender.apply(e,n),void 0)}function s(e,t){ABINEMASKME.App.isLocked()?ABINEMASKME.App.renderPage():e._oldRouteAction.apply(e,t)}n.Security={showBlankWhenLocked:function(e){e.prototype._oldRender=e.prototype.render,e.prototype.render=function(){a(this,e,arguments)
}},showLoginWhenLocked:function(e){e._oldRouteAction=e.routeAction,e.routeAction=function(){s(e,arguments)}}}}),ABINEMASKME.requireDuckbone=function(e){ABINEMASKME.require(["duckbone/core","duckbone/model","duckbone/syncable","duckbone/collection","duckbone/routeable_application","duckbone/view_lifecycle_extensions","duckbone/handlebars_extensions","duckbone/idme_template_registry","duckbone/nestable_view","duckbone/templateable_view","duckbone/stylizeable_view","duckbone/pageable_view","duckbone/pageable_collection","duckbone/bindable_view","duckbone/listable_view","duckbone/flashable_view","duckbone/bindable_field","duckbone/validateable_field","duckbone/form_fields","duckbone/editable_view","duckbone/form_validations","duckbone/remoteable_view","duckbone/simple_queue","duckbone/base_classes"],function(){e()})},ABINEMASKME.define("abine/models/account",["models","documentcloud/underscore"],function(e,t){var n=e.BaseModel.extend({storageEntity:"account",initialize:function(){this.hasMany({accountFields:{collection:e.AccountFieldCollection,belongsTo:"account"},accountActivity:{collection:e.AccountActivityCollection,belongsTo:"account"},disposableEmails:{collection:e.DisposableEmailCollection,belongsTo:"account"},disposablePhones:{collection:e.DisposablePhoneCollection,belongsTo:"account"}}),this.hasOne({site:{model:e.Site}})},deleteExceptEmail:function(e){var t="delete:account:exceptEmail:"+this.getId();this.sync(t,this,{eventName:t,success:e.success,error:e.error})},getDomain:function(){return this.site.get("domain")},getId:function(){return this.get("id")},addAccountFieldValue:function(t,n){var i=new e.AccountField({accountId:this.getId(),dataType:t,value:n});i.save(),this.accountFields.add(i)},getAccountFieldValue:function(e){if(!this.accountFields||0==this.accountFields.length)return"";var t="";return this.accountFields.forEach(function(n){n.has("dataType")&&n.get("dataType")==e&&(t=n.get("value"))}),t},getEmail:function(){return this.getAccountFieldValue("/contact/email")},getUsername:function(){return this.getAccountFieldValue("/nameperson/friendly")},getPhone:function(){return this.getAccountFieldValue("/contact/phone")},getPassword:function(){return this.getAccountFieldValue("/password")},getLoginForAccount:function(){if(!this.accountFields||0===this.accountFields.length)return null;var e=null;return this.accountFields.forEach(function(t){!t.has("dataType")||"/contact/email"!=t.get("dataType")&&"/nameperson/friendly"!=t.get("dataType")||(e=t.get("value"))}),e},getAccountID:function(){return this.get("id")},prettyDateCreated:function(){return new Date(this.get("createdAt")).toString()},markDeleted:function(){this.save({deleted:1})},isFullyProtected:function(){var e=this,t=null;return t=e.accountFields.find(function(e){return e.isAnExposedEmail()||e.isAnExposedPhone()}),!t},isLoginAccount:function(){return"register"==this.attributes.type||"login"==this.attributes.type},isEmptyAccount:function(){return!this.accountFields||0==this.accountFields.length},isIncompleteAccount:function(){return this.accountFields.length>0&&4>this.accountFields.length},emailExposed:function(){var e=this,t=null;return t=e.accountFields.find(function(e){return e.isAnExposedEmail()})},phoneExposed:function(){var e=this,t=null;return t=e.accountFields.find(function(e){return e.isAnExposedPhone()})},passwordReused:function(){var e=this;t.async.detect(e.accountFields.models,function(t){t.has("dataType")&&"/password"===t.get("dataType")&&e.sync("read",e,{eventName:"read:account:passwords:"+t.get("id"),success:function(t){e.hasAReusedPassword=t.timesReused,e.totalPasswordUses=t.timesReused+1},error:function(){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/account]#[passwordReused]# error event in model.sync eventName: read:account:passwords:id")}})},function(e){return"undefined"!=typeof e})},fieldIsAnExposedEmail:function(e){return e.isAnExposedEmail()},fieldIsAnExposedPhone:function(e){return e.isAnExposedPhone()}}),i=e.BaseCollection.extend({model:n,fetchAllForPrinting:function(e){e=e||function(){},this.fetch({reset:!0,eventName:"read:account:all:login,register,fill",success:t.bind(function(t){for(var n=[],i=0;this.length>i;i++)(this.models[i].isTrue("deleted")||this.models[i].site.isTrue("blacklisted"))&&n.push(t[i]);this.remove(n),e()},this),error:function(){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/account]#[fetchAllForPrinting]# error event in model.fetch eventName: read:account:all:login,register"),e()}})},comparator:function(e){return-1*new Date(e.get("modifiedAt")).getTime()}});return e.Account=n,e.AccountCollection=i,{Account:n,AccountCollection:i}}),ABINEMASKME.define("abine/models/accountActivity",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"accountActivity",highlighted:!1,initialize:function(){this.hasOne({account:{model:t.Account}}),this.hasOne({accountField:{model:t.AccountField}})},getDomain:function(){return this.account.site.get("domain")},getId:function(){return this.get("id")},getLogin:function(){return this.account.getLoginForAccount()||"this account"},getSiteId:function(){return this.account.site.get("id")},getIcon:function(){var e={"new login":"icon-user","new register":"icon-user",login:"icon-home","disposable email":"icon-envelope","disposable phone":"icon-bell","primary email":"icon-envelope","primary phone":"icon-bell","strong password":"icon-lock","update password":"icon-lock",update:"icon-ok","reused password":"icon-lock"};return e[this.get("activityType")]},getDescriptionForType:function(e){var t="";return"new login"==e?t+="MaskMe stored your account.":"new register"==e?t+="MaskMe stored your registration.":"login"==e?t+="Logged in.":"disposable email"==e?t+="Good! You masked your email.":"disposable phone"==e?t+="Good! You masked your phone.":"primary email"==e?t+="You disclosed your real email address.":"primary phone"==e?t+="You disclosed your real phone number.":"strong password"==e?t+="Good! You used a unique password.":"update password"==e?t+="MaskMe updated the stored password for this account.":"update"==e?t+="MaskMe updated the stored information for this account.":"life easier"==e?t+="Next time you login, we'll make your life easier!":"reused password"==e&&(t+="You have reused this password on other sites"),t},getHighlightedClass:function(){return this.get("highlighted")?"highlighted":""},getProtectedClass:function(){var e=this.get("protectionLevel");return 2==e?"fullyProtected":1==e?"partlyProtected":"notProtected"},getExtraActivities:function(){var e=this.get("extraActivityTypes");if(e){for(var t=[],n=e.split(","),i=0;n.length>i;i++)t.push(this.getDescriptionForType(n[i]));return t}return[]},getPrettyDescription:function(){var e=this.get("activityType");return this.getDescriptionForType(e)}}),i=t.BaseCollection.extend({model:n,initialize:function(){this.cid=e.uniqueId();var t=this;this.debouncedRefetcher=e.debounce(function(){t.fetchAll()},500),this.messenger=this.getMessenger()},bindBroadcasts:function(){this.messenger.on("broadcast:accountActivity:new",this.debouncedRefetcher,this)},unbindBroadcasts:function(){this.messenger.off("broadcast:accountActivity:new",this.debouncedRefetcher)},comparator:function(e){return new Date-new Date(e.get("createdAt"))}});return t.AccountActivity=n,t.AccountActivityCollection=i,{AccountActivity:n,AccountActivityCollection:i}}),ABINEMASKME.define("abine/models/accountField",["documentcloud/underscore","models"],function(e,t){var n={"/nameperson/friendly":{title:"Username",icon:"icon-user"},"/contact/email":{title:"Email address",icon:"icon-envelope"},"/contact/phone":{title:"Phone number",icon:"icon-bell"},"/password":{title:"Password",icon:"icon-lock"}},i=t.BaseModel.extend({storageEntity:"accountField",initialize:function(){this.hasOne({account:{model:t.Account}})},markDeleted:function(){this.save({deleted:1})},numReused:function(){return this.attributes.reuse?this.attributes.reuse.length:1},getDomain:function(){return this.attributes.site&&this.attributes.site.domain?this.attributes.site.domain:"Unknown"},getId:function(){return this.get("id")},deleteAccount:function(e){e=e||{},this.sync("delete",this,{eventName:"delete:accountField:account:"+this.attributes.accountId,success:e.success,error:e.error})},deleteVersioned:function(e){e=e||{},this.sync("delete",this,{eventName:"delete:accountField:version:"+this.getId(),success:e.success,error:e.error})},prettyFieldName:function(){var e=this.get("dataType");return e&&n[e]?n[e].title:"Unknown field"},getIcon:function(){var e=this.get("dataType");return e&&n[e]?n[e].icon:"icon-question-sign"},getProtectionClass:function(){var e=this.get("dataType");return this.exposed="/password"===e?this.account.hasAReusedPassword?"field-exposed":"field-protected":"/contact/email"===e?"disposable"!==this.get("origin")?"field-exposed":"field-protected":"/contact/phone"===e?"disposable"!==this.get("origin")?"field-exposed":"field-protected":"field-neutral",this.exposed},isAnExposedEmail:function(){return"/contact/email"===this.get("dataType")&&"disposable"!==this.get("origin")},isAnExposedPhone:function(){return"/contact/phone"===this.get("dataType")&&"disposable"!==this.get("origin")},isUnique:function(){return this.attributes.reuse?1==this.attributes.reuse.length?!0:!1:!0},getExposedTip:function(){return"Use protection to gain control over your personal info!"},getReuseTip:function(){return this.attributes.reuse?this.attributes.reuse.join("<br/>"):void 0},getProtectionTip:function(){var e=this.getProtectionClass(),t=this.get("dataType");return"/password"===t?"field-exposed"===e?"This password is not unique. You have used it "+this.account.totalPasswordUses+" times.":"This password is unique!":"/contact/email"===t?"field-exposed"===e?this.account.site.get("name")+" may share your email with third parties. We suggest changing your account's contact email to a masked email.":"This email is masked!":"/contact/phone"===t?"field-exposed"===e?this.account.site.get("name")+" may share your phone with third parties. We suggest changing your account's contact phone to a masked phone.":"This phone is masked!":""},safeFieldValue:function(){return"/password"!==this.get("dataType")||this.shownPassword?this.get("value"):"&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;&bull;"},canBeDeleted:function(){return 1!==this.get("latest")||this.attributes.accountType in{fill:1,passwordless:1}}}),a=t.BaseCollection.extend({model:i,sanitizeForAccountView:function(){this.removeRedundantPasswords(),this.removeRedundantEmails(),this.removeUnwantedFields()},removeRedundantPasswords:function(){var e=!1,t=this.filter(function(t){if("/password"===t.get("dataType")){if(e)return!0;e=!0}return!1});this.remove(t)},removeRedundantEmails:function(){var e={},t=this.filter(function(t){if("/contact/email"===t.get("dataType")){var n=t.get("value");if(e[n])return!0;e[n]=n}return!1});this.remove(t)},removeUnwantedFields:function(){var e=this.filter(function(e){return!n[e.get("dataType")]});this.remove(e)},comparator:function(e){return"/nameperson/friendly"==e.get("dataType")?1:"/contact/email"==e.get("dataType")?2:"/password"==e.get("dataType")?3:"/contact/phone"==e.get("dataType")?4:5}});return t.AccountField=i,t.AccountFieldCollection=a,{AccountField:i,AccountFieldCollection:a}}),ABINEMASKME.define("abine/models/base",["abine/contentMessenger","documentcloud/backbone","duckbone/core","models"],function(e,t,n,i){var a,s=function(){return a=a||new e.ContentMessenger({eventAggregator:ABINEMASKME.eventAggregator||window.eventAggregator})},r=function(e,t,n){s();var i,r,o,l={};!t||"create"!=e&&"update"!=e||(l=t.toJSON()),n.eventName?i=n.eventName:(i=t.model?e+":"+t.model.storageEntity:e+":"+t.storageEntity,"create"!=e&&(i+=":"+t.id)),r="response:"+i.split(":").slice(1).join(":"),o="error:"+i.split(":").slice(1).join(":");var c=function(e){a.off(r,c),a.off(o,d),delete t.errors,n.success.call(t,e,200,null),t.trigger("sync:success",e)},d=function(e){a.off(o,d),a.off(r,c),delete t.errors,n.error.call(t,e,500,null),t.trigger("sync:error",e)};a.on(r,c,t),a.on(o,d,t),t.trigger("sync:"+e.toLowerCase()),a.send(i,l)},o=function(e){var t=this.get(e);return"1"===t||"true"===t||t===!0||1===t?!0:!1},l=function(e){return!o(e)},c=t.Model.extend({sync:r,getMessenger:s,isTrue:o,isFalse:l});n.include(c.prototype,n.AssociableModel,n.ModelHelpers);var d=t.Collection.extend({sync:r,getMessenger:s,fetchAll:function(e){e=e||{},e.eventName=["read",this.model.prototype.storageEntity,"all"].join(":"),this.fetch(e)}});return n.include(d.prototype,n.CollectionHelpers),i.BaseModel=c,i.BaseCollection=d,{BaseModel:c,BaseCollection:d}}),ABINEMASKME.define("abine/models/disposableCard",["models","abine/eventLogger"],function(e,t){var n=e.BaseModel.extend({storageEntity:"disposableCard",initialize:function(){},deactivateCard:function(e){e.eventName="update:disposableCard:deactivate:"+this.get("id"),this.sync("update",this,e)},isGift:function(){return this.isTrue("gift")},getRecipientEmail:function(){return this.get("recipient_email")},isActive:function(){return this.isTrue("active")},getID:function(){return this.id},getGUID:function(){return this.get("guid")},getAmountRefunded:function(){return"$"+(this.get("amount_refunded")/100).toFixed(2)},getOriginalValue:function(){return"$"+(this.get("original_amount")/100).toFixed(2)},getCardDetails:function(){return this.getCardNumber()+" - "+this.getExpiry()},getLastFour:function(){return this.get("number").substr(this.get("number").length-4)},getCardNumber:function(){return this.get("number")},getType:function(){return this.get("type").toLowerCase()},getPrettyNumber:function(){for(var e="",t=0;this.get("number").length>t;t++)e+=this.get("number").charAt(t),3==t%4&&(e+="  ");return e},getCVC:function(){return this.get("cvc")},getExpiry:function(){var e=parseInt(this.get("expiry_month"));return 10>e&&(e="0"+e),e+"/"+this.get("expiry_year")},getLabel:function(){var e=this.get("label");return e&&e.length>15&&(e=e.substr(0,12)+"..."),e},getProtectedNumber:function(){var e=this.get("number")+"";return e.substr(0,e.length-12).replace(/./g,"x")+e.substr(e.length-4)},getProtectedVerification:function(){var e=this.get("verification")+"";return e.substr(0,e.length-1).replace(/./g,"x")+e.substr(e.length-1)},toggleDisposable:function(){this.save({active:1===this.get("active")?0:1})}});n.convertStringToCents=function(e){return parseFloat(e).toFixed(2).toString().replace(".","")};var i=e.BaseCollection.extend({model:n,fetchAllLocal:function(e){e=e||{},"undefined"==typeof e.reset&&(e.reset=!0),e.eventName=["read",this.model.prototype.storageEntity,"allLocal"].join(":"),this.fetch(e)},fetchAllBySite:function(e){this.sync("read",this,{eventName:"read:disposableCard:site:"+e,success:function(e){this.reset(e)},error:function(){t.error("[ERROR HANDLER][abine/models/disposableCard][fetchAllBySite]: error event in model.sync event: read:disposableCard:site:id")}})},fetchAllFromServer:function(e){this.sync("read",this,{eventName:"read:disposableCard:server",success:function(t){this.reset(t),e.success(t)},error:function(){e.error(),true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/disposableCard]#[fetchAllFromServer]# error event in model.sync eventName: read:disposableCard:server")}})},fetchAllByDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:disposableCard:domain:"+e,success:function(e){this.reset(e),t()},error:function(){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/disposableCard]#[fetchAllByDomain]# error event in model.sync eventName: read:disposableCard:domain:domain")}})},comparator:function(e){return new Date-new Date(e.get("createdAt"))}});return e.DisposableCard=n,e.DisposableCardCollection=i,{DisposableCard:n,DisposableCardCollection:i}}),ABINEMASKME.define("abine/models/disposableEmail",["models","documentcloud/underscore"],function(e,t){var n=e.BaseModel.extend({storageEntity:"disposableEmail",highlighted:!1,initialize:function(){this.hasOne({account:{model:e.Account}})},getId:function(){return this.get("id")},hasWebmail:function(){return this.has("webmails")&&this.get("webmails").length>0?!0:!1},getWebmailCount:function(){return this.hasWebmail()?this.get("webmails").length:0},hasAccount:function(){return this.has("accountId")&&""!=this.get("accountId")&&this.account?t.any(this.account.accountFields.models,function(e){return e.get("value")==this.getAddress()},this):!1},getAddress:function(){return this.get("user")+"@"+this.get("domain")},getHighlightedClass:function(){return this.get("highlighted")?"highlighted":""},noConnectionError:function(){return!this.get("err")},isActive:function(){return 1==this.get("active")},toggleDisposable:function(e){this.save({active:1==this.get("active")?0:1},e)},needsTruncation:function(){var e=this.getDomain();return e.length>20},getTruncatedDomain:function(){var e=this.getDomain();return e.substring(0,20)+"..."},getDomain:function(){return this.attributes.label?this.attributes.label:"Unknown"}}),i=e.BaseCollection.extend({model:n,interestedBroadcasts:/broadcast:saveForm:(new|update)/i,initialize:function(){this.messenger=this.getMessenger()},totalWebmails:function(){return t.reduce(this.models,function(e,t){return e+t.getWebmailCount()},0)},fetchAllLocal:function(e){e=e||{},"undefined"==typeof e.reset&&(e.reset=!0),e.eventName=["read",this.model.prototype.storageEntity,"allLocal"].join(":"),this.fetch(e)},fetchAllBySite:function(e){this.sync("read",this,{eventName:"read:disposableEmail:site:"+e,success:function(e){this.reset(e)},error:function(){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/disposableEmail]#[fetchAllBySite]# error event in model.sync eventName: read:disposableEmail:site:id")}})},fetchAllFromServer:function(e){this.sync("read",this,{eventName:"read:disposableEmail:server",success:function(t){this.reset(t),e()},error:function(){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/disposableEmail]#[fetchAllFromServer]# error event in model.sync eventName: read:disposableEmail:server")}})},fetchAllByDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:disposableEmail:domain:"+e,success:function(e){this.reset(e),t()},error:function(){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/disposableEmail]#[fetchAllByDomain]# error event in model.sync eventName: read:disposableEmail:domain:domain")}})},comparator:function(e){return new Date-new Date(e.get("createdAt"))}});return e.DisposableEmail=n,e.DisposableEmailCollection=i,{DisposableEmail:n,DisposableEmailCollection:i}}),ABINEMASKME.define("abine/models/disposablePhone",["models"],function(e){var t=e.BaseModel.extend({storageEntity:"disposablePhone",initialize:function(){this.hasOne({account:{model:e.Account}})},getAreaCode:function(){return this.get("number").substr(0,3)},getExchange:function(){return this.get("number").substr(3,3)},getLocal:function(){return this.get("number").substr(6,4)},getPrettyNumber:function(){var e="("+this.getAreaCode()+") "+this.getExchange()+"-"+this.getLocal();return e},toggleDisposable:function(){this.save({active:1===this.get("active")?0:1})}}),n=e.BaseCollection.extend({model:t,fetchAllBySite:function(e){this.sync("read",this,{eventName:"read:disposablePhone:site:"+e,success:function(e){this.reset(e)},error:function(){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/disposablePhone]#[fetchAllBySite]# error event in model.sync event: read:disposablePhone:site:id")}})}});return e.DisposablePhone=t,e.DisposablePhoneCollection=n,{DisposablePhone:t,DisposablePhoneCollection:n}}),ABINEMASKME.define("abine/models/phoneLog",["documentcloud/underscore","models","jquery"],function(e,t){var n=t.BaseModel.extend({storageEntity:"phoneLog",initialize:function(){var e=this.attributes.updated_at,t=e.split("T"),n=t[0].split("-"),i=t[1].split("Z")[0].split(":"),a=n[0],s=parseInt(n[1],10),r=parseInt(n[2],10),o=parseInt(i[0],10),l=parseInt(i[1],10),c=parseInt(i[2],10),d=Date.UTC(a,s-1,r,o,l,c,0);this.attributes.updated_at=new Date(d)},isAllowed:function(){return"true"==this.get("is_allowed")||1==this.get("is_allowed")},toggleActive:function(e){this.save({is_allowed:!this.isAllowed()},e)},setLabel:function(e){this.save({label:e})}}),i=t.BaseCollection.extend({model:n,initialize:function(){}});return t.PhoneLog=n,t.PhoneLogCollection=i,{PhoneLog:n,PhoneLogCollection:i}}),ABINEMASKME.define("abine/models/preference",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"preference",initialize:function(){},forPreferencesPage:function(){return this.get("description")},isBlacklist:function(){return"rememberAccounts"===this.get("key")},parse:function(e){return"true"==e.value?e.value=!0:"false"==e.value&&(e.value=!1),e},toJSON:function(){var t=e.clone(this.attributes);return t.value===!0?t.value="true":t.value===!1&&(t.value="false"),t}}),i=t.BaseCollection.extend({model:n,interestedBroadcasts:/broadcast:preference:reload/i,parse:function(t){return e(t).map(function(e){return"true"==e.value?e.value=!0:"false"==e.value&&(e.value=!1),e})},restoreDefaults:function(t){this.sync("update",this,{eventName:"update:preference:restore",success:e.bind(function(e){this.reset(this.parse(e)),t()},this),error:function(e){t(e)}})},getPrefFromStorage:function(t,i){this.sync("read",this,{eventName:"read:preference:name:"+t,success:function(t){e.isArray(t)&&0===t.length?i(null):e.isObject(t)?i(new n(t)):i(null)},error:function(){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/preference]#[getPrefFromStorage]# error event in model.sync eventName: read:preference:name:key"),i(null)}})},isPrefTrue:function(t){var n=e(this.models).find(function(e){return e.get("key")===t});return n?n.isTrue("value"):!1},getPref:function(t){var n=e(this.models).find(function(e){return e.get("key")===t});return n?n.get("value"):null},setPref:function(t,n){var i=e(this.models).find(function(e){return e.get("key")===t});i.save({value:n})},hasPref:function(t){var n=e(this.models).find(function(e){return e.get("key")===t});return!!n},fetchAllForPreferencesPage:function(e){e=e||function(){},this.sync("read",this,{eventName:"read:preference:prefspage",success:function(t){this.reset(this.parse(t)),e.call(this)},error:function(){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/preference]#[fetchAllForPreferencesPage]# error event in model.sync eventName: read:preference:prefspage"),e.call(null)}})}});return t.Preference=n,t.PreferenceCollection=i,{Preference:n,PreferenceCollection:i}}),ABINEMASKME.define("abine/models/formData",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"formData",initialize:function(){}}),i=t.BaseCollection.extend({model:n,initialize:function(){}});return t.FormData=n,t.FormDataCollection=i,{FormData:n,FormDataCollection:i}}),ABINEMASKME.define("abine/models/mappedForm",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"mappedForm",initialize:function(){this.hasMany({fields:{collection:t.MappedFieldCollection}})},searchSignature:function(t){this.sync("read",this,{eventName:"read:mappedForm:signature:"+this.get("signature"),success:e.bind(function(e){e?(this.set(e),t()):t(!0)},this),error:function(){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/mappedForm]#[searchSignature]# error event in searchSignature"),t(!0)}})}}),i=t.BaseCollection.extend({model:n,initialize:function(){},fetchAllByDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:mappedForm:site:"+e,success:function(e){this.reset(e),t()},error:function(){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/mappedForm]#[fetchAllByDomain]# error event in read:mappedForm:site:domain"),t(!0)}})}});return t.MappedForm=n,t.MappedFormCollection=i,{MappedForm:n,MappedFormCollection:i}}),ABINEMASKME.define("abine/models/mappedField",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"mappedField",initialize:function(){}}),i=t.BaseCollection.extend({model:n,initialize:function(){}});return t.MappedField=n,t.MappedFieldCollection=i,{MappedField:n,MappedFieldCollection:i}}),ABINEMASKME.define("abine/models/shieldedCard",["models","documentcloud/underscore","abine/eventLogger"],function(e){var t=e.BaseModel.extend({storageEntity:"shieldedCard",interestedBroadcasts:/broadcast:billinginfo:updated/i,generateDisposable:function(){return new e.DisposableCard({shielded_card_id:this.get("id")})},getName:function(){return this.get("first_name")+" "+this.get("last_name")},getExpiry:function(){return parseInt(this.get("month"))+" / "+parseInt(this.get("year"))},getFirstName:function(){return this.get("first_name").toUpperCase()},getLastName:function(){return this.get("last_name").toUpperCase()},getLastFour:function(){return this.get("last_four")},getProtectedNumber:function(){if(!this.get("number"))return"---";var e=this.get("number")+"";return e.substr(0,e.length-4).replace(/./g,"x")+e.substr(e.length-4)},getProtectedVerification:function(){if(!this.get("number"))return"---";var e=this.get("verification")+"";return e.substr(0,e.length-1).replace(/./g,"x")+e.substr(e.length-1)}}),n=e.BaseCollection.extend({model:t,getPrimaryCardName:function(){return this.models.length>0?this.models[0].getFirstName+" "+this.models[0].getLastName():""},getPrimaryCardLastFour:function(){return this.models.length>0?this.models[0].getLastFour():""},getPrimaryCardExpiry:function(){return this.models.length>0?this.models[0].get:""}});return e.ShieldedCard=t,e.ShieldedCardCollection=n,{ShieldedCard:t,ShieldedCardCollection:n}}),ABINEMASKME.define("abine/models/shieldedEmail",["models"],function(e){var t=e.BaseModel.extend({storageEntity:"shieldedEmail",generateDisposable:function(t){return new e.DisposableEmail({targetGuid:this.get("guid"),label:t})},getAddress:function(){return this.get("email")},isValidated:function(){return 1==this.get("active")},resendValidationEmail:function(e){this.sync("update",this,{eventName:"update:shieldedEmail:resendValidationEmail:"+this.get("id"),success:function(t){e(t)},error:function(t){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/shieldedEmail]#[resendValidationEmail]# error event in model.sync eventName: update:shieldedEmail:resendValidationEmail:id"),e(t)}})}}),n=e.BaseCollection.extend({model:t,interestedBroadcasts:/broadcast:register:success/i});return e.ShieldedEmail=t,e.ShieldedEmailCollection=n,{ShieldedEmail:t,ShieldedEmailCollection:n}}),ABINEMASKME.define("abine/models/shieldedPhone",["models","documentcloud/underscore"],function(e){var t=e.BaseModel.extend({storageEntity:"shieldedPhone",generateDisposable:function(){return new e.DisposablePhone({shielded_phone_id:this.get("id")})},hasNumber:function(){return this.has("number")&&""!=this.get("number")?!0:!1},registerNumber:function(e){this.sync("create",this,{eventName:"create:shieldedPhone",success:e.success,error:e.error})},verifySecret:function(e){this.sync("update",this,{eventName:"update:shieldedPhone:secret",success:e.success,error:e.error})},getAreaCode:function(){return this.get("number").substr(0,3)},getExchange:function(){return this.get("number").substr(3,3)},getLocal:function(){return this.get("number").substr(6,4)},getPrettyNumber:function(){var e="("+this.getAreaCode()+") "+this.getExchange()+"-"+this.getLocal();return e},isValidated:function(){return"true"==this.get("is_validated")}}),n=e.BaseCollection.extend({model:t});return e.ShieldedPhone=t,e.ShieldedPhoneCollection=n,{ShieldedPhone:t,ShieldedPhoneCollection:n}}),ABINEMASKME.define("abine/models/site",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"site",initialize:function(){this.hasMany({accounts:{collection:t.AccountCollection,belongsTo:"site"}}),this.messenger=this.getMessenger()},getHistory:function(e){this.sync("read",this,{eventName:"read:site:history:"+this.get("id"),success:function(t){e(t)},error:function(){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/site]#[getHistory]# error event in model.sync eventName: read:site:history:id"),e(null)}})},filledAccountForSite:function(t,n){this.messenger.on("broadcast:filledAccount:rolledback",e.bind(function(){this.messenger.off("broadcast:filledAccount:rolledback"),n()},this)),this.messenger.send("contentManager:filledAccount",{accountId:t})},getDomain:function(){return this.get("domain")},getId:function(){return this.get("id")},blacklist:function(e){var t=this.get("domain");t&&(t=t.replace(":","::"));var n="update:site:blacklist:domain:"+t;this.sync(n,this,{eventName:n,success:e.success,error:e.error})},loadAccounts:function(e,t){var n=this,i=e?"create":"read",a=this.get("domain");a&&(a=a.replace(":","::"));var s=i+":site:domain:"+a;this.sync(i,this,{eventName:s,success:function(e){n.set(e),t(null)},error:function(){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/site]#[loadAccounts]# error event in model.sync eventName: create/read:site:domain:domain"),n.accounts.reset([]),t("No site, so no accounts")}})},getExposedTip:function(){return"Use protection to gain control over your personal info!"},hasNothingExposed:function(){var e=this.attributes.privacyStatus;return e?0===e.badEmails.length&&0===e.badPhones.length:null},hasNothingProtected:function(){var e=this.attributes.privacyStatus;return e?0===e.goodEmails.length&&0===e.goodPhones.length:null},hasGoodEmail:function(){var e=this.attributes.privacyStatus;return e?e.goodEmails.length>0:null},hasGoodPhone:function(){var e=this.attributes.privacyStatus;return e?e.goodPhones.length>0:null},hasReusedPassword:function(){var t=this.attributes.privacyStatus;return t?e(t.passwords).find(function(e){return e.reuse.length>1}):null},isFullyProtected:function(){var e=this.accounts.find(function(e){return!e.isFullyProtected()});return!e},emailExposed:function(){var e=this.accounts.find(function(e){return e.emailExposed()});return e},phoneExposed:function(){var e=this.accounts.find(function(e){return e.phoneExposed()});return e},anyLogins:function(){return this.accounts.find(function(e){return"login"===e.get("type")})},hasAccounts:function(){return this.accounts&&this.accounts.length>0}}),i=t.BaseCollection.extend({model:n,initialize:function(){this.messenger=this.getMessenger()}}),a=t.BaseCollection.extend({model:n,initialize:function(){this.messenger=this.getMessenger()},fetchAllForBlacklistedPage:function(e){e=e||function(){},this.sync("read",this,{eventName:"read:site:blacklisted",success:function(t){this.reset(this.parse(t)),e.call(this)},error:function(){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/site]#[fetchAllForBlacklistedPage]# error event in model.sync eventName: read:site:blacklisted"),e.call(null)}})},fetchForIsBlacklisted:function(e){e=e||function(){},this.sync("read",this,{eventName:"read:site:blacklisted",success:function(t){this.reset(this.parse(t)),e.call(this)},error:function(){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/site]#[fetchForIsBlacklisted]# error event in model.sync eventName: read:site:blacklisted"),e.call(null)}})},loadBlacklistedForDomain:function(t,n){this.fetchForIsBlacklisted(function(){var i=e.any(this.models,function(e){return e.get("domain")===t})||!1;n(i)})}}),s={protectedPhones:"totalPhones",protectedEmails:"totalEmails",uniquePasswords:"totalPasswords"},r=t.BaseModel.extend({defaults:{protectedPhones:0,protectedEmails:0,uniquePasswords:0,totalPhones:0,totalEmails:0,totalPasswords:0},initialize:function(e){this.sites=e.sites,this.sites.bind("sync:success",function(){this.computeStats()},this)},computeStats:function(){var e={protectedPhones:0,protectedEmails:0,uniquePasswords:0,totalPhones:0,totalEmails:0,totalPasswords:0};this.sites.forEach(function(t){var n=t.get("protections");n&&(e.protectedPhones+=n.totalPhones&&n.phone?1:0,e.protectedEmails+=n.totalEmails&&n.email?1:0,e.uniquePasswords+=n.totalPasswords&&n.password?1:0,e.totalPhones+=n.totalPhones,e.totalEmails+=n.totalEmails,e.totalPasswords+=n.totalPasswords)}),this.set(e)},getProtectionRatio:function(e){var t=s[e];return this.get(t)?this.get(e)/this.get(t):1}});return t.Site=n,t.SiteCollection=i,t.BlacklistedSiteCollection=a,t.SiteStatistics=r,{Site:n,SiteCollection:i,SiteStatistics:r}}),ABINEMASKME.define("abine/models/user",["documentcloud/underscore","models","abine/config","abine/proxies","abine/responseCodes","abine/intl"],function(e,t,n,i,a,s){function r(){}var o=t.BaseModel.extend({initialize:function(){this.messenger=this.getMessenger(),this.hasMany({preferences:{collection:t.PreferenceCollection},shieldedEmails:{collection:t.ShieldedEmailCollection},shieldedPhones:{collection:t.ShieldedPhoneCollection},shieldedCards:{collection:t.ShieldedCardCollection},disposableCards:{collection:t.DisposableCardCollection},disposableEmails:{collection:t.DisposableEmailCollection},disposablePhones:{collection:t.DisposablePhoneCollection},sites:{collection:t.SiteCollection}}),this.hasOne({shieldedEmail:{model:t.ShieldedEmail},shieldedPhone:{model:t.ShieldedPhone},shieldedCard:{model:t.ShieldedCard},disposablePhone:{model:t.DisposablePhone}}),this.bindBroadcasts()
},handleBroadcastMessages:function(e){for(var t in this._associations)this[t]&&this[t].interestedBroadcasts&&this[t].interestedBroadcasts.test(e)&&("hasMany"==this._associations[t]?this[t].fetchAll():this[t].fetch())},hookBroadcastEvent:function(t){var n=this;this.messenger.on(t,e.debounce(function(){n.handleBroadcastMessages(t)},1e3))},bindBroadcasts:function(){this.hookBroadcastEvent("broadcast:preference:reload"),this.hookBroadcastEvent("broadcast:saveForm:new"),this.hookBroadcastEvent("broadcast:saveForm:login"),this.hookBroadcastEvent("broadcast:saveForm:update"),this.hookBroadcastEvent("broadcast:saveForm:rollback"),this.hookBroadcastEvent("broadcast:billinginfo:updated"),this.hookBroadcastEvent("broadcast:register:success"),this.hookBroadcastEvent("response:create:account"),this.hookBroadcastEvent("response:update:account"),this.hookBroadcastEvent("response:delete:account"),this.hookBroadcastEvent("response:create:site"),this.hookBroadcastEvent("response:update:site"),this.hookBroadcastEvent("response:delete:site")},loadAll:function(t){t=t||r;var n=this;e.async.parallel([function(e){n.loadPreferences(e)},function(e){n.loadShieldedEmails(e)},function(e){n.loadShieldedPhones(e)},function(e){n.loadShieldedCards(e)},function(e){n.loadDisposablePhones(e)},function(e){n.detectPrivacySuite(e)},function(e){n.loadDisposableCards(e)},function(e){n.loadDisposableEmails(e)}],e.bind(function(){n.hasRegistered()&&!n.isUninstalled()?n.refreshEntitlements(function(){t()}):t()},this))},loadMin:function(t){t=t||r;var n=this;i.securityManager.isLocked(function(i){var a=[function(e){n.loadPreferences(e)}];i||(a=a.concat([function(e){n.loadShieldedEmails(e)},function(e){n.loadShieldedPhones(e)},function(e){n.loadShieldedCards(e)},function(e){n.loadDisposablePhones(e)},function(e){n.loadDisposableCards(e,!0)},function(e){n.loadDisposableEmails(e,!0)}])),a.push(function(e){n.detectPrivacySuite(e)}),e.async.parallel(a,e.bind(function(){t(),i||n.hasRegistered()&&!n.isUninstalled()&&n.refreshEntitlements(function(){})},this))})},sendPasswordResetEmail:function(t){i.licenseModule.sendResetPasswordEmail({email:t},e.bind(function(e){if(e){var t=e.errorCode;t==a.UNKNOWN_ERROR?this.trigger("resetPasswordEmailFailed"):t==a.MISSING_PARAMETERS?this.trigger("resetPasswordBadEmail"):t==a.NO_ACCOUNT_FOUND_FOR_EMAIL?this.trigger("resetPasswordBadEmail"):this.trigger("resetPasswordEmailFailed")}else this.trigger("resetPasswordEmailSent")},this))},getEmailAddress:function(){return this.shieldedEmail.get("email")},getUpgradeLink:function(e){var t=n.protocol+n.licenseServerHost+"/subscriptions/id_me?auth_token="+this.getAuthToken()+"&email="+this.getEmailAddress();return e&&e.feature&&(t+="&feature="+e.feature),(this.hasRegEmail()||this.hasRegPassword())&&(t+="&notsetup=true"),t},getPremiumLink:function(){var e=n.protocol+n.licenseServerHost+"/subscriptions/id_me/new?subscription_type=premium&auth_token="+this.getAuthToken()+"&email="+this.getEmailAddress();return e},getManageLink:function(){return n.protocol+n.licenseServerHost+"/subscriptions/billing?auth_token="+this.getAuthToken()+"&email="+this.getEmailAddress()},getSubscriptionLink:function(){return this.isEntitledToPhone()?this.getManageLink():this.getUpgradeLink()},getSubscriptionText:function(){return this.isEntitledToPhone()?s.getText("mm_user_show_subscriptionPremium"):this.isEntitledToSync()?s.getText("mm_user_show_subscriptionOnline"):s.getText("mm_user_show_subscriptionFree")},getUpdateCardLink:function(){return n.protocol+n.licenseServerHost+"/subscriptions/billing_info/edit?auth_token="+this.getAuthToken()+"&email="+this.getEmailAddress()},getDisposablePhoneNumber:function(){return this.hasShieldedPhone()&&this.hasDisposablePhone()?this.disposablePhone.getPrettyNumber():"It's time to get your Masked Phone number set up. "},getShieldedPhoneNumber:function(){return this.hasShieldedPhone()&&this.hasDisposablePhone()?this.shieldedPhone.getPrettyNumber():"It's time to get your Masked Phone number set up. "},getShieldedCardLastFour:function(){return this.shieldedCard?this.shieldedCard.getLastFour():""},getPhoneButtonTxt:function(){return this.hasShieldedPhone()?"Change":"Setup"},loadShieldedEmails:function(t){t=t||r,this.shieldedEmails.fetchAll({success:e.bind(function(){var e=this.shieldedEmails.at(0);this.setShieldedEmail(e?e.attributes:null),t()},this),error:e.bind(function(){t()},this)})},loadShieldedCards:function(n){n=n||r,this.shieldedCards.fetchAll({success:e.bind(function(){var e=this.shieldedCards.length>0?this.shieldedCards.at(0):new t.ShieldedCard;this.setShieldedCard(e.attributes),n()},this),error:e.bind(function(){n()},this)})},loadShieldedPhones:function(t){t=t||r,this.shieldedPhones.fetchAll({success:e.bind(function(){var e=this.shieldedPhones.find(function(e){return e.isTrue("is_validated")});this.setShieldedPhone(e?e.attributes:null),t()},this),error:e.bind(function(){t()},this)})},loadDisposablePhones:function(t){t=t||r,this.disposablePhones.fetchAll({success:e.bind(function(){var e=this.disposablePhones.at(0);this.setDisposablePhone(e?e.attributes:null),t()},this),error:e.bind(function(){t()},this)})},loadDisposableEmails:function(t,n){t=t||r,this.disposableEmails[n?"fetchAllLocal":"fetchAll"]({success:e.bind(function(){t()},this),error:e.bind(function(){t()},this)})},loadDisposableCards:function(t,n){t=t||r,this.disposableCards[n?"fetchAllLocal":"fetchAll"]({localOnly:n,success:e.bind(function(){t()},this),error:e.bind(function(){t()},this)})},loadPreferences:function(t){t=t||r,this.preferences.fetchAll({success:e.bind(function(){t()},this),error:e.bind(function(){t()})})},loadSites:function(t){t=t||r,this.sites.fetchAll({success:e.bind(function(){t()},this),error:e.bind(function(){t()})})},refreshEntitlements:function(t){t=t||r,i.licenseModule.refreshEntitlements(e.bind(function(){this.preferences.fetchAll({success:function(){t()},error:function(){t()}})},this))},getRegEmail:function(){return this.hasRegEmail()?this.preferences.getPref("regEmail"):""},getRegPassword:function(){return this.hasRegPassword()?this.preferences.getPref("regPassword"):""},hasRegEmail:function(){return 0==this.preferences.length?null:this.preferences.hasPref("regEmail")},hasRegPassword:function(){return 0==this.preferences.length?null:this.preferences.hasPref("regPassword")},isEntitledToSync:function(){return 0==this.preferences.length?null:this.preferences.isPrefTrue("entitledToSync")},isEntitledToPayments:function(){return 0==this.preferences.length?null:this.preferences.isPrefTrue("entitledToPayments")},isEntitledToPhone:function(){return 0==this.preferences.length?null:this.preferences.isPrefTrue("entitledToPhone")},isUninstalled:function(){return 0==this.preferences.length?null:this.preferences.isPrefTrue("uninstalled")},getPasswordHint:function(){return 0==this.preferences.length||this.preferences.getPref("passwordHint")&&(0==this.preferences.getPref("passwordHint").length||"null"===this.preferences.getPref("passwordHint").toLowerCase())?null:this.preferences.getPref("passwordHint")},hasTimelineEnabled:function(){return this.preferences.isPrefTrue("enablePrivacyTimeline")},hasSyncEnabled:function(){return this.preferences.isPrefTrue("enableSyncButton")},hasEnabledPayments:function(){return this.preferences.isPrefTrue("hasEnabledPayments")},hasRegistered:function(){return this.preferences.isPrefTrue("hasRegistered")},hasPostinstallFlowNotCompleted:function(){return this.preferences.isPrefTrue("postinstallFlowNotCompleted")},registerInProgress:function(){return this.preferences.isPrefTrue("registerInProgress")},resetPasswordInProgress:function(){return this.preferences.isPrefTrue("resetPasswordInProgress")},isSyncDirty:function(){return 0==this.preferences.length?!1:this.hasLastSync()&&this.hasLastLocalModifiedAt()?this.getLastSync()<this.getLastLocalModifiedAt():!1},hasLastSync:function(){return 0==this.preferences.length?!1:this.preferences.getPref("lastSync")?!0:!1},hasLastLocalModifiedAt:function(){return 0==this.preferences.length?!1:this.preferences.getPref("lastLocalModifiedAt")?!0:!1},getLastLocalModifiedAt:function(){return Math.floor(this.preferences.getPref("lastLocalModifiedAt"))},getLastSync:function(){return Math.floor(this.preferences.getPref("lastSync"))},hasRegisteredForSync:function(){return 0==this.preferences.length?null:this.preferences.isPrefTrue("hasRegisteredSync")},isAuthenticated:function(){if(0==this.preferences.length)return null;var e=this.preferences.getPref("authToken");return e&&e.length>0},getAuthToken:function(){if(0==this.preferences.length)return null;var e=this.preferences.getPref("authToken");return e},setSeenNotificationsGrowlPref:function(){this.preferences.length>0&&this.preferences.setPref("seenNotificationsGrowl",!0)},hasSeenNotificationsGrowl:function(){return 0==this.preferences.length?null:this.preferences.isPrefTrue("seenNotificationsGrowl")},setSeenLoginsGrowlPref:function(){this.preferences.length>0&&this.preferences.setPref("seenLoginsGrowl",!0)},hasSeenLoginsGrowl:function(){return 0==this.preferences.length?null:this.preferences.isPrefTrue("seenLoginsGrowl")},setAccountSortPref:function(e){if(this.preferences.hasPref("accountsSortOrder"))this.preferences.setPref("accountsSortOrder",e);else{var n=new t.Preference({key:"accountsSortOrder",value:e});this.preferences.add(n),n.save()}},getAccountSortPref:function(e){return this.preferences.hasPref("accountsSortOrder")?this.preferences.getPref("accountsSortOrder"):e},turnOffNotifications:function(){this.preferences.length>0&&this.preferences.setPref("showNotifications",!1)},rememberOnlyMaskMe:function(){this.preferences.length>0&&this.preferences.setPref("rememberOnlyMaskMe",!0)},hasPassword:function(){return 0==this.preferences.length?null:this.preferences.isPrefTrue("hasPassword")},hasShieldedEmail:function(){return this.shieldedEmail&&this.shieldedEmail.get("active")},hasShieldedPhone:function(){return this.shieldedPhone&&"true"==this.shieldedPhone.get("is_validated")},hasDisposablePhone:function(){return this.disposablePhone},shouldSendErrorReports:function(){return 0==this.preferences.length?null:this.preferences.isPrefTrue("shouldSendErrorReports")},getEmailSalt:function(){return 0==this.preferences.length?null:this.preferences.getPref("Salt.ShieldedEmail")},getGUIDs:function(){var e={};return this.isEntitledToPhone()&&this.shieldedPhone&&(e.disposable_phone_id=this.disposablePhone.get("rails_id"),e.shielded_phone_id=this.shieldedPhone.get("rails_id")),e.shielded_email_guid=this.shieldedEmail.get("guid"),e},detectPrivacySuite:function(e){if(e=e||r,this._privacySuiteCheckDone)e();else if(this._privacySuiteCheckDone=!0,this._hasPrivacySuite=!1,this._privacySuiteAddonName="","undefined"!=typeof Components)try{var t={},n=this;Components.utils["import"]("resource://abine/modules/global.js",t),Components.utils["import"]("resource://gre/modules/AddonManager.jsm",t),t.AddonManager.getAddonByID(t.Abine.ExtensionID,function(t){t&&(n._hasPrivacySuite=!0,n._privacySuiteAddonName=t.name),e()})}catch(i){e()}else e()},canImportFromPrivacySuite:function(){return this._hasPrivacySuite},getPrivacySuiteAddonName:function(){return this._privacySuiteAddonName},clone:function(){var e=new this.constructor(this);return e}});return t.User=o,o}),ABINEMASKME.define("abine/models/userInfo",["documentcloud/underscore","documentcloud/backbone","models","abine/proxies"],function(e,t,n,i){var a=t.Model.extend({initialize:function(){},load:function(t){t=t||{};var a=new n.ShieldedEmailCollection;a.fetchAll({success:e.bind(function(){a.length>0?(this.shieldedEmailModel=a.at(0),this.attributes.shieldedEmail=this.shieldedEmailModel.getAddress()):(this.shieldedEmailModel=new n.ShieldedEmail,this.attributes.shieldedEmail=null),this.checkLoaded(t)},this),error:function(){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/userInfo]#[load]# error event in shieldedEmails.fetchAll")}});var s=new n.ShieldedPhoneCollection;s.fetchAll({success:e.bind(function(){s.length>0?(this.shieldedPhoneModel=s.at(0),this.attributes.shieldedPhone=this.shieldedPhoneModel.getPrettyNumber()):(this.shieldedPhoneModel=new n.ShieldedPhone,this.attributes.shieldedPhone=null),this.checkLoaded(t)},this),error:function(){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/userInfo]#[load]# error event in shieldedPhones.fetchAll")}}),i.securityManager.hasPassword(e.bind(function(e){this.set({hasPassword:e}),this.checkLoaded(t)},this)),i.securityManager.hasRegisteredSync(e.bind(function(e){this.set({hasRegisteredSync:e}),this.checkLoaded(t)},this)),i.securityManager.needsToChangePassword(e.bind(function(e){this.set({needsToChangePassword:e}),this.checkLoaded(t)},this)),t.loadDisposablePhone&&this.loadDisposablePhone(e.bind(function(){this.checkLoaded(t)},this))},loadDisposablePhone:function(t){var i=new n.DisposablePhoneCollection;i.fetchAll({success:e.bind(function(){i.length>0?(this.disposablePhoneModel=i.at(0),this.attributes.disposablePhone=this.disposablePhoneModel.getPrettyNumber()):(this.disposablePhoneModel=new n.DisposablePhone,this.attributes.disposablePhone=null),this.trigger("disposablePhoneLoaded"),t()},this),error:function(){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/userInfo]#[load]# error event in disposablePhones.fetchAll")}})},checkLoaded:function(e){this.isLoaded(e)&&this.trigger("loaded",this)},isLoaded:function(e){var t=this.attributes.hasOwnProperty("hasPassword")&&this.attributes.hasOwnProperty("shieldedEmail")&&this.attributes.hasOwnProperty("shieldedPhone")&&this.attributes.hasOwnProperty("hasRegisteredSync");return e.loadDisposablePhone&&!this.attributes.hasOwnProperty("disposablePhone")&&(t=!1),t},showPhoneValidationMsg:function(){return this.shieldedPhoneModel?0==this.shieldedPhoneModel.get("active"):!1},showEmailValidationMsg:function(){return this.shieldedEmailModel?0==this.shieldedEmailModel.get("active"):!1},isSetup:function(){return!!this.get("shieldedEmail")&&!!this.shieldedEmailModel.get("active")},clone:function(){var e=new this.constructor(this);return e.namePreference=this.namePreference,e.shieldedEmailModel=this.shieldedEmailModel,e.shieldedPhoneModel=this.shieldedPhoneModel,e}});return n.UserInfo=a,{UserInfo:a}}),ABINEMASKME.define("abine/models/userPhone",["documentcloud/underscore","models","abine/intl"],function(e,t,n){var i=t.BaseModel.extend({initialize:function(){this.messenger=this.getMessenger()},save:function(){var e=this;this.attributes,this.messenger.on("serverResponse:users:changePhone",function(t){e.messenger.off("serverResponse:users:changePhone"),200==t.status||201==t.status?(e.trigger("sync:success",t),e.trigger("changePhoneComplete")):401==t.status||(e.errorMessage=n.getText("mm_ServerError"),e.trigger("sync:error",t)),e.trigger("sync:complete")}),this.messenger.send("server:users:changePhone",this.attributes),this.trigger("sync:update")}});return t.UserPhone=i,i}),ABINEMASKME.define("abine/models/feedback",["documentcloud/underscore","documentcloud/backbone","models"],function(e,t,n){var i=n.BaseModel.extend({initialize:function(){},getSuccessLeadMsg:function(){return this.attributes.leadMsg},getSuccessMsg:function(){return this.attributes.successMsg},clone:function(){var e=new this.constructor(this);return e.user=this.user,e}});return n.Feedback=i,{Feedback:i}}),ABINEMASKME.define("abine/models/cardTransaction",["documentcloud/underscore","models","jquery"],function(e,t){var n=t.BaseModel.extend({storageEntity:"cardTransaction",initialize:function(){},getDate:function(){var e=new Date(this.get("date"));return e.toDateString()}}),i=t.BaseCollection.extend({model:n,initialize:function(){},fetchAllByCardId:function(t,n){this.sync("read",this,{eventName:"read:cardTransaction:card:"+t,success:e.bind(function(e){this.reset(e),n.success(e)},this),error:function(){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/cardTransaction]#[fetchAllByCardId]# error event in model.sync eventName: read:transactions:card:id"),n.error()}})}});return t.CardTransaction=n,t.CardTransactionCollection=i,{CardTransaction:n,CardTransactionCollection:i}}),ABINEMASKME.define("abine/models/privacysuite",["documentcloud/underscore","models","abine/config","abine/proxies"],function(e,t){var n=t.BaseModel.extend({}),i=t.BaseCollection.extend({model:n}),a=t.BaseModel.extend({initialize:function(){this.hasMany({fields:{collection:i}})}}),s=t.BaseCollection.extend({model:a}),r=t.BaseModel.extend({initialize:function(){this.hasMany({accounts:{collection:s}})},numAccounts:function(){return this.accounts.length}}),o=t.BaseCollection.extend({model:r}),l=t.BaseModel.extend({initialize:function(){this.loaded=!1,this.messenger=this.getMessenger(),this.hasMany({sites:{collection:o}}),this.hasOne({})},load:function(e){var t={};Components.utils["import"]("resource://abine/modules/global.js",t),this._loginRequired=t.Abine.SecurityManager.isLoginRequired("master")?!0:!1,this._loginRequired||this.loadPrivacySuiteSites(t.Abine),e&&e()},loadPrivacySuiteSites:function(e){var t=e.Model.Site.doSelect("where id in (select site_id from info_card where type = 'login') order by name_order"),n=e.Model.InfoCard.doSelect("where type = 'login'"),i=e.Model.InfoCardField.doSelect("where info_card_id in (select id from info_card where type = 'login')"),s=0;this.sites.reset();for(var o=0;t.length>o;o++){for(var l=t[o],c=new r({id:l.id(),name:l.name(),domain:l.domain()}),d=0;n.length>d;d++){var u=n[d];if(u.site_id()==l.id()){for(var h=new a({id:u.id(),name:u.name(),domain:l.domain()}),p=0;i.length>p;p++){var f=i[p];f.info_card_id()==u.id()&&h.fields.add({id:f.id(),name:f.name(),value:f.value(),type:f.type(),data_type:f.data_type()})}s++,c.accounts.add(h)}}this.sites.add(c)}this._totalAccounts=s},getTotalAccounts:function(){return this._totalAccounts},getPrivacySuiteAddonName:function(){return ABINEMASKME.user.getPrivacySuiteAddonName()},canImportAccounts:function(){return!this._loginRequired&&this._totalAccounts>0},isLoginRequired:function(){return this._loginRequired},clone:function(){var e=new this.constructor(this);return e}});return t.PrivacySuite=l,l}),ABINEMASKME.define("abine/models/webmail",["models","documentcloud/underscore"],function(e,t){var n=e.BaseModel.extend({storageEntity:"webmail",initialize:function(){},getFrom:function(){var e="Unknown";if(this.has("from"))if(this.get("from").indexOf("@")>=0){var t=this.get("from").split("@");e=t.length>1&&t[0].length>12?t[0].substring(0,12)+"..."+"@"+t[1]:this.get("from")}else e=this.get("from");return e},fetchMail:function(e){this.cachedMail?e.success(this.cachedMail):this.sync("read",this,{eventName:"read:webmail:"+this.get("mid"),success:t.bind(function(t){this.cachedMail=t,e.success(t)},this),error:e.error})},receivedMS:function(){return 1e3*parseInt(this.get("received"))}}),i=e.BaseCollection.extend({model:n,initialize:function(){this.messenger=this.getMessenger()}});return e.Webmail=n,e.WebmailCollection=i,{Webmail:n,WebmailCollection:i}}),ABINEMASKME.define("models",[],function(){return{}}),ABINEMASKME.requireModels=function(e){ABINEMASKME.require(["abine/models/base","abine/models/account","abine/models/accountActivity","abine/models/accountField","abine/models/disposableCard","abine/models/disposableEmail","abine/models/disposablePhone","abine/models/phoneLog","abine/models/preference","abine/models/mappedForm","abine/models/mappedField","abine/models/shieldedCard","abine/models/shieldedEmail","abine/models/shieldedPhone","abine/models/site","abine/models/user","abine/models/userInfo","abine/models/userPhone","abine/models/feedback","abine/models/cardTransaction","abine/models/privacysuite","abine/models/webmail"],function(){e()})},ABINEMASKME.CompiledTemplates=ABINEMASKME.CompiledTemplates||{},ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/account/account"]=e.template(function(e,t,n,i,a){function s(e){var t,i,a="";return a+='\n        <div class="maskStatus">\n            <span class="label label-success"><a class="noDec" href="https://www.abine.com/maskme/faq/#maskedaccounts" target="_blank">',t="mm_account_maskedAccount",A=n.intl,i=A||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===w?i.call(e,t,{hash:{}}):i===k?S.call(e,"intl",t,{hash:{}}):i,a+=I(t)+"</a></span>\n        </div>\n     "}function r(e){var t,i,a="";return a+='\n        <div class="maskStatus">\n            <span class="label"><a class="noDec" href="https://www.abine.com/maskme/faq/#maskedaccounts" target="_blank">',t="mm_account_unmaskedAccount",A=n.intl,i=A||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===w?i.call(e,t,{hash:{}}):i===k?S.call(e,"intl",t,{hash:{}}):i,a+=I(t)+"</a></span>\n        </div>\n     "}function o(e,t){var i,a,s="";return s+="\n                ",A=n.emailExposed,i=A||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"emailExposed"),a=n["if"],E=_.program(6,l,t),E.hash={},E.fn=E,E.inverse=_.program(8,c,t),i=a.call(e,i,E),(i||0===i)&&(s+=i),s+="\n              "}function l(e){var t,i,a="";return a+='\n                  <li><a id="deleteExceptEmail" href=#>',t="mm_account_removeAccount",A=n.intl,i=A||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===w?i.call(e,t,{hash:{}}):i===k?S.call(e,"intl",t,{hash:{}}):i,a+=I(t)+"</a></li>\n                "}function c(e){var t,i,a="";return a+='\n                  <li><a href="#holdOnMaskedEmail',A=n.getId,t=A||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getId"),typeof t===w?t=t.call(e,{hash:{}}):t===k&&(t=S.call(e,"getId",{hash:{}})),a+=I(t)+'" data-toggle="modal">',t="mm_account_removeAccount",A=n.intl,i=A||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===w?i.call(e,t,{hash:{}}):i===k?S.call(e,"intl",t,{hash:{}}):i,(t||0===t)&&(a+=t),a+="</a></li>\n                "}function d(e){var t,i,a="";return a+='\n                  <li><a id="deleteExceptEmail" href=#>',t="mm_account_removeAccount",A=n.intl,i=A||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===w?i.call(e,t,{hash:{}}):i===k?S.call(e,"intl",t,{hash:{}}):i,a+=I(t)+"</a></li>\n              "}function u(e,t){var i,a,s="";return s+="\n      ",A=n.showEdit,i=A||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"showEdit"),a=n["if"],E=_.program(13,h,t),E.hash={},E.fn=E,E.inverse=_.program(15,p,t),i=a.call(e,i,E),(i||0===i)&&(s+=i),s+="\n    "}function h(){return"\n      "}function p(e){var t,i,a="";return a+='\n        <div id="uhoh">\n          ',t="mm_account_uhoh",A=n.intl,i=A||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===w?i.call(e,t,{hash:{}}):i===k?S.call(e,"intl",t,{hash:{}}):i,a+=I(t)+'\n          <a href="https://www.abine.com/maskme/faq/" target="_blank">',t="mm_account_what",A=n.intl,i=A||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===w?i.call(e,t,{hash:{}}):i===k?S.call(e,"intl",t,{hash:{}}):i,a+=I(t)+'</a>\n          <span class="accountEdit fieldIcon"><i class="icon-pencil"></i></span>\n        </div>\n      '}function f(e){var t,i,a="";return a+="\n      ",t="fieldList",A=n.child,i=A||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"child"),t=typeof i===w?i.call(e,t,{hash:{}}):i===k?S.call(e,"child",t,{hash:{}}):i,a+=I(t)+"\n    "}function m(e,t){var i,a,s="";return s+="\n      ",A=n.isIncompleteAccount,i=A||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"isIncompleteAccount"),a=n["if"],E=_.program(20,g,t),E.hash={},E.fn=E,E.inverse=_.noop,i=a.call(e,i,E),(i||0===i)&&(s+=i),s+="\n      ",i="optionalFields",A=n.child,a=A||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"child"),i=typeof a===w?a.call(e,i,{hash:{}}):a===k?S.call(e,"child",i,{hash:{}}):a,s+=I(i)+'\n      <div id="editButtons">\n        <button id="cancelEdit" class="btn btn-small btn-inverse">\n            ',i="mm_account_cancel",A=n.intl,a=A||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===w?a.call(e,i,{hash:{}}):a===k?S.call(e,"intl",i,{hash:{}}):a,s+=I(i)+'\n        </button>\n        <button id="saveNewValue" class="btn btn-small btn-success">\n            ',i="mm_account_save",A=n.intl,a=A||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===w?a.call(e,i,{hash:{}}):a===k?S.call(e,"intl",i,{hash:{}}):a,s+=I(i)+"\n        </button>\n      </div>\n    "}function g(e){var t,i,a="";return a+='\n        <div id="addFields">',t="mm_account_addFields",A=n.intl,i=A||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===w?i.call(e,t,{hash:{}}):i===k?S.call(e,"intl",t,{hash:{}}):i,a+=I(t)+"</div>\n      "}n=n||e.helpers;var b,y,v,A,E,M="",_=this,w="function",S=n.helperMissing,k=void 0,I=this.escapeExpression;return M+='<div class="row">\n  <div class="span8">\n     ',A=n.isFullyProtected,b=A||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"isFullyProtected"),y=n["if"],E=_.program(1,s,a),E.hash={},E.fn=E,E.inverse=_.program(3,r,a),b=y.call(t,b,E),(b||0===b)&&(M+=b),M+='\n    <span class="time-ago"><i class="icon-time"></i>',b="mm_account_lastUpdated",A=n.intl,y=A||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),b=typeof y===w?y.call(t,b,{hash:{}}):y===k?S.call(t,"intl",b,{hash:{}}):y,M+=I(b)+" &nbsp;",b="modifiedAt",A=n.live_timestamp,y=A||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"live_timestamp"),b=typeof y===w?y.call(t,b,{hash:{}}):y===k?S.call(t,"live_timestamp",b,{hash:{}}):y,M+=I(b)+'</span>\n    <span class="questionAccount" id="paneHover">\n        <a href="https://www.abine.com/maskme/faq/#incorrectaccount" target="_blank">\n            <img src="',b="/pages/images/manage/dd_question_icon.png",A=n.assetUrl,y=A||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),b=typeof y===w?y.call(t,b,{hash:{}}):y===k?S.call(t,"assetUrl",b,{hash:{}}):y,M+=I(b)+'"/>\n        </a>\n    </span>\n    <span class="deleteAccount dropdown">\n          <a class="close dropdown-toggle" data-toggle="dropdown"><i class="icon-trash"></i></a>\n          <ul class="dropdown-menu">\n              ',A=n.getEmail,b=A||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getEmail"),y=n["if"],E=_.program(5,o,a),E.hash={},E.fn=E,E.inverse=_.program(10,d,a),b=y.call(t,b,E),(b||0===b)&&(M+=b),M+='\n              <li><a href="#holdOnCowboy',A=n.getId,b=A||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getId"),typeof b===w?b=b.call(t,{hash:{}}):b===k&&(b=S.call(t,"getId",{hash:{}})),M+=I(b)+'" data-toggle="modal">',A=n.getDomain,b=A||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getDomain"),y="mm_account_hideSite",A=n.intl,v=A||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),b=typeof v===w?v.call(t,y,b,{hash:{}}):v===k?S.call(t,"intl",y,b,{hash:{}}):v,(b||0===b)&&(M+=b),M+="\n              </a></li>\n          </ul>\n    </span>\n    ",b="cowboy",A=n.child,y=A||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),b=typeof y===w?y.call(t,b,{hash:{}}):y===k?S.call(t,"child",b,{hash:{}}):y,M+=I(b)+"\n    ",b="maskedemail",A=n.child,y=A||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),b=typeof y===w?y.call(t,b,{hash:{}}):y===k?S.call(t,"child",b,{hash:{}}):y,M+=I(b)+"\n    ",b="passwordlessCowboy",A=n.child,y=A||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),b=typeof y===w?y.call(t,b,{hash:{}}):y===k?S.call(t,"child",b,{hash:{}}):y,M+=I(b)+"\n    ",A=n.isEmptyAccount,b=A||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"isEmptyAccount"),y=n["if"],E=_.program(12,u,a),E.hash={},E.fn=E,E.inverse=_.program(17,f,a),b=y.call(t,b,E),(b||0===b)&&(M+=b),M+="\n    ",A=n.showEdit,b=A||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"showEdit"),y=n["if"],E=_.program(19,m,a),E.hash={},E.fn=E,E.inverse=_.noop,b=y.call(t,b,E),(b||0===b)&&(M+=b),M+="\n  </div>\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/account/account"]}),ABINEMASKME.define("abine/views/account",["jquery","models","duckbone/core","documentcloud/underscore","abine/proxies","abine/views/recheck","abine/views/holdOnCowboyView","abine/intl","abine/views/holdOnPasswordlessView","abine/views/holdOnMaskedEmailView"],function(e,t,n,i,a,s,r,o,l,c){var d=n.View.extend({tagName:"li",templateName:"account_one",events:{"click .toggleShowPassword":"checkAndTogglePassword","click .editField":"checkAndShowEditField"},afterInitialize:function(){},createChildren:function(){},render:function(){return this.model?("/password"===this.model.get("dataType")&&(this.templateName="account_password"),this.renderTemplate(),this.model.clicked&&(this.focusNewValue(),this.model.clicked=!1),this):this},getDataType:function(){return this.model.get("dataType")},getNewValue:function(){return e(this.el).find("#newValue").val()},getOldValue:function(){return this.model.attributes.value},focusNewValue:function(){i.defer(i.bind(function(){e(this.el).find("#newValue").focus()},this))},saveNewValue:function(){this.model.set({value:this.getNewValue(),silent:!0}),"/contact/email"===this.getDataType()&&this.model.set({origin:""}),this.model.save(),this.model.showEdit=!1,this.model.shownPassword=!1,this.render()},removeValue:function(){this.model.deleteVersioned({success:i.bind(function(){},this),error:i.bind(function(){e(".errorDiv").show(),e("body").scrollTop(0)})})},cancelEdit:function(){this.model.showEdit=!1,this.model.shownPassword=!1,this.render()},showEditField:function(){this.model.shownPassword=!0,this.model.showEdit=!0},triggerEditField:function(){this.model.clicked=!0,this.trigger("account:edit")},toggleShowPassword:function(){this.model.shownPassword=!this.model.shownPassword,this.render()},recheckPassword:function(t,n,i){var a=new s({element:t,callback:n,label:i});e("body").append(a.el)},checkAndShowEditField:function(e){a.securityManager.passwordValidationRequired(i.bind(function(t){t?this.recheckPassword(e.target,i.bind(this.triggerEditField,this),o.getText("mm_recheck_edit")):this.triggerEditField()},this))},checkAndTogglePassword:function(e){this.model.shownPassword?this.toggleShowPassword():a.securityManager.passwordValidationRequired(i.bind(function(t){t?this.recheckPassword(e.target,i.bind(this.toggleShowPassword,this),o.getText("mm_recheck_view")):this.toggleShowPassword()},this))}}),u=n.View.extend({tagName:"li",templateName:"account_one_add",getValue:function(){return e(this.el).find("#newValue").val()},getDataType:function(){return this.model.get("dataType")}}),h=n.ListView.extend({tagName:"ul",viewClass:d}),p=n.ListView.extend({tagName:"ul",viewClass:u}),f=n.View.extend({templateName:"account_account",events:{"click #deleteAccount":"deleteAccount","click #deleteExceptEmail":"deleteExceptEmail","click #deleteEverythingBtn":"blacklistSite","click #accountEdit":"showEdit","click #cancelEdit":"cancelEdit","click #saveNewValue":"saveNewValues","click #saveFromCowboy":"forceSaveNewValues"},afterInitialize:function(){},createChildren:function(){var e={};this.model.accountFields.sanitizeForAccountView(),this.list=new h({collection:this.model.accountFields});var t={};return i.each(this.list.collection.models,function(e){t[e.get("dataType")]=!0;var n=this.list.getViewByModel(e);n.bind("account:edit",function(){this.showEdit()},this),n.bind("account:rerender",function(){delete this.model.waitToRender,this.render()},this)},this),e.fieldList=this.list,e.optionalFields=this.getAdditionalFields(t),e.cowboy=new r({model:this.model}),e.maskedemail=new c({model:this.model}),e.passwordlessCowboy=new l({model:this.model}),e},getAdditionalFields:function(e){var n=new t.AccountFieldCollection;return e["/nameperson/friendly"]||n.add(new t.AccountField({dataType:"/nameperson/friendly"})),e["/contact/email"]||n.add(new t.AccountField({dataType:"/contact/email"})),e["/contact/phone"]||n.add(new t.AccountField({dataType:"/contact/phone"})),e["/password"]||n.add(new t.AccountField({dataType:"/password"})),this.addFieldsList=new p({collection:n}),this.addFieldsList},render:function(){return this.model?("undefined"==typeof this.model.hasAReusedPassword&&this.model.passwordReused(),this.renderTemplate(),this):this},recheckPassword:function(t,n,i){var a=new s({element:t,callback:n,label:i});e("body").append(a.el)},deleteAccount:function(){e(this.el).find("#holdOnMaskedEmail"+this.model.getId()).modal("hide");var t=e(".account_account",this.el.parentNode).length>1,n="sites";t&&(n="sites/"+this.model.site.id),this.model.destroy({success:i.bind(function(){ABINEMASKME.App.navigate(n,!0)},this),error:i.bind(function(){e(".errorDiv").show(),e("body").scrollTop(0)},this)})},deleteExceptEmail:function(){e(this.el).find("#holdOnMaskedEmail"+this.model.getId()).modal("hide");var t=e(".account_account",this.el.parentNode).length>1,n="sites";t&&(n="sites/"+this.model.site.id),this.model.deleteExceptEmail({success:i.bind(function(){this.model.collection.remove(this.model)},this),error:i.bind(function(){e(".errorDiv").show(),e("body").scrollTop(0)})})},blacklistSite:function(){e(this.el).find("#holdOnCowboy"+this.model.getId()).modal("hide");var t=this.model;t.site.blacklist({success:i.bind(function(){ABINEMASKME.App.navigate("blacklist",!0)
},this),error:i.bind(function(){e(".errorDiv").show(),e("body").scrollTop(0)},this)})},showEdit:function(){this.model.showEdit=!0,i.each(this.list.collection.models,function(e){var t=this.list.getViewByModel(e);t.showEditField()},this),this.render()},cancelEdit:function(){this.model.showEdit=!1,i.each(this.list.collection.models,function(e){var t=this.list.getViewByModel(e);t.cancelEdit()},this),this.render()},saveNewValues:function(t){this.model.showEdit=!1,t=t||{force:!1};var n=!1,a=[],s=[],r=[],o=[];i.each(this.list.collection.models,function(e){var t=this.list.getViewByModel(e);""===t.getNewValue()?("/password"==t.getDataType()&&(n=!0),a.push(t)):t.getNewValue()!==t.getOldValue()?s.push(t):r.push(t)},this),i.each(this.addFieldsList.collection.models,function(e){var t=this.addFieldsList.getViewByModel(e);t.getValue()&&""!==t.getValue()&&o.push(t)},this),0===s.length&&0===r.length&&0===o.length?this.model.emailExposed()?this.deleteAccount():e("#holdOnMaskedEmail"+this.model.get("id")).modal("show"):!t.force&&n?e("#holdOnPasswordless"+this.model.get("id")).modal("show"):(i.each(a,function(e){e.removeValue()},this),i.each(s,function(e){e.saveNewValue()},this),i.each(r,function(e){e.cancelEdit()},this),i.each(o,function(e){this.model.addAccountFieldValue(e.getDataType(),e.getValue())},this),this.render(),window.location.reload())},forceSaveNewValues:function(){e("#holdOnPasswordless"+this.model.get("id")).modal("hide"),this.saveNewValues({force:!0})}});return n.Security.showLoginWhenLocked(f),f}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/account/one"]=e.template(function(e,t,n,i,a){function s(e){var t,i="";return i+='\n        <div class="span2 fieldName">\n            ',c=n.prettyFieldName,t=c||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"prettyFieldName"),typeof t===p?t=t.call(e,{hash:{}}):t===m&&(t=f.call(e,"prettyFieldName",{hash:{}})),i+=g(t)+':\n        </div>\n        <div class="span5 fieldData">\n            <input type="text" id="newValue" value="',c=n.safeFieldValue,t=c||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"safeFieldValue"),typeof t===p?t=t.call(e,{hash:{}}):t===m&&(t=f.call(e,"safeFieldValue",{hash:{}})),i+=g(t)+'" />\n        </div>\n    '}function r(e){var t,i="";return i+='\n        <div class="span2 fieldName">\n            ',c=n.prettyFieldName,t=c||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"prettyFieldName"),typeof t===p?t=t.call(e,{hash:{}}):t===m&&(t=f.call(e,"prettyFieldName",{hash:{}})),i+=g(t)+':\n        </div>\n        <div class="span5 fieldData">\n            <input type="text" value="',c=n.safeFieldValue,t=c||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"safeFieldValue"),typeof t===p?t=t.call(e,{hash:{}}):t===m&&(t=f.call(e,"safeFieldValue",{hash:{}})),i+=g(t)+'" readonly/>\n            <span class="editField fieldIcon"><i class="icon-pencil"></i></span>\n        </div>\n    '}n=n||e.helpers;var o,l,c,d,u="",h=this,p="function",f=n.helperMissing,m=void 0,g=this.escapeExpression;return u+='<div class="row">\n    ',c=n.showEdit,o=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"showEdit"),l=n["if"],d=h.program(1,s,a),d.hash={},d.fn=d,d.inverse=h.program(3,r,a),o=l.call(t,o,d),(o||0===o)&&(u+=o),u+="\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/account/one"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/account/one_add"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s="",r="function",o=n.helperMissing,l=void 0,c=this.escapeExpression;return s+='<div class="row">\n  <div class="span2 fieldName optionalFieldName">\n      ',a=n.prettyFieldName,i=a||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"prettyFieldName"),typeof i===r?i=i.call(t,{hash:{}}):i===l&&(i=o.call(t,"prettyFieldName",{hash:{}})),s+=c(i)+':\n  </div>\n  <div class="span5 fieldData">\n      <input type="text" id="newValue" value="" />\n  </div>\n</div>\n'}),ABINEMASKME.CompiledTemplates["views/account/one_add"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/account/password"]=e.template(function(e,t,n,i,a){function s(e){var t,i="";return i+='\n        <div class="span2 fieldName">\n            ',u=n.prettyFieldName,t=u||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"prettyFieldName"),typeof t===m?t=t.call(e,{hash:{}}):t===b&&(t=g.call(e,"prettyFieldName",{hash:{}})),i+=y(t)+':\n        </div>\n        <div class="span5 fieldData">\n            <input type="text" id="newValue" value="',u=n.safeFieldValue,t=u||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"safeFieldValue"),typeof t===m?t=t.call(e,{hash:{}}):t===b&&(t=g.call(e,"safeFieldValue",{hash:{}})),i+=y(t)+'" />\n        </div>\n        </br>\n    '}function r(e,t){var i,a,s="";return s+='\n        <div class="span2 fieldName">\n            ',u=n.prettyFieldName,i=u||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"prettyFieldName"),typeof i===m?i=i.call(e,{hash:{}}):i===b&&(i=g.call(e,"prettyFieldName",{hash:{}})),s+=y(i)+':\n        </div>\n        <div class="span5 fieldData">\n            <input type="text" value="',u=n.safeFieldValue,i=u||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"safeFieldValue"),typeof i===m?i=i.call(e,{hash:{}}):i===b&&(i=g.call(e,"safeFieldValue",{hash:{}})),s+=y(i)+'" readonly/>\n            <span class="editField fieldIcon"><i class="icon-pencil"></i></span>\n            <span class="toggleShowPassword fieldIcon">\n              ',u=n.shownPassword,i=u||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"shownPassword"),a=n["if"],h=f.program(4,o,t),h.hash={},h.fn=h,h.inverse=f.program(6,l,t),i=a.call(e,i,h),(i||0===i)&&(s+=i),s+="\n            </span>\n        </div>\n        </br>\n    "}function o(){return'\n                <i class="icon-eye-close"></i>\n              '}function l(){return'\n                <i class="icon-eye-open"></i>\n               '}n=n||e.helpers;var c,d,u,h,p="",f=this,m="function",g=n.helperMissing,b=void 0,y=this.escapeExpression;return p+='<div class="row">\n    ',u=n.showEdit,c=u||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"showEdit"),d=n["if"],h=f.program(1,s,a),h.hash={},h.fn=h,h.inverse=f.program(3,r,a),c=d.call(t,c,h),(c||0===c)&&(p+=c),p+="\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/account/password"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/blacklist/add_site"]=e.template(function(e,t,n,i,a){function s(e){var t,i,a="";return a+='\n<fieldset>\n    <div class="control-group">\n        <label>',t="mm_blacklist_ignoreSite",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,a+=m(t)+'</label>\n        <div class="controls">\n            ',t="site",l=n.form_text,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"form_text"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"form_text",t,{hash:{}}):i,a+=m(t)+'\n            <input type="submit" value="" style="display:none;"/>\n            <a href="#" class="addSite btn btn-primary">&nbsp;',t="mm_blacklist_add",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,a+=m(t)+"</a>\n        </div>\n    </div>\n</fieldset>\n"}n=n||e.helpers;var r,o,l,c,d="",u=this,h="function",p=n.helperMissing,f=void 0,m=this.escapeExpression,g=n.blockHelperMissing;return r="blockSite",l=n.form,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"form"),c=u.program(1,s,a),c.hash={},c.fn=c,c.inverse=u.noop,r=l&&typeof o===h?o.call(t,r,c):g.call(t,o,r,c),(r||0===r)&&(d+=r),d+="\n",r="holdOnBlacklist",l=n.child,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),r=typeof o===h?o.call(t,r,{hash:{}}):o===f?p.call(t,"child",r,{hash:{}}):o,d+=m(r)+"\n"}),ABINEMASKME.CompiledTemplates["views/blacklist/add_site"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/blacklist/blacklist"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r,o="",l="function",c=n.helperMissing,d=void 0,u=this.escapeExpression;return o+='<span class="deleteAll dropdown">\n    <a class="btn btn-small dropdown-toggle" data-toggle="dropdown" href="#">\n        <i class="icon-trash"></i>\n        &nbsp;',i="mm_blacklist_clear",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'\n    </a>\n    <ul class="dropdown-menu">\n        <li><a id="clear-blacklist" href=#>',i="mm_blacklist_clearAll",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+"</a></li>\n    </ul>\n</span>\n<h2>",i="mm_blacklist_ignoreAccounts",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+"</h2>\n<p>",i="mm_blacklist_anyWebsites",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'</p>\n<div class="error-notice alert alert-error" style="display: none">\n    ',i="mm_blacklist_errorIgnoreAdd",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'\n</div>\n<div class="empty-notice alert alert-info" style="display: none">\n    ',i="mm_blacklist_emptyIgnoreList",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'\n</div>\n<table class="table table-striped">\n    ',i="tbody",a="siteList",r=n.child,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"child",a,i,{hash:{}}):s,o+=u(i)+"\n</table>\n<div>\n    ",i="addSite",r=n.child,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"child",i,{hash:{}}):a,o+=u(i)+"\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/blacklist/blacklist"]}),ABINEMASKME.define("abine/views/blacklist",["documentcloud/underscore","jquery","models","duckbone/core","wycats/handlebars","abine/url","abine/views/holdOnBlacklistView"],function(e,t,n,i,a,s,r){var o=i.View.extend({tagName:"tr",className:"blacklistRow",templateName:"blacklist_one",events:{"click #item-delete-domain":"deleteDomain"},afterInitialize:function(){},deleteDomain:function(){t(document).find("div.error-notice").hide(),this.model.destroy({success:e.bind(function(){t(this.el).hide()},this),error:function(){}})}}),l=i.ListView.extend({tagName:"tbody",viewClass:o,clearBlacklist:function(n){t(document).find("div.error-notice").hide();var i=[];e.each(this.collection.models,function(e){i.push(e)}),e.async.forEach(i,function(t,n){t.destroy({success:e.bind(function(){n()},this),error:e.bind(function(e){n(e)},this)})},e.bind(function(t){t&&true&&ABINEMASKME.log.error("[ERROR CALLBACK]#[abine/views/blacklist]#[clearkBlacklist]# error while clearing blacklisted sites"),this.collection.fetchAllForBlacklistedPage(e.bind(function(){n()},this))},this))}}),c=i.View.extend({templateName:"blacklist_add_site",events:{"click .addSite":"showCowboy","click #deleteEverythingBtn":"blacklistSite"},afterInitialize:function(){t(this.el).find("form").addClass("form-horizontal").addClass("well"),t(this.el).find("label").addClass("control-label");var e=this;this.$("div.controls").keypress(function(t){t&&13==t.which&&(t.preventDefault(),e.showCowboy())})},createChildren:function(){var e={};return e.holdOnBlacklist=new r({model:new n.BaseModel}),e},showCowboy:function(){var i=e.escape(t(this.el).find('input[name="site"]').val());if(i=s.getTLD(i)){this.children.holdOnBlacklist.model.attributes.site=i,this.children.holdOnBlacklist.render();var a=new n.Site({domain:i});a.loadAccounts(!1,e.bind(function(){a.accounts&&a.accounts.models.length>0?t("#holdOnBlacklist").modal("show"):this.blacklistSite(a.attributes.domain)},this))}else t(this.options.parent.el).find("div.error-notice").show()},blacklistSite:function(){var i=e.escape(t(this.el).find('input[name="site"]').val());i=s.getTLD(i);var a=new n.Site({domain:i,blacklisted:1}),r={success:e.bind(function(){this.options.list.collection.fetchAllForBlacklistedPage(e.bind(function(){t(this.el).find('input[name="site"]').val(""),t("#holdOnBlacklist").modal("hide"),t(this.options.parent.el).find("div.empty-notice").hide(),t(this.options.parent.el).find("div.error-notice").hide(),t(this.options.parent.el).find(".deleteAll").show()},this))},this),error:function(){}};a.blacklist(r)}}),d=i.View.extend({templateName:"blacklist_blacklist",events:{"click #clear-blacklist":"clearBlacklist"},createChildren:function(){this.weakBindTo(ABINEMASKME.user.sites,"sync",e.debounce(e.bind(function(){ABINEMASKME.App.loadView(d)},this),500));var i={},a=new l({collection:new n.BlacklistedSiteCollection});return a.collection.fetchAllForBlacklistedPage(e.bind(function(){0===a.collection.length&&(t(this.el).find("div.empty-notice").show(),t(this.el).find(".deleteAll").hide())},this)),i.siteList=a,i.addSite=new c({list:a,parent:this}),i},clearBlacklist:function(){this.children.siteList.clearBlacklist(e.bind(function(){0===this.children.siteList.collection.length&&t(this.el).find(".deleteAll").hide()},this))}},{routeName:"blacklist",routeAction:function(){ABINEMASKME.App.loadView(d)}});return i.Security.showLoginWhenLocked(d),d}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/blacklist/one"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<td class="domain">\n    <img class="favicon" src="',s=n.domain,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"domain"),s=n.favicon,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"favicon"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"favicon",i,{hash:{}}):a,r+=d(i)+'" height="16" width="16">',s=n.domain,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"domain"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"domain",{hash:{}})),r+=d(i)+'\n</td>\n<td class="delete">\n    <div class="dropdown">\n        <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">\n            <!--<i class="icon-random"></i>-->\n            <i class="icon-trash"></i>\n        </a>\n        <ul class="dropdown-menu">\n            <li><a id="item-delete-domain" href=#>',i="mm_blacklist_dontIgnore",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+"</a></li>\n            <li><a href=#>",i="mm_blacklist_nevermind",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+"</a></li>\n        </ul>\n    </div>\n</td>\n\n"}),ABINEMASKME.CompiledTemplates["views/blacklist/one"]}),ABINEMASKME.define("abine/views/commonhelpers",["wycats/handlebars","abine/config","abine/intl"],function(e,t,n){var i="http://g.etfv.co/http://";e.registerHelper("configVar",function(n){return e.Utils.escapeExpression(t[n])}),e.registerHelper("favicon",function(t){return e.Utils.escapeExpression(i+t)}),e.registerHelper("idMeAppName",function(){return e.Utils.escapeExpression(t.appName)}),e.registerHelper("isChrome",function(){return"Chrome"===t.browser}),e.registerHelper("isFirefox",function(){return"Firefox"===t.browser}),e.registerHelper("ifUser",function(e,t){return"function"==typeof ABINEMASKME.user[e]&&ABINEMASKME.user[e]()?t.fn(this):t.inverse(this)}),e.registerHelper("ifContentUser",function(e,t){return"function"==typeof ABINEMASKME.contentuser[e]&&ABINEMASKME.contentuser[e]()?t.fn(this):t.inverse(this)}),e.registerHelper("ifUser",function(e,t){return"function"==typeof ABINEMASKME.user[e]&&ABINEMASKME.user[e]()?t.fn(this):t.inverse(this)}),e.registerHelper("user",function(e){return"function"==typeof ABINEMASKME.user[e]?ABINEMASKME.user[e]():""}),e.registerHelper("intl",function(e,t){return arguments.length>1&&(t=Array.prototype.slice.call(arguments,1)),n.getText(e,t)}),e.registerHelper("helpLink",function(t,i){var a="";return i=e.Utils.escapeExpression(i),0==t.length?a='<a href="https://www.abine.com/maskme/faq/#'+i+'" target="_blank"><i class="icon-question-sign"></i></a>':"panel"==t?a='<a href="https://www.abine.com/maskme/faq/#'+i+'" class="panel-help" target="_blank"><span class="panel-help-wrapper">?</span></a>':(t=e.Utils.escapeExpression(n.getText(t)),a='<span class="question-text">',a+='<a href="https://www.abine.com/maskme/faq/#'+i+'" target="_blank"> <em>'+t+"</em> </a>",a+="</span>"),a})}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/edit_user/edit_email"]=e.template(function(e,t,n,i,a){function s(e,t){var i,a,s="";return s+='\n    <div style="margin-top:75px;">\n        <h2>Email Setup</h2>\n    </div>\n    <div class="changePassText alert alert-info">\n        <b>Here is what you\'ll get</b>\n        <ul>\n            <li>Ability to forward Masked Emails to your real email address.</li>\n            <li>Option to use MaskMe\'s Sync feature to backup & access your MaskMe data online.</li>\n            <li>Autofill your real email address when you choose not to mask it.</li>\n        </ul>\n    </div>\n\n    <form style="position:relative;" class="form-horizontal well" id="changeEmailFrm">\n\n        <div style="display:none;" id="changeEmailError" class="alert alert-error">',i="mm_edit_user_error",p=n.intl,a=p||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===b?a.call(e,i,{hash:{}}):a===v?y.call(e,"intl",i,{hash:{}}):a,s+=A(i)+'</div>\n\n        <fieldset>\n            <div class="control-group">\n                <label class="control-label" for="email">Primary Email Address:</label>\n                <div class="controls">\n                    <input type="email" id="email" />\n                    <div class="help-block"></div>\n                </div>\n            </div>\n\n            ',i="hasRegPassword",p=n.ifUser,a=p||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"ifUser"),f=g.program(2,r,t),f.hash={},f.fn=f,f.inverse=g.program(4,o,t),i=p&&typeof a===b?a.call(e,i,f):E.call(e,a,i,f),(i||0===i)&&(s+=i),s+='\n\n            <div class="control-group">\n                <div class="controls">\n                    <input type="submit" id="changeEmailBtn" class="btn btn-large btn-primary" value=\'Set Email\' />\n                    <img src="',i="/pages/images/ajax_loader.gif",p=n.assetUrl,a=p||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),i=typeof a===b?a.call(e,i,{hash:{}}):a===v?y.call(e,"assetUrl",i,{hash:{}}):a,s+=A(i)+'" style="display:none;" id="changeEmailSpinner" />\n                    <input type="button" id="cancelChangeEmailBtn" class="btn" value="',i="mm_edit_user_cancel",p=n.intl,a=p||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===b?a.call(e,i,{hash:{}}):a===v?y.call(e,"intl",i,{hash:{}}):a,s+=A(i)+'" />\n                </div>\n            </div>\n        </fieldset>\n        <div style="position:absolute;bottom:5px;right:5px;font-size:12px;" class="sign-in">',i="mm_user_registration_haveAccount",p=n.intl,a=p||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===b?a.call(e,i,{hash:{}}):a===v?y.call(e,"intl",i,{hash:{}}):a,s+=A(i)+' <a href="#userLogin/editUser_email">',i="mm_user_registration_login",p=n.intl,a=p||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===b?a.call(e,i,{hash:{}}):a===v?y.call(e,"intl",i,{hash:{}}):a,s+=A(i)+"</a></div>\n    </form>\n"}function r(e){var t,i,a="";return a+='\n                <input type="hidden" id="currentPassword" value="',t="getRegPassword",p=n.user,i=p||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"user"),t=typeof i===b?i.call(e,t,{hash:{}}):i===v?y.call(e,"user",t,{hash:{}}):i,a+=A(t)+'" />\n            '}function o(e){var t,i,a="";return a+='\n                <div class="control-group oldPassword">\n                    <label class="control-label" for="currentPassword">',t="mm_edit_user_passwordColon",p=n.intl,i=p||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===b?i.call(e,t,{hash:{}}):i===v?y.call(e,"intl",t,{hash:{}}):i,a+=A(t)+'</label>\n                    <div class="controls">\n                        <input type="password" id="currentPassword" value=""/>\n                        <div class="help-block"></div>\n                    </div>\n                </div>\n            '}function l(e,t){var i,a,s="";return s+='\n    <div style="margin-top:75px;">\n        <h2>Change Email</h2>\n    </div>\n    <div class="changePassText alert alert-info">\n        <b>',i="mm_edit_user_wantToChangeEmail",p=n.intl,a=p||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===b?a.call(e,i,{hash:{}}):a===v?y.call(e,"intl",i,{hash:{}}):a,s+=A(i)+"</b> ",i="mm_edit_user_keepTwoThings",p=n.intl,a=p||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===b?a.call(e,i,{hash:{}}):a===v?y.call(e,"intl",i,{hash:{}}):a,s+=A(i)+"\n        <ol>\n            <li>",i="mm_edit_user_thingOne",p=n.intl,a=p||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===b?a.call(e,i,{hash:{}}):a===v?y.call(e,"intl",i,{hash:{}}):a,s+=A(i)+"</li>\n            <li>",i="mm_edit_user_thingTwo",p=n.intl,a=p||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===b?a.call(e,i,{hash:{}}):a===v?y.call(e,"intl",i,{hash:{}}):a,s+=A(i)+'</li>\n        </ol>\n    </div>\n\n    <form class="form-horizontal well" id="changeEmailFrm">\n\n        <div style="display:none;" id="changeEmailError" class="alert alert-error">',i="mm_edit_user_error",p=n.intl,a=p||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===b?a.call(e,i,{hash:{}}):a===v?y.call(e,"intl",i,{hash:{}}):a,s+=A(i)+'</div>\n\n        <fieldset>\n            <div class="control-group">\n                <label class="control-label" for="email">',i="mm_edit_user_newEmail",p=n.intl,a=p||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===b?a.call(e,i,{hash:{}}):a===v?y.call(e,"intl",i,{hash:{}}):a,s+=A(i)+'</label>\n                <div class="controls">\n                    <input type="email" id="email" />\n                    <div class="help-block"></div>\n                </div>\n            </div>\n\n            ',i="hasRegPassword",p=n.ifUser,a=p||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"ifUser"),f=g.program(7,c,t),f.hash={},f.fn=f,f.inverse=g.program(9,d,t),i=p&&typeof a===b?a.call(e,i,f):E.call(e,a,i,f),(i||0===i)&&(s+=i),s+='\n\n            <div class="control-group">\n                <div class="controls">\n                    <input type="submit" id="changeEmailBtn" class="btn btn-large btn-primary" value=\'',i="mm_edit_user_changeEmail",p=n.intl,a=p||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===b?a.call(e,i,{hash:{}}):a===v?y.call(e,"intl",i,{hash:{}}):a,s+=A(i)+"' />\n                    <img src=\"",i="/pages/images/ajax_loader.gif",p=n.assetUrl,a=p||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),i=typeof a===b?a.call(e,i,{hash:{}}):a===v?y.call(e,"assetUrl",i,{hash:{}}):a,s+=A(i)+'" style="display:none;" id="changeEmailSpinner" />\n                    <input type="button" id="cancelChangeEmailBtn" class="btn" value="',i="mm_edit_user_cancel",p=n.intl,a=p||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===b?a.call(e,i,{hash:{}}):a===v?y.call(e,"intl",i,{hash:{}}):a,s+=A(i)+'" />\n                </div>\n            </div>\n        </fieldset>\n    </form>\n'}function c(e){var t,i,a="";return a+='\n                <input type="hidden" id="currentPassword" value="',t="getRegPassword",p=n.user,i=p||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"user"),t=typeof i===b?i.call(e,t,{hash:{}}):i===v?y.call(e,"user",t,{hash:{}}):i,a+=A(t)+'" />\n            '}function d(e){var t,i,a="";return a+='\n                <div class="control-group oldPassword">\n                    <label class="control-label" for="currentPassword">',t="mm_edit_user_passwordColon",p=n.intl,i=p||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===b?i.call(e,t,{hash:{}}):i===v?y.call(e,"intl",t,{hash:{}}):i,a+=A(t)+'</label>\n                    <div class="controls">\n                        <input type="password" id="currentPassword" value=""/>\n                        <div class="help-block"></div>\n                    </div>\n                </div>\n            '}n=n||e.helpers;var u,h,p,f,m="",g=this,b="function",y=n.helperMissing,v=void 0,A=this.escapeExpression,E=n.blockHelperMissing;return u="hasRegEmail",p=n.ifUser,h=p||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"ifUser"),f=g.program(1,s,a),f.hash={},f.fn=f,f.inverse=g.program(6,l,a),u=p&&typeof h===b?h.call(t,u,f):E.call(t,h,u,f),(u||0===u)&&(m+=u),m+="\n\n\n"}),ABINEMASKME.CompiledTemplates["views/edit_user/edit_email"]}),ABINEMASKME.define("abine/views/editEmail",["documentcloud/underscore","jquery","duckbone/core","abine/proxies","abine/responseCodes","abine/intl"],function(e,t,n,i,a,s){var r=n.View.extend({templateName:"edit_user_edit_email",events:{"click #cancelChangeEmailBtn":"cancelChangePassword","submit #changeEmailFrm":"changeEmail"},afterInitialize:function(){},clearErrors:function(){t(this.el).find("#changeEmailError").hide()},changeEmail:function(n){n.preventDefault();var r={email:t(this.el).find("#email").val(),current_password:t(this.el).find("#currentPassword").val()};return this.clearErrors(),""==r.email?(t(this.el).find("#changeEmailError").html(s.getText("mm_user_email_EmailError")).show(),void 0):""==r.current_password?(t(this.el).find("#changeEmailError").html(s.getText("mm_user_password_PasswordError")).show(),void 0):(i.licenseModule.changeEmail(r,e.bind(function(e){e?(e.errorCode==a.FAILED_CREATING_TARGET_EMAIL?t(this.el).find("#changeEmailError").html(s.getText("mm_ServerError")):e.errorCode==a.FAILED_TO_UPDATE_USER?e.responseJSON.data.errors?(e.responseJSON.data.errors.current_password&&t(this.el).find("#changeEmailError").html(s.getText("mm_user_password_PasswordError")),e.responseJSON.data.errors.email&&("has already been taken"==e.responseJSON.data.errors.email?t(this.el).find("#changeEmailError").html(s.getText("mm_user_email_EmailAlreadyTakenError")):t(this.el).find("#changeEmailError").html(s.getText("mm_user_email_EmailError")))):t(this.el).find("#changeEmailError").html(s.getText("mm_ServerError")):e.errorCode==a.UNKNOWN_ERROR?t(this.el).find("#changeEmailError").html(s.getText("mm_ServerError")):e.errorCode==a.INVALID_EMAIL_ADDRESS&&t(this.el).find("#changeEmailError").html(s.getText("mm_user_email_EmailError")),t(this.el).find("#changeEmailError").show()):ABINEMASKME.user.loadMin(function(){ABINEMASKME.App.navigate("#userInfo",!0)})},this)),void 0)},cancelChangePassword:function(){ABINEMASKME.App.navigate("userInfo",!0)}});return r}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/edit_user/edit_password"]=e.template(function(e,t,n,i,a){function s(e,t){var i,a,s="";return s+='\n    <div style="margin-top:75px;">\n        <h2>Password Setup</h2>\n    </div>\n\n    <div class="changePassText alert alert-info">\n        <b>Here is what you\'ll get:</b>\n        <ul>\n            <li>MaskMe will encrypt your data with your own password, meaning you hold the keys.</li>\n            <li>Ability to Lock MaskMe so no one can access your data.</li>\n            <li>Option to use MaskMe\'s Sync feature to securely backup & access your MaskMe data online.</li>\n        </ul>\n    </div>\n\n    <form style="position:relative;" class="form-horizontal well" id="changePasswdFrm">\n\n        <div class="alert alert-error" style="display: none;" id="changePasswordError">\n            ',i="mm_edit_user_error",d=n.intl,a=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===f?a.call(e,i,{hash:{}}):a===g?m.call(e,"intl",i,{hash:{}}):a,s+=b(i)+'\n        </div>\n\n        <fieldset>\n\n            <input type="hidden" id="currentPassword" value="',i="getRegPassword",d=n.user,a=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"user"),i=typeof a===f?a.call(e,i,{hash:{}}):a===g?m.call(e,"user",i,{hash:{}}):a,s+=b(i)+'" />\n\n            <div class="control-group passwordsTrigger">\n                <label class="control-label" for="password">',i="mm_edit_user_newPassword",d=n.intl,a=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===f?a.call(e,i,{hash:{}}):a===g?m.call(e,"intl",i,{hash:{}}):a,s+=b(i)+'</label>\n                <div class="controls">\n                    <div class="passwordsDiv" style="float:right;margin-top:10px;margin-right:260px;width:10px;height:10px;"></div>\n                    <input type="password" id="password" />\n                    <div id="passwordError" class="help-block error"></div>\n                </div>\n\n            </div>\n\n            <div class="control-group">\n                <label class="control-label" for="passwordConfirmation">',i="mm_edit_user_confirmNewPassword",d=n.intl,a=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===f?a.call(e,i,{hash:{}}):a===g?m.call(e,"intl",i,{hash:{}}):a,s+=b(i)+'</label>\n                <div class="controls">\n                    <input type="password" id="passwordConfirmation" />\n                    <div id="passwordConfirmationError" class="help-block error"></div>\n                </div>\n            </div>\n\n            <div class="control-group">\n                <label class="control-label" for="passwordHint">',i="mm_edit_user_passwordHint",d=n.intl,a=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===f?a.call(e,i,{hash:{}}):a===g?m.call(e,"intl",i,{hash:{}}):a,s+=b(i)+'</label>\n                <div class="controls">\n                    <input type="text" id="passwordHint" />\n                    <div id="passwordHintError" class="help-block error"></div>\n                </div>\n            </div>\n\n            <div class="control-group">\n                <div class="controls">\n                    <input type="submit" id="changePasswordBtn" class="btn btn-large btn-primary" value=\'Set Password\' />\n                    <img src="',i="/pages/images/ajax_loader.gif",d=n.assetUrl,a=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),i=typeof a===f?a.call(e,i,{hash:{}}):a===g?m.call(e,"assetUrl",i,{hash:{}}):a,s+=b(i)+'" style="display:none;" id="changePasswordSpinner" />\n                    <input type="button" id="cancelChangePasswordBtn" class="btn" value="',i="mm_edit_user_cancel",d=n.intl,a=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===f?a.call(e,i,{hash:{}}):a===g?m.call(e,"intl",i,{hash:{}}):a,s+=b(i)+'" />\n                </div>\n            </div>\n        </fieldset>\n        ',i="hasRegEmail",d=n.ifUser,a=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"ifUser"),u=p.program(2,r,t),u.hash={},u.fn=u,u.inverse=p.noop,i=d&&typeof a===f?a.call(e,i,u):y.call(e,a,i,u),(i||0===i)&&(s+=i),s+="\n    </form>\n\n\n"}function r(e){var t,i,a="";return a+='\n            <div style="position:absolute;bottom:5px;right:5px;font-size:12px;" class="sign-in">',t="mm_user_registration_haveAccount",d=n.intl,i=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===f?i.call(e,t,{hash:{}}):i===g?m.call(e,"intl",t,{hash:{}}):i,a+=b(t)+' <a href="#userLogin/editUser_password">',t="mm_user_registration_login",d=n.intl,i=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===f?i.call(e,t,{hash:{}}):i===g?m.call(e,"intl",t,{hash:{}}):i,a+=b(t)+"</a></div>\n        "}function o(e){var t,i,a="";return a+='\n    <div style="margin-top:75px;">\n        <h2>Change Password</h2>\n    </div>\n\n    <div class="changePassText alert alert-info">\n        <b>',t="mm_edit_user_wantToChangePassword",d=n.intl,i=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===f?i.call(e,t,{hash:{}}):i===g?m.call(e,"intl",t,{hash:{}}):i,a+=b(t)+"</b> ",t="mm_edit_user_goForIt",d=n.intl,i=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===f?i.call(e,t,{hash:{}}):i===g?m.call(e,"intl",t,{hash:{}}):i,a+=b(t)+'\n    </div>\n\n\n    <form class="form-horizontal well" id="changePasswdFrm">\n\n        <div class="alert alert-error" style="display: none;" id="changePasswordError">\n            ',t="mm_edit_user_error",d=n.intl,i=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===f?i.call(e,t,{hash:{}}):i===g?m.call(e,"intl",t,{hash:{}}):i,a+=b(t)+'\n        </div>\n\n        <fieldset>\n\n            <div class="control-group oldPassword">\n                <label class="control-label" for="currentPassword">',t="mm_edit_user_currentPassword",d=n.intl,i=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===f?i.call(e,t,{hash:{}}):i===g?m.call(e,"intl",t,{hash:{}}):i,a+=b(t)+'</label>\n\n                <div class="controls">\n                    <input type="password" id="currentPassword" />\n                    <div id="currentPasswordError" class="help-block error"></div>\n                </div>\n            </div>\n\n            <div class="control-group passwordsTrigger">\n                <label class="control-label" for="password">',t="mm_edit_user_newPassword",d=n.intl,i=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===f?i.call(e,t,{hash:{}}):i===g?m.call(e,"intl",t,{hash:{}}):i,a+=b(t)+'</label>\n                <div class="controls">\n                    <div class="passwordsDiv" style="float:right;margin-top:10px;margin-right:260px;width:10px;height:10px;"></div>\n                    <input type="password" id="password" />\n                    <div id="passwordError" class="help-block error"></div>\n                </div>\n\n            </div>\n\n            <div class="control-group">\n                <label class="control-label" for="passwordConfirmation">',t="mm_edit_user_confirmNewPassword",d=n.intl,i=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===f?i.call(e,t,{hash:{}}):i===g?m.call(e,"intl",t,{hash:{}}):i,a+=b(t)+'</label>\n                <div class="controls">\n                    <input type="password" id="passwordConfirmation" />\n                    <div id="passwordConfirmationError" class="help-block error"></div>\n                </div>\n            </div>\n\n            <div class="control-group">\n                <label class="control-label" for="passwordHint">',t="mm_edit_user_passwordHint",d=n.intl,i=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===f?i.call(e,t,{hash:{}}):i===g?m.call(e,"intl",t,{hash:{}}):i,a+=b(t)+'</label>\n                <div class="controls">\n                    <input type="text" id="passwordHint" />\n                    <div id="passwordHintError" class="help-block error"></div>\n                </div>\n            </div>\n\n            <div class="control-group">\n                <div class="controls">\n                    <input type="submit" id="changePasswordBtn" class="btn btn-large btn-primary" value=\'',t="mm_edit_user_changePassword",d=n.intl,i=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===f?i.call(e,t,{hash:{}}):i===g?m.call(e,"intl",t,{hash:{}}):i,a+=b(t)+"' />\n                    <img src=\"",t="/pages/images/ajax_loader.gif",d=n.assetUrl,i=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===f?i.call(e,t,{hash:{}}):i===g?m.call(e,"assetUrl",t,{hash:{}}):i,a+=b(t)+'" style="display:none;" id="changePasswordSpinner" />\n                    <input type="button" id="cancelChangePasswordBtn" class="btn" value="',t="mm_edit_user_cancel",d=n.intl,i=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===f?i.call(e,t,{hash:{}}):i===g?m.call(e,"intl",t,{hash:{}}):i,a+=b(t)+'" />\n                </div>\n            </div>\n        </fieldset>\n    </form>\n\n\n'
}n=n||e.helpers;var l,c,d,u,h="",p=this,f="function",m=n.helperMissing,g=void 0,b=this.escapeExpression,y=n.blockHelperMissing;return l="hasRegPassword",d=n.ifUser,c=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"ifUser"),u=p.program(1,s,a),u.hash={},u.fn=u,u.inverse=p.program(4,o,a),l=d&&typeof c===f?c.call(t,l,u):y.call(t,c,l,u),(l||0===l)&&(h+=l),h+="\n"}),ABINEMASKME.CompiledTemplates["views/edit_user/edit_password"]}),ABINEMASKME.define("abine/views/editPassword",["documentcloud/underscore","jquery","duckbone/core","abine/intl","abine/passwordScore","abine/proxies","abine/responseCodes"],function(e,t,n,i,a,s,r){var o=9,l=n.View.extend({templateName:"edit_user_edit_password",events:{"click #cancelChangePasswordBtn":"cancelChangePassword","submit #changePasswdFrm":"changePassword","keyup .passwordsTrigger":"recalculateStrength","click .passwordsTrigger":"recalculateStrength","blur .passwordsTrigger":"hidePopover"},afterInitialize:function(){t(this.el).find(".passwordsDiv").popover({animation:!0,placement:"right",html:!0,trigger:"manual",title:"<span style='color:red;'>"+i.getText("mm_user_registration_passwordWeak")+"</span>",content:i.getText("mm_user_registration_passwordPopoverContent"),template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})},cancelChangePassword:function(){ABINEMASKME.App.navigate("userInfo",!0)},clearErrors:function(){t(this.el).find("#changePasswordError").html("").hide(),t(this.el).find("#currentPasswordError").html(""),t(this.el).find("#passwordError").html(""),t(this.el).find("#passwordConfirmationError").html(""),t(this.el).find("#passwordHintError").html("")},changePassword:function(n){n.preventDefault();var a={current_password:t(this.el).find("#currentPassword").val(),password:t(this.el).find("#password").val(),password_confirmation:t(this.el).find("#passwordConfirmation").val(),password_hint:t(this.el).find("#passwordHint").val()};return this.clearErrors(),""==a.current_password?(t(this.el).find("#changePasswordError").html(i.getText("mm_user_registration_error")).show(),t(this.el).find("#currentPasswordError").html(i.getText("mm_user_registration_passwordRequired")),void 0):""==a.password?(t(this.el).find("#changePasswordError").html(i.getText("mm_user_registration_error")).show(),t(this.el).find("#passwordError").html(i.getText("mm_user_registration_passwordRequired")),void 0):a.password!=a.password_confirmation?(t(this.el).find("#changePasswordError").html(i.getText("mm_user_registration_error")).show(),t(this.el).find("#passwordConfirmationError").html(i.getText("mm_user_registration_passwordsDoNotMatch")),void 0):""==a.password_hint?(t(this.el).find("#changePasswordError").html(i.getText("mm_user_registration_error")).show(),t(this.el).find("#passwordHintError").html(i.getText("mm_user_registration_passwordHintInvalid")),void 0):(t(this.el).find("#changePasswordSpinner").show(),t(this.el).find("#changePasswordBtn").attr("disabled","disabled"),s.licenseModule.changePassword(a,e.bind(function(e){t(this.el).find("#changePasswordSpinner").hide(),t(this.el).find("#changePasswordBtn").removeAttr("disabled"),e?e.errorCode==r.FAILED_CREATING_TARGET_EMAIL?t(this.el).find("#changePasswordError").html(i.getText("mm_ServerError")):e.errorCode==r.FAILED_TO_UPDATE_USER?e.responseJSON.data.errors&&e.responseJSON.data.errors.current_password?t(this.el).find("#currentPasswordError").html(i.getText("mm_user_password_PasswordError")):t(this.el).find("#changePasswordError").html(i.getText("mm_ServerError")):e.errorCode==r.UNKNOWN_ERROR?t(this.el).find("#changePasswordError").html(i.getText("mm_ServerError")):t(this.el).find("#changePasswordError").html(i.getText("mm_ServerError")):ABINEMASKME.App.navigate("#userInfo",!0)},this)),void 0)},recalculateStrength:function(e){if(e.keyCode!==o){var n=t(this.el).find(".passwordsDiv"),s=n.data("popover"),r=a.calculateScore(this.fields.password.el.value);s.options.title=i.getText("mm_user_registration_passwordPopoverTitle")+" "+a.calculateStrengthForTitle(r),s.options.content=a.calculateProgressForContent(r)+i.getText("mm_user_registration_passwordPopoverContent"),s.options.animation=!1,n.popover("show")}},hidePopover:function(){var e=t(this.el).find(".passwordsDiv");e.data("popover"),e.popover("hide")}});return l}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/edit_user/edit_phone"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r,o="",l="function",c=n.helperMissing,d=void 0,u=this.escapeExpression;return o+='<div style="padding-top:20px;">\n    <h2 class="titleText">',i="mm_edit_user_maskedPhoneSetup",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+" ",i="aliasphone",a="mm_help_link_whatIsThis",r=n.helpLink,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"helpLink"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"helpLink",a,i,{hash:{}}):s,(i||0===i)&&(o+=i),o+='</h2>\n</div>\n<div id="errorMsg" class="alert alert-error" style="display:none;"/>\n<div id="resentMsg" class="alert alert-info" style="display:none;"/>\n\n<div id="enterPhoneNumber">\n    <h3>\n        <span class="setup-step">&nbsp;1&nbsp;</span> ',i="mm_edit_user_enterPhone",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'\n    </h3>\n    <input type="text" id="phoneArea" class="input-small" maxlength="3" size="3" placeholder="555" />\n    <input type="text" id="phoneExchange" class="input-small" maxlength="3" size="3" placeholder="555" />\n    <input type="text" id="phoneLocal" class="input-small" maxlength="4" size="4"  placeholder="5555" />\n    <h3>\n        <span class="setup-step">&nbsp;2&nbsp;</span> ',i="mm_edit_user_selectVerification",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'\n    </h3>\n    <label class="radio">\n        <input type="radio" name="verification_method" checked="checked" value="txt" /> ',i="mm_edit_user_textMe",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'\n    </label>\n\n    <label class="radio">\n        <input type="radio" name="verification_method" value="call" /> ',i="mm_edit_user_callMe",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'\n    </label>\n\n    <input type="button" id="savePhoneBtn" class="btn btn-primary btn-large" value="',i="mm_edit_user_next",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'" />\n    <img id="ajaxSpinner" style="display:none;" src="',i="/pages/images/ajax_loader.gif",r=n.assetUrl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"assetUrl",i,{hash:{}}):a,o+=u(i)+'" />\n</div>\n\n<div id="enterVerificationCode" style="display:none;">\n    <input type="button" id="backBtn" class="btn" value="',i="mm_edit_user_back",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'" style="display:none;" />\n    <h3>\n        <span class="setup-step">&nbsp;3&nbsp;</span> ',i="mm_edit_user_enterVerification",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'\n    </h3>\n    <input type="text" id="verificationCode" class="input-large" placeholder="12345" />\n    <input type="button" id="verifyCodeBtn" class="btn btn-primary btn-large" value="',i="mm_edit_user_verify",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'" />\n    <input type="button" id="resendCodeBtn" class="btn btn-success btn-large" value="',i="mm_edit_user_resend",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'" />\n    <img id="verifySpinner" style="display:none;" src="',i="/pages/images/ajax_loader.gif",r=n.assetUrl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"assetUrl",i,{hash:{}}):a,o+=u(i)+'" />\n</div>\n\n<div id="allSet" style="display:none;">\n    <h3>',i="mm_edit_user_allSet",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+"</h3>\n    ",i="mm_edit_user_newMaskedPhone",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'  <strong id="finalDisposable"></strong><br/>\n    ',i="mm_edit_user_callsWillForward",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+' <strong id="finalShielded"></strong>\n</div>\n'}),ABINEMASKME.CompiledTemplates["views/edit_user/edit_phone"]}),ABINEMASKME.define("abine/views/editPhone",["documentcloud/underscore","jquery","duckbone/core","models","abine/intl","abine/responseCodes","abine/proxies"],function(e,t,n,i,a,s){var r=n.View.extend({templateName:"edit_user_edit_phone",events:{"click input#savePhoneBtn":"savePhone","click input#verifyCodeBtn":"verifyCode","click input#resendCodeBtn":"resendCode","click input#backBtn":"back","keyup input#phoneArea":"tabToNextField","keyup input#phoneExchange":"tabToNextField"},afterInitialize:function(){},showVerifySpinner:function(){t(this.el).find("#verifySpinner").show(),t(this.el).find("#errorMsg").hide(),t(this.el).find("#resentMsg").hide()},registerPhone:function(){this.model.registerNumber({success:e.bind(function(e){this.model.set(e),t(this.el).find("#savePhoneBtn").removeAttr("disabled"),t(this.el).find("#verifySpinner").hide(),t(this.el).find("#resentMsg").html(a.getText("mm_edit_phone_ResendCode")+" "+this.model.getPrettyNumber()).show(),t(this.el).find("#errorMsg").hide(),t(this.el).find("#enterPhoneNumber").hide(),t(this.el).find("#enterVerificationCode").show()},this),error:e.bind(function(e){t(this.el).find("#savePhoneBtn").removeAttr("disabled"),t(this.el).find("#verifySpinner").hide(),e.errorCode==s.PHONE_ALREADY_VALIDATED?t(this.el).find("#errorMsg").html(a.getText("mm_edit_phone_AlreadyValidated")).show():e.errorCode==s.FAILED_TO_SAVE_PHONE?t(this.el).find("#errorMsg").html(a.getText("mm_edit_phone_ServerError")).show():e.errorCode==s.FAILED_TO_SEND_VERIFICATION_CODE?t(this.el).find("#errorMsg").html(a.getText("mm_edit_phone_ServerError")).show():t(this.el).find("#errorMsg").html(a.getText("mm_edit_phone_ServerError")).show()},this)})},savePhone:function(){var e=t(this.el).find("#phoneArea").val()+t(this.el).find("#phoneExchange").val()+t(this.el).find("#phoneLocal").val();e=e.replace(/[^\d]/g,"");var n=t(this.el).find("input:radio[name=verification_method]:checked").val();this.model.set("verification_method",n),this.model.set("number",e),t(this.el).find("#errorMsg").hide(),t(this.el).find("#savePhoneBtn").attr("disabled","disabled"),t(this.el).find("#ajaxSpinner").show(),10!=e.length?(t(this.el).find("#errorMsg").html(a.getText("mm_edit_phone_ValidUSNumber")).show(),t(this.el).find("#savePhoneBtn").removeAttr("disabled"),t(this.el).find("#ajaxSpinner").hide()):(t(this.el).find("#ajaxSpinner").hide(),this.registerPhone())},verifyCode:function(){this.showVerifySpinner();var n=t(this.el).find("#verificationCode").val();this.model.set("secret",n),this.model.verifySecret({success:e.bind(function(n){this.model.set(n.shielded_phone),t(this.el).find("#verifySpinner").hide();var a=new i.DisposablePhone;a.set(n.disposable_phone),ABINEMASKME.user.loadMin(e.bind(function(){t(this.el).find("#backBtn").hide(),t(this.el).find("#enterVerificationCode").hide(),t(this.el).find("#allSet").show(),t(this.el).find("#finalDisposable").html(a.getPrettyNumber()),t(this.el).find("#finalShielded").html(this.model.getPrettyNumber())},this))},this),error:e.bind(function(e){true&&ABINEMASKME.log.error("[ERROR HANDLER]#[abine/models/shieldedPhone]#[verifySecret]# error event in model.sync eventName: update:shieldedPhone:secret"),t(this.el).find("#verifySpinner").hide(),e.errorCode==s.NO_NUMBERS_AVAILABLE?t(this.el).find("#errorMsg").html(a.getText("mm_edit_phone_NoPhonesError")).show():e.errorCode==s.PHONE_NOT_FOUND?t(this.el).find("#errorMsg").html(a.getText("mm_edit_phone_PhoneNotFound")).show():e.errorCode==s.WRONG_VERIFICATION_CODE?t(this.el).find("#errorMsg").html(a.getText("mm_edit_phone_VerificationCode")).show():t(this.el).find("#errorMsg").html(a.getText("mm_edit_phone_ServerError")).show()},this)})},resendCode:function(){this.showVerifySpinner(),this.registerPhone()},tabToNextField:function(e){var n=t(this.el).find("#"+e.target.id).eq(0);n.val().length==n.attr("maxlength")&&("phoneArea"==e.target.id?t(this.el).find("#phoneExchange").focus():"phoneExchange"==e.target.id&&t(this.el).find("#phoneLocal").focus())},back:function(){t(this.el).find("#backBtn").hide(),t(this.el).find("#errorMsg").hide(),t(this.el).find("#resentMsg").hide(),t(this.el).find("#enterVerificationCode").hide(),t(this.el).find("#enterPhoneNumber").show()}});return r}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/edit_user/edit_user"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return i="editField",s=n.child,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"child",i,{hash:{}}):a,r+=d(i)+"\n"}),ABINEMASKME.CompiledTemplates["views/edit_user/edit_user"]}),ABINEMASKME.define("abine/views/editUser",["jquery","duckbone/core","models","abine/views/editPassword","abine/views/editEmail","abine/views/editPhone","abine/eventLogger"],function(e,t,n,i,a,s){var r=t.View.extend({templateName:"edit_user_edit_user",createChildren:function(){return"email"==this.options.field?{editField:new a}:"password"==this.options.field?{editField:new i}:"phone"==this.options.field?{editField:new s({model:new n.ShieldedPhone})}:void 0}},{routeName:"editUser",routeAction:function(e){ABINEMASKME.App.loadView(r,{field:e})}});return t.Security.showLoginWhenLocked(r),r}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/email_disabled/disabled"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r,o="",l="function",c=n.helperMissing,d=void 0,u=this.escapeExpression;return o+='<br/>\n<div class="alert alert-error">\n    <p>',i="mm_email_disabled_error",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+"</p>\n</div>\n<p>",r=n.getEmailAddress,i=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getEmailAddress"),a="mm_email_disabled_flagged",r=n.intl,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"intl",a,i,{hash:{}}):s,o+=u(i)+"</p>\n<p>",i="mm_email_disabled_info",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'</p>\n<p class=center><a id="changeEmailBtn" class="btn btn-primary">',i="mm_email_disabled_change",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+"</a></p>\n<p>",i="mm_email_disabled_support",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+"</p>\n<br/><br/>\n<h4>",i="mm_email_disabled_faq_title",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+"</h4>\n<p>",i="mm_email_disabled_faq_details",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'</h3>\n<p><a href="https://www.abine.com/maskme/faq/#aliasemail" target="_blank">',i="mm_email_disabled_faq_readmore",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+"</a></p>\n"}),ABINEMASKME.CompiledTemplates["views/email_disabled/disabled"]}),ABINEMASKME.define("abine/views/emailDisabled",["documentcloud/underscore","jquery","duckbone/core","models","abine/views/commonhelpers","abine/config"],function(e,t,n){var i=n.View.extend({templateName:"email_disabled_disabled",events:{"click a#changeEmailBtn":"changeEmail"},changeEmail:function(){ABINEMASKME.App.navigate("editUser/email",!0)}},{routeName:"emailDisabled",routeAction:function(){ABINEMASKME.user.loadMin(function(){ABINEMASKME.App.loadView(i,{model:ABINEMASKME.user})})}});return i}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/email_helper/panel"]=e.template(function(e,t,n,i,a){function s(e,t){var i,a,s="";return s+='\n        <div class="header">\n            <div class="buttons-panel close-header-margin">\n                <span class="close-icon close-header" id="paneHover"></span>\n            </div>\n            <div class="buttons-panel question-header-margin">\n                <a href="https://www.abine.com/maskme/faq/#aliasemail" target="_blank"><span class="question-icon" id="paneHover"></span></a>\n            </div>\n            <img class="panel-icon" src="',i="/pages/images/manage/maskme_logo_short_green.png",g=n.assetUrl,a=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),i=typeof a===A?a.call(e,i,{hash:{}}):a===M?E.call(e,"assetUrl",i,{hash:{}}):a,s+=_(i)+'"/>\n        </div>\n\n        <!--Mask My Email-->\n        <a href="#" class="mmKeyOption disposableEmail"><div class="element" id="mask">\n            <span class="panelLeft">\n                <img class="iconPos" src="',i="/pages/images/maskmail-icon.png",g=n.assetUrl,a=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),i=typeof a===A?a.call(e,i,{hash:{}}):a===M?E.call(e,"assetUrl",i,{hash:{}}):a,s+=_(i)+'"/>\n                ',i="mm_email_helper_maskMyEmail",g=n.intl,a=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===A?a.call(e,i,{hash:{}}):a===M?E.call(e,"intl",i,{hash:{}}):a,s+=_(i)+'\n            </span>\n            <span class="panelRight">\n                <img class="loading" style="display:none;" src="',i="/pages/images/ajax_loader.gif",g=n.assetUrl,a=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),i=typeof a===A?a.call(e,i,{hash:{}}):a===M?E.call(e,"assetUrl",i,{hash:{}}):a,s+=_(i)+'"/>\n\n            </span>\n        </div></a>\n\n        <!--Server Down Error Handling-->\n        <span class="errorBtn disabled errorReportLink" style="display:none;cursor:pointer;"><div class="element">\n            <span class="panelLeft">\n                <a>',i="mm_email_helper_serverIsDown",g=n.intl,a=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===A?a.call(e,i,{hash:{}}):a===M?E.call(e,"intl",i,{hash:{}}):a,s+=_(i)+'</a>\n            </span>\n            <span class="panelRight">\n                <a>',i="mm_email_helper_tryAgainLater",g=n.intl,a=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===A?a.call(e,i,{hash:{}}):a===M?E.call(e,"intl",i,{hash:{}}):a,s+=_(i)+'</a>\n            </span>\n        </div></span>\n\n        <!--Account disabled Error Handling-->\n        <div class="accountDisabledBtn element" style="display:none">\n            <span class="message">',i="mm_email_helper_accountDisabled",g=n.intl,a=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===A?a.call(e,i,{hash:{}}):a===M?E.call(e,"intl",i,{hash:{}}):a,s+=_(i)+'</span>\n            <a href=# class="enableAccount">',i="mm_email_helper_accountEnableLink",g=n.intl,a=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===A?a.call(e,i,{hash:{}}):a===M?E.call(e,"intl",i,{hash:{}}):a,s+=_(i)+"</a>\n        </div>\n\n        <!--Disclose My Email-->\n        ",i="hasRegEmail",g=n.ifContentUser,a=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"ifContentUser"),b=v.program(2,r,t),b.hash={},b.fn=b,b.inverse=v.program(4,o,t),i=g&&typeof a===A?a.call(e,i,b):w.call(e,a,i,b),(i||0===i)&&(s+=i),s+="\n\n         <!-- If Masked Emails already exist for this domain -->\n         ",g=n.disposableEmails,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"disposableEmails"),i=null===i||void 0===i||i===!1?i:ABINEMASKME.Duckbone.Handlebars.getAttr(i,"length"),a=n["if"],b=v.program(6,l,t),b.hash={},b.fn=b,b.inverse=v.noop,i=a.call(e,i,b),(i||0===i)&&(s+=i),s+="\n         ",g=n.disposableEmails,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"disposableEmails"),a=n.each,b=v.program(8,c,t),b.hash={},b.fn=b,b.inverse=v.noop,i=a.call(e,i,b),(i||0===i)&&(s+=i),s+="\n\n    "}function r(e){var t,i,a="";return a+='\n            <a href="#" class="mmKeyOption primaryEmail"><div class="element" id="disclose">\n                <span class="panelLeft">\n                    <img class="iconPos" src="',t="/pages/images/disclosemail-icon.png",g=n.assetUrl,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===A?i.call(e,t,{hash:{}}):i===M?E.call(e,"assetUrl",t,{hash:{}}):i,a+=_(t)+'"/>\n                    Use My Email\n                </span>\n            </div></a>\n        '}function o(e){var t,i,a="";return a+='\n            <a href="#" class="mmKeyOption primaryEmail"><div class="element" id="disclose">\n                <span class="panelLeft">\n                    <img class="iconPos" src="',t="/pages/images/disclosemail-icon.png",g=n.assetUrl,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===A?i.call(e,t,{hash:{}}):i===M?E.call(e,"assetUrl",t,{hash:{}}):i,a+=_(t)+'"/>\n                    ',t="mm_email_helper_discloseEmail",g=n.intl,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===A?i.call(e,t,{hash:{}}):i===M?E.call(e,"intl",t,{hash:{}}):i,a+=_(t)+'\n                </span>\n                <span class="panelRight">\n                    <span class="overflowText">',g=n.primaryEmail,t=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"primaryEmail"),t=null===t||void 0===t||t===!1?t:ABINEMASKME.Duckbone.Handlebars.getAttr(t,"email"),typeof t===A?t=t.call(e,{hash:{}}):t===M&&(t=E.call(e,"primaryEmail.email",{hash:{}})),a+=_(t)+"</span>\n                </span>\n            </div></a>\n        "}function l(e){var t,i,a="";return a+='\n            <div><p style="text-align:center;">',t="mm_email_helper_or",g=n.intl,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===A?i.call(e,t,{hash:{}}):i===M?E.call(e,"intl",t,{hash:{}}):i,a+=_(t)+"</p></div>\n         "}function c(e){var t,i,a="";return a+='\n            <a href="#" aliasAddress="',t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getAddress"),typeof t===A?t=t.call(e,{hash:{}}):t===M&&(t=E.call(e,"this.getAddress",{hash:{}})),a+=_(t)+'" class="mmKeyOption usedEmail"><div class="element" id="mask">\n                <span class="panelLeft">\n                    <img class="iconPos" src="',t="/pages/images/maskmail-icon.png",g=n.assetUrl,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===A?i.call(e,t,{hash:{}}):i===M?E.call(e,"assetUrl",t,{hash:{}}):i,a+=_(t)+'"/>\n                    ',t="mm_email_helper_use",g=n.intl,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===A?i.call(e,t,{hash:{}}):i===M?E.call(e,"intl",t,{hash:{}}):i,a+=_(t)+" ",t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getAddress"),typeof t===A?t=t.call(e,{hash:{}}):t===M&&(t=E.call(e,"this.getAddress",{hash:{}})),a+=_(t)+'\n                </span>\n                <span class="panelRight">\n                    <span class="overflowText">',t="mm_email_helper_created",g=n.intl,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===A?i.call(e,t,{hash:{}}):i===M?E.call(e,"intl",t,{hash:{}}):i,a+=_(t)+" ",t="createdAt",g=n.live_timestamp,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"live_timestamp"),t=typeof i===A?i.call(e,t,{hash:{}}):i===M?E.call(e,"live_timestamp",t,{hash:{}}):i,a+=_(t)+"</span>\n                </span>\n            </div></a>\n         "}function d(e,t){var i,a,s="";return s+="\n        ",g=n.dynamicPanel,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"dynamicPanel"),a=n["if"],b=v.program(11,u,t),b.hash={},b.fn=b,b.inverse=v.program(14,p,t),i=a.call(e,i,b),(i||0===i)&&(s+=i),s+="\n    "}function u(e,t){var i,a,s="";return s+="\n            ",g=n.panelSections,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"panelSections"),a=n.each,b=v.program(12,h,t),b.hash={},b.fn=b,b.inverse=v.noop,i=a.call(e,i,b),(i||0===i)&&(s+=i),s+="\n        "}function h(e){var t,n="";return n+='\n                <div id="',t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"id"),typeof t===A?t=t.call(e,{hash:{}}):t===M&&(t=E.call(e,"this.id",{hash:{}})),n+=_(t)+'" style="height:',t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"height"),typeof t===A?t=t.call(e,{hash:{}}):t===M&&(t=E.call(e,"this.height",{hash:{}})),n+=_(t)+'" class="panelSection ',t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"class_name"),typeof t===A?t=t.call(e,{hash:{}}):t===M&&(t=E.call(e,"this.class_name",{hash:{}})),n+=_(t)+'">\n                    ',t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"body"),typeof t===A?t=t.call(e,{hash:{}}):t===M&&(t=E.call(e,"this.body",{hash:{}})),(t||0===t)&&(n+=t),n+="\n                </div>\n            "}function p(e){var t,i,a="";return a+='\n            <div class="header">\n                <div class="buttons-panel close-header-margin">\n                    <span class="close-icon close-header" id="paneHover"></span>\n                </div>\n                <div class="buttons-panel question-header-margin">\n                    <a href="https://www.abine.com/maskme/faq/#aliasemail" target="_blank"><span class="question-icon" id="paneHover"></span></a>\n                </div>\n                <img class="panel-icon" src="',t="/pages/images/manage/maskme_logo_short_green.png",g=n.assetUrl,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===A?i.call(e,t,{hash:{}}):i===M?E.call(e,"assetUrl",t,{hash:{}}):i,a+=_(t)+'"/>\n            </div>\n            <a href="javascript:void(0);" class="getStarted">\n                <div class="element" id="mask">\n                <span class="panelLeft">\n                    ',t="mm_helper_installed",g=n.intl,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===A?i.call(e,t,{hash:{}}):i===M?E.call(e,"intl",t,{hash:{}}):i,a+=_(t)+"\n                </span>\n                </div>\n            </a>\n        "}n=n||e.helpers;var f,m,g,b,y="",v=this,A="function",E=n.helperMissing,M=void 0,_=this.escapeExpression,w=n.blockHelperMissing;return y+='<div class="panel">\n    ',g=n.hasRegistered,f=g||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"hasRegistered"),m=n["if"],b=v.program(1,s,a),b.hash={},b.fn=b,b.inverse=v.program(10,d,a),f=m.call(t,f,b),(f||0===f)&&(y+=f),y+="\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/email_helper/panel"]}),ABINEMASKME.define("abine/views/emailHelperPanel",["documentcloud/underscore","jquery","duckbone/core","models","abine/views/panelBase","abine/timer","abine/contentMessenger","abine/proxies"],function(e,t,n,i,a,s,r,o){var l=a.extend({templateName:"email_helper_panel",events:{"click a.primaryEmail":"fillWithPrimaryEmail","click a.disposableEmail":"fillWithDisposableEmail","click a.usedEmail":"fillWithUsedEmail","click a.getStarted":"getStarted","click a.disabled":"closePanel","click .panelSection":"performActions","click a.enableAccount":"enableAccount","click .errorReportLink":"makeErrorReport"},makeErrorReport:function(){this.messenger=this.messenger||new r.ContentMessenger,this.messenger.send("window:createTab",{localUrl:"pages/index.html#errorReport/email_dropdown"}),this.closePanel()},afterInitialize:function(){this.field=this.options.field,this.numMenuOptions=3,this.bindBaseEvents(),this.applyFadingStyle(),this.fadeIn(),this.contentManager=this.options.contentManager,this.model={primaryEmail:!1,hasRegistered:this.options.hasRegistered,dynamicPanel:this.options.dynamicPanel},this.options.dynamicPanel&&(this.setupDynamicPanel(),this.model.panelSections=this.panelSections),this.model.shieldedEmails=new i.ShieldedEmailCollection,this.model.shieldedEmails.fetchAll({success:e.bind(function(){this.model.shieldedEmails.length>0&&(this.model.primaryEmail=this.model.shieldedEmails.at(0)),this.model.primaryEmail?(this.model.disposableEmails=new i.DisposableEmailCollection,this.model.disposableEmails.fetchAllByDomain(this.options.domain,e.bind(function(){this.bind("enter0",function(e){this.fillWithDisposableEmail(e)}),this.bind("enter1",function(e){this.fillWithPrimaryEmail(e)}),this.numMenuOptions=this.model.disposableEmails.length+2;for(var e=2;this.numMenuOptions>e;e++)this.bind("enter"+e,function(e,t){this.fillWithUsedEmail(e,t)});this.render()},this))):(this.model.dynamicPanel?this.contentManager.messenger.send("update:panelActivity:impression",{panelId:this.model.dynamicPanel.id}):this.bind("enter0",function(e){this.getStarted(e)},this),this.render())},this)})},fillWithPrimaryEmail:function(e){if(e&&e.preventDefault(),this.field&&this.model.primaryEmail&&!ABINEMASKME.contentuser.hasRegEmail())this.fillFieldsByType(this.options.fields,"/contact/email",this.model.primaryEmail.getAddress(),{domain:this.options.domain,origin:"primary"});else if(ABINEMASKME.contentuser.hasRegEmail())return this.openSetupEmailPage(),void 0;this.closePanel()},fillWithDisposableEmail:function(t){if(t&&t.preventDefault(),!this.field.element.hasAttribute("generatingDisposable")){this.field.element.setAttribute("generatingDisposable","true"),this.$(".loading").show();var n=this.model.primaryEmail.generateDisposable(this.options.domain);n.save({},{success:e.bind(function(){this.field.disposableGUID=n.get("guid"),this.fillFieldsByType(this.options.fields,"/contact/email",n.getAddress(),{domain:this.options.domain,origin:"disposable",disposableGUID:n.get("guid")}),s.setTimeout(e.bind(function(){this.options.contentManager.showNotification({msg:"Click here to control your new Masked Email.",targetUrl:"pages/index.html#home/emails/",targetId:n.get("guid")})},this),1e3),this.closePanel(),this.field.element.removeAttribute("generatingDisposable"),o.licenseModule.postInstallCompleted({silent:!0})},this),error:e.bind(function(e){this.$(".disposableEmail").hide(),e&&"9"==e.statusCode?this.$(".accountDisabledBtn").show():this.$(".errorBtn").show()},this)})}},enableAccount:function(e){this.messenger=this.messenger||new r.ContentMessenger,this.messenger.send("window:createTab",{localUrl:"pages/index.html#emailDisabled"}),this.closePanel(e)},fillWithUsedEmail:function(n,i){n&&n.preventDefault();var a;if(i||0==i){var s=e(this.el.children[0].children).filter(function(e){return t(e).is("a")&&!t(e).hasClass("disabled")});a=t(s[i]).attr("aliasAddress")}else a=t(n.target).closest("a").attr("aliasAddress");this.fillFieldsByType(this.options.fields,"/contact/email",a,{domain:this.options.domain,origin:"disposable"}),this.closePanel()}});return l}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/error_report/error_report"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<div class="feedback">\n  <h3>',i="mm_errorReport_lead",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+=' <span id="errorType"></span></h3>\n  <p>',i="mm_errorReport_body",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+="</p>\n\n  ",i="feedback",s=n.child,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"child",i,{hash:{}}):a,r+=d(i)+"\n</div>\n"
}),ABINEMASKME.CompiledTemplates["views/error_report/error_report"]}),ABINEMASKME.define("abine/views/errorReport",["documentcloud/underscore","jquery","models","duckbone/core","abine/eventLogger","abine/views/feedback","abine/intl"],function(e,t,n,i,a,s,r){var o=i.View.extend({templateName:"error_report_error_report",afterInitialize:function(){},createChildren:function(){this.defaultMessage="high_risk_country"==this.options.reason?r.getText("mm_errorReport_high_risk_country"):"banned_user"==this.options.reason?r.getText("mm_errorReport_banned_user"):"email_dropdown"==this.options.reason?r.getText("mm_errorReport_email_dropdown"):"loading_card_create_panel"==this.options.reason?r.getText("mm_errorReport_loading_card_create_panel"):"loading_hold_on_payment"==this.options.reason?r.getText("mm_errorReport_loading_hold_on_payment"):"manage_emails_error"==this.options.reason?r.getText("mm_errorReport_loading_manage_email"):"loading_manage_password"==this.options.reason?r.getText("mm_errorReport_loading_manage_password"):"loading_manage_phones"==this.options.reason?r.getText("mm_errorReport_loading_manage_phones"):"loading_recurly_info_on_activation"==this.options.reason?r.getText("mm_errorReport_loading_recurly_info_on_activation"):"loading_manage_cards"==this.options.reason?r.getText("mm_errorReport_loading_manage_cards"):"loading_manage_cards_create"==this.options.reason?r.getText("mm_errorReport_loading_manage_cards_create"):"loading_manage_cards_gift_create"==this.options.reason?r.getText("mm_errorReport_loading_manage_cards_gift_create"):"loading_manage_cards_refresh"==this.options.reason?r.getText("mm_errorReport_loading_manage_cards_refresh"):"loading_sites"==this.options.reason?r.getText("mm_errorReport_loading_sites"):"loading_timeline"==this.options.reason?r.getText("mm_errorReport_loading_timeline"):"loading_card_details"==this.options.reason?r.getText("mm_errorReport_loading_card_details"):r.getText("mm_errorReport_defaultMessage");var e=new s({model:new n.Feedback({successMsg:r.getText("mm_errorReport_successMsg"),leadMsg:r.getText("mm_errorReport_successLead"),defaultMessage:this.defaultMessage}),source:this.options.reason?this.options.reason:"unknown error"});return{feedback:e}}},{routeName:"errorReport",routeAction:function(e){ABINEMASKME.App.loadView(o,{reason:e})}});return o}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/feedback/feedback"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<div class="alert alert-error" id="feedbackError" style="display:none;">\n    ',i="mm_feedback_serverError",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'\n</div>\n<div class="alert alert-success" id="feedbackSuccess" style="display:none;">\n    <p class="lead">',s=n.getSuccessLeadMsg,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getSuccessLeadMsg"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"getSuccessLeadMsg",{hash:{}})),(i||0===i)&&(r+=i),r+="</p>\n    <p>",s=n.getSuccessMsg,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getSuccessMsg"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"getSuccessMsg",{hash:{}})),(i||0===i)&&(r+=i),r+='</p>\n</div>\n\n<div id="feedbackForm">\n<form class="form-horizontal well">\n    <fieldset>\n        <div class="control-group">\n            <label class="control-label" for="name"> ',i="mm_feedback_name",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+='</label>\n            <div class="controls">\n               <input type="text" id="name" />\n            </div>\n        </div>\n        <div class="control-group">\n            <label class="control-label" for="email"> ',i="mm_feedback_email",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+='</label>\n            <div class="controls">\n                <input type="text" id="email" /> <input type="button" class="btn" id="generateMasked" value=\'',i="mm_feedback_useMasked",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+='\' />\n                <div class="help-block">',i="mm_feedback_emailHelp",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+='</div>\n            </div>\n        </div>\n        <div class="control-group">\n            <label class="control-label" for="message"> ',i="mm_feedback_message",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+' </label>\n            <div class="controls">\n                <textarea id="message"></textarea>\n            </div>\n        </div>\n        <div class="controls">\n            <input type="submit" id="submitFeedback" class="btn btn-primary" value="',i="mm_feedback_sendFeedback",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'" />\n            <img id="spinner" style="display:none;width:15px;" src="',i="/pages/images/ajax_loader.gif",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" />\n        </div>\n    </fieldset>\n</form>\n</div>\n'}),ABINEMASKME.CompiledTemplates["views/feedback/feedback"]}),ABINEMASKME.define("abine/views/feedback",["documentcloud/underscore","jquery","duckbone/core","models","abine/views/commonhelpers","abine/config","abine/contentMessenger","abine/proxies"],function(e,t,n,i,a,s,r,o){var l=n.View.extend({templateName:"feedback_feedback",afterInitialize:function(){this.model.attributes.message=this.model.attributes.defaultMessage,t(this.el).find("textarea").val(this.model.get("message")),this.model.get("message")||t(this.el).find(".form_submit").addClass("disabled"),t(this.el).find("textarea").attr("placeholder",this.model.attributes.messagePlaceholder),this.model.has("buttonText")&&t(this.el).find("#submitFeedback").val(this.model.attributes.buttonText),this.source=this.options.source,this.cardInfo=this.options.cardInfo?this.options.cardInfo:""},events:{"click #submitFeedback":"sendFeedback","click #generateMasked":"generateDisposable","keyup #message":"enableSubmit"},feedbackSuccess:function(){t(this.el).find("#feedbackForm").hide(),t(this.el).find("#spinner").hide(),t(this.el).find("div.alert-success").show()},feedbackError:function(){t(this.el).find("div.alert-error").show(),t(this.el).find("#spinner").hide()},sendFeedback:function(n){n&&n.preventDefault();var i=t(this.el).find("#message").val(),a=t(this.el).find("#name").val(),r=t(this.el).find("#email").val();t(this.el).find("#spinner").show(),t(this.el).find("div.alert-error").hide();var l={message:i,name:a,email:r,userAgent:window.navigator.userAgent,buildNum:s.buildNum,version:s.version,tags:s.tags.join(","),auth_token:ABINEMASKME.user.preferences.getPref("authToken"),source:this.source,cardInfo:this.cardInfo,premiumStatus:ABINEMASKME.user.isEntitledToPhone()};o.licenseModule.sendFeedbackEmail(l,e.bind(function(e){e?this.feedbackError():this.feedbackSuccess()},this))},generateDisposable:function(n){n.preventDefault();var i="MaskMe Feedback";if(i&&""!=i&&ABINEMASKME.user.shieldedEmail){var a=ABINEMASKME.user.shieldedEmail.generateDisposable();a.attributes.label=i,a.save({},{success:e.bind(function(){t(this.el).find("#email").val(a.getAddress())},this),error:e.bind(function(){},this)})}},hideMaskEmail:function(){t(this.el).find("#generateMasked").hide()},enableSubmit:function(){t(this.el).find("#message").val().length>0?t(this.el).find("#submitFeedback").removeAttr("disabled"):t(this.el).find("#submitFeedback").attr("disabled","disabled")}});return l}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/help/index"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<div class="page-header">\n    <h1>',i="mm_help_help",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</h1>\n    <p class="version">',i="mm_help_version",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+" ",i="version",s=n.configVar,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"configVar"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"configVar",i,{hash:{}}):a,r+=d(i)+"<br />",i="mm_help_buildNumber",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+" ",i="buildNum",s=n.configVar,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"configVar"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"configVar",i,{hash:{}}):a,r+=d(i)+'</p>\n</div>\n\n<div class="faq">\n\n	<p>\n        <h3> ',i="mm_help_top5",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+' </h3>\n        <ol>\n            <li> <a href="https://www.abine.com/maskme/faq/#aliasemail" target="_blank"> <em>',i="mm_help_whatMaskedEmail",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</em> </a> </li>\n            <li> <a href="https://www.abine.com/maskme/faq/#whatissync" target="_blank"> <em>',i="mm_help_howAccess",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</em> </a> </li>\n            <li> <a href="https://www.abine.com/maskme/faq/#noemail" target="_blank"> <em>',i="mm_help_noEmails",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</em> </a> </li>\n            <li> <a href="https://www.abine.com/maskme/faq/#locking" target="_blank"> <em>',i="mm_help_howPrevent",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</em> </a> </li>\n            <li> <a href="https://www.abine.com/maskme/faq/#whatitstores" target="_blank"> <em>',i="mm_help_whatDoes",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+='</em> </a> </li>\n	    </ol>\n	</p>\n\n    <p>\n	    <a href="https://www.abine.com/maskme/faq/" target="_blank">\n	        <button class="btn btn-primary" id="faq_btn"><i class="icon-info-sign icon-white"/> ',i="mm_help_seeMore",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</button>\n	    </a>\n	    <a href="https://www.abine.com/phpBB3/viewforum.php?f=7&sid=3db957f6f95c83c3be99123e77f97cff" target="_blank">\n            <button class="btn btn-primary" id="forum_btn"><i class="icon-comment icon-white"/> ',i="mm_help_forums",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</button>\n        </a>\n    </p>\n\n</div>\n\n<div class="feedback">\n<h3>',i="mm_help_haveFeedback",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+"</h3>\n<p>",i="mm_help_loveToHear",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+"</p>\n    ",i="feedback",s=n.child,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"child",i,{hash:{}}):a,r+=d(i)+"\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/help/index"]}),ABINEMASKME.define("abine/views/helpIndex",["documentcloud/underscore","jquery","duckbone/core","models","abine/views/feedback","wycats/handlebars","abine/config","abine/timer","abine/intl"],function(e,t,n,i,a,s,r,o,l){var c=n.View.extend({templateName:"help_index",createChildren:function(){var e={};return e.feedback=new a({model:new i.Feedback({leadMsg:l.getText("mm_feedback_thanks"),successMsg:l.getText("mm_feedback_workingHard"),messagePlaceholder:"Your truly appreciated feedback goes here.",buttonText:l.getText("mm_feedback_sendFeedback")}),source:"help"}),e},render:function(){this.renderTemplate()}},{routeName:"helpIndex",routeAction:function(){ABINEMASKME.App.loadView(c)}});return c}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/help_cards/index"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<ul class="breadcrumb" id="homeBreadCrumb">\n  <li><a href="#/home">',i="mm_payment_home",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</a> <span class="divider">/</span></li>\n  <li class="active">Masked Cards FAQ</li>\n</ul>\n\n<ul class="breadcrumb" id="cardsBreadCrumb" style="display:none;">\n  <li><a href="#/home">',i="mm_payment_home",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</a> <span class="divider">/</span></li>\n  <li><a href="#/payments">',i="mm_payment_card",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</a> <span class="divider">/</span></li>\n  <li class="active">Masked Cards FAQ</li>\n</ul>\n\n<div id="activationSuccessful">\n    <div class="">\n        <div class="alert alert-success">\n            <h5><i class="icon-check"></i> You\'re ready to start using Masked Cards.</h5>\n            If you were in the middle of a purchase, refresh that page to see the \'Mask My Card\' option.\n        </div>\n\n        <div class="row">\n            <div class="span4"><h5 class="step2">Look for this option when you click credit card fields:</h5></div>\n            <div class="span4"><img src="',i="/pages/images/manage/card-input.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" style="margin-top:15px;"/></div>\n        </div>\n        <br/>\n        <br/>\n        <a href="#payments" class="btn btn-primary">Check out the Masked Cards page</a>\n        <p><strong>Remember:</strong> this is a beta feature. We\'d love to hear your thoughts. <a href="mailto:support@getabine.com">Send us an email</a>.</p>\n\n    </div>\n</div>\n\n<div id="nonActivationFlowDiv" style="display:none;">\n    <p><strong>Remember:</strong> this is a beta feature. We\'d love to hear your thoughts. <a href="mailto:support@getabine.com">Send us an email</a>.</p>\n</div>\n<br>\n<div id="faq">\n    <div class="well">\n        <h4>Top 5 Frequently Asked Questions</h4>\n        <ol>\n            <li><a href="https://www.abine.com/masked-card-faq/#statement" target="_blank">What appears on my credit card statement?</a></li>\n            <li><a href="https://www.abine.com/masked-card-faq/#use" target="_blank">Where can I use Masked Cards?</a></li>\n            <li><a href="https://www.abine.com/masked-card-faq/#chargebacks" target="_blank">What if I want to get a refund for a purchase on a Masked Card? How do you handle charge-backs?</a></li>\n            <li><a href="https://www.abine.com/masked-card-faq/#refund" target="_blank">Can I get a refund for Masked Cards I don\'t use?</a></li>\n            <li><a href="https://www.abine.com/masked-card-faq/#billing" target="_blank">What billing information should I enter into the website checkout form?</a></li>\n        </ol>\n        <a href="https://www.abine.com/masked-card-faq/" class="btn btn-info" target="_blank">Masked Cards Frequently Asked Questions</a>\n    </div>\n</div>\n'}),ABINEMASKME.CompiledTemplates["views/help_cards/index"]}),ABINEMASKME.define("abine/views/helpCardsIndex",["documentcloud/underscore","jquery","duckbone/core","models","abine/views/feedback","wycats/handlebars","abine/config","abine/timer"],function(e,t,n){var i=n.View.extend({templateName:"help_cards_index",afterInitialize:function(){this.options&&0==this.options.activationFlow&&(t(this.el).find("#homeBreadCrumb").hide(),t(this.el).find("#activationSuccessful").hide(),t(this.el).find("#nonActivationFlowDiv").show(),t(this.el).find("#cardsBreadCrumb").show())}},{routeName:"helpCardsIndex",routeAction:function(){ABINEMASKME.App.loadView(i)}});return i}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/hold_on/blacklist"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r,o="",l="function",c=n.helperMissing,d=void 0;return o+='<div class="modal hide fade" id="holdOnBlacklist">\n  <div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal">&times;</button>\n    <h3 id="blacklistLabel">',r=n.site,i=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"site"),a="mm_hold_on_blacklist",r=n.intl,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"intl",a,i,{hash:{}}):s,(i||0===i)&&(o+=i),o+='</h3>\n  </div>\n  <div class="modal-body">\n    <p>',i="mm_hold_on_blacklistWarning",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</p>\n  </div>\n  <div class="modal-footer">\n    <button id="deleteEverythingBtn" class="btn">',i="mm_hold_on_delete",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</button>\n    <button class="btn btn-primary" data-dismiss="modal">',i="mm_hold_on_nevermind",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+="</button>\n  </div>\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/hold_on/blacklist"]}),ABINEMASKME.define("abine/views/holdOnBlacklistView",["documentcloud/underscore","jquery","duckbone/core","models","abine/eventLogger"],function(e,t,n,i,a){var s=n.View.extend({templateName:"hold_on_blacklist",events:{},afterInitialize:function(){a.debug("Initialized blacklist cowboy")}});return s}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/hold_on/cowboy"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r,o="",l="function",c=n.helperMissing,d=void 0,u=this.escapeExpression;return o+='<div class="modal hide fade" id="holdOnCowboy',r=n.getId,i=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getId"),typeof i===l?i=i.call(t,{hash:{}}):i===d&&(i=c.call(t,"getId",{hash:{}})),o+=u(i)+'">\n  <div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal">&times;</button>\n    <h3 id="cowboyLabel">',i="mm_hold_on_cowboy",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</h3>\n  </div>\n  <div class="modal-body">\n    <p>',r=n.getDomain,i=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getDomain"),a="mm_hold_on_warning",r=n.intl,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"intl",a,i,{hash:{}}):s,(i||0===i)&&(o+=i),o+='</p>\n  </div>\n  <div class="modal-footer">\n    <button id="deleteEverythingBtn" class="btn">',i="mm_hold_on_delete",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</button>\n    <button class="btn btn-primary" data-dismiss="modal">',i="mm_hold_on_nevermind",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+="</button>\n  </div>\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/hold_on/cowboy"]}),ABINEMASKME.define("abine/views/holdOnCowboyView",["documentcloud/underscore","jquery","duckbone/core","models","abine/eventLogger"],function(e,t,n,i,a){var s=n.View.extend({templateName:"hold_on_cowboy",events:{},afterInitialize:function(){a.debug("Initialized cowboy")}});return s}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/hold_on/email"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r,o="",l="function",c=n.helperMissing,d=void 0,u=this.escapeExpression;return o+='<div class="modal hide fade" id="holdOnEmail',r=n.getId,i=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getId"),typeof i===l?i=i.call(t,{hash:{}}):i===d&&(i=c.call(t,"getId",{hash:{}})),o+=u(i)+'">\n  <div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal">&times;</button>\n    <h3 id="cowboyLabel">',i="mm_hold_on_cowboy",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</h3>\n  </div>\n  <div class="modal-body">\n    <p>',r=n.getDomain,i=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getDomain"),a="mm_hold_on_email",r=n.intl,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"intl",a,i,{hash:{}}):s,(i||0===i)&&(o+=i),o+='</p>\n  </div>\n  <div class="modal-footer">\n    <button id="deleteEmailAndAccountBtn" class="btn">',i="mm_hold_on_deleteAccount",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</button>\n    <button class="btn btn-primary" data-dismiss="modal">',i="mm_hold_on_nevermind",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+="</button>\n  </div>\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/hold_on/email"]}),ABINEMASKME.define("abine/views/holdOnEmailView",["documentcloud/underscore","jquery","duckbone/core","models","abine/eventLogger"],function(e,t,n,i,a){var s=n.View.extend({templateName:"hold_on_email",events:{},afterInitialize:function(){a.debug("Initialized email cowboy")}});return s}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/hold_on/gift"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<div class="modal hide fade" id="holdOnGift">\n  <div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal">&times;</button>\n    <h3 id="cowboyLabel">',i="mm_hold_on_areYouSure",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+='</h3>\n  </div>\n  <div class="modal-body">\n    <p>',s=n.msg,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"msg"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"msg",{hash:{}})),r+=d(i)+'</p>\n  </div>\n  <div class="modal-footer cowboyOptions">\n    <button class="confirmCardBtn btn">Purchase Card</button>\n    <button class="btn btn-primary nevermindBtn" data-dismiss="modal">',i="mm_hold_on_nevermind",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+="</button>\n  </div>\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/hold_on/gift"]}),ABINEMASKME.define("abine/views/holdOnGiftView",["documentcloud/underscore","jquery","duckbone/core","models","abine/eventLogger","abine/views/loading_display"],function(e,t,n){var i=n.View.extend({templateName:"hold_on_gift",events:{},afterInitialize:function(){}});return i}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/hold_on/giftcardresend"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r,o="",l="function",c=n.helperMissing,d=void 0,u=this.escapeExpression;return o+='<div class="modal hide fade" id="holdOnGiftCardResend',r=n.getID,i=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getID"),typeof i===l?i=i.call(t,{hash:{}}):i===d&&(i=c.call(t,"getID",{hash:{}})),o+=u(i)+'">\n  <div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal">&times;</button>\n    <h3 id="cowboyLabel">',i="mm_hold_on_areYouSure",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</h3>\n  </div>\n  <div class="modal-body">\n    <p>',r=n.getRecipientEmail,i=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getRecipientEmail"),a="mm_hold_on_resendGiftEmailBody",r=n.intl,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"intl",a,i,{hash:{}}):s,o+=u(i)+'</p>\n     <div class="alert alert-error" style="display:none;" id="resendError">',i="mm_hold_on_resendGiftError",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'</div>\n  </div>\n  <div class="modal-footer cowboyOptions">\n    <img src="',i="/pages/images/ajax_loader.gif",r=n.assetUrl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"assetUrl",i,{hash:{}}):a,o+=u(i)+'" style="display:none;" id="resendGiftSpinner" />\n    <button class="resendGiftEmailBtn btn">',i="mm_hold_on_resendGiftEmail",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</button>\n    <button class="btn btn-primary nevermindBtn" data-dismiss="modal">',i="mm_hold_on_nevermind",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+="</button>\n  </div>\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/hold_on/giftcardresend"]}),ABINEMASKME.define("abine/views/holdOnGiftCardResendView",["documentcloud/underscore","jquery","duckbone/core","models","abine/eventLogger","abine/views/loading_display"],function(e,t,n,i,a,s){var r=n.View.extend({templateName:"hold_on_giftcardresend",events:{},afterInitialize:function(){a.debug("Initialized giftcardresend cowboy")},createChildren:function(){return this.children={loadingDisplay:new s({pageName:"hold_on_giftcardresend"})},this.children}});return r}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/hold_on/maskedemail"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<div class="modal hide fade" id="holdOnMaskedEmail',s=n.getId,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getId"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"getId",{hash:{}})),r+=d(i)+'">\n  <div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal">&times;</button>\n    <h3 id="cowboyLabel">',i="mm_hold_on_cowboy",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+='</h3>\n  </div>\n  <div class="modal-body">\n    <p>',i="mm_hold_on_maskedEmail",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+='</p>\n  </div>\n  <div class="modal-footer">\n    <button id="deleteAccount" class="btn">',i="mm_hold_on_maskedEmailDelete",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+='</button>\n    <button id="deleteExceptEmail" class="btn btn-primary" data-dismiss="modal">',i="mm_hold_on_maskedEmailDontDelete",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+="</button>\n  </div>\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/hold_on/maskedemail"]}),ABINEMASKME.define("abine/views/holdOnMaskedEmailView",["documentcloud/underscore","jquery","duckbone/core","models","abine/eventLogger"],function(e,t,n,i,a){var s=n.View.extend({templateName:"hold_on_maskedemail",events:{},afterInitialize:function(){a.debug("Initialized masked email cowboy")}});return s}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/hold_on/password"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r,o="",l="function",c=n.helperMissing,d=void 0,u=this.escapeExpression;return o+='<div class="modal hide fade" id="holdOnPassword',r=n.getId,i=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getId"),typeof i===l?i=i.call(t,{hash:{}}):i===d&&(i=c.call(t,"getId",{hash:{}})),o+=u(i)+'">\n  <div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal">&times;</button>\n    <h3 id="cowboyLabel">',i="mm_hold_on_cowboy",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</h3>\n  </div>\n  <div class="modal-body">\n    <p>',r=n.getDomain,i=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getDomain"),a="mm_hold_on_password",r=n.intl,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"intl",a,i,{hash:{}}):s,(i||0===i)&&(o+=i),o+='</p>\n  </div>\n  <div class="modal-footer">\n    <button id="deletePasswordAndAccountBtn" class="btn">',i="mm_hold_on_deleteAccount",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</button>\n    <button class="btn btn-primary" data-dismiss="modal">',i="mm_hold_on_nevermind",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+="</button>\n  </div>\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/hold_on/password"]}),ABINEMASKME.define("abine/views/holdOnPasswordView",["documentcloud/underscore","jquery","duckbone/core","models","abine/eventLogger"],function(e,t,n,i,a){var s=n.View.extend({templateName:"hold_on_password",events:{},afterInitialize:function(){a.debug("Initialized password cowboy")}});return s}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/hold_on/passwordless"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r,o="",l="function",c=n.helperMissing,d=void 0,u=this.escapeExpression;return o+='<div class="modal hide fade" id="holdOnPasswordless',r=n.getId,i=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getId"),typeof i===l?i=i.call(t,{hash:{}}):i===d&&(i=c.call(t,"getId",{hash:{}})),o+=u(i)+'">\n  <div class="modal-header">\n    <button type="button" class="close nevermind" data-dismiss="modal">&times;</button>\n    <h3 id="cowboyLabel">',i="mm_hold_on_cowboy",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</h3>\n  </div>\n  <div class="modal-body">\n    <p>',r=n.getDomain,i=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getDomain"),a="mm_hold_on_passwordless",r=n.intl,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"intl",a,i,{hash:{}}):s,(i||0===i)&&(o+=i),o+='</p>\n  </div>\n  <div class="modal-footer">\n    <button id="saveFromCowboy" class="btn">',i="mm_hold_on_save",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</button>\n    <button class="btn btn-primary nevermind" data-dismiss="modal">',i="mm_hold_on_nevermind",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+="</button>\n  </div>\n</div>\n"
}),ABINEMASKME.CompiledTemplates["views/hold_on/passwordless"]}),ABINEMASKME.define("abine/views/holdOnPasswordlessView",["documentcloud/underscore","jquery","duckbone/core","models","abine/eventLogger"],function(e,t,n,i,a){var s=n.View.extend({templateName:"hold_on_passwordless",events:{},afterInitialize:function(){a.debug("Initialized passwordless cowboy")}});return s}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/hold_on/payment"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<div class="modal hide fade" id="holdOnPayment',s=n.getID,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getID"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"getID",{hash:{}})),r+=d(i)+'">\n  <div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal">&times;</button>\n    <h3 id="cowboyLabel">',i="mm_hold_on_areYouSure",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+='</h3>\n  </div>\n  <div class="modal-body">\n    <p>',i="mm_hold_on_deactivateBody",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</p>\n    <p>\n        You will be refunded:\n        <span style="display:none;" id="loadingAmount',s=n.getID,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getID"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"getID",{hash:{}})),r+=d(i)+'"><img src="',i="/pages/images/ajax_loader.gif",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" /></span>\n        <span style="display:none;" id="amountLeft',s=n.getID,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getID"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"getID",{hash:{}})),r+=d(i)+'"></span>\n    </p>\n    <div class="deactivateLoading" style="display:none;">',i="loadingDisplay",s=n.child,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"child",i,{hash:{}}):a,r+=d(i)+'</div>\n    <div style="display:none;" class="alert alert-error deactivateError"></div>\n  </div>\n  <div class="modal-footer cowboyOptions">\n    <button class="deactivateCardBtn btn">',i="mm_hold_on_deactivateAccount",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+='</button>\n    <button class="btn btn-primary" id="okBtn" data-dismiss="modal" style="display:none;">',i="mm_hold_on_ok",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+='</button>\n    <button class="btn btn-primary nevermindBtn" data-dismiss="modal">',i="mm_hold_on_nevermind",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+="</button>\n  </div>\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/hold_on/payment"]}),ABINEMASKME.define("abine/views/holdOnPaymentView",["documentcloud/underscore","jquery","duckbone/core","models","abine/eventLogger","abine/views/loading_display"],function(e,t,n,i,a,s){var r=n.View.extend({templateName:"hold_on_payment",events:{},afterInitialize:function(){a.debug("Initialized payment cowboy")},createChildren:function(){return this.children={loadingDisplay:new s({pageName:"hold_on_payment"})},this.children}});return r}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/hold_on/site"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r,o="",l="function",c=n.helperMissing,d=void 0,u=this.escapeExpression;return o+='<div class="modal hide fade" id="holdOnSite',r=n.getId,i=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getId"),typeof i===l?i=i.call(t,{hash:{}}):i===d&&(i=c.call(t,"getId",{hash:{}})),o+=u(i)+'">\n  <div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal">&times;</button>\n    <h3 id="cowboyLabel">',i="mm_hold_on_cowboy",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</h3>\n  </div>\n  <div class="modal-body">\n    <p>',r=n.getDomain,i=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getDomain"),a="mm_hold_on_site",r=n.intl,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"intl",a,i,{hash:{}}):s,(i||0===i)&&(o+=i),o+='</p>\n  </div>\n  <div class="modal-footer">\n    <button id="deleteSiteAndAccountBtn" class="btn">',i="mm_hold_on_delete",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</button>\n    <button class="btn btn-primary" data-dismiss="modal">',i="mm_hold_on_nevermind",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+="</button>\n  </div>\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/hold_on/site"]}),ABINEMASKME.define("abine/views/holdOnSiteView",["documentcloud/underscore","jquery","duckbone/core","models","abine/eventLogger"],function(e,t,n,i,a){var s=n.View.extend({templateName:"hold_on_site",events:{},afterInitialize:function(){a.debug("Initialized site cowboy")}});return s}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/home/home"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='</br>\n</br>\n</br>\n<div id="row1" class="row home homeGrid" style="margin-left:60px;text-align:center;">\n    <div id="icon1" class="span3 hover hoverOut">\n        <a href="#home/emails">\n            <img src="',i="/pages/images/manage/MailOFF.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'"/>\n            <h4>',i="mm_home_maskedEmails",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+"</h4>\n            <p>",i="mm_home_maskedEmailsDesc",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</p>\n        </a>\n    </div>\n    <div id="icon2" class="span3 hover hoverOut">\n        <a href="#" class="managePhone">\n          <img id="phoneImage" src="',i="/pages/images/manage/PhoneOFF.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'"/>\n          <h4>',i="mm_home_maskedPhones",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+"</h4>\n          <p>",i="mm_home_maskedPhonesDesc",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</p>\n        </a>\n    </div>\n\n    <div id="icon3" class="paymentsIcon span3 hover hoverOut">\n        <a href="#" class="managePayments">\n            <img id="cardsImage" src="',i="/pages/images/manage/CardOFF.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'"/>\n            <h4>',i="mm_home_maskedCard",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+"</h4>\n            <p>",i="mm_home_maskedCardDesc",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</p>\n        </a>\n    </div>\n</div>\n\n<div id="row2" class="row home homeGrid offset2" style="margin-top:40px;margin-left:175px;text-align:center;">\n    <div id="icon4" class="span3 hover hoverOut">\n        <a href="#home/passwords">\n            <img src="',i="/pages/images/manage/PasswordOFF.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'"/>\n            <h4>',i="mm_home_encryptedPasswords",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+"</h4>\n            <p>",i="mm_home_encryptedPasswordsDesc",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</p>\n        </a>\n    </div>\n\n    <div id="icon5" class="span3 hover hoverOut">\n         <a href="#sites">\n             <img src="',i="/pages/images/manage/AccountsOFF.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'"/>\n             <h4>',i="mm_home_accountList",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+"</h4>\n             <p>",i="mm_home_accountListDesc",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</p>\n         </a>\n    </div>\n\n    <div class="span2"></div>\n</div>\n\n</div>\n\n<div style="width:500px;height:10px;position:relative;margin-left:auto;margin-right:auto;margin:0px;padding:0px;overflow:hidden"></div>\n\n\n<div class="row">\n    <div class="span7 offset2">\n        <div class="homeFooter">\n            <a href="http://youtu.be/PYfZDesjIQk" target="_blank"><i class="icon-play-circle"></i> ',i="mm_home_introVideo",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</a> |\n            <a href="https://www.abine.com/maskme/emails/" target="_blank"><i class="icon-info-sign"></i> ',i="mm_home_gettingStarted",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</a> |\n            <a href="https://www.abine.com/products/maskme/support/datause.php" target="_blank"><i class="icon-lock"></i> ',i="mm_home_dataPrivacy",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+"</a>\n        </div>\n    </div>\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/home/home"]}),ABINEMASKME.define("abine/views/home",["documentcloud/underscore","jquery","models","duckbone/core","abine/proxies","abine/config"],function(e,t,n,i,a,s){var r=i.View.extend({templateName:"home_home",events:{"mouseover div.hover":"hoverOn","mouseout div.hoverOut":"hoverOff","click .managePhone":"openPlansIfFree","click .managePayments":"paymentsOrPlans"},afterInitialize:function(){if(s.payments&&!ABINEMASKME.user.isEntitledToPayments()){var e=t(this.el).find("#cardsImage").attr("src").replace(".png","-g.png");t(this.el).find("#cardsImage").attr("src",e);var n=t(this.el).find("#phoneImage").attr("src").replace(".png","-g.png");t(this.el).find("#phoneImage").attr("src",n)}},hoverOn:function(e){var n;n="DIV"!=e.target.nodeName?t(e.target.parentNode).find("img"):t(e.target).find("img");var i=t(n).attr("src").replace("OFF","ON");t(n).attr("src",i)},hoverOff:function(e){var n;n="DIV"!=e.target.nodeName?t(e.target.parentNode).find("img"):t(e.target).find("img");var i=t(n).attr("src").replace("ON","OFF");t(n).attr("src",i)},paymentsOrPlans:function(){s.payments&&(ABINEMASKME.user.isEntitledToPayments()?ABINEMASKME.App.navigate("payments",!0):a.securityManager.openPage(ABINEMASKME.user.getUpgradeLink({feature:"cards"}),!1))},openPlansIfFree:function(){ABINEMASKME.user.isEntitledToPhone()?ABINEMASKME.user.hasShieldedPhone()?ABINEMASKME.App.navigate("home/phones",!0):ABINEMASKME.App.navigate("editUser/phone",!0):a.securityManager.openPage(ABINEMASKME.user.getUpgradeLink({feature:"phone"}),!1)}},{routeName:"home",routeAction:function(){ABINEMASKME.App.loadView(r,{model:ABINEMASKME.user})}});return i.Security.showLoginWhenLocked(r),r}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/import/import"]=e.template(function(e,t,n,i,a){function s(e){var t,i,a="";return a+='\n<a id="import" class="btn btn-warning">',t="mm_privacy_suite_import",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,a+=v(t)+"</a>\n"}function r(e){var t,i,a,s="";return s+='\n    <div class="errorDiv alert alert-error">\n      ',h=n.getPrivacySuiteAddonName,t=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getPrivacySuiteAddonName"),i="mm_privacy_suite_login_required",h=n.intl,a=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof a===g?a.call(e,i,t,{hash:{}}):a===y?b.call(e,"intl",i,t,{hash:{}}):a,s+=v(t)+"\n    </div>\n"}function o(e,t){var i,a,s="";return s+="\n  ",h=n.canImportAccounts,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"canImportAccounts"),a=n["if"],p=m.program(6,l,t),p.hash={},p.fn=p,p.inverse=m.program(8,c,t),i=a.call(e,i,p),(i||0===i)&&(s+=i),s+="\n"}function l(e){var t,i,a,s,r="";return r+="\n    ",h=n.getPrivacySuiteAddonName,t=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getPrivacySuiteAddonName"),h=n.getTotalAccounts,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getTotalAccounts"),a="mm_privacy_suite_accounts_to_import",h=n.intl,s=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof s===g?s.call(e,a,i,t,{hash:{}}):s===y?b.call(e,"intl",a,i,t,{hash:{}}):s,r+=v(t)+'\n    <div class="showProgress well" style="display:none">\n      <div class="progress progress-striped active">\n        <div class="bar" style="width: 0%;"></div>\n      </div>\n      <div class="message"></div>\n      <a id="done" href="#sites" style="display:none;margin-top: 5px;" class="btn btn-primary">',t="mm_privacy_suite_done_action",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,r+=v(t)+'</a>\n    </div>\n    <div class="accounts">\n      ',t="sites",h=n.child,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"child"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"child",t,{hash:{}}):i,r+=v(t)+"\n    </table>\n  "}function c(e){var t,i,a="";return a+="\n      ",t="mm_privacy_suite_no_accounts",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,a+=v(t)+"\n  "}n=n||e.helpers;var d,u,h,p,f="",m=this,g="function",b=n.helperMissing,y=void 0,v=this.escapeExpression;return f+='<br/>\n<div class="clearfix">\n<h2>',h=n.getPrivacySuiteAddonName,d=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getPrivacySuiteAddonName"),typeof d===g?d=d.call(t,{hash:{}}):d===y&&(d=b.call(t,"getPrivacySuiteAddonName",{hash:{}})),f+=v(d)+"</h2>\n",h=n.canImportAccounts,d=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"canImportAccounts"),u=n["if"],p=m.program(1,s,a),p.hash={},p.fn=p,p.inverse=m.noop,d=u.call(t,d,p),(d||0===d)&&(f+=d),f+='\n<a id="refresh" class="btn btn-primary">',d="mm_privacy_suite_refresh",h=n.intl,u=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),d=typeof u===g?u.call(t,d,{hash:{}}):u===y?b.call(t,"intl",d,{hash:{}}):u,f+=v(d)+'</a>\n</div>\n<div class="clearfix">\n',h=n.isLoginRequired,d=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"isLoginRequired"),u=n["if"],p=m.program(3,r,a),p.hash={},p.fn=p,p.inverse=m.program(5,o,a),d=u.call(t,d,p),(d||0===d)&&(f+=d),f+="\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/import/import"]}),ABINEMASKME.define("abine/views/import",["jquery","models","duckbone/core","documentcloud/underscore","abine/proxies","abine/views/recheck","abine/views/holdOnCowboyView","abine/intl","abine/views/holdOnPasswordlessView","abine/views/holdOnMaskedEmailView"],function(e,t,n,i,a,s,r,o){var l=n.View.extend({templateName:"import_oneaccount",className:"import_oneaccount clearfix",afterInitialize:function(){e(this.el).addClass("acc"+this.model.id)},createChildren:function(){return{accounts:new c({collection:this.model.accounts})}}}),c=n.ListView.extend({tagName:"div",className:"",viewClass:l}),d=n.View.extend({templateName:"import_onesite",className:"import_onesite clearfix",events:{click:"toggleSite"},afterInitialize:function(){e(this.el).addClass("site"+this.model.id)},toggleSite:function(){this.$(".accounts",this.el).toggle()},createChildren:function(){return{accounts:new c({collection:this.model.accounts})}}}),u=n.ListView.extend({tagName:"div",className:"",viewClass:d}),h=n.View.extend({templateName:"import_import",events:{"click #refresh":"refresh","click #import":"importAccounts"},afterInitialize:function(){},createChildren:function(){var e={sites:new u({collection:this.model.sites})};return e},refresh:function(){this.model.load(i.bind(this.render,this))},updateProgress:function(e,t,n){this.$(".showProgress").show(),this.$(".showProgress .bar").css("width",Math.floor(100*(1*e/t))+"%"),this.$(".showProgress .message").text(n)},importNextSite:function(e,n,a,s){if(e++,e>=this.model.sites.length){var r=o.getText("mm_privacy_suite_import_done",[a-s]);return s>0&&(r+=" "+o.getText("mm_privacy_suite_import_duplicates",[s])),this.updateProgress(a,a,r),this.$(".progress").addClass("progress-success").removeClass("progress-striped"),this.$("#done").show(),void 0}var l=this.model.sites.at(e);this.$(".site"+l.get("id")).addClass("importing");var c=new t.Site({domain:l.get("domain"),name:l.get("name")});c.loadAccounts(!0,i.bind(function(){for(var r=l.accounts.length,d=0,u=i.bind(function(){this.$(".site"+l.get("id")).removeClass("importing").addClass(d==r?"done":"partial_done"),n+=r,this.updateProgress(n,a,o.getText("mm_privacy_suite_import_progress",[n,a])),i.defer(i.bind(this.importNextSite,this),e,n,a,s)},this),h=[],p=0;r>p;p++){for(var f=!1,m=l.accounts.at(p),g=0;c.accounts.length>g;g++){var b=c.accounts.at(g).get("name");if(b=b.replace(/\@.*/,""),b==m.get("name")){f=!0,s++;break}}f?this.$(".import_oneaccount.acc"+m.id).addClass("skipped"):(this.$(".import_oneaccount.acc"+m.id).addClass("imported"),h.push(i.bind(function(e,i){d++,this.updateProgress(n+d,a,o.getText("mm_privacy_suite_import_progress",[n+d,a]));var s=c.get("name")+" login account",r=new t.Account({name:e.get("name"),description:s,siteId:c.id,active:1,type:"login"});c.accounts.create(r,{success:function(){for(var n=0,a=0;e.fields.length>a;a++){var s=e.fields.at(a);if("checkbox"!=s.get("type")){var o=s.get("data_type");"/contact/email"!=o&&-1!=s.get("value").indexOf("@")&&(o="/contact/email");var l=new t.AccountField({accountId:r.id,name:s.get("name"),dataType:o,value:s.get("value"),latest:1,version:1,deleted:0,origin:""});r.accountFields.create(l,{success:function(){n++,n==e.fields.length&&i()}})}else n++}}})},this,m)))}i.async.series(h,u)},this))},importAccounts:function(){var e=this.model.getTotalAccounts();this.updateProgress(0,e,o.getText("mm_privacy_suite_init_import")),this.$(".import_onesite").removeClass("importing").removeClass("done").removeClass("partial_done"),this.$(".import_oneaccount").removeClass("imported").removeClass("skipped"),this.$(".progress").removeClass("progress-success").addClass("progress-striped"),this.$("#done").hide(),i.delay(i.bind(this.importNextSite,this,-1,0,e,0),500)}},{routeName:"import",routeAction:function(){var e=new t.PrivacySuite;e.load(function(){ABINEMASKME.App.loadView(h,{model:e})})}});return n.Security.showLoginWhenLocked(h),h}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/import/oneaccount"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s="",r="function",o=n.helperMissing,l=void 0,c=this.escapeExpression;return s+='<div class="name">',a=n.name,i=a||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"name"),typeof i===r?i=i.call(t,{hash:{}}):i===l&&(i=o.call(t,"name",{hash:{}})),s+=c(i)+"</div>\n"}),ABINEMASKME.CompiledTemplates["views/import/oneaccount"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/import/onesite"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<div class=name title="',s=n.domain,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"domain"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"domain",{hash:{}})),r+=d(i)+'">',s=n.name,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"name"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"name",{hash:{}})),r+=d(i)+"</div>\n<div class=count>",s=n.numAccounts,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"numAccounts"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"numAccounts",{hash:{}})),r+=d(i)+'</div>\n<div class=accounts style="display:none">\n  ',i="accounts",s=n.child,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"child",i,{hash:{}}):a,r+=d(i)+"\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/import/onesite"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/inbox/inbox"]=e.template(function(e,t,n,i,a){function s(){return'\n    <h4>This is your temporary inbox.</h4>\n    <div>\n        Any emails sent to your Masked Emails will appear here.  To get them in your personal inbox instead, <a href="#editUser/email">set up free forwarding</a>.\n    </div>\n'}function r(){return"\n    <h3>View recent mail here in case there is a delay forwarding masked mail</h3>\n"}function o(){return"\n        There have not been any mails sent to you in the last 4 hours.\n      "}function l(e){var t,i="";return i+="\n        There have not been any mails sent to ",h=n.shieldedEmail,t=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"shieldedEmail"),t=null===t||void 0===t||t===!1?t:ABINEMASKME.Duckbone.Handlebars.getAttr(t,"email"),typeof t===g?t=t.call(e,{hash:{}}):t===y&&(t=b.call(e,"shieldedEmail.email",{hash:{}})),i+=v(t)+" in the last 4 hours.\n      "}n=n||e.helpers;var c,d,u,h,p,f="",m=this,g="function",b=n.helperMissing,y=void 0,v=this.escapeExpression,A=n.blockHelperMissing;return f+='<ul class="breadcrumb">\n  <li><a href="#/home">',c="mm_manage_emails_home",h=n.intl,d=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),c=typeof d===g?d.call(t,c,{hash:{}}):d===y?b.call(t,"intl",c,{hash:{}}):d,f+=v(c)+'</a> <span class="divider">/</span></li>\n  <li><a class="backToMaskedEmails" href="#home/emails">',c="mm_manage_emails_maskedEmails",h=n.intl,d=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),c=typeof d===g?d.call(t,c,{hash:{}}):d===y?b.call(t,"intl",c,{hash:{}}):d,f+=v(c)+'</a><span class="divider">/</span></li>\n  <li class="active">Inbox</li>\n</ul>\n\n\n<div class="inboxView">\n  <div class="row" style="clear:both;margin-bottom:25px;text-align:center">\n',c="hasRegEmail",h=n.ifUser,d=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"ifUser"),p=m.program(1,s,a),p.hash={},p.fn=p,p.inverse=m.program(3,r,a),c=h&&typeof d===g?d.call(t,c,p):A.call(t,d,c,p),(c||0===c)&&(f+=c),f+='\n\n    <div style="margin-top:25px;">Note: Mails are only stored here for 4 hours</div>\n  </div>\n\n\n  <div class="loading" style="text-align:center;margin:auto;">\n    ',c="loading",h=n.child,d=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),c=typeof d===g?d.call(t,c,{hash:{}}):d===y?b.call(t,"child",c,{hash:{}}):d,f+=v(c)+'\n  </div>\n\n  <div class="alert alert-notice noWebmail" style="display:none;">\n      ',c="hasRegEmail",h=n.ifUser,d=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"ifUser"),p=m.program(5,o,a),p.hash={},p.fn=p,p.inverse=m.program(7,l,a),c=h&&typeof d===g?d.call(t,c,p):A.call(t,d,c,p),(c||0===c)&&(f+=c),f+='\n  </div>\n\n  <table class="table table-striped inboxTable" style="display:none;">\n      <thead>\n          <tr>\n            <th>Received</th>\n            <th>From</th>\n            <th>Subject</th>\n            <th>To</th>\n          </tr>\n      </thead>\n      ',c="tbody",d="inbox",h=n.child,u=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),c=typeof u===g?u.call(t,d,c,{hash:{}}):u===y?b.call(t,"child",d,c,{hash:{}}):u,f+=v(c)+'\n  </table>\n\n  <div class="modal hide fade mailModal">\n    <div class="modal-header">\n      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\n      <h3></h3>\n    </div>\n    <div class="modal-body">\n        <img class="ajaxSpinner" src="',c="/pages/images/ajax_loader.gif",h=n.assetUrl,d=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),c=typeof d===g?d.call(t,c,{hash:{}}):d===y?b.call(t,"assetUrl",c,{hash:{}}):d,f+=v(c)+'" />\n    </div>\n    <div class="modal-footer">\n      <a href="javascript:void(0);" class="btn closeMailModal">Close</a>\n    </div>\n  </div>\n</div>\n\n<div class="well post-install" style="display:none;text-align: center">\n    <h4>Ready?  Learn about Abine\'s security, our premium plans, videos, and other FAQ\'s</h4>\n    <a class="btn btn-primary btn-large" href="#userRegistration/finish">Finish</a>\n</div>\n'}),ABINEMASKME.CompiledTemplates["views/inbox/inbox"]}),ABINEMASKME.define("abine/views/inbox",["documentcloud/underscore","jquery","models","duckbone/core","abine/timer","abine/views/loading_display"],function(e,t,n,i,a,s){var r=i.View.extend({tagName:"tr",templateName:"inbox_onewebmail",events:{"click .backToMaskedEmails":"backToMaskedEmails","click .readMail":"readMail"},readMail:function(){this.model.trigger("fetchMail",this.model.get("subject")),this.model.fetchMail({success:e.bind(function(e){this.model.trigger("displayMail",e)},this),error:e.bind(function(e){this.model.trigger("fetchMail:error",e)},this)})},backToMaskedEmails:function(){ABINEMASKME.App.navigate("#home/emails",!0)},afterInitialize:function(){}}),o=i.ListView.extend({tagName:"tbody",viewClass:r}),l=i.View.extend({templateName:"inbox_inbox",events:{"click .closeMailModal":"closeModal"},afterInitialize:function(){"postinstall"==this.options.param&&this.$(".post-install").show()},closeModal:function(){t(this.el).find(".mailModal").modal("hide"),t(this.el).find(".modal-header h3").html(""),t(this.el).find(".modal-body").html("")},createChildren:function(){var i=new o({collection:new n.WebmailCollection}),a=new s;return i.collection.bind("fetchMail",function(e){t(this.el).find(".modal-header h3").html(e),t(this.el).find(".ajaxSpinner").show(),t(this.el).find(".mailModal").modal("show")},this),i.collection.bind("displayMail",function(e){t(this.el).find(".ajaxSpinner").hide(),e.html&&""!=e.html?t(this.el).find(".modal-body").html(e.html):t(this.el).find(".modal-body").append(t("<pre></pre>").text(e.txt))},this),i.collection.fetchAll({success:e.bind(function(){a.hide(),i.collection.length>0?t(this.el).find(".inboxTable").show():t(this.el).find(".noWebmail").show()},this),error:function(){}}),{inbox:i,loading:a}}},{routeName:"home/inbox",routeAction:function(e){ABINEMASKME.App.loadView(l,{model:ABINEMASKME.user,param:e})}});return i.Security.showLoginWhenLocked(l),l}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/inbox/onewebmail"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<td><span class="time-ago"><i class="icon-time"></i>&nbsp;',i="receivedMS",s=n.live_timestamp,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"live_timestamp"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"live_timestamp",i,{hash:{}}):a,r+=d(i)+"</span></td>\n<td>",s=n.getFrom,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getFrom"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"getFrom",{hash:{}})),r+=d(i)+'</td>\n<td><a href="javascript:void(0);" class="readMail">',s=n.subject,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"subject"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"subject",{hash:{}})),r+=d(i)+"</a></td>\n<td>",s=n.disposable,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"disposable"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"disposable",{hash:{}})),r+=d(i)+"</td>\n"}),ABINEMASKME.CompiledTemplates["views/inbox/onewebmail"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/layouts/main"]=e.template(function(e,t,n){return n=n||e.helpers,'<div id="navPlaceholder">\n\n</div>\n\n<div class="container">\n  <div class="row">\n    <div class="span11">\n      <section id="main_content">\n        <!-- Main application goes here -->\n      </section>\n    </div>\n  </div>\n</div>\n\n<div id="criticalProcessModal" class="modal hide">\n    <div class="modal-header">\n        <h3 id="criticalProcessHeader"></h3>\n    </div>\n\n    <div class="modal-body" style="padding-top:15px;padding-bottom:5px;">\n        <p id="criticalProcessBody"></p>\n        <div id="criticalProcessProgress" class="progress progress-striped active" style="margin-bottom:2px;">\n          <div id="criticalProcessBar" class="bar" style="width: 10%;"></div>\n        </div>\n    </div>\n\n    <div id="criticalProcessExtra" style="font-size:11px;font-weight:italic;text-align:center;padding-bottom:10px;">\n\n    </div>\n\n    <div id="criticalProcessFooter" class="hide modal-footer">\n        <a href="#" data-dismiss="modal" class="btn">Close</a>\n    </div>\n</div>\n'}),ABINEMASKME.CompiledTemplates["views/layouts/main"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/layouts/register"]=e.template(function(e,t,n){return n=n||e.helpers,'<div class="container">\n    <div class="row">\n        <div class="span11">\n            <section id="main_content">\n                <!-- Main application goes here -->\n            </section>\n        </div>\n    </div>\n</div>\n'}),ABINEMASKME.CompiledTemplates["views/layouts/register"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/loading_display/loading_display"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<div class="loading-display">\n  <div class="progress progress-striped active">\n    <div class="bar bar-info" style="width: 100%;"></div>\n  </div>\n  <div class="loading-message">\n    ',i="mm_loading_display_Loading",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'\n  </div>\n</div>\n<div class="refreshing-display" style="display:none;">\n    <img src="',i="/pages/images/ajax_loader.gif",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" />\n</div>\n'}),ABINEMASKME.CompiledTemplates["views/loading_display/loading_display"]}),ABINEMASKME.define("abine/views/loading_display",["documentcloud/underscore","jquery","duckbone/core","abine/timer","abine/intl"],function(e,t,n,i,a){var s=n.View.extend({templateName:"loading_display_loading_display",afterInitialize:function(){this.options.customMessages||(this.options.customMessages=["mm_loading_display_LotOfAccounts","mm_loading_display_StillWorking","mm_loading_display_HangOn","mm_loading_display_Sorry"]);
var n=0;this.changeMessage=i.setInterval(e.bind(function(){n>=this.options.customMessages.length?i.clearInterval(this.changeMessage):(t(this.el).find(".loading-message").html(a.getText(this.options.customMessages[n],"loading_"+this.options.pageName)),n++)},this),5e3)},reset:function(){i.clearInterval(this.changeMessage),t(this.el).find(".loading-message").html(""),this.afterInitialize()},hide:function(){i.clearInterval(this.changeMessage),t(this.el).find(".loading-display").hide(),t(this.el).find(".refreshing-display").hide()},startRefreshing:function(){t(this.el).find(".refreshing-display").show()}});return s}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/login_helper/panel"]=e.template(function(e,t,n,i,a){function s(e){var t,i,a="";return a+='\n    <!-- Login Accounts -->\n    <a href="#" class="mmKeyOption account acctIDLevel" acctID="',t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getAccountID"),typeof t===h?t=t.call(e,{hash:{}}):t===f&&(t=p.call(e,"this.getAccountID",{hash:{}})),a+=m(t)+'"><div class="element" id="mask">\n        <span class="panelLeft">\n            <img class="iconPos" src="',t="/pages/images/user-icon.png",l=n.assetUrl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"assetUrl",t,{hash:{}}):i,a+=m(t)+'"/>\n            ',t="mm_login_helper_loginAs",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,a+=m(t)+'\n        </span>\n        <span class="panelRight">\n          <span class="largeOverflowText">',t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getLoginForAccount"),typeof t===h?t=t.call(e,{hash:{}}):t===f&&(t=p.call(e,"this.getLoginForAccount",{hash:{}})),a+=m(t)+"</span>\n        </span>\n    </div></a>\n    "}n=n||e.helpers;var r,o,l,c,d="",u=this,h="function",p=n.helperMissing,f=void 0,m=this.escapeExpression;return d+='<div class="panel">\n\n    <!-- Logo and Panel Buttons -->\n    <div class="header">\n        <div class="buttons-panel close-header">\n            <span class="close-icon close-header" id="paneHover"></span>\n        </div>\n        <img class="panel-icon" src="',r="/pages/images/manage/maskme_logo_short_green.png",l=n.assetUrl,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),r=typeof o===h?o.call(t,r,{hash:{}}):o===f?p.call(t,"assetUrl",r,{hash:{}}):o,d+=m(r)+'"/>\n    </div>\n\n    ',l=n.accounts,r=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"accounts"),o=n.each,c=u.program(1,s,a),c.hash={},c.fn=c,c.inverse=u.noop,r=o.call(t,r,c),(r||0===r)&&(d+=r),d+="\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/login_helper/panel"]}),ABINEMASKME.define("abine/views/loginHelperPanel",["documentcloud/underscore","jquery","duckbone/core","models","abine/views/panelBase"],function(e,t,n,i,a){var s=a.extend({templateName:"login_helper_panel",events:{"click a.account":"fillWithAccount"},afterInitialize:function(){this.field=this.options.field,this.bindBaseEvents(),this.applyFadingStyle(),this.fadeIn(),this.contentManager=this.options.contentManager,this.model=new i.Site({domain:this.options.domain}),this.model.loadAccounts(!1,e.bind(function(){if(0===this.model.accounts.length)this.closePanel();else{this.numMenuOptions=this.model.accounts.length;for(var e=0;this.model.accounts.length>e;e++)this.bind("enter"+e,function(e,t){this.fillWithAccount(e,t)});this.render()}},this))},fillWithAccount:function(n,i){if(n&&n.preventDefault(),this.model&&this.model.accounts.length>0){var a;if(i||0==i){var s=e(this.el.children[0].children).filter(function(e){return t(e).is("a")&&!t(e).hasClass("disabled")});a=t(s[i]).attr("acctID")}else a=t(n.target).closest("a").attr("acctID");var r=this.model.accounts.find(function(e){return e.get("id")==a}),o={};e.each(this.options.fields,function(e){e.dataType&&(o[e.dataType]=e)});var l={};r.accountFields.each(function(e){e.has("dataType")&&(l[e.get("dataType")]=e.get("value"))}),e.each(e.keys(o),e.bind(function(e){e in l?this.fillFieldsByType(this.options.fields,e,l[e]):("/contact/email"==e&&"/nameperson/friendly"in l&&(this.fillFieldsByType(this.options.fields,e,l["/nameperson/friendly"]),o[e].element.value=l["/nameperson/friendly"]),"/nameperson/friendly"==e&&"/contact/email"in l&&this.fillFieldsByType(this.options.fields,e,l["/contact/email"]))},this)),this.model.filledAccountForSite(a,e.bind(function(){var e=this.options.contentManager.document.createEvent("Events");e.initEvent("abinemaskmesubmit",!0,!1),this.options.formEl.dispatchEvent(e),t(this.options.formEl).submit()},this))}}});return s}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/manage_emails/email"]=e.template(function(e,t,n,i,a){function s(e,t){var i,a,s="";return s+="\n\n      ",i="hasRegEmail",h=n.ifUser,a=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"ifUser"),p=m.program(2,r,t),p.hash={},p.fn=p,p.inverse=m.program(4,o,t),i=h&&typeof a===g?a.call(e,i,p):A.call(e,a,i,p),(i||0===i)&&(s+=i),s+="\n    "}function r(e){var t,i,a="";return a+='\n          <div class="header-left" style="margin-left:50px;">\n              <span class="badge badge-important numWebmails" style="float:left;display:none;position:relative;left:30px;"></span>\n              <img style="cursor:pointer;" src="',t="/pages/images/manage/MailOFF.png",h=n.assetUrl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"assetUrl",t,{hash:{}}):i,a+=v(t)+'" class="email_icon"/>\n          </div>\n          <div class="header-left" style="margin-left:50px;padding-top:1px;">\n              <h4>These are your Masked Emails.</h4>\n              <div style="">\n                  Emails will go to your <a href="javascript:void(0);" class="inbox_link">temporary inbox</a>.   To get them in your personal inbox <a href="#editUser/email">set up free forwarding</a>.\n              </div>\n          </div>\n      '}function o(e){var t,i,a="";return a+='\n          <div class="header-left" style="margin-left:50px;">\n              <span class="badge badge-important numWebmails" style="float:left;display:none;position:relative;left:30px;"></span>\n              <img style="cursor:pointer;" src="',t="/pages/images/manage/MailOFF.png",h=n.assetUrl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"assetUrl",t,{hash:{}}):i,a+=v(t)+'" class="email_icon"/>\n              <div class="masked-email">\n                  <p class="maskDisplay">',t="mm_manage_emails_yourMaskedEmails",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,a+=v(t)+'</p>\n              </div>\n          </div>\n         <div class="header-left" style="margin-left:50px;">\n             <img src="',t="/pages/images/manage/forward.png",h=n.assetUrl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"assetUrl",t,{hash:{}}):i,a+=v(t)+'" class="forward"/>\n             <div class="real-email">\n                ',t="mm_manage_emails_forwardTo",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,a+=v(t)+'\n                <p class="actualDisplay">',h=n.shieldedEmail,t=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"shieldedEmail"),t=null===t||void 0===t||t===!1?t:ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getAddress"),typeof t===g?t=t.call(e,{hash:{}}):t===y&&(t=b.call(e,"shieldedEmail.getAddress",{hash:{}})),a+=v(t)+"</p>\n             </div>\n         </div>\n      "}function l(e){var t,i,a="";return a+='\n         <img src="',t="/pages/images/manage/MailOFF.png",h=n.assetUrl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"assetUrl",t,{hash:{}}):i,a+=v(t)+'" class="email_icon"/>\n         <p class="setupEmail">',t="mm_manage_emails_youHaveNot",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,(t||0===t)&&(a+=t),a+="</p>\n    "}function c(e){var t,i,a,s="";return s+='\n<div class="data-display" style="display:none;">\n  <div class="errorDiv alert alert-error" style="display:none;">\n    ',t="mm_manage_emails_serverError",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,(t||0===t)&&(s+=t),s+='\n  </div>\n  <table class="table table-striped disposableEmailTable">\n    <thead>\n      <tr><th class="sort-column" id="sortby-desc-createdAt">',t="mm_manage_emails_created",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,s+=v(t)+'&nbsp;<i class="icon-chevron-down"></i></th>\n          <th class="sort-column" id="sortby-desc-domain">',t="mm_payment_usedFor",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,s+=v(t)+'&nbsp;<i class="icon-chevron-down"></i></th>\n          <th class="sort-column" id="sortby-desc-address">',t="mm_manage_emails_email",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,s+=v(t)+'&nbsp;<i class="icon-chevron-down"></i></th>\n          <th class="sort-column" id="sortby-desc-mails">',t="mm_manage_emails_timesEmailed",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,s+=v(t)+'&nbsp;<i class="icon-chevron-down"></i></th>\n          <th class="sort-column" id="sortby-desc-active">',t="mm_manage_emails_active",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,s+=v(t)+'&nbsp;<i class="icon-chevron-down"></i></th>\n      </tr>\n    </thead>\n    ',t="tbody",i="disposableEmailList",h=n.child,a=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"child"),t=typeof a===g?a.call(e,i,t,{hash:{}}):a===y?b.call(e,"child",i,t,{hash:{}}):a,s+=v(t)+'\n  </table>\n  <div class="well post-install" style="display:none;text-align: center">\n      <h4>Ready?  Learn about MaskMe\'s security, premium plans, videos, and other FAQ\'s</h4>\n      <a class="btn btn-primary btn-large" href="#userRegistration/finish">Finish</a>\n  </div>\n\n  <div class="empty-notice alert alert-info" style="display:none;">\n    ',t="mm_manage_emails_noMaskedEmails",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,s+=v(t)+'\n  </div>\n\n  <div class="well create-disposable">\n    <h4>',t="mm_manage_emails_createNew",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,s+=v(t)+'</h4>\n    <div class="row">\n      <div class="span4 mask-it">\n        ',t="mm_manage_emails_makeANote",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,s+=v(t)+'\n      </div>\n      <form>\n      <div class="span2">\n        <input type="text" class="reason" value="" placeholder="www.example.com" id="disposableLabel" />\n      </div>\n      <div class="span3">\n        <input type="submit" class="btn generateDisposable" value=',t="mm_manage_emails_createMaskedEmail",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,s+=v(t)+'/>\n      </div>\n      </form>\n    </div>\n    <div class="row" id="generateDisposableError" style="display:none">\n      ',t="mm_manage_emails_GenerateDisposableError",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,s+=v(t)+"\n    </div>\n  </div>\n</div>\n"}n=n||e.helpers;var d,u,h,p,f="",m=this,g="function",b=n.helperMissing,y=void 0,v=this.escapeExpression,A=n.blockHelperMissing;return f+='<ul class="breadcrumb">\n  <li><a href="#/home">',d="mm_manage_emails_home",h=n.intl,u=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),d=typeof u===g?u.call(t,d,{hash:{}}):u===y?b.call(t,"intl",d,{hash:{}}):u,f+=v(d)+'</a> <span class="divider">/</span></li>\n  <li class="active">',d="mm_manage_emails_maskedEmails",h=n.intl,u=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),d=typeof u===g?u.call(t,d,{hash:{}}):u===y?b.call(t,"intl",d,{hash:{}}):u,f+=v(d)+'</li>\n</ul>\n\n<div class="alert alert-inverse" id="disableNotifications" style="margin-top:10px;display: none;text-align:center;">\n    <table width="100%"><tr>\n      <td width="3%">\n        <img src="',d="/images/Icon.png",h=n.assetUrl,u=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),d=typeof u===g?u.call(t,d,{hash:{}}):u===y?b.call(t,"assetUrl",d,{hash:{}}):u,f+=v(d)+'" style="margin:-5px 0px 0px -10px;"/>\n      </td>\n      <td width="96%">\n        <div>\n            <span style="margin:0px 20px 0px -1px;">',d="mm_manage_disableNotificationsTitle",h=n.intl,u=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),d=typeof u===g?u.call(t,d,{hash:{}}):u===y?b.call(t,"intl",d,{hash:{}}):u,(d||0===d)&&(f+=d),f+='</span>\n            <a class="btn" id="disableNotificationsBtn" style="margin-right:20px;">',d="mm_manage_disableNotificationsBtn",h=n.intl,u=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),d=typeof u===g?u.call(t,d,{hash:{}}):u===y?b.call(t,"intl",d,{hash:{}}):u,(d||0===d)&&(f+=d),f+='</a>\n            <a class="btn btn-primary" id="keepItUpBtn">',d="mm_manage_keepItUp",h=n.intl,u=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),d=typeof u===g?u.call(t,d,{hash:{}}):u===y?b.call(t,"intl",d,{hash:{}}):u,(d||0===d)&&(f+=d),f+='</a>\n        </div>\n      </td>\n      <td>\n        <div style="height:40px;">\n          <button id="dismissAlert" class="close close-notification" style="color:white;">&times;</button>\n        </div>\n      </td>\n    </tr></table>\n</div>\n\n<div class="row" style="margin-bottom:25px;">\n  <div class="manage_header_box email-header" id="showEmail">\n    ',h=n.shieldedEmail,d=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"shieldedEmail"),u=n["if"],p=m.program(1,s,a),p.hash={},p.fn=p,p.inverse=m.program(6,l,a),d=u.call(t,d,p),(d||0===d)&&(f+=d),f+='\n  </div>\n\n  <div style="display:none;" id="showSetup">\n     <img src="',d="/pages/images/manage/PhoneOFF.png",h=n.assetUrl,u=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),d=typeof u===g?u.call(t,d,{hash:{}}):u===y?b.call(t,"assetUrl",d,{hash:{}}):u,f+=v(d)+'" class="email_icon"/>\n     <p class="setupPhone">',d="mm_manage_emails_whyNot",h=n.intl,u=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),d=typeof u===g?u.call(t,d,{hash:{}}):u===y?b.call(t,"intl",d,{hash:{}}):u,(d||0===d)&&(f+=d),f+='</p>\n  </div>\n  <br style="clear:both;"/>\n</div>\n\n',d="loadingDisplay",h=n.child,u=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),d=typeof u===g?u.call(t,d,{hash:{}}):u===y?b.call(t,"child",d,{hash:{}}):u,f+=v(d)+"\n\n",h=n.shieldedEmail,d=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"shieldedEmail"),u=n["if"],p=m.program(8,c,a),p.hash={},p.fn=p,p.inverse=m.noop,d=u.call(t,d,p),(d||0===d)&&(f+=d),f+="\n"}),ABINEMASKME.CompiledTemplates["views/manage_emails/email"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/manage_emails/oneemail"]=e.template(function(e,t,n,i,a){function s(e){var t,i="";return i+='\n    <span class="truncated-domain" rel="tooltip" title="',b=n.getDomain,t=b||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getDomain"),typeof t===E?t=t.call(e,{hash:{}}):t===_&&(t=M.call(e,"getDomain",{hash:{}})),i+=w(t)+'">\n      ',b=n.getTruncatedDomain,t=b||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getTruncatedDomain"),typeof t===E?t=t.call(e,{hash:{}}):t===_&&(t=M.call(e,"getTruncatedDomain",{hash:{}})),i+=w(t)+"\n    </span>\n  "}function r(e){var t,i="";return i+="\n    ",b=n.getDomain,t=b||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getDomain"),typeof t===E?t=t.call(e,{hash:{}}):t===_&&(t=M.call(e,"getDomain",{hash:{}})),i+=w(t)+"\n  "}function o(){return'\n    <div><a class="newmail" style="color:red;font-size:12px;text-decoration:none;" href=# >\n        <i class="icon-envelope"></i> new mail\n    </a></div>\n  '}function l(e,t){var i,a,s="";return s+="\n  <td>\n      ",b=n.mails,i=b||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"mails"),typeof i===E?i=i.call(e,{hash:{}}):i===_&&(i=M.call(e,"mails",{hash:{}})),s+=w(i)+"\n  </td>\n  <td>\n      ",i="hasRegEmail",b=n.ifUser,a=b||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"ifUser"),y=A.program(8,c,t),y.hash={},y.fn=y,y.inverse=A.program(10,d,t),i=b&&typeof a===E?a.call(e,i,y):S.call(e,a,i,y),(i||0===i)&&(s+=i),s+='\n  </td>\n  <td>\n    <div class="dropdown">\n      <a class="close dropdown-toggle" data-toggle="dropdown" href="#"><i class="icon-trash"></i></a>\n\n      <ul class="dropdown-menu">\n        ',b=n.hasAccount,i=b||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"hasAccount"),a=n["if"],y=A.program(15,p,t),y.hash={},y.fn=y,y.inverse=A.program(17,f,t),i=a.call(e,i,y),(i||0===i)&&(s+=i),s+="\n      </ul>\n    </div>\n    ",i="cowboy",b=n.child,a=b||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"child"),i=typeof a===E?a.call(e,i,{hash:{}}):a===_?M.call(e,"child",i,{hash:{}}):a,s+=w(i)+"\n    ",i="email",b=n.child,a=b||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"child"),i=typeof a===E?a.call(e,i,{hash:{}}):a===_?M.call(e,"child",i,{hash:{}}):a,s+=w(i)+"\n  </td>\n"}function c(){return'\n           <a class="btn disabled" href="javascript:void(0);">Unavailable</a>\n      '}function d(e,t){var i,a,s="";return s+="\n          ",b=n.isActive,i=b||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"isActive"),a=n["if"],y=A.program(11,u,t),y.hash={},y.fn=y,y.inverse=A.program(13,h,t),i=a.call(e,i,y),(i||0===i)&&(s+=i),s+="\n      "}function u(e){var t,i,a="";return a+='\n              <a class="btn btn-success block_email"><i class="icon-ok-circle icon-white"/> ',t="mm_manage_emails_forwarding",b=n.intl,i=b||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===E?i.call(e,t,{hash:{}}):i===_?M.call(e,"intl",t,{hash:{}}):i,a+=w(t)+"</a>\n          "}function h(e){var t,i,a="";return a+='\n              <a class="btn btn-danger unblock_email"><i class="icon-ban-circle icon-white"/> ',t="mm_manage_emails_blocked",b=n.intl,i=b||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===E?i.call(e,t,{hash:{}}):i===_?M.call(e,"intl",t,{hash:{}}):i,a+=w(t)+"</a>\n          "}function p(e){var t,i,a,s="";return s+='\n          <li><a href="#holdOnEmail',b=n.getId,t=b||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getId"),typeof t===E?t=t.call(e,{hash:{}}):t===_&&(t=M.call(e,"getId",{hash:{}})),s+=w(t)+'" data-toggle="modal">',t="mm_manage_emails_deleteEmail",b=n.intl,i=b||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===E?i.call(e,t,{hash:{}}):i===_?M.call(e,"intl",t,{hash:{}}):i,s+=w(t)+'</a></li>\n          <li><a href="#holdOnCowboy',b=n.getId,t=b||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getId"),typeof t===E?t=t.call(e,{hash:{}}):t===_&&(t=M.call(e,"getId",{hash:{}})),s+=w(t)+'" data-toggle="modal">',b=n.getDomain,t=b||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getDomain"),i="mm_manage_emails_hideSite",b=n.intl,a=b||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof a===E?a.call(e,i,t,{hash:{}}):a===_?M.call(e,"intl",i,t,{hash:{}}):a,s+=w(t)+"</a></li>\n        "}function f(e){var t,i,a="";return a+='\n          <li><a href="#" class="removeEmail">',t="mm_manage_emails_deleteEmail",b=n.intl,i=b||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===E?i.call(e,t,{hash:{}}):i===_?M.call(e,"intl",t,{hash:{}}):i,(t||0===t)&&(a+=t),a+="</a></li>\n        "}n=n||e.helpers;var m,g,b,y,v="",A=this,E="function",M=n.helperMissing,_=void 0,w=this.escapeExpression,S=n.blockHelperMissing;return v+='<td>\n    <span class="time-ago"><i class="icon-time"></i>&nbsp;',m="createdAt",b=n.live_timestamp,g=b||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"live_timestamp"),m=typeof g===E?g.call(t,m,{hash:{}}):g===_?M.call(t,"live_timestamp",m,{hash:{}}):g,v+=w(m)+'</span>\n</td>\n<td>\n\n   <span class="showLabel" style="cursor:pointer;">\n  ',b=n.needsTruncation,m=b||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"needsTruncation"),g=n["if"],y=A.program(1,s,a),y.hash={},y.fn=y,y.inverse=A.program(3,r,a),m=g.call(t,m,y),(m||0===m)&&(v+=m),v+='\n   </span>\n\n  <span class="editLabel" style="display:none;">\n    <input type="text" value="',b=n.getDomain,m=b||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getDomain"),typeof m===E?m=m.call(t,{hash:{}}):m===_&&(m=M.call(t,"getDomain",{hash:{}})),v+=w(m)+'" class="editLabelInput input-small" /> <a href="javascript:void(0);" style="vertical-align:super;" class="saveEditLabel btn btn-mini"><i class="icon-ok"></i></a> <a href="javascript:void(0);" style="vertical-align:super;" class="cancelEditLabel btn btn-mini"><i class="icon-remove"></i></a>\n  </span>\n\n  ',b=n.hasWebmail,m=b||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"hasWebmail"),g=n["if"],y=A.program(5,o,a),y.hash={},y.fn=y,y.inverse=A.noop,m=g.call(t,m,y),(m||0===m)&&(v+=m),v+='\n</td>\n<td>\n    <span id="emailAddress">',b=n.getAddress,m=b||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getAddress"),typeof m===E?m=m.call(t,{hash:{}}):m===_&&(m=M.call(t,"getAddress",{hash:{}})),v+=w(m)+"</span>\n</td>\n",b=n.noConnectionError,m=b||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"noConnectionError"),g=n["if"],y=A.program(7,l,a),y.hash={},y.fn=y,y.inverse=A.noop,m=g.call(t,m,y),(m||0===m)&&(v+=m),v+="\n"}),ABINEMASKME.CompiledTemplates["views/manage_emails/oneemail"]}),ABINEMASKME.define("abine/views/manageEmail",["documentcloud/underscore","jquery","models","duckbone/core","abine/views/holdOnCowboyView","abine/views/holdOnEmailView","abine/timer","abine/views/loading_display"],function(e,t,n,i,a,s,r,o){var l=i.View.extend({tagName:"tr",className:"disposableEmailRow",templateName:"manage_emails_oneemail",events:{"click .block_email":"toggleDisposable","click .unblock_email":"toggleDisposable","click #deleteEmailAndAccountBtn":"deleteEmail","click #deleteEverythingBtn":"blacklistSite","click .removeEmail":"deleteEmail","dblclick #emailAddress":"highlightEmail","click .showLabel":"showEditLabel","click .cancelEditLabel":"cancelEditLabel","click .saveEditLabel":"saveEditLabel","click .newmail":"showInbox"},showInbox:function(e){var t=window.location.hash;ABINEMASKME.App.navigate("#home/inbox"+(t&&-1!=t.indexOf("/postinstall")?"/postinstall":""),!0),e.preventDefault()},saveEditLabel:function(){this.model.save({label:t(this.el).find(".editLabelInput").val()},{success:e.bind(function(){this.render()},this),error:e.bind(function(){this.render()},this)})},cancelEditLabel:function(){t(this.el).find(".editLabelInput").val(this.model.attributes.label),t(this.el).find(".showLabel").show(),t(this.el).find(".editLabel").hide()},showEditLabel:function(){t(this.el).find(".showLabel").hide(),t(this.el).find(".editLabel").show()},afterInitialize:function(){this.model.needsTruncation()&&this.$(".truncated-domain").tooltip(),this.model.bind("sync:success",this.render,this),this.model.bind("showError",e.bind(function(){t(".errorDiv").show(),t("body").scrollTop(0)},this)),this.model.bind("hideError",e.bind(function(){t(".errorDiv").hide()},this))},createChildren:function(){var e=new a({model:this.model}),t=new s({model:this.model});return{cowboy:e,email:t}},toggleDisposable:function(){this.model.toggleDisposable({success:e.bind(function(){this.model.trigger("hideError")},this),error:e.bind(function(){true&&ABINEMASKME.log.error("[ERROR LOGIC]#[abine/models/disposableEmail]#[toggleDisposable]# error event in model.save"),this.model.trigger("showError")},this)})},deleteEmail:function(){this.model.hasAccount()&&t(this.el).find("#holdOnEmail"+this.model.getId()).modal("hide"),this.model.destroy({success:e.bind(function(){this.model.hasAccount()&&this.model.account.destroy(),t(this.el).hide(),this.model.trigger("hideError")},this),error:e.bind(function(){this.model.trigger("showError")},this)})},blacklistSite:function(){t(this.el).find("#holdOnCowboy"+this.model.getId()).modal("hide");var i=new n.Site(this.model.attributes.site);i.blacklist({success:e.bind(function(){ABINEMASKME.App.navigate("blacklist",!0)},this),error:e.bind(function(){t(".errorDiv").show(),t("body").scrollTop(0)},this)})},highlightEmail:function(e){e.preventDefault();var n=t(this.el).find("#emailAddress").get(0),i=n.ownerDocument.createRange();i.selectNode(n);var a=n.ownerDocument.defaultView.getSelection();a.removeAllRanges(),a.addRange(i)}}),c=i.ListView.extend({tagName:"tbody",viewClass:l}),d=i.View.extend({templateName:"manage_emails_email",events:{"click .generateDisposable":"generateDisposable","submit form":"submit","click .sort-column":"sortByColumn","click .email_icon":"showInbox","click .inbox_link":"showInbox","click #keepItUpBtn":"dismissAlert","click #dismissAlert":"dismissAlert","click #disableNotificationsBtn":"disableNotifications"},showInbox:function(e){var t=window.location.hash;ABINEMASKME.App.navigate("#home/inbox"+(t&&-1!=t.indexOf("/postinstall")?"/postinstall":""),!0),e.preventDefault()},emailsComparator:{createdAt:function(e){var t=e.get("createdAt");return new Date-new Date(t)},domain:function(e){return e.getDomain()},address:function(e){return e.getAddress()},mails:function(e){return e.attributes.mails},active:function(e){return e.attributes.active}},afterInitialize:function(){this.options.guid&&!ABINEMASKME.user.hasSeenNotificationsGrowl()&&t(this.el).find("#disableNotifications").show(),this.options.postinstall&&(t(this.el).find(".post-install").show(),t(this.el).find(".create-disposable").hide())},dataChanged:function(){var n=this.children.loadingDisplay,i=this.children.disposableEmailList;if(n.hide(),this.$(".data-display").show(),0===i.collection.length)t(this.el).find("table.disposableEmailTable").hide(),t(this.el).find("div.empty-notice").show();else{t(this.el).find("table.disposableEmailTable").show(),t(this.el).find("div.empty-notice").hide();var a=i.collection.at(0).get("err");if(a){if(401==a.status)return ABINEMASKME.App.navigate("userLogin",!0),!1;this.$("#sortby-desc-mails").hide(),this.$("#sortby-desc-active").hide(),this.$(".create-disposable").hide(),this.$(".errorDiv").show()}else this.$("#sortby-desc-mails").show(),this.$("#sortby-desc-active").show(),this.options.postinstall||this.$(".create-disposable").show(),this.$(".errorDiv").hide();i.collection.totalWebmails()>0&&t(this.el).find(".numWebmails").show().html(i.collection.totalWebmails()),"postinstall"==this.options.guid&&(this.options.postinstall=!0,delete this.options.guid),this.options.guid&&e.each(i.children,e.bind(function(e){e.model.get("guid")==this.options.guid&&t("td",e.el).css("backgroundColor","#CFF0FC")},this))}return!0},createChildren:function(){var e=new o({pageName:"manage_email"}),t=new c({collection:ABINEMASKME.user.disposableEmails});return this.children={disposableEmailList:t,loadingDisplay:e},this.dataChanged()?(this.weakBindTo(t.collection,"sync:read",function(){e.startRefreshing()},this),this.weakBindTo(t.collection,"sync",this.dataChanged,this),t.collection.fetchAll(),this.children):void 0},generateDisposable:function(n){n.preventDefault(),t("#generateDisposableError").hide();var i=e.escape(t("#disposableLabel").val());if(t("#disposableLabel").val(""),i&&""!=i){if(this.model.shieldedEmail){var a=this.model.shieldedEmail.generateDisposable();a.attributes.label=i,a.save({},{success:e.bind(function(e){return e.attributes.error?(t(".errorDiv").show(),void 0):(t(this.el).find(".errorDiv").hide(),this.children.disposableEmailList.collection.add(a),t(this.el).find("table.disposableEmailTable").show(),t(this.el).find("div.empty-notice").hide(),this.render(),void 0)},this),error:e.bind(function(){t(this.el).find(".errorDiv").show(),t("body").scrollTop(0)},this)})}}else t("#generateDisposableError").show()},submit:function(e){e.preventDefault(),this.generateDisposable()},dismissAlert:function(){t(this.el).find("#disableNotifications").hide(),ABINEMASKME.user.setSeenNotificationsGrowlPref()},disableNotifications:function(){ABINEMASKME.user.turnOffNotifications(),this.dismissAlert()},sortByColumn:function(e){var n=e.currentTarget.id.split("-"),i=n[n.length-1],a="desc"==n[n.length-2];this.children.disposableEmailList.collection.comparator=this.emailsComparator[i],this.children.disposableEmailList.collection.sort({silent:!0}),a&&this.children.disposableEmailList.collection.models.reverse(),this.children.disposableEmailList.collection.trigger("reset"),e.currentTarget.id="sortby-"+(a?"asc":"desc")+"-"+i;var s=t(e.currentTarget).find("i");s.hasClass("icon-chevron-down")?(s.removeClass("icon-chevron-down"),s.addClass("icon-chevron-up")):(s.removeClass("icon-chevron-up"),s.addClass("icon-chevron-down"))}},{routeName:"home/emails",routeAction:function(e){ABINEMASKME.App.loadView(d,{model:{shieldedEmail:ABINEMASKME.user.shieldedEmail?ABINEMASKME.user.shieldedEmail:!1},guid:e})}});return i.Security.showLoginWhenLocked(d),d}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/manage_passwords/onepassword"]=e.template(function(e,t,n,i,a){function s(e){var t,i,a="";return a+='\n        <span class="label label-success">',t="mm_manage_passwords_unique",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,a+=v(t)+"</span>\n    "}function r(e){var t,i,a,s="";return s+='\n    	<div class="field-tip" data-html="true" rel="tooltip" title="',h=n.getReuseTip,t=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getReuseTip"),typeof t===g?t=t.call(e,{hash:{}}):t===y&&(t=b.call(e,"getReuseTip",{hash:{}})),(t||0===t)&&(s+=t),s+='">\n    	    <span class="label label-warning">',h=n.numReused,t=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"numReused"),i="mm_manage_passwords_used",h=n.intl,a=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof a===g?a.call(e,i,t,{hash:{}}):a===y?b.call(e,"intl",i,t,{hash:{}}):a,s+=v(t)+"</span>\n    	</div>\n    "}function o(e){var t,i,a="";return a+="\n    		",t="mm_manage_passwords_hideMe",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,a+=v(t)+"\n  		"}function l(e){var t,i,a="";return a+="\n    		",t="mm_manage_passwords_showMe",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,a+=v(t)+"\n   		"}n=n||e.helpers;var c,d,u,h,p,f="",m=this,g="function",b=n.helperMissing,y=void 0,v=this.escapeExpression;return f+='<td>\n    <span class="time-ago"><i class="icon-time"></i>&nbsp;',c="createdAt",h=n.live_timestamp,d=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"live_timestamp"),c=typeof d===g?d.call(t,c,{hash:{}}):d===y?b.call(t,"live_timestamp",c,{hash:{}}):d,f+=v(c)+"</span>\n</td>\n<td>\n    ",h=n.getDomain,c=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getDomain"),typeof c===g?c=c.call(t,{hash:{}}):c===y&&(c=b.call(t,"getDomain",{hash:{}})),f+=v(c)+"\n</td>\n<td>\n    ",h=n.isUnique,c=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"isUnique"),d=n["if"],p=m.program(1,s,a),p.hash={},p.fn=p,p.inverse=m.program(3,r,a),c=d.call(t,c,p),(c||0===c)&&(f+=c),f+='\n</td>\n<td>\n	<span id="password">',h=n.safeFieldValue,c=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"safeFieldValue"),typeof c===g?c=c.call(t,{hash:{}}):c===y&&(c=b.call(t,"safeFieldValue",{hash:{}})),f+=v(c)+'</span>\n	<span class="toggleShowPassword btn btn-mini">\n  		',h=n.shownPassword,c=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"shownPassword"),d=n["if"],p=m.program(5,o,a),p.hash={},p.fn=p,p.inverse=m.program(7,l,a),c=d.call(t,c,p),(c||0===c)&&(f+=c),f+='\n	</span>\n</td>\n<td>\n  <div class="dropdown">\n    <a class="close dropdown-toggle" data-toggle="dropdown"><i class="icon-trash"></i></a>\n\n    <ul class="dropdown-menu">\n      <li><a href="#holdOnPassword',h=n.getId,c=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getId"),typeof c===g?c=c.call(t,{hash:{}}):c===y&&(c=b.call(t,"getId",{hash:{}})),f+=v(c)+'" data-toggle="modal">',c="mm_manage_passwords_deletePassword",h=n.intl,d=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),c=typeof d===g?d.call(t,c,{hash:{}}):d===y?b.call(t,"intl",c,{hash:{}}):d,f+=v(c)+'</a></li>\n      <li><a href="#holdOnCowboy',h=n.getId,c=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getId"),typeof c===g?c=c.call(t,{hash:{}}):c===y&&(c=b.call(t,"getId",{hash:{}})),f+=v(c)+'" data-toggle="modal">',h=n.getDomain,c=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getDomain"),d="mm_manage_passwords_hideSite",h=n.intl,u=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),c=typeof u===g?u.call(t,d,c,{hash:{}}):u===y?b.call(t,"intl",d,c,{hash:{}}):u,(c||0===c)&&(f+=c),f+="\n      </a></li>\n\n    </ul>\n  </div>\n  ",c="cowboy",h=n.child,d=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),c=typeof d===g?d.call(t,c,{hash:{}}):d===y?b.call(t,"child",c,{hash:{}}):d,f+=v(c)+"\n  ",c="password",h=n.child,d=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),c=typeof d===g?d.call(t,c,{hash:{}}):d===y?b.call(t,"child",c,{hash:{}}):d,f+=v(c)+"\n</td>\n"
}),ABINEMASKME.CompiledTemplates["views/manage_passwords/onepassword"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/manage_passwords/password"]=e.template(function(e,t,n,i,a){function s(e){var t,i,a="";return a+='\n    <div class="manage_header_box" style="text-align:left;">\n        <img src="',t="/pages/images/manage/PasswordOFF.png",d=n.assetUrl,i=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===f?i.call(e,t,{hash:{}}):i===g?m.call(e,"assetUrl",t,{hash:{}}):i,a+=b(t)+'" class="email_icon" style="margin-left:50px;" />\n        <div style="float:left;padding-top:1px;margin-left:20px;">\n            <h4>',t="mm_manage_passwords_yourPasswords",d=n.intl,i=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===f?i.call(e,t,{hash:{}}):i===g?m.call(e,"intl",t,{hash:{}}):i,a+=b(t)+'</h4>\n            <div>\n                To make sure nobody can access your passwords you need to <a href="#editUser/password">setup your password</a>.\n            </div>\n    </div>\n    '}function r(e){var t,i,a="";return a+='\n    <div class="span6 manage_header_box">\n        <img src="',t="/pages/images/manage/PasswordOFF.png",d=n.assetUrl,i=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===f?i.call(e,t,{hash:{}}):i===g?m.call(e,"assetUrl",t,{hash:{}}):i,a+=b(t)+'" class="email_icon"/><h3>',t="mm_manage_passwords_yourPasswords",d=n.intl,i=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===f?i.call(e,t,{hash:{}}):i===g?m.call(e,"intl",t,{hash:{}}):i,a+=b(t)+"</h3>\n    </div>\n    "}n=n||e.helpers;var o,l,c,d,u,h="",p=this,f="function",m=n.helperMissing,g=void 0,b=this.escapeExpression,y=n.blockHelperMissing;return h+='<ul class="breadcrumb">\n  <li><a href="#/home">',o="mm_manage_passwords_home",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,h+=b(o)+'</a> <span class="divider">/</span></li>\n  <li class="active">',o="mm_manage_passwords_encryptedPasswords",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,h+=b(o)+'</li>\n</ul>\n\n<div class="alert alert-inverse" id="disableNotifications" style="margin-top:10px;display: none;text-align:center;">\n    <table width="100%"><tr>\n      <td width="3%">\n        <img src="',o="/images/Icon.png",d=n.assetUrl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"assetUrl",o,{hash:{}}):l,h+=b(o)+'" style="margin:-5px 0px 0px -10px;"/>\n      </td>\n      <td width="96%">\n        <div>\n            <span style="margin:0px 20px 0px -1px;">',o="mm_manage_disableNotificationsTitle",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,(o||0===o)&&(h+=o),h+='</span>\n            <a class="btn" id="disableNotificationsBtn" style="margin-right:20px;">',o="mm_manage_disableNotificationsBtn",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,(o||0===o)&&(h+=o),h+='</a>\n            <a class="btn btn-primary" id="keepItUpBtn">',o="mm_manage_keepItUp",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,(o||0===o)&&(h+=o),h+='</a>\n        </div>\n      </td>\n      <td>\n        <div style="height:40px;">\n          <button id="dismissAlert" class="close close-notification" style="color:white;">&times;</button>\n        </div>\n      </td>\n    </tr></table>\n</div>\n\n<div class="trust"><a href="https://www.abine.com/products/maskme/support/datause.php" target="_blank">',o="mm_manage_passwords_dataSecurity",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,h+=b(o)+'</a></div>\n\n<div class="row">\n  	<div class="span2">&nbsp;</div>\n    ',o="hasRegPassword",d=n.ifUser,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"ifUser"),u=p.program(1,s,a),u.hash={},u.fn=u,u.inverse=p.program(3,r,a),o=d&&typeof l===f?l.call(t,o,u):y.call(t,l,o,u),(o||0===o)&&(h+=o),h+='\n\n	<div class="span2" style="clear:both;">&nbsp;</div>\n</div>\n\n',o="loadingDisplay",d=n.child,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"child",o,{hash:{}}):l,h+=b(o)+'\n\n<div class="data-display" style="clear:both;display:none;">\n  <div class="errorDiv alert alert-error" style="display:none;">\n    ',o="mm_manage_passwords_serverError",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,(o||0===o)&&(h+=o),h+='\n  </div>\n\n  <table class="table table-striped">\n    <thead>\n      <tr><th class="sort-column" id="sortby-desc-createdAt">',o="mm_manage_passwords_created",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,h+=b(o)+'&nbsp;<i class="icon-chevron-down"></i></th>\n          <th class="sort-column" id="sortby-desc-site">',o="mm_manage_passwords_website",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,h+=b(o)+'&nbsp;<i class="icon-chevron-down"></i></th>\n          <th class="sort-column" id="sortby-desc-reuse">',o="mm_manage_passwords_reuse",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,h+=b(o)+'&nbsp;<i class="icon-chevron-down"></i></th>\n          <th class="sort-column" id="sortby-desc-value">',o="mm_manage_passwords_password",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,h+=b(o)+'&nbsp;<i class="icon-chevron-down"></i></th>\n      </tr>\n    </thead>\n    ',o="tbody",l="passwordList",d=n.child,c=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),o=typeof c===f?c.call(t,l,o,{hash:{}}):c===g?m.call(t,"child",l,o,{hash:{}}):c,h+=b(o)+'\n  </table>\n\n  <div class="well generatePassword">\n    <h4>',o="mm_manage_passwords_roulette",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,h+=b(o)+'</h4>\n    <br/>\n    <div class="row">\n      <div class="span3 offset1">\n        <button class="btn generatePasswordBtn"><i class="icon-lock"></i>&nbsp;',o="mm_manage_passwords_generatePassword",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,h+=b(o)+'</button>\n      </div>\n      <div class="span2 generatedPassword">\n      </div>\n    </div>\n  </div>\n</div>\n'}),ABINEMASKME.CompiledTemplates["views/manage_passwords/password"]}),ABINEMASKME.define("abine/views/managePassword",["documentcloud/underscore","jquery","models","duckbone/core","abine/password","abine/proxies","abine/views/recheck","abine/views/holdOnCowboyView","abine/views/holdOnPasswordView","abine/timer","abine/views/loading_display"],function(e,t,n,i,a,s,r,o,l,c,d){var u=i.View.extend({tagName:"tr",className:"passwordRow",templateName:"manage_passwords_onepassword",events:{"click .toggleShowPassword":"checkAndTogglePassword","dblclick #password":"highlightPassword","click #deletePasswordAndAccountBtn":"deletePassword","click #deleteEverythingBtn":"blacklistSite"},afterInitialize:function(){this.model.bind("sync:success",this.render,this),this.model.bind("error:hide",e.bind(function(){t(".errorDiv").hide()},this)),this.model.bind("error:show",e.bind(function(){t(".errorDiv").show(),t("body").scrollTop(0)},this)),this.model.isUnique()||this.$("div.field-tip").tooltip()},createChildren:function(){var e=new o({model:this.model}),t=new l({model:this.model});return{cowboy:e,password:t}},toggleShowHidePassword:function(){this.model.shownPassword=!this.model.shownPassword,this.render()},recheckPassword:function(e,n){var i=new r({element:e,callback:n,label:"To view"});t("body").append(i.el)},checkAndTogglePassword:function(t){this.model.shownPassword?this.toggleShowHidePassword():s.securityManager.passwordValidationRequired(e.bind(function(n){n?this.recheckPassword(t.target,e.bind(this.toggleShowHidePassword,this)):this.toggleShowHidePassword()},this))},highlightPassword:function(e){e.preventDefault();var n=t(this.el).find("#password").get(0),i=n.ownerDocument.createRange();i.selectNode(n);var a=n.ownerDocument.defaultView.getSelection();a.removeAllRanges(),a.addRange(i)},deletePassword:function(){t(this.el).find("#holdOnPassword"+this.model.getId()).modal("hide"),this.model.deleteAccount({success:e.bind(function(){t(this.el).hide(),this.model.trigger("error:hide")},this),error:e.bind(function(){this.model.trigger("error:show")},this)})},blacklistSite:function(){t(this.el).find("#holdOnCowboy"+this.model.getId()).modal("hide");var i=new n.Site(this.model.attributes.site);i.blacklist({success:e.bind(function(){ABINEMASKME.App.navigate("blacklist",!0)},this),error:e.bind(function(){t(".errorDiv").show(),t("body").scrollTop(0)},this)})}}),h=i.ListView.extend({tagName:"tbody",viewClass:u}),p=i.View.extend({templateName:"manage_passwords_password",events:{"click .generatePasswordBtn":"playPasswordRoulette","dblclick .generatedPassword":"selectPassword","click .sort-column":"sortByColumn","click #keepItUpBtn":"dismissAlert","click #dismissAlert":"dismissAlert","click #disableNotificationsBtn":"disableNotifications"},passwordsComparator:{createdAt:function(e){var t=e.get("createdAt");return new Date-new Date(t)},site:function(e){return e.getDomain()},reuse:function(e){return e.isUnique()?0:e.numReused()},value:function(e){return e.safeFieldValue()}},afterInitialize:function(){this.options.password&&!ABINEMASKME.user.hasSeenNotificationsGrowl()&&t(this.el).find("#disableNotifications").show()},createChildren:function(){var i=new d({pageName:"manage_password"}),a=new h({collection:new n.AccountFieldCollection});return a.collection.sync("read",a.collection,{eventName:"read:accountField:passwords",success:e.bind(function(n){i.hide(),t(this.el).find(".data-display").show(),a.collection.reset(n),this.options.password&&e.each(a.children,e.bind(function(e){e.model.get("value")==this.options.password&&t("td",e.el).css("backgroundColor","#CFF0FC")},this))},this),error:function(){}}),ABINEMASKME.user.messenger.on("broadcast:saveForm:new",function(){a.collection.sync("read",a.collection,{eventName:"read:accountField:passwords",success:function(e){a.collection.reset(e)}})}),{passwordList:a,loadingDisplay:i}},generatePassword:function(){var e=a.generateRandomPassword();t(".generatedPassword").html(e)},passwordRoulette:function(n){n>0?(this.generatePassword(),n>25?this.passwordRoulette(n-1):n>10?c.setTimeout(e.bind(function(){this.passwordRoulette(n-1)},this),25):n>3?c.setTimeout(e.bind(function(){this.passwordRoulette(n-1)},this),50):n>1?c.setTimeout(e.bind(function(){this.passwordRoulette(n-1)},this),250):c.setTimeout(e.bind(function(){this.passwordRoulette(n-1)},this),500)):(this.generatePassword(),t(".generatedPassword").css("font-weight","bold"),t(".generatedPassword").css("font-size","125%"),t(".generatePasswordBtn").removeAttr("disabled"))},playPasswordRoulette:function(){t(".generatePasswordBtn").attr("disabled","disabled"),t(".generatedPassword").css("font-weight","normal"),t(".generatedPassword").css("font-size","100%"),this.passwordRoulette(300)},selectPassword:function(e){e.preventDefault();var n=t(".generatedPassword").get(0),i=n.ownerDocument.createRange();i.selectNode(n);var a=n.ownerDocument.defaultView.getSelection();a.removeAllRanges(),a.addRange(i)},sortByColumn:function(e){var n=e.currentTarget.id.split("-"),i=n[n.length-1],a="desc"==n[n.length-2];this.children.passwordList.collection.comparator=this.passwordsComparator[i],this.children.passwordList.collection.sort({silent:!0}),a&&this.children.passwordList.collection.models.reverse(),this.children.passwordList.collection.trigger("reset"),e.currentTarget.id="sortby-"+(a?"asc":"desc")+"-"+i;var s=t(e.currentTarget).find("i");s.hasClass("icon-chevron-down")?(s.removeClass("icon-chevron-down"),s.addClass("icon-chevron-up")):(s.removeClass("icon-chevron-up"),s.addClass("icon-chevron-down"))},dismissAlert:function(){t(this.el).find("#disableNotifications").hide(),ABINEMASKME.user.setSeenNotificationsGrowlPref()},disableNotifications:function(){ABINEMASKME.user.turnOffNotifications(),this.dismissAlert()}},{routeName:"home/passwords",routeAction:function(e){ABINEMASKME.App.loadView(p,{password:e})}});return i.Security.showLoginWhenLocked(p),p}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/manage_phones/onephonelog"]=e.template(function(e,t,n,i,a){function s(e){var t,i,a="";return a+='\n        <a class="btn btn-success block_number"><i class="icon-ok-circle icon-white"/> ',t="mm_manage_phones_forwarding",c=n.intl,i=c||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===p?i.call(e,t,{hash:{}}):i===m?f.call(e,"intl",t,{hash:{}}):i,a+=g(t)+"</a>\n    "}function r(e){var t,i,a="";return a+='\n        <a class="btn btn-danger unblock_number"><i class="icon-ban-circle icon-white"/> ',t="mm_manage_phones_blocked",c=n.intl,i=c||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===p?i.call(e,t,{hash:{}}):i===m?f.call(e,"intl",t,{hash:{}}):i,a+=g(t)+"</a>\n    "}n=n||e.helpers;var o,l,c,d,u="",h=this,p="function",f=n.helperMissing,m=void 0,g=this.escapeExpression;return u+='<td>\n    <span class="time-ago"><i class="icon-time"></i>&nbsp;',o="updated_at",c=n.live_timestamp,l=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"live_timestamp"),o=typeof l===p?l.call(t,o,{hash:{}}):l===m?f.call(t,"live_timestamp",o,{hash:{}}):l,u+=g(o)+"</span>\n</td>\n<td>\n    ",c=n.caller,o=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"caller"),typeof o===p?o=o.call(t,{hash:{}}):o===m&&(o=f.call(t,"caller",{hash:{}})),u+=g(o)+"\n</td>\n<td>\n    ",c=n.label,o=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"label"),typeof o===p?o=o.call(t,{hash:{}}):o===m&&(o=f.call(t,"label",{hash:{}})),u+=g(o)+"\n</td>\n<td>\n    ",c=n.count,o=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"count"),typeof o===p?o=o.call(t,{hash:{}}):o===m&&(o=f.call(t,"count",{hash:{}})),u+=g(o)+" / ",c=n.txt_count,o=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"txt_count"),typeof o===p?o=o.call(t,{hash:{}}):o===m&&(o=f.call(t,"txt_count",{hash:{}})),u+=g(o)+"\n</td>\n<td>\n    ",c=n.isAllowed,o=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"isAllowed"),l=n["if"],d=h.program(1,s,a),d.hash={},d.fn=d,d.inverse=h.program(3,r,a),o=l.call(t,o,d),(o||0===o)&&(u+=o),u+="\n</td>\n"}),ABINEMASKME.CompiledTemplates["views/manage_phones/onephonelog"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/manage_phones/phone"]=e.template(function(e,t,n,i,a){function s(e){var t,i,a,s="";return s+='\n<div class="data-display" style="display:none;">\n  <table class="table table-striped">\n    <thead>\n      <tr><th class="sort-column" id="sortby-desc-lastContact">',t="mm_manage_phones_lastContacted",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,s+=m(t)+'&nbsp;<i class="icon-chevron-down"></i></th>\n          <th class="sort-column" id="sortby-desc-number">',t="mm_manage_phones_number",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,s+=m(t)+'&nbsp;<i class="icon-chevron-down"></i></th>\n          <th class="sort-column" id="sortby-desc-who">',t="mm_manage_phones_who",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,s+=m(t)+'&nbsp;<i class="icon-chevron-down"></i></th>\n          <th><span  class="sort-column" id="sortby-desc-timesCalled">',t="mm_manage_phones_timesCalled",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,s+=m(t)+'&nbsp;<i class="icon-chevron-down"></i></span>/\n           <span class="sort-column" id="sortby-desc-timesTexted">',t="mm_manage_phones_timesTexted",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,s+=m(t)+'&nbsp;<i class="icon-chevron-down"></th>\n          <th class="sort-column" id="sortby-desc-active">',t="mm_manage_phones_action",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,s+=m(t)+'&nbsp;<i class="icon-chevron-down"></i></th></tr>\n    </thead>\n    ',t="tbody",i="phoneLogList",l=n.child,a=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"child"),t=typeof a===h?a.call(e,i,t,{hash:{}}):a===f?p.call(e,"child",i,t,{hash:{}}):a,s+=m(t)+'\n  </table>\n  <div class="empty-notice alert alert-info" style="display:none;">\n    ',t="mm_manage_phones_noMaskedPhones",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,s+=m(t)+"\n  </div>\n</div>\n"}n=n||e.helpers;var r,o,l,c,d="",u=this,h="function",p=n.helperMissing,f=void 0,m=this.escapeExpression;return d+='<ul class="breadcrumb">\n  <li><a href="#/home">',r="mm_manage_phones_home",l=n.intl,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),r=typeof o===h?o.call(t,r,{hash:{}}):o===f?p.call(t,"intl",r,{hash:{}}):o,d+=m(r)+'</a> <span class="divider">/</span></li>\n  <li class="active">',r="mm_manage_phones_maskedPhones",l=n.intl,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),r=typeof o===h?o.call(t,r,{hash:{}}):o===f?p.call(t,"intl",r,{hash:{}}):o,d+=m(r)+'</li>\n</ul>\n\n<div class="row">\n  <div class="span2">&nbsp;</div>\n  <div class="span7 manage_header_box phone-header" id="showPhone">\n     <div class="header-left">\n         <img src="',r="/pages/images/manage/PhoneOFF.png",l=n.assetUrl,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),r=typeof o===h?o.call(t,r,{hash:{}}):o===f?p.call(t,"assetUrl",r,{hash:{}}):o,d+=m(r)+'" class="email_icon"/>\n         <div class="masked-phone">\n            ',r="mm_manage_phones_maskedPhoneIs",l=n.intl,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),r=typeof o===h?o.call(t,r,{hash:{}}):o===f?p.call(t,"intl",r,{hash:{}}):o,d+=m(r)+'\n            <p class="maskDisplay">',l=n.disposablePhone,r=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"disposablePhone"),r=null===r||void 0===r||r===!1?r:ABINEMASKME.Duckbone.Handlebars.getAttr(r,"getPrettyNumber"),typeof r===h?r=r.call(t,{hash:{}}):r===f&&(r=p.call(t,"disposablePhone.getPrettyNumber",{hash:{}})),d+=m(r)+'</p>\n         </div>\n     </div>\n     <div class="header-right">\n         <img src="',r="/pages/images/manage/forward.png",l=n.assetUrl,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),r=typeof o===h?o.call(t,r,{hash:{}}):o===f?p.call(t,"assetUrl",r,{hash:{}}):o,d+=m(r)+'" class="forward"/>\n         <div class="real-phone">\n            ',r="mm_manage_phones_callsForwardTo",l=n.intl,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),r=typeof o===h?o.call(t,r,{hash:{}}):o===f?p.call(t,"intl",r,{hash:{}}):o,d+=m(r)+'\n            <p class="actualDisplay">',l=n.shieldedPhone,r=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"shieldedPhone"),r=null===r||void 0===r||r===!1?r:ABINEMASKME.Duckbone.Handlebars.getAttr(r,"getPrettyNumber"),typeof r===h?r=r.call(t,{hash:{}}):r===f&&(r=p.call(t,"shieldedPhone.getPrettyNumber",{hash:{}})),d+=m(r)+'</p>\n         </div>\n     </div>\n  </div>\n\n  <div class="span7 setupReq" style="display:none;" id="showSetup">\n     <img src="',r="/pages/images/manage/PhoneOFF.png",l=n.assetUrl,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),r=typeof o===h?o.call(t,r,{hash:{}}):o===f?p.call(t,"assetUrl",r,{hash:{}}):o,d+=m(r)+'" class="email_icon"/>\n     <p class="setupPhone"> <a href="#editUser/phone">',r="mm_manage_phones_letsGet",l=n.intl,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),r=typeof o===h?o.call(t,r,{hash:{}}):o===f?p.call(t,"intl",r,{hash:{}}):o,d+=m(r)+'</a></p>\n     <p class="quick">(',r="mm_manage_phones_quick",l=n.intl,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),r=typeof o===h?o.call(t,r,{hash:{}}):o===f?p.call(t,"intl",r,{hash:{}}):o,d+=m(r)+')</p>\n  </div>\n  <div class="span2"></div>\n</div>\n\n',r="loadingDisplay",l=n.child,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),r=typeof o===h?o.call(t,r,{hash:{}}):o===f?p.call(t,"child",r,{hash:{}}):o,d+=m(r)+'\n<div class="errorDiv alert alert-error" style="display:none;">\n    ',r="mm_manage_phones_serverError",l=n.intl,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),r=typeof o===h?o.call(t,r,{hash:{}}):o===f?p.call(t,"intl",r,{hash:{}}):o,(r||0===r)&&(d+=r),d+="\n</div>\n\n",l=n.shieldedPhone,r=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"shieldedPhone"),o=n["if"],c=u.program(1,s,a),c.hash={},c.fn=c,c.inverse=u.noop,r=o.call(t,r,c),(r||0===r)&&(d+=r),d+="\n\n"}),ABINEMASKME.CompiledTemplates["views/manage_phones/phone"]}),ABINEMASKME.define("abine/views/managePhone",["documentcloud/underscore","jquery","models","duckbone/core","abine/intl","abine/views/loading_display","abine/responseCodes"],function(e,t,n,i,a,s,r){var o=i.View.extend({tagName:"tr",className:"phoneLogRow",templateName:"manage_phones_onephonelog",events:{"click .block_number":"toggleActive","click .unblock_number":"toggleActive"},toggleActive:function(){this.model.toggleActive({success:function(){t(".errorDiv").hide()},error:function(){t(".errorDiv").show()}})},afterInitialize:function(){this.model.bind("sync:success",this.render,this)}}),l=i.ListView.extend({tagName:"tbody",viewClass:o}),c=i.View.extend({templateName:"manage_phones_phone",events:{"click .sort-column":"sortByColumn"},phonesComparator:{lastContact:function(e){var t=e.get("updated_at");return new Date-new Date(t)},number:function(e){return e.get("caller")},who:function(e){var t=e.get("label");return null===t?"ZZZZZZZZZ":t},timesCalled:function(e){return e.get("count")},timesTexted:function(e){return e.get("txt_count")},active:function(e){return e.isAllowed()}},afterInitialize:function(){this.model.shieldedPhone?(t(this.el).find("#showPhone").show(),t(this.el).find("#showSetup").hide()):(t(this.el).find("#showSetup").show(),t(this.el).find("#showPhone").hide())},createChildren:function(){var i=new s({pageName:"manage_phone"}),o=new l({collection:new n.PhoneLogCollection});return this.model.shieldedPhone?o.collection.fetchAll({success:e.bind(function(){i.hide(),t(this.el).find(".data-display").show(),0===o.collection.length&&t(this.el).find("div.empty-notice").show()},this),error:e.bind(function(e,n){i.hide(),n.errorCode==r.PHONE_NOT_FOUND||n.errorCode==r.NO_DISPOSABLE_PHONE?t(".errorDiv").html(a.getText("mm_manage_phones_PhoneSetup")).show():t(".errorDiv").show()},this)}):i.hide(),{phoneLogList:o,loadingDisplay:i}},sortByColumn:function(e){var n=e.currentTarget.id.split("-"),i=n[n.length-1],a="desc"==n[n.length-2];this.children.phoneLogList.collection.comparator=this.phonesComparator[i],this.children.phoneLogList.collection.sort({silent:!0}),a&&this.children.phoneLogList.collection.models.reverse(),this.children.phoneLogList.collection.trigger("reset"),e.currentTarget.id="sortby-"+(a?"asc":"desc")+"-"+i;var s=t(e.currentTarget).find("i");s.hasClass("icon-chevron-down")?(s.removeClass("icon-chevron-down"),s.addClass("icon-chevron-up")):(s.removeClass("icon-chevron-up"),s.addClass("icon-chevron-down"))}},{routeName:"home/phones",routeAction:function(){ABINEMASKME.App.loadView(c,{model:{shieldedPhone:ABINEMASKME.user.shieldedPhone?ABINEMASKME.user.shieldedPhone:!1,disposablePhone:ABINEMASKME.user.disposablePhone?ABINEMASKME.user.disposablePhone:!1}})}});return i.Security.showLoginWhenLocked(c),c}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/nav/lock"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<ul class="nav">\n    <li class="action lock" style="margin-left:15px;">\n        <a href="javascript:void(0);" class="lock-it" style=""><img src="',i="pages/images/nav-lock.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'"/>&nbsp;',i="mm_nav_lock",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+"</a>\n    </li>\n</ul>\n"}),ABINEMASKME.CompiledTemplates["views/nav/lock"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/nav/nav"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<div id="navbar" class="navbar navbar-inverse navbar-fixed-top">\n    <div class="navbar-inner">\n        <div class="container">\n            <div class="row">\n                <nav>\n                    <ul class="nav" style="margin-left:5%;">\n                        <li><a href="http://link.abine.com/maskme_icon" target="_blank" ><img src="',i="/pages/images/manage/maskme_logo_green.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" width="150"></a></li>\n                    </ul>\n                </nav>\n                <nav id="nav">\n                    ',i="navOptions",s=n.child,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"child",i,{hash:{}}):a,r+=d(i)+'\n                </nav>\n\n                <div id="lock" style="margin-left:15px;">\n                   ',i="lock",s=n.child,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"child",i,{hash:{}}):a,r+=d(i)+'\n                </div>\n                <div id="sync" style="">\n                    ',i="sync",s=n.child,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"child",i,{hash:{}}):a,r+=d(i)+"\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/nav/nav"]}),ABINEMASKME.define("abine/views/nav",["documentcloud/underscore","jquery","models","duckbone/core","wycats/handlebars","abine/assets","abine/proxies","abine/eventLogger","abine/responseCodes"],function(e,t,n,i,a,s,r){var o=i.View.extend({templateName:"nav_options",afterInitialize:function(){}}),l=i.View.extend({tagName:"nav",templateName:"nav_sync",events:{"click a.syncLink":"sync"},afterInitialize:function(){},sync:function(){var e=this;ABINEMASKME.user.refreshEntitlements(function(){ABINEMASKME.user.isEntitledToSync()?r.syncModule.sync({},function(t){t?ABINEMASKME.user.loadPreferences(function(){e.render()}):ABINEMASKME.user.loadAll(function(){e.render()})}):r.securityManager.openPage(ABINEMASKME.user.getUpgradeLink({feature:"sync"}),!1)})}}),c=i.View.extend({tagName:"nav",templateName:"nav_lock",events:{"click .lock-it":"clickOnLock"},afterInitialize:function(){},clickOnLock:function(){r.securityManager.lock()}}),d=i.View.extend({templateName:"nav_nav",afterInitialize:function(){this.checkTimeline()},checkTimeline:function(){ABINEMASKME.user.hasTimelineEnabled()?this.$(".timeline").show():this.$(".timeline").hide()},renderEmpty:function(){this.children.navOptions.$el.hide(),this.children.sync.$el.hide(),this.children.lock.$el.hide(),this.$el.show(),this.checkTimeline()},renderNaked:function(){this.$el.hide()},renderFull:function(){this.$el.show(),this.children.navOptions.$el.show(),this.children.sync.$el.show(),this.children.lock.$el.show(),this.checkTimeline()},createChildren:function(){return this.children={navOptions:new o({model:ABINEMASKME.user}),sync:new l({model:ABINEMASKME.user}),lock:new c({model:ABINEMASKME.user})},this.children}});return d}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/nav/options"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<ul class="nav mainNav">\n    <li class="home"><a href="#home">',i="mm_nav_home",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</a></li>\n    <li style="display:none;" class="timeline"><a href="#timeline">',i="mm_nav_timeline",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</a></li>\n    <li class="userInfo"><a href="#userInfo">',i="mm_nav_settings",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</a></li>\n    <li class="helpIndex"><a href="#helpIndex">',i="mm_nav_help",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+"</a></li>\n</ul>\n"}),ABINEMASKME.CompiledTemplates["views/nav/options"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/nav/sync"]=e.template(function(e,t,n,i,a){function s(e,t){var i,a,s="";return s+="\n    ",i="mm_nav_lastSync",u=n.intl,a=u||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===m?a.call(e,i,{hash:{}}):a===b?g.call(e,"intl",i,{hash:{}}):a,s+=y(i)+"<br/>\n\n    ",u=n.isSyncDirty,i=u||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"isSyncDirty"),a=n["if"],h=f.program(2,r,t),h.hash={},h.fn=h,h.inverse=f.program(4,o,t),i=a.call(e,i,h),(i||0===i)&&(s+=i),s+="\n\n"}function r(e){var t,i,a="";return a+='\n        <span style="color:#ffc804;">',t="getLastSync",u=n.live_timestamp,i=u||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"live_timestamp"),t=typeof i===m?i.call(e,t,{hash:{}}):i===b?g.call(e,"live_timestamp",t,{hash:{}}):i,a+=y(t)+"</span>\n    "}function o(e){var t,i,a="";return a+="\n        <span>",t="getLastSync",u=n.live_timestamp,i=u||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"live_timestamp"),t=typeof i===m?i.call(e,t,{hash:{}}):i===b?g.call(e,"live_timestamp",t,{hash:{}}):i,a+=y(t)+"</span>\n    "}function l(e){var t,i,a="";return a+='\n    <div style="font-size:11px;padding-top:6px;color:#f1584b;">',t="mm_nav_tooLongSync",u=n.intl,i=u||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===m?i.call(e,t,{hash:{}}):i===b?g.call(e,"intl",t,{hash:{}}):i,a+=y(t)+"</div>\n"}n=n||e.helpers;var c,d,u,h,p="",f=this,m="function",g=n.helperMissing,b=void 0,y=this.escapeExpression;return p+='<ul class="nav" style="margin-right:0px;">\n    <li class="action sync" style="margin-left:-25px;">\n        <a href="javascript:void(0);" id="syncLink" class="syncLink">\n            <img src="',c="pages/images/nav-sync.png",u=n.assetUrl,d=u||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),c=typeof d===m?d.call(t,c,{hash:{}}):d===b?g.call(t,"assetUrl",c,{hash:{}}):d,p+=y(c)+'"/>&nbsp;',c="mm_nav_sync",u=n.intl,d=u||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),c=typeof d===m?d.call(t,c,{hash:{}}):d===b?g.call(t,"intl",c,{hash:{}}):d,p+=y(c)+'\n        </a>\n    </li>\n</ul>\n<div class="lastSyncText">\n',u=n.hasLastSync,c=u||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"hasLastSync"),d=n["if"],h=f.program(1,s,a),h.hash={},h.fn=h,h.inverse=f.program(6,l,a),c=d.call(t,c,h),(c||0===c)&&(p+=c),p+="\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/nav/sync"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/notification_helper/card_notification"]=e.template(function(e,t,n){n=n||e.helpers;
var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<div class="close-notification">\n    <span class="notf-close-icon"><img class="close-image" src="',i="/pages/images/manage/dd_close_icon.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'"/></span>\n</div>\n<div class="body-notification outerCard">\n    <div id="maskedCard" class="creditcardfont" style="color:rgb(80,80,80);height:181px;width:336px;">\n        <div style="border-radius:8px;padding:10px;padding-top:0px;background-repeat:no-repeat;width:336px;height:181px;background-image:url(\'',i="/pages/images/maskedcard.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'\');">\n             <br style="clear:both;"/>\n             <div style="text-align:center;margin-top:10px;">\n                <h3 id="cardNumber">',s=n.maskedCard,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"maskedCard"),i=null===i||void 0===i||i===!1?i:ABINEMASKME.Duckbone.Handlebars.getAttr(i,"getCardNumber"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"maskedCard.getCardNumber",{hash:{}})),r+=d(i)+'</h3>\n             </div>\n             <div style="font-size:15px;">\n                  <span style="float:left;">Exp Date: <span id="expiration">',s=n.maskedCard,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"maskedCard"),i=null===i||void 0===i||i===!1?i:ABINEMASKME.Duckbone.Handlebars.getAttr(i,"getExpiry"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"maskedCard.getExpiry",{hash:{}})),r+=d(i)+'</span></span> <span style="float:right;margin-right:25px;"> CVC: <span id="cvc">',s=n.maskedCard,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"maskedCard"),i=null===i||void 0===i||i===!1?i:ABINEMASKME.Duckbone.Handlebars.getAttr(i,"getCVC"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"maskedCard.getCVC",{hash:{}})),r+=d(i)+'</span></span>\n                  <br style="clear:both;"/>\n                  <div style="margin-left:127px;font-size:16px;letter-spacing:2px;">\n                     ',s=n.primaryCard,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"primaryCard"),i=null===i||void 0===i||i===!1?i:ABINEMASKME.Duckbone.Handlebars.getAttr(i,"getFirstName"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"primaryCard.getFirstName",{hash:{}})),r+=d(i)+" ",s=n.primaryCard,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"primaryCard"),i=null===i||void 0===i||i===!1?i:ABINEMASKME.Duckbone.Handlebars.getAttr(i,"getLastName"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"primaryCard.getLastName",{hash:{}})),r+=d(i)+'\n                  </div>\n                  <span id="street" style="margin-left: 100px;">280 SUMMER STREET</span><br><span id="cityStateZip" style="margin-left: 106px;">BOSTON MA 02210</span>\n              </div>\n        </div>\n    </div>\n</div>\n<div style="text-align:center;padding-bottom:5px;">\n<input type="button" class="btn btn-primary" style="width:90%;text-align:center;" value="Click here to chat with support" onclick="javascript:window.open(\'https://a3.websitealive.com/623/rRouter.asp?infocapture_ids=259,260&infocapture_values=|&groupid=623&wsa_custom0=&wsa_custom1=&websiteid=0&departmentid=755&dl=maskedcard\',\'\',\'width=400,height=400\');" />\n</div>\n'}),ABINEMASKME.CompiledTemplates["views/notification_helper/card_notification"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/notification_helper/panel"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<div class="close-notification">\n    <span class="notf-close-icon" id="paneHover"><img class="close-image" src="',i="/pages/images/manage/dd_close_icon.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'"/></span>\n</div>\n<div class="body-notification"><img src="',i="/images/Icon.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'"/>',s=n.msg,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"msg"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"msg",{hash:{}})),(i||0===i)&&(r+=i),r+="</div>\n\n"}),ABINEMASKME.CompiledTemplates["views/notification_helper/panel"]}),ABINEMASKME.define("abine/views/notificationPanel",["documentcloud/underscore","jquery","duckbone/core","abine/views/panelBase","abine/timer","abine/contentMessenger","abine/assets"],function(e,t,n,i,a,s){var r=i.extend({templateName:"notification_helper_panel",events:{mouseover:"onHover",mouseout:"onHoverEnd",click:"clicked"},afterInitialize:function(){this.targetId=this.options.notification.targetId?this.options.notification.targetId:"",this.targetUrl=this.options.notification.targetUrl?this.options.notification.targetUrl:"pages/index.html#home",this.targetUrl+=this.targetId,this.applyFadingStyle(),this.fadeIn(),this.model={get:e.bind(function(e){return this.options.notification[e]},this)},this.render(),this.startFadeOut()},clicked:function(e){return"close-notification"==e.target.className||"notf-close-icon"==e.target.className||"close-image"==e.target.className?(this.stopFadeOut(),this.closePanel(),void 0):(this.messenger=this.messenger||new s.ContentMessenger,this.messenger.send("window:createTab",{localUrl:this.targetUrl}),this.stopFadeOut(),this.closePanel(),void 0)},onHoverEnd:function(){t(this.el).css("border","2px solid #99cb33"),this.startFadeOut()},onHover:function(){t(this.el).css("border","2px solid #d8d8d8"),t(this.el).find("div.close-notification").show(),this.stopFadeOut()},startFadeOut:function(){this.options.notification.neverFade||(this.stopFadeOut(),this.fadeOutTimer=a.setTimeout(e.bind(function(){this.fadeOutTimer&&this.fadeOut()},this),this.options.timeout))},stopFadeOut:function(){this.fadeOutTimer&&(a.clearTimeout(this.fadeOutTimer),this.fadeOutTimer=null)}}),o=r.extend({templateName:"notification_helper_card_notification",afterInitialize:function(){this.applyFadingStyle(),this.fadeIn(),this.model=this.options.notification.model,this.render(),this.startFadeOut()},clicked:function(e){return"close-notification"==e.target.className||"notf-close-icon"==e.target.className||"close-image"==e.target.className?(this.stopFadeOut(),this.hidePanel(),void 0):void 0}});return{NotificationPanelView:r,CardNotificationPanelView:o}}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/password_helper/panel"]=e.template(function(e,t,n,i,a){function s(e){var t,i,a="";return a+='\n    <div class="header">\n        <div class="buttons-panel close-header-margin">\n          <span class="close-icon close-header" id="paneHover"></span>\n        </div>\n        <div class="buttons-panel question-header-margin">\n           <a href="https://www.abine.com/maskme/faq/#strongpassword" target="_blank"><span class="question-icon" id="paneHover"></span></a>\n        </div>\n        <img class="panel-icon" src="',t="/pages/images/manage/maskme_logo_short_green.png",h=n.assetUrl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"assetUrl",t,{hash:{}}):i,a+=v(t)+'"/>\n      </div>\n    <!-- Generate Password -->\n    <a href="#" class="mmKeyOption password strongPassword lessOptions"><div class="element" id="pass">\n      <span class="panelLeft">\n        <img class="iconPos" src="',t="/pages/images/password-icon.png",h=n.assetUrl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"assetUrl",t,{hash:{}}):i,a+=v(t)+'"/>\n        ',t="mm_password_helper_generateStrong",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,a+=v(t)+'\n      </span>\n      <span class="panelRight"></span>\n    </div></a>\n    <a href="#" class="mmKeyOption password lessOptions"><div class="element" id="options">\n      <span class="panelLeft">\n        <i class="iconPos icon-arrow-right"></i>\n        ',t="mm_password_helper_moreOptions",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,a+=v(t)+'\n      </span>\n      <span class="panelRight"></span>\n    </div></a>\n    <!-- more options -->\n    <a href="#" class="mmKeyOption password moreOptions" style="display:none"><div class="element" id="differentSpecialChars">\n      <span>\n        <img class="iconPos" src="',t="/pages/images/password-icon.png",h=n.assetUrl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"assetUrl",t,{hash:{}}):i,a+=v(t)+'"/>\n        ',t="mm_password_helper_differentSpecialChars",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,a+=v(t)+'\n      </span>\n    </div></a>\n    <a href="#" class="mmKeyOption password moreOptions" style="display:none"><div class="element" id="noSpecialChars">\n      <span>\n        <img class="iconPos" src="',t="/pages/images/password-icon.png",h=n.assetUrl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"assetUrl",t,{hash:{}}):i,a+=v(t)+'"/>\n        ',t="mm_password_helper_noSpecialChars",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,a+=v(t)+'\n      </span>\n    </div></a>\n    <a href="#" class="mmKeyOption password moreOptions" style="display:none"><div class="element" id="noNumbers">\n      <span>\n        <img class="iconPos" src="',t="/pages/images/password-icon.png",h=n.assetUrl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"assetUrl",t,{hash:{}}):i,a+=v(t)+'"/>\n        ',t="mm_password_helper_noNumbers",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,a+=v(t)+'\n      </span>\n    </div></a>\n    <div class="moreOptions clearfix" style="display:none;"><div style="text-align:center;">\n      ',t="mm_password_helper_or",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,a+=v(t)+" <br/>\n      ",t="mm_password_helper_typePassword",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,a+=v(t)+"\n    </div></div>\n  "}function r(e,t){var i,a,s="";return s+="\n    ",h=n.dynamicPanel,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"dynamicPanel"),a=n["if"],p=m.program(4,o,t),p.hash={},p.fn=p,p.inverse=m.program(7,c,t),i=a.call(e,i,p),(i||0===i)&&(s+=i),s+="\n  "}function o(e,t){var i,a,s="";return s+="\n        ",h=n.panelSections,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"panelSections"),a=n.each,p=m.program(5,l,t),p.hash={},p.fn=p,p.inverse=m.noop,i=a.call(e,i,p),(i||0===i)&&(s+=i),s+="\n    "}function l(e){var t,n="";return n+='\n            <div id="',t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"id"),typeof t===g?t=t.call(e,{hash:{}}):t===y&&(t=b.call(e,"this.id",{hash:{}})),n+=v(t)+'" style="height:',t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"height"),typeof t===g?t=t.call(e,{hash:{}}):t===y&&(t=b.call(e,"this.height",{hash:{}})),n+=v(t)+'" class="panelSection ',t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"class_name"),typeof t===g?t=t.call(e,{hash:{}}):t===y&&(t=b.call(e,"this.class_name",{hash:{}})),n+=v(t)+'">\n                ',t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"body"),typeof t===g?t=t.call(e,{hash:{}}):t===y&&(t=b.call(e,"this.body",{hash:{}})),(t||0===t)&&(n+=t),n+="\n            </div>\n        "}function c(e){var t,i,a="";return a+='\n        <div class="header">\n            <div class="buttons-panel close-header-margin">\n                <span class="close-icon close-header" id="paneHover"></span>\n            </div>\n            <div class="buttons-panel question-header-margin">\n                <a href="https://www.abine.com/maskme/faq/#strongpassword" target="_blank"><span class="question-icon" id="paneHover"></span></a>\n            </div>\n            <img class="panel-icon" src="',t="/pages/images/manage/maskme_logo_short_green.png",h=n.assetUrl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"assetUrl",t,{hash:{}}):i,a+=v(t)+'"/>\n        </div>\n\n        <!-- Get Started -->\n        <a href="#" class="mmKeyOption getStarted"><div class="element" id="mask">\n          <span class="panelLeft">\n            ',t="mm_helper_installed",h=n.intl,i=h||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===g?i.call(e,t,{hash:{}}):i===y?b.call(e,"intl",t,{hash:{}}):i,a+=v(t)+"\n          </span>\n        </div></a>\n    "}n=n||e.helpers;var d,u,h,p,f="",m=this,g="function",b=n.helperMissing,y=void 0,v=this.escapeExpression;return f+='<div class="panel">\n  ',h=n.hasRegistered,d=h||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"hasRegistered"),u=n["if"],p=m.program(1,s,a),p.hash={},p.fn=p,p.inverse=m.program(3,r,a),d=u.call(t,d,p),(d||0===d)&&(f+=d),f+="\n</div>\n\n"}),ABINEMASKME.CompiledTemplates["views/password_helper/panel"]}),ABINEMASKME.define("abine/views/passwordHelperPanel",["documentcloud/underscore","jquery","duckbone/core","abine/views/panelBase","abine/password","abine/timer"],function(e,t,n,i,a,s){var r=i.extend({templateName:"password_helper_panel",events:{"click .panelSection":"performActions","click #options":"showOptions","click a.strongPassword":"fillWithStrongPassword","click #differentSpecialChars":"fillWithDifferentSpecialChars","click #noSpecialChars":"fillWithNoSpecialChars","click #noNumbers":"fillWithNoNumbers","click a.getStarted":"getStarted"},afterInitialize:function(){this.field=this.options.field,this.contentManager=this.options.contentManager,this.numMenuOptions=1,this.bindBaseEvents(),this.applyFadingStyle(),this.fadeIn(),this.model={hasRegistered:this.options.hasRegistered,dynamicPanel:this.options.dynamicPanel},this.options.dynamicPanel&&(this.setupDynamicPanel(),this.model.panelSections=this.panelSections),this.contentManager.loadUserPreferences(e.bind(function(){this.model.hasRegistered=this.contentManager.preferences.getPref("hasRegistered")?!0:!1,this.model.hasRegistered?this.bind("enter0",function(e){this.fillWithStrongPassword(e)}):this.model.dynamicPanel?this.contentManager.messenger.send("update:panelActivity:impression",{panelId:this.model.dynamicPanel.id}):this.bind("enter0",function(e){this.getStarted(e)},this),this.render()},this))},showOptions:function(e){e&&e.preventDefault(),t(".moreOptions",this.el).show(),t(".lessOptions",this.el).hide(),this.trigger("render")},fillPassword:function(t,n){t&&t.preventDefault(),this.fillFieldsByType(this.options.fields,"/password",n,{domain:this.options.domain,origin:"strong"}),s.setTimeout(e.bind(function(){this.options.contentManager.showNotification({msg:"Click here to view your password.",targetUrl:"pages/index.html#home/passwords/",targetId:n})},this),1e3),this.closePanel()},fillWithStrongPassword:function(e){this.fillPassword(e,a.generateRandomPassword())},fillWithDifferentSpecialChars:function(e){this.fillPassword(e,a.generateSpecialCharsPassword())},fillWithNoSpecialChars:function(e){this.fillPassword(e,a.generateNoSpecialCharsPassword())},fillWithNoNumbers:function(e){this.fillPassword(e,a.generateNoDigitsPassword())}});return r}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/payment_helper/panel"]=e.template(function(e,t,n,i,a){function s(e,t){var i,a,s="";return s+="\n        ",y=n.primaryCard,i=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"primaryCard"),a=n["if"],v=E.program(2,r,t),v.hash={},v.fn=v,v.inverse=E.program(7,c,t),i=a.call(e,i,v),(i||0===i)&&(s+=i),s+="\n    "}function r(e,t){var i,a,s="";return s+='\n            <div class="header">\n                <div class="buttons-panel close-header-margin">\n                    <span class="close-icon close-header" id="paneHover"></span>\n                </div>\n                <div class="buttons-panel question-header-margin">\n                  <a href="#" id="faqLink"><span class="question-icon" id="paneHover"></span></a>\n                </div>\n                <img class="panel-icon" src="',i="/pages/images/manage/maskme_logo_short_green.png",y=n.assetUrl,a=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),i=typeof a===M?a.call(e,i,{hash:{}}):a===w?_.call(e,"assetUrl",i,{hash:{}}):a,s+=S(i)+'"/>\n            </div>\n            <span id="panelOptions">\n            <!--Mask My Card-->\n                <a href="#" class="mmKeyOption disposableCard">\n                    <div class="element" id="mask">\n                        <span class="panelLeft">\n                          <img class="iconPos" src="',i="/pages/images/maskcard-icon.png",y=n.assetUrl,a=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),i=typeof a===M?a.call(e,i,{hash:{}}):a===w?_.call(e,"assetUrl",i,{hash:{}}):a,s+=S(i)+'"/>\n                          ',i="mm_payment_helper_maskCard",y=n.intl,a=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===M?a.call(e,i,{hash:{}}):a===w?_.call(e,"intl",i,{hash:{}}):a,s+=S(i)+'\n                        </span>\n                        <span class="panelRight">\n                          <img class="loading" style="display:none;" src="',i="/pages/images/ajax_loader.gif",y=n.assetUrl,a=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),i=typeof a===M?a.call(e,i,{hash:{}}):a===w?_.call(e,"assetUrl",i,{hash:{}}):a,s+=S(i)+'"/>\n                          <span class="overflowText">',i="mm_payment_helper_usesCard",y=n.intl,a=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===M?a.call(e,i,{hash:{}}):a===w?_.call(e,"intl",i,{hash:{}}):a,s+=S(i)+"</span>\n                        </span>\n                    </div>\n                </a>\n\n            <!-- If Masked Cards already exist for this domain -->\n                ",y=n.disposableCards,i=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"disposableCards"),i=null===i||void 0===i||i===!1?i:ABINEMASKME.Duckbone.Handlebars.getAttr(i,"length"),a=n["if"],v=E.program(3,o,t),v.hash={},v.fn=v,v.inverse=E.noop,i=a.call(e,i,v),(i||0===i)&&(s+=i),s+="\n                ",y=n.disposableCards,i=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"disposableCards"),a=n.each,v=E.program(5,l,t),v.hash={},v.fn=v,v.inverse=E.noop,i=a.call(e,i,v),(i||0===i)&&(s+=i),s+='\n            </span>\n            <span id="newMaskedCard" style="display:none;">\n                <div style="height:auto;margin-left:15px;">\n                    <div class="row">\n                        <div class="span5">\n                            <p style="font-size=110%;font-weight:bold;text-align:center;"><img class="iconPos" src="',i="/pages/images/maskcard-icon.png",y=n.assetUrl,a=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),i=typeof a===M?a.call(e,i,{hash:{}}):a===w?_.call(e,"assetUrl",i,{hash:{}}):a,s+=S(i)+'"/> Mask it: Limit the bill. Protect your card #.</p>\n                        </div>\n                    </div>\n                    <div class="row" id="regularCardAmountRow">\n                        <div class="span3">\n                            <span class="input-prepend">\n                              <span class="add-on" style="font-size:38px;line-height:40px;height:40px;">$</span>\n                              <input maxlength="6" class="span2" id="cardAmount" type="text" style="font-size:38px;line-height:40px;height:50px;" placeholder="0.00">\n                            </span>\n                            <br/>\n                            <span id="amountError" style="line-height:11px;font-size:10px;color:red;"></span>\n                        </div>\n\n                        <div class="span2">\n                            <p style="margin-left:15px;font-size:14px;line-height:16px;">Please enter the exact amount for this transaction.</p>\n                        </div>\n                    </div>\n\n                    <div class="row" id="subscriptionCardAmountRow" style="display:none;">\n                        <div class="span3">\n                            <div style="padding:5px;">Monthly Price:</div>\n                            <div style="padding:5px;margin-top:10px;">Number of months you want:</div>\n                        </div>\n                        <div class="span2">\n                            <span class="input-prepend">\n                              <span class="add-on" style="font-size:18px;line-height:20px;height:20px;">$</span>\n                              <input maxlength="6" id="subscriptionAmount" type="text" style="width:100px;font-size:18px;line-height:20px;height:30px;" placeholder="0.00">\n                            </span>\n                            <br/>\n\n                            <input maxlength="2" class="span2" id="subscriptionMonths" type="text" style="margin-top:10px;font-size:18px;line-height:20px;height:30px;" placeholder="0" />\n                        </div>\n                    </div>\n\n                    <div class="row" id="subscriptionErrorRow" style="display:none;">\n                        <div class="offset1 span4" style="text-align:right;margin-bottom:5px;">\n                            <span id="subscriptionError" style="line-height:13px;font-size:11px;color:red;"></span>\n                        </div>\n                    </div>\n\n                    <div class="row">\n                        <div class="span2">\n                            <p style="font-size:10px;line-height:12px;margin-top:5px;">Charge will be applied to card ending in <strong>',y=n.primaryCard,i=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"primaryCard"),i=null===i||void 0===i||i===!1?i:ABINEMASKME.Duckbone.Handlebars.getAttr(i,"getLastFour"),typeof i===M?i=i.call(e,{hash:{}}):i===w&&(i=_.call(e,"primaryCard.getLastFour",{hash:{}})),s+=S(i)+'</strong></p>\n                        </div>\n\n                        <div class="span3">\n                            <input type="button" id="createCard" style="margin-left:95px;font-size:16px;" value="&nbsp;&nbsp;&nbsp;&nbsp;Next&nbsp;&nbsp;&nbsp;&nbsp;" class="btn btn-primary" />\n                        </div>\n                    </div>\n                    <div class="row">\n                        <div class="offset2 span3" style="">\n                            <input type="checkbox" id="subscriptionCard" /> <label style="display:inline-block;vertical-align:sub;" for="subscriptionCard">Is this for a subscription?</label>\n                        </div>\n                    </div>\n                </div>\n            </span>\n            <span id="confirmAmountView" style="display:none;">\n              <div style="padding:5px;padding-left:15px;">\n                  <h5 id="confirmRegularMsg">\n                    Great! They\'ll never see your real card. Please confirm a charge of\n                    $<span class="confirmAmount"></span> to your card ending in ',y=n.primaryCard,i=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"primaryCard"),i=null===i||void 0===i||i===!1?i:ABINEMASKME.Duckbone.Handlebars.getAttr(i,"getLastFour"),typeof i===M?i=i.call(e,{hash:{}}):i===w&&(i=_.call(e,"primaryCard.getLastFour",{hash:{}})),s+=S(i)+' before we make you a Masked Card.\n                  </h5>\n                  <h5 id="confirmSubscriptionMsg" style="display:none;">\n                    Your card ending in ',y=n.primaryCard,i=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"primaryCard"),i=null===i||void 0===i||i===!1?i:ABINEMASKME.Duckbone.Handlebars.getAttr(i,"getLastFour"),typeof i===M?i=i.call(e,{hash:{}}):i===w&&(i=_.call(e,"primaryCard.getLastFour",{hash:{}})),s+=S(i)+' will be charged $<span class="confirmAmount"></span> now and\n                    expire in <span id="monthsExpired"></span> months. Is this OK?\n                  </h5>\n                  <div style="text-align:center;">\n                    <input type="button" value="Nevermind" id="cancelCardCreate" class="btn" />\n                    <input type="button" value="Yes, Create Card" id="confirmCardCreate" class="btn btn-primary" />\n                  </div>\n                  <div style="text-align:center;margin-top:20px;margin-left:-60px;">\n                    <label for="dontShowCardConfirm">\n                        <input type="checkbox" id="dontShowCardConfirm" style="margin-top:-2px;"/> Don\'t ask me in the future\n                    </label>\n                  </div>\n              </div>\n            </span>\n            <span id="maskedCardView" style="display:none;">\n                <div id="maskedCardError" style="height:50px;display:none;text-align:center;padding:10px;">\n                    <div id="maskedCardErrorMsg" class="alert alert-error">\n\n                    </div>\n                </div>\n                <div id="loadingMaskedCard" style="height:50px;display:none;text-align:center;padding:10px;">\n                </div>\n                <div id="maskedCard" class="creditcardfont" style="color:rgb(80,80,80);width:336px;margin:auto;padding:10px;display:none;">\n                    <div style="border-radius:8px;padding:10px;padding-top:0px;background-repeat:no-repeat;width:336px;height:181px;background-image:url(\'',i="/pages/images/maskedcard.png",y=n.assetUrl,a=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),i=typeof a===M?a.call(e,i,{hash:{}}):a===w?_.call(e,"assetUrl",i,{hash:{}}):a,s+=S(i)+'\');">\n                         <br style="clear:both;"/>\n                         <div style="text-align:center;margin-top:10px;">\n                            <h3 id="cardNumber"></h3>\n                         </div>\n                         <div style="font-size:15px;">\n                             <span style="float:left;">Exp Date: <span id="expiration"></span></span> <span style="float:right;margin-right:25px;"> CVC: <span id="cvc"></span></span>\n                             <br style="clear:both;"/>\n                             <div style="margin-left:127px;font-size:16px;letter-spacing:2px;">\n                                ',y=n.primaryCard,i=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"primaryCard"),i=null===i||void 0===i||i===!1?i:ABINEMASKME.Duckbone.Handlebars.getAttr(i,"getFirstName"),typeof i===M?i=i.call(e,{hash:{}}):i===w&&(i=_.call(e,"primaryCard.getFirstName",{hash:{}})),s+=S(i)+" ",y=n.primaryCard,i=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"primaryCard"),i=null===i||void 0===i||i===!1?i:ABINEMASKME.Duckbone.Handlebars.getAttr(i,"getLastName"),typeof i===M?i=i.call(e,{hash:{}}):i===w&&(i=_.call(e,"primaryCard.getLastName",{hash:{}})),s+=S(i)+'\n                             </div>\n                             <span id="street" style="margin-left: 100px;">280 SUMMER STREET</span><br><span id="cityStateZip" style="margin-left: 106px;">BOSTON MA 02210</span>\n                         </div>\n                    </div>\n                     <div style="text-align:center;">\n                        <input type="button" value="Use My Masked Card" class="btn btn-primary" id="useMaskedCard" />\n                     </div>\n                </div>\n\n            </span>\n        '}function o(e){var t,i,a="";return a+='\n                    <div><p style="text-align:center;">',t="mm_email_helper_or",y=n.intl,i=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===M?i.call(e,t,{hash:{}}):i===w?_.call(e,"intl",t,{hash:{}}):i,a+=S(t)+"</p></div>\n                "}function l(e){var t,i,a="";return a+='\n                  <a href="#" cardId="',y=n.id,t=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"id"),typeof t===M?t=t.call(e,{hash:{}}):t===w&&(t=_.call(e,"id",{hash:{}})),a+=S(t)+'" class="mmKeyOption usedCard">\n                    <div class="element" id="mask">\n                      <span class="panelLeft">\n                          <img class="iconPos" src="',t="/pages/images/maskcard-icon.png",y=n.assetUrl,i=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===M?i.call(e,t,{hash:{}}):i===w?_.call(e,"assetUrl",t,{hash:{}}):i,a+=S(t)+'"/>\n                          Use card ending in ',t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getLastFour"),typeof t===M?t=t.call(e,{hash:{}}):t===w&&(t=_.call(e,"this.getLastFour",{hash:{}})),a+=S(t)+'\n                      </span>\n                      <span class="panelRight">\n                          <span class="overflowText">',y=n.getOriginalValue,t=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getOriginalValue"),typeof t===M?t=t.call(e,{hash:{}}):t===w&&(t=_.call(e,"getOriginalValue",{hash:{}})),a+=S(t)+" card</span>\n                      </span>\n                    </div>\n                  </a>\n                "}function c(){return"\n        <!-- shouldn't be possible to get here.. -->\n        "}function d(e,t){var i,a,s="";return s+="\n        ",y=n.dynamicPanel,i=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"dynamicPanel"),a=n["if"],v=E.program(10,u,t),v.hash={},v.fn=v,v.inverse=E.program(13,p,t),i=a.call(e,i,v),(i||0===i)&&(s+=i),s+="\n    "}function u(e,t){var i,a,s="";return s+="\n            ",y=n.panelSections,i=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"panelSections"),a=n.each,v=E.program(11,h,t),v.hash={},v.fn=v,v.inverse=E.noop,i=a.call(e,i,v),(i||0===i)&&(s+=i),s+="\n        "}function h(e){var t,n="";return n+='\n                <div id="',t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"id"),typeof t===M?t=t.call(e,{hash:{}}):t===w&&(t=_.call(e,"this.id",{hash:{}})),n+=S(t)+'" style="height:',t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"height"),typeof t===M?t=t.call(e,{hash:{}}):t===w&&(t=_.call(e,"this.height",{hash:{}})),n+=S(t)+'" class="panelSection ',t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"class_name"),typeof t===M?t=t.call(e,{hash:{}}):t===w&&(t=_.call(e,"this.class_name",{hash:{}})),n+=S(t)+'">\n                    ',t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"body"),typeof t===M?t=t.call(e,{hash:{}}):t===w&&(t=_.call(e,"this.body",{hash:{}})),(t||0===t)&&(n+=t),n+="\n                </div>\n            "}function p(e,t){var i,a,s="";return s+='\n            <div class="header">\n                <div class="buttons-panel close-header-margin">\n                    <span class="close-icon close-header" id="paneHover"></span>\n                </div>\n                <div class="buttons-panel question-header-margin">\n                 <a href="#" id="faqLink"><span class="question-icon" id="paneHover"></span></a>\n                </div>\n                <img class="panel-icon" src="',i="/pages/images/manage/maskme_logo_short_green.png",y=n.assetUrl,a=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),i=typeof a===M?a.call(e,i,{hash:{}}):a===w?_.call(e,"assetUrl",i,{hash:{}}):a,s+=S(i)+'"/>\n            </div>\n            ',y=n.entitledToPayments,i=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"entitledToPayments"),a=n["if"],v=E.program(14,f,t),v.hash={},v.fn=v,v.inverse=E.program(16,m,t),i=a.call(e,i,v),(i||0===i)&&(s+=i),s+="\n        "}function f(e){var t,i,a="";return a+='\n            <!-- Setup card -->\n              <a href="#" class="mmKeyOption setupCard">\n                <div class="element" id="mask">\n                  <span class="panelLeft">\n                      ',t="mm_payment_helper_setupMasked",y=n.intl,i=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===M?i.call(e,t,{hash:{}}):i===w?_.call(e,"intl",t,{hash:{}}):i,a+=S(t)+"\n                  </span>\n                </div>\n              </a>\n            "}function m(e){var t,i,a="";return a+='\n            <!-- Get Started -->\n                <a href="#" class="mmKeyOption setupCard">\n                    <div class="element" id="mask">\n                        <span class="panelLeft">\n                            ',t="mm_payment_helper_upgradeMaskedCard",y=n.intl,i=y||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===M?i.call(e,t,{hash:{}}):i===w?_.call(e,"intl",t,{hash:{}}):i,a+=S(t)+"\n                        </span>\n                    </div>\n                </a>\n            "
}n=n||e.helpers;var g,b,y,v,A="",E=this,M="function",_=n.helperMissing,w=void 0,S=this.escapeExpression;return A+='<div class="panel">\n    ',y=n.hasEnabledPayments,g=y||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"hasEnabledPayments"),b=n["if"],v=E.program(1,s,a),v.hash={},v.fn=v,v.inverse=E.program(9,d,a),g=b.call(t,g,v),(g||0===g)&&(A+=g),A+="\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/payment_helper/panel"]}),ABINEMASKME.define("abine/views/paymentHelperPanel",["documentcloud/underscore","jquery","duckbone/core","models","abine/views/panelBase","abine/timer","abine/views/loading_display","abine/contentMessenger","abine/intl","abine/responseCodes","abine/config"],function(e,t,n,i,a,s,r,o,l,c,d){var u=a.extend({templateName:"payment_helper_panel",events:{"click a.primaryCard":"fillWithPrimaryCard","click a.disposableCard":"showNewMaskedCardView","click a.usedCard":"fillWithUsedCard","click a.getStarted":"getStarted","click a.setupCard":"getStartedWithPayments","click .panelSection":"performActions","click #createCard":"createCard","click #cancelCardCreate":"cancelCardCreate","click #confirmCardCreate":"confirmCardCreate","click #useMaskedCard":"fillWithDisposableCard","click #faqLink":"openFaqTab","click #linkToErrorReport":"makeErrorReport","click #maskedCardErrorMsg a":"makeErrorReport"},makeErrorReport:function(e){return e&&e.target&&"verificationLink"!=e.target.id&&e.preventDefault(),!e||e&&e.target&&"verificationLink"!=e.target.id?(this.messenger=this.messenger||new o.ContentMessenger,this.messenger.send("window:createTab",{localUrl:"pages/index.html#errorReport/loading_card_create_panel"}),!1):void 0},openFaqTab:function(){this.messenger=this.messenger||new o.ContentMessenger,this.messenger.send("window:createTab",{localUrl:"pages/index.html#helpCardsIndex"})},convertCentsToString:function(e){return"$"+(e/100).toFixed(2)},confirmCardCreate:function(e){this.cardBeingCreated||(this.cardBeingCreated=!0,this.model.maskedCard=new i.DisposableCard({domain:this.options.domain,amount:i.DisposableCard.convertStringToCents(this.amount),months:this.months,shielded_card_id:this.model.primaryCard.id}),!e.skipConfirmCheck&&t(this.el).find("#dontShowCardConfirm").is(":checked")&&this.contentManager.preferences.setPref("confirmProtectedCard",!1),this.model.maskedCard.bind("sync:success",function(){this.cardBeingCreated=!1,t(this.el).find("#loadingMaskedCard").hide(),t(this.el).find("#cardNumber").html(this.model.maskedCard.getPrettyNumber()),t(this.el).find("#expiration").html(this.model.maskedCard.getExpiry()),t(this.el).find("#cvc").html(this.model.maskedCard.getCVC()),t(this.el).find("#maskedCard").show(),this.trigger("render")},this),this.model.maskedCard.bind("sync:error",function(e){t(this.el).find("#loadingMaskedCard").hide(),e.errorCode==c.NO_BILLING_ACCOUNT_FOR_USER_ERROR_CODE||e.errorCode==c.BILLING_FAILED_ERROR_CODE?t(this.el).find("#maskedCardErrorMsg").html(l.getText("mm_payment_error_billing")):e.errorCode==c.BILLING_DECLINED_ERROR_CODE?t(this.el).find("#maskedCardErrorMsg").html(l.getText("mm_payment_error_declined")):e.errorCode==c.NO_CARDS_AVAILABLE_ERROR_CODE||e.errorCode==c.PROVIDER_READ_FAILED_ERROR_CODE||e.errorCode==c.PROVIDER_CARD_CREATION_FAILED_ERROR_CODE?t(this.el).find("#maskedCardErrorMsg").html(l.getText("mm_payment_error_provider")):e.errorCode==c.REQUESTED_AMOUNT_OVER_LIMIT_ERROR_CODE?"verified"==e.responseJSON.data.category?t(this.el).find("#maskedCardErrorMsg").html(l.getText("mm_payment_error_validation_verified",[this.convertCentsToString(e.responseJSON.data.min),this.convertCentsToString(e.responseJSON.data.max)])):t(this.el).find("#maskedCardErrorMsg").html(l.getText("mm_payment_error_validation_max",[this.convertCentsToString(e.responseJSON.data.max)])+"<a id='verificationLink' href="+d.protocol+d.licenseServerHost+"/fraud_verification?auth_token="+this.model.authToken+" target=_blank "+"> verify your card.</a>"):e.errorCode==c.REQUESTED_AMOUNT_BELOW_MINIMUM_ERROR_CODE?t(this.el).find("#maskedCardErrorMsg").html(l.getText("mm_payment_error_validation_min",[this.convertCentsToString(e.responseJSON.data.min)])):e.errorCode==c.REQUEST_ALREADY_EXISTS_ERROR_CODE||e.errorCode==c.NO_CARD_FOUND_ERROR_CODE||e.errorCode==c.NO_BILLING_TRANSACTION_FOUND_ERROR_CODE?t(this.el).find("#maskedCardErrorMsg").html(l.getText("mm_payment_error_abine")):e.errorCode==c.REFUND_FAILED_ERROR_CODE?t(this.el).find("#maskedCardErrorMsg").html(l.getText("mm_payment_error_refund")):e.errorCode==c.FRAUD_SOFT_LIMIT_REACHED?t(this.el).find("#maskedCardErrorMsg").html(l.getText("mm_payment_error_soft_limit")+"<a id='verificationLink' href="+d.protocol+d.licenseServerHost+"/fraud_verification?auth_token="+this.model.authToken+" target=_blank "+"> verify your card.</a>"):e.errorCode==c.FRAUD_HARD_LIMIT_REACHED?t(this.el).find("#maskedCardErrorMsg").html(l.getText("mm_payment_error_hard_limit")):e.errorCode==c.FRAUD_VERIFIED_SOFT_LIMIT_REACHED?t(this.el).find("#maskedCardErrorMsg").html(l.getText("mm_payment_error_verified_soft_limit")):e.errorCode==c.FRAUD_HIGH_RISK_COUNTRY_ERROR_CODE?t(this.el).find("#maskedCardErrorMsg").html(l.getText("mm_payment_error_high_risk_country")):e.errorCode==c.GREY_LISTED_ERROR_CODE?t(this.el).find("#maskedCardErrorMsg").html(l.getText("mm_payment_error_grey_listed")+"<a id='verificationLink' href="+d.protocol+d.licenseServerHost+"/fraud_verification?auth_token="+this.model.authToken+" target=_blank "+"> verify your card.</a>"):t(this.el).find("#maskedCardErrorMsg").html(l.getText("mm_payment_error")),t(this.el).find("#maskedCardError").show(),this.trigger("render")},this),t(this.el).find("#newMaskedCard").hide(),t(this.el).find("#confirmAmountView").hide(),t(this.el).find("#maskedCardView").show(),this.loadingDisplay=new r({customMessages:["mm_loading_display_Crunching","mm_loading_display_Clouds","mm_loading_display_Tubes","mm_loading_display_HangOn","mm_loading_display_Whoops_Panel"],el:t(this.el).find("#loadingMaskedCard"),pageName:"card_create_panel"}),t(this.el).find("#loadingMaskedCard").show(),this.trigger("render"),this.ignoreExplicitClose=!0,this.model.maskedCard.save())},cancelCardCreate:function(){t(this.el).find("#confirmAmountView").hide(),t(this.el).find("#newMaskedCard").show(),this.ignoreBlur=!1,t(this.el).find("#cardAmount").focus(),this.trigger("render")},createCard:function(){var e,n,i=/[^\d\.]/g,a=t(this.el).find("#subscriptionCard").is(":checked");if(a?(e=t(this.el).find("#subscriptionAmount").val(),n=t(this.el).find("#subscriptionMonths").val(),n=n.replace(i,""),n=parseInt(n)):e=t(this.el).find("#cardAmount").val(),e=e.replace(i,""),e=parseFloat(parseFloat(e).toFixed(2)),a){if(isNaN(n)||1>n)return t(this.el).find("#subscriptionError").html(l.getText("mm_payment_helper_nonzero_months")),t(this.el).find("#subscriptionErrorRow").show(),this.trigger("render"),void 0;t(this.el).find("#subscriptionErrorRow").hide(),t(this.el).find("#subscriptionError").html(""),e*=n}isNaN(e)?(t(this.el).find("#amountError").html(l.getText("mm_payment_error_validation_input")),this.trigger("render")):(t(this.el).find("#amountError").html(""),this.amount=e,this.months=n,this.contentManager.preferences.isPrefTrue("confirmProtectedCard")?this.showConfirmAmountView(e,n):this.confirmCardCreate({amount:e,months:n,skipConfirmCheck:!0}))},showConfirmAmountView:function(e,n){t(this.el).find("#newMaskedCard").hide(),t(this.el).find(".confirmAmount").html(e),n?(t(this.el).find("#monthsExpired").html(n),t(this.el).find("#confirmRegularMsg").hide(),t(this.el).find("#confirmSubscriptionMsg").show()):(t(this.el).find("#confirmRegularMsg").show(),t(this.el).find("#confirmSubscriptionMsg").hide()),t(this.el).find("#confirmAmountView").show(),this.ignoreBlur=!0,t(this.options.field).focus(),this.trigger("render")},showNewMaskedCardView:function(n){n&&n.preventDefault(),t(this.el).find("#panelOptions").hide(),t(this.el).find("#newMaskedCard").show(),this.ignoreBlur=!1,t(this.field.element).unbind("blur"),t(this.el).find("#cardAmount").focus(),this.bindPanelTextInput(t(this.el).find("#cardAmount")),t(this.el).find("#subscriptionCard").change(e.bind(function(){t(this.el).find("#subscriptionCard").is(":checked")?(t(this.el).find("#regularCardAmountRow").hide(),t(this.el).find("#subscriptioncardAmountRow").show(),t(this.el).find("#subscriptionErrorRow").show()):(t(this.el).find("#subscriptionErrorRow").hide(),t(this.el).find("#subscriptioncardAmountRow").hide(),t(this.el).find("#regularCardAmountRow").show()),this.trigger("render")},this)),this.trigger("render")},cleanupPanel:function(){},afterInitialize:function(){this.field=this.options.field,this.numMenuOptions=2,this.bindHeaderClose(),this.bindFieldBlur(),this.bindKeyDown(),this.bindKeyUp(),this.applyFadingStyle(),this.fadeIn(),this.model={primaryCard:!1,authToken:this.options.authToken,hasRegistered:this.options.hasRegistered,entitledToPayments:this.options.entitledToPayments,hasEnabledPayments:this.options.hasEnabledPayments,dynamicPanel:this.options.dynamicPanel},this.options.dynamicPanel&&(this.setupDynamicPanel(),this.model.panelSections=this.panelSections),this.contentManager=this.options.contentManager,this.model.shieldedCard=new i.ShieldedCardCollection,this.model.shieldedCard.bind("sync:success",function(){this.model.shieldedCard.length>0&&(this.model.primaryCard=this.model.shieldedCard.at(0)),this.model.primaryCard?(this.model.disposableCards=new i.DisposableCardCollection,this.model.disposableCards.fetchAllByDomain(this.options.domain,e.bind(function(){this.bind("enter0",function(e){this.showNewMaskedCardView(e)}),this.bind("enter1",function(e){this.fillWithPrimaryCard(e)}),this.render()},this))):this.model.dynamicPanel?this.contentManager.messenger.send("update:panelActivity:impression",{panelId:this.model.dynamicPanel.id}):this.bind("enter0",function(e){this.getStarted(e)},this),this.render()},this),this.model.shieldedCard.fetchAll(),this.options.fromContextMenu&&s.setTimeout(e.bind(function(){this.showNewMaskedCardView()},this),100)},fillWithPrimaryCard:function(e){e&&e.preventDefault();var t=this.model.primaryCard,n=this.fillPaymentFieldsWith(this.options.fields,t.get("number"),t.get("type"),t.get("issued_to"),t.get("expiry_month"),t.get("expiry_year"),t.get("verification"));this.triggerPanelFillEvent({domain:this.options.domain,origin:"primary",field:{name:this.field.name,value:n,dataType:"/financial/creditcard/number",origin:this.field.origin}}),this.closePanel()},fillWithDisposableCard:function(t){t&&t.preventDefault();var n=this.fillPaymentFieldsWith(this.options.fields,this.model.maskedCard.get("number"),this.model.maskedCard.get("type"),this.model.primaryCard.getFirstName()+" "+this.model.primaryCard.getLastName(),this.model.maskedCard.get("expiry_month"),this.model.maskedCard.get("expiry_year"),this.model.maskedCard.get("cvc"));this.triggerPanelFillEvent({domain:this.options.domain,origin:"disposable",field:{name:this.field.name,disposableGUID:this.model.maskedCard.get("guid"),value:n,dataType:"/financial/creditcard/number",origin:this.field.origin}}),s.setTimeout(e.bind(function(){this.options.contentManager.showNotification({msg:"<h4 style='display:inline;'>Masked Card</h4><div style='text-align:center;'><div>"+this.model.maskedCard.get("type")+"</div><div>"+this.model.maskedCard.get("number")+"</div><div>"+this.model.maskedCard.getExpiry()+"</div><div>"+this.model.maskedCard.getCVC()+"</div></div>",targetUrl:"pages/index.html#payments",targetId:"",model:this.model,height:260,neverFade:!0})},this),1e3),this.closePanel()},setupCard:function(e){this.messenger=this.messenger||new o.ContentMessenger,this.messenger.send("window:createTab",{localUrl:"pages/index.html#payments"}),this.closePanel(e)},fillWithUsedCard:function(n,i){n&&n.preventDefault();var a;if(i||0==i){var r=e(this.el.children[0].children).filter(function(e){return t(e).is("a")&&!t(e).hasClass("disabled")});a=t(r[i]).attr("cardId")}else a=t(n.currentTarget).attr("cardId");var o=e.find(this.model.disposableCards.models,function(e){return e.id==a?!0:void 0});o&&(this.fillPaymentFieldsWith(this.options.fields,o.get("number"),o.get("type"),this.model.primaryCard.getFirstName()+" "+this.model.primaryCard.getLastName(),o.get("expiry_month"),o.get("expiry_year"),o.get("cvc")),s.setTimeout(e.bind(function(){this.options.contentManager.showNotification({msg:"",targetUrl:"pages/index.html#payments",targetId:"",model:{maskedCard:o,primaryCard:this.model.primaryCard},height:260,neverFade:!0})},this),1e3)),this.closePanel()}});return u}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/payments/edit_shielded"]=e.template(function(e,t,n,i,a){function s(e){var t,i,a,s="";return s+="\n\n  ",t="mm_payment_error",l=n.form_error_banner,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"form_error_banner"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"form_error_banner",t,{hash:{}}):i,s+=m(t)+'\n\n  <fieldset>\n\n    <div class="control-group">\n      ',t="mm_payment_issued_to",i="issued_to",l=n.form_label,a=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"form_label"),t=typeof a===h?a.call(e,i,t,{hash:{}}):a===f?p.call(e,"form_label",i,t,{hash:{}}):a,s+=m(t)+'\n      <div class="controls">\n        ',t="issued_to",l=n.form_text,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"form_text"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"form_text",t,{hash:{}}):i,s+=m(t)+'\n        <div class="help-block"></div>\n      </div>\n    </div>\n\n    <div class="control-group">\n      ',t="mm_payment_number",i="number",l=n.form_label,a=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"form_label"),t=typeof a===h?a.call(e,i,t,{hash:{}}):a===f?p.call(e,"form_label",i,t,{hash:{}}):a,s+=m(t)+'\n      <div class="controls">\n        ',t="number",l=n.form_text,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"form_text"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"form_text",t,{hash:{}}):i,s+=m(t)+'\n        <input class="form_text" type="text" name="verification" placeholder="CVV" />\n        <div class="accepted_cards">\n          <div class="card ',l=n.type,t=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"type"),typeof t===h?t=t.call(e,{hash:{}}):t===f&&(t=p.call(e,"type",{hash:{}})),s+=m(t)+'">',t="type",l=n.attr,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"attr"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"attr",t,{hash:{}}):i,s+=m(t)+'</div>\n        </div>\n        <div class="help-block"></div>\n      </div>\n    </div>\n\n    <div class="control-group">\n      ',t="mm_payment_expiry",i="expiry",l=n.form_label,a=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"form_label"),t=typeof a===h?a.call(e,i,t,{hash:{}}):a===f?p.call(e,"form_label",i,t,{hash:{}}):a,s+=m(t)+'\n      <div class="controls">\n        ',t="expiry_month",l=n.form_select,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"form_select"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"form_select",t,{hash:{}}):i,s+=m(t)+"\n        ",t="expiry_year",l=n.form_select,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"form_select"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"form_select",t,{hash:{}}):i,s+=m(t)+'\n        <div class="help-block"></div>\n      </div>\n    </div>\n\n    <div class="control-group">\n      <div class="controls">\n        <a class="form_submit" name="paymentSubmit">',t="mm_payment_save",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,s+=m(t)+'</a>\n        <a href="#" class="cancel btn">',t="mm_edit_user_cancel",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,s+=m(t)+"</a>\n      </div>\n    </div>\n  </fieldset>\n"}n=n||e.helpers;var r,o,l,c,d="",u=this,h="function",p=n.helperMissing,f=void 0,m=this.escapeExpression,g=n.blockHelperMissing;return r="editCard",l=n.form,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"form"),c=u.program(1,s,a),c.hash={},c.fn=c,c.inverse=u.noop,r=l&&typeof o===h?o.call(t,r,c):g.call(t,o,r,c),(r||0===r)&&(d+=r),d+="\n"}),ABINEMASKME.CompiledTemplates["views/payments/edit_shielded"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/payments/enable"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<ul class="breadcrumb">\n  <li><a href="#/home">',i="mm_manage_payments_home",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</a> <span class="divider">/</span></li>\n  <li class="active">',i="mm_manage_payments_MaskedCards",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</li>\n</ul>\n\n<div id="activePayments" class="row">\n    <div class="span4"><img src="',i="/pages/images/manage/activate-page.jpg",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" style="width:300px;" /></div>\n    <div class="span5">\n        <h3>Introducing Masked Cards. </h3> <h4>The smarter way to shop online.</h4> </br>\n\n        <h6>As a MaskMe premium subscriber, you can try this exclusive new feature.</h6>\n        <ul>\n            <li>Keep your credit card private when you shop online.</li>\n            <li>You choose when to mask your card and when not to.</li>\n            <li><strong>Completely free.</strong> No set up required. No charge to use. </li>\n        </ul>\n        <div class="well">\n            Use the card you already have on file: <br/><br/>\n                ',i="loadingDisplay",s=n.child,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"child",i,{hash:{}}):a,r+=d(i)+"\n                ",i="recurlyCardInformation",s=n.child,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"child",i,{hash:{}}):a,r+=d(i)+' <br/>\n                or, <a href="',s=n.getUpdateCardLink,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getUpdateCardLink"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"getUpdateCardLink",{hash:{}})),r+=d(i)+'" target="_blank"> change card.</a>\n        </div>\n\n        <form>\n            <fieldset>\n                <label class="checkbox">\n                    <input type="checkbox" id="terms" /> I accept the <a href="https://www.abine.com/legal/terms/cards/" target="_blank">Terms of Service</a>.<br/>\n                </label>\n                <label class="checkbox">\n                    <input type="checkbox" id="beta" /> I understand this is a new beta feature and am willing to provide feedback if I see bugs or have suggestions.<br/>\n                </label>\n                <span style="display: none;color:red;" id="termsError">You must accept both options above.</span><br/>\n                <span style="display: none;color:red;" id="activateError">Sorry, we\'re having trouble activating cards right now.  If this continues to happen, please contact support@abine.com.</span><br/>\n                <input type="button" id="activatePaymentsBtn" class="btn btn-primary" style="padding: 7px 25px 7px 25px; font-size: 15px; margin-top: -2px;" value="Agree" />\n                <img id="ajaxSpinner" style="display:none;" src="',i="/pages/images/ajax_loader.gif",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" />\n            </fieldset>\n        </form>\n    </div>\n</div>\n'}),ABINEMASKME.CompiledTemplates["views/payments/enable"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/payments/one_disposable"]=e.template(function(e,t,n,i,a){function s(){return'\n        <a class="btn btn-info" href="javascript:void" disabled="disabled">Gifted</a>\n    '}function r(e,t){var i,a,s="";return s+="\n        ",f=n.isActive,i=f||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"isActive"),a=n["if"],m=b.program(4,o,t),m.hash={},m.fn=m,m.inverse=b.program(6,l,t),i=a.call(e,i,m),(i||0===i)&&(s+=i),s+="\n    "}function o(e){var t,i,a="";return a+='\n            <a class="btn btn-success btn-mini deactivate_card" href="#holdOnPayment',f=n.getID,t=f||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getID"),typeof t===y?t=t.call(e,{hash:{}}):t===A&&(t=v.call(e,"getID",{hash:{}})),a+=E(t)+'"><i class="icon-ok-circle icon-white"/> ',t="mm_payment_disposable_active",f=n.intl,i=f||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===y?i.call(e,t,{hash:{}}):i===A?v.call(e,"intl",t,{hash:{}}):i,a+=E(t)+"</a>\n        "}function l(e){var t,i,a="";return a+='\n            <input type="button" disabled class="btn btn-danger deactivated" value="',t="mm_payment_disposable_blocked",f=n.intl,i=f||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===y?i.call(e,t,{hash:{}}):i===A?v.call(e,"intl",t,{hash:{}}):i,a+=E(t)+'" />\n        '}function c(e,t){var i,a,s="";return s+="\n      ",f=n.recipient_email,i=f||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"recipient_email"),a=n["if"],m=b.program(9,d,t),m.hash={},m.fn=m,m.inverse=b.noop,i=a.call(e,i,m),(i||0===i)&&(s+=i),s+="\n    "}function d(e){var t,i,a="";return a+='\n      <p id="emailResent',f=n.getID,t=f||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getID"),typeof t===y?t=t.call(e,{hash:{}}):t===A&&(t=v.call(e,"getID",{hash:{}})),a+=E(t)+'" style="display:none;color:green;"></p>\n        <a href="#" class="resendGiftEmailLink">Resend</a>\n        ',t="giftCardResendCowboy",f=n.child,i=f||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"child"),t=typeof i===y?i.call(e,t,{hash:{}}):i===A?v.call(e,"child",t,{hash:{}}):i,a+=E(t)+"\n      "}function u(e){var t,i="";return i+='\n        <a href="#/transactions/',f=n.id,t=f||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"id"),typeof t===y?t=t.call(e,{hash:{}}):t===A&&(t=v.call(e,"id",{hash:{}})),i+=E(t)+'">View</a>\n    '}n=n||e.helpers;var h,p,f,m,g="",b=this,y="function",v=n.helperMissing,A=void 0,E=this.escapeExpression;return g+='\n<td>\n    <span class="time-ago"><i class="icon-time"></i>&nbsp;',h="serverCreatedAt",f=n.live_timestamp,p=f||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"live_timestamp"),h=typeof p===y?p.call(t,h,{hash:{}}):p===A?v.call(t,"live_timestamp",h,{hash:{}}):p,g+=E(h)+'</span>\n</td>\n<td title="',f=n.domain,h=f||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"domain"),typeof h===y?h=h.call(t,{hash:{}}):h===A&&(h=v.call(t,"domain",{hash:{}})),g+=E(h)+'">\n    <span class="showLabel" style="cursor:pointer;">\n        ',f=n.domain,h=f||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"domain"),typeof h===y?h=h.call(t,{hash:{}}):h===A&&(h=v.call(t,"domain",{hash:{}})),g+=E(h)+'\n    </span>\n\n     <span class="editLabel" style="display:none;">\n       <input type="text" style="width:100px;" value="',f=n.domain,h=f||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"domain"),typeof h===y?h=h.call(t,{hash:{}}):h===A&&(h=v.call(t,"domain",{hash:{}})),g+=E(h)+'" class="editLabelInput" /> <a href="javascript:void(0);" style="vertical-align:super;" class="saveEditLabel btn btn-mini"><i class="icon-ok"></i></a> <a href="javascript:void(0);" style="vertical-align:super;" class="cancelEditLabel btn btn-mini"><i class="icon-remove"></i></a>\n     </span>\n</td>\n<td>\n    ',f=n.getOriginalValue,h=f||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getOriginalValue"),typeof h===y?h=h.call(t,{hash:{}}):h===A&&(h=v.call(t,"getOriginalValue",{hash:{}})),g+=E(h)+'\n</td>\n<td>\n  <span class="details">x',f=n.getLastFour,h=f||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getLastFour"),typeof h===y?h=h.call(t,{hash:{}}):h===A&&(h=v.call(t,"getLastFour",{hash:{}})),g+=E(h)+"</span>\n</td>\n<td>\n",f=n.activeToDate,h=f||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"activeToDate"),typeof h===y?h=h.call(t,{hash:{}}):h===A&&(h=v.call(t,"activeToDate",{hash:{}})),g+=E(h)+'\n</td>\n<td>\n    <p id="cardDeactivated',f=n.getID,h=f||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getID"),typeof h===y?h=h.call(t,{hash:{}}):h===A&&(h=v.call(t,"getID",{hash:{}})),g+=E(h)+'" style="display:none;color:green;"></p>\n    ',f=n.isGift,h=f||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"isGift"),p=n["if"],m=b.program(1,s,a),m.hash={},m.fn=m,m.inverse=b.program(3,r,a),h=p.call(t,h,m),(h||0===h)&&(g+=h),g+="\n\n    ",h="cowboy",f=n.child,p=f||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),h=typeof p===y?p.call(t,h,{hash:{}}):p===A?v.call(t,"child",h,{hash:{}}):p,g+=E(h)+"\n</td>\n<td>\n    ",f=n.isGift,h=f||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"isGift"),p=n["if"],m=b.program(8,c,a),m.hash={},m.fn=m,m.inverse=b.program(11,u,a),h=p.call(t,h,m),(h||0===h)&&(g+=h),g+="\n</td>\n"}),ABINEMASKME.CompiledTemplates["views/payments/one_disposable"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/payments/payment"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r,o="",l="function",c=n.helperMissing,d=void 0,u=this.escapeExpression;return o+='<ul class="breadcrumb">\n  <li><a href="#/home">',i="mm_payment_home",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'</a> <span class="divider">/</span></li>\n  <li class="active">',i="mm_payment_card",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+"</li>\n</ul>\n\n",i="loadingDisplay",r=n.child,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"child",i,{hash:{}}):a,o+=u(i)+'\n\n<div id="noMaskedCards" style="display:none;" class="alert alert-info">\n   ',i="mm_payment_noMaskedCards",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'\n</div>\n\n<div class="data-display" style="display:none;">\n  <div class="errorDiv alert alert-error" style="display:none;">\n    ',i="mm_payment_serverError",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'\n  </div>\n</div>\n\n<div style="display:none;" id="cardData">\n\n    <div class="manage_header_box card-header" id="showCard">\n        <div class="header-left">\n           <img src="',i="/pages/images/manage/CardOFF.png",r=n.assetUrl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"assetUrl",i,{hash:{}}):a,o+=u(i)+'" class="email_icon"/>\n           <div class="masked-card">\n              <p class="maskDisplay">Your Masked Cards</p>\n           </div>\n        </div>\n        <div class="header-left">\n           <img src="',i="/pages/images/manage/forward.png",r=n.assetUrl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"assetUrl",i,{hash:{}}):a,o+=u(i)+'" class="forward"/>\n           ',i="shieldedCardView",r=n.child,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"child",i,{hash:{}}):a,o+=u(i)+'\n        </div>\n\n        <br style="clear:both;"/>\n    </div>\n\n    <div id="emailTableWell" style="display:none;">\n      <table class="table table-striped disposableEmailTable">\n        <thead>\n          <tr><th class="sort-column" id="sortby-desc-createdAt">',i="mm_payment_created",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'</th>\n              <th class="sort-column" id="sortby-desc-label">',i="mm_payment_usedFor",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'</th>\n              <th class="type-column" id="sortby-desc-card-details">',i="mm_payment_originalValue",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'</th>\n              <th class="sort-column" id="sortby-desc-card-details">',i="mm_payment_lastFour",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'</th>\n              <th class="sort-column" id="sortby-desc-activeToDate"><span id="activeToDateSpan">',i="mm_payment_activeToDate",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'<a href="#" id="helpActiveToDateIcon"><i class ="icon-question-sign"></i></a></span></th>\n              <th class="sort-column" id="sortby-desc-active"><span id="activeSpan">',i="mm_payment_active",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'<a href="#" id="helpActiveIcon"><i class ="icon-question-sign"></i></a></span></th>\n              <th id="details-column">Details</th>\n          </tr>\n        </thead>\n        ',i="tbody",a="disposableCards",r=n.child,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"child",a,i,{hash:{}}):s,o+=u(i)+'\n      </table>\n    </div>\n</div>\n\n<div class="row">\n    <div class="span4">\n        <a href="#" class="btn btn-info" id="faqLink"><i class="icon-question-sign icon-white"></i> Masked Cards FAQ</a>\n    </div>\n    <div class="span4" style="margin:0px 0px 15px -110px">\n        <a style="display:inline-block;" class="btn btn btn-primary span2"\n           id="refreshCardsBtn"><i class="icon-refresh icon-white"></i> Refresh Card List</a>\n        <span style="display:none;font-size:14px;color:green;margin-top:7px;margin-left:10px;"\n              id="refreshedMsg">Refreshed!</span>\n        <span id="refreshLoading" style="display:none;">\n            <img id="ajaxSpinner" style="display:inline-block;margin-top:7px;margin-left:10px;"\n                 src="',i="/pages/images/ajax_loader.gif",r=n.assetUrl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"assetUrl",i,{hash:{}}):a,o+=u(i)+'" />\n        </span>\n    </div>\n</div>\n\n',i="giftCowboy",r=n.child,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"child",i,{hash:{}}):a,o+=u(i)+'\n<div class="well" id="createCard">\n    <h3> Create a new Masked Card </h3>\n    <div id="step1">\n        <p> Make a Masked Card to use anywhere... or send one as a gift. <input type="button" id="getStarted" class="btn btn-primary" value="Get started" />\n    </div>\n\n    <div id="step2" style="display:none;">\n        <div class="span3" id="step2_left">\n            <label style="display:inline-block;margin-top:7px;">Card Value:</label>\n            <span class="input-prepend">\n              <span class="add-on" style="font-size:14px;line-height:20px;height:20px;">$</span>\n              <input maxlength="6" class="span1" id="cardAmount" type="text" style="font-size:14px;line-height:20px;height:20px;" placeholder="0.00">\n            </span>\n            <br/>\n            <span id="amountError" style="line-height:11px;font-size:10px;color:red;"></span>\n            <br/>\n\n            <p>Is this for personal use, or a gift?</p>\n            <label style="display:inline-block;" for="personal_radio"><input type="radio" style="vertical-align: middle; margin: 0px;" id="personal_radio" name="cardUse" /> Personal </label>\n            <label style="display:inline-block;margin-left:15px;" for="gift_radio"><input type="radio" style="vertical-align: middle; margin: 0px;" id="gift_radio" name="cardUse" /> Gift </label>\n        </div>\n\n        <div class="span6" id="step2_gift" style="display:none;padding-left:10px;border-left:2px solid rgb(120,120,120);">\n            <label style="display:inline;margin-right:25px;" for="firstName">',i="mm_payment_gift_to",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+=' </label>\n              <input style="display:inline;margin-top:8px;" type="text" id="firstName" class="span2" placeholder="',i="mm_payment_gift_first_name",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='" />\n              <input style="margin-top:8px;display:inline;" class="span2" type="text" id="lastName" placeholder="',i="mm_payment_gift_last_name",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='" /> <br/>\n\n            <label style="display:inline;margin-right:5px;" for="giftEmail">',i="mm_payment_gift_email",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+=' </label>\n              <input style="display:inline;margin-top:8px;" type="text" id="giftEmail" placeholder="cris.p@bacon.com" /> <br />\n\n            <p style="font-size:10px;">',i="mm_payment_gift_info",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</p>\n\n            <input type="button" class="btn btn-primary" id="createGiftCard" value="',i="mm_payment_create_card",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='" />\n              <span class="loadingMaskedCard" style="display:none;">',i="giftCardLoadingDisplay",r=n.child,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"child",i,{hash:{}}):a,o+=u(i)+'</span>\n            <span class="maskedCardError" style="display:none;color:red;font-size:10px;"><span class="maskedCardErrorMsg"></span></span>\n        </div>\n        <div class="span6" id="step2_personal" style="display:none;padding-left:10px;border-left:2px solid rgb(120,120,120);">\n            <label for="cardFor" style="display:inline-block;">Make a note of where you\'ll use it:</label> <input type="text" style="margin-top:8px;display:inline-block;" id="cardFor" placeholder="www.example.com" />\n            <p style="font-size:10px;">Your card ending in <span class="lastFourSpan"></span> will be charged for the specified amount.</p>\n            <input type="button" class="btn btn-primary" id="createPersonalCard" value="Create Card" /><span class="loadingMaskedCard" style="display:none;">',i="cardLoadingDisplay",r=n.child,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"child",i,{hash:{}}):a,o+=u(i)+'</span>\n                                                                                                               <span class="maskedCardError" style="display:none;color:red;font-size:10px;"><span class="maskedCardErrorMsg"></span></span>\n        </div>\n\n    </div>\n    <br style="clear: both;"/>\n</div>\n\n<div class="modal hide" id="helpActiveToDateModal">\n  <div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal">&times;</button>\n    <h3 id="modalLabel">',i="mm_help_active_to_date_modal_Label",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</h3>\n  </div>\n  <div class="modal-body">\n    <p>',i="mm_help_active_to_date_modal_Body",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</p>\n  </div>\n  <div class="modal-footer">\n    <button id="ok" class="btn btn-primary" data-dismiss="modal">',i="mm_help_active_to_date_modal_Ok",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</button>\n  </div>\n</div>\n\n<div class="modal hide" id="helpActiveModal">\n  <div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal">&times;</button>\n    <h3 id="modalLabel">',i="mm_help_active_to_date_modal_Label",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</h3>\n  </div>\n  <div class="modal-body">\n    <p>',i="mm_help_active_modal_Body",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</p>\n  </div>\n  <div class="modal-footer">\n    <button id="ok" class="btn btn-primary" data-dismiss="modal">',i="mm_help_active_to_date_modal_Ok",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+="</button>\n  </div>\n</div>\n"
}),ABINEMASKME.CompiledTemplates["views/payments/payment"]}),ABINEMASKME.define("abine/views/payments",["documentcloud/underscore","jquery","models","duckbone/core","wycats/handlebars","abine/assets","abine/config","abine/url","abine/views/holdOnCowboyView","abine/intl","abine/pluralizer","abine/views/loading_display","abine/proxies","abine/views/recheck","abine/views/holdOnPaymentView","abine/views/holdOnGiftView","abine/views/holdOnGiftCardResendView","abine/views/helpCardsIndex","abine/contentMessenger","abine/responseCodes","abine/config"],function(e,t,n,i,a,s,r,o,l,c,d,u,h,p,f,m,g,b,y,v,A){var E=i.View.extend({tagName:"tr",className:"disposableCardRow",templateName:"payments_one_disposable",events:{"click .deactivateCardBtn":"deactivateCard","click .deactivate_card":"openDeactivateModal","click .nevermindBtn":"nevermind","click .showLabel":"showEditLabel","click .cancelEditLabel":"cancelEditLabel","click .saveEditLabel":"saveEditLabel","click .resendGiftEmailLink":"openResendModal","click .resendGiftEmailBtn":"resendGiftEmail"},openResendModal:function(){t("#resendError").hide(),t(this.el).find("#holdOnGiftCardResend"+this.model.getID()).modal()},resendGiftEmail:function(){t("#resendGiftSpinner").show(),h.paymentsModule.resendGiftCardEmail({card_guid:this.model.getGUID(),recipient_email:this.model.getRecipientEmail()},e.bind(function(e){t("#resendGiftSpinner").hide(),e?t("#resendError").show():(t(this.el).find("#holdOnGiftCardResend"+this.model.getID()).modal("hide"),t(this.el).find("#emailResent"+this.model.getID()).html("Gift card resent").show().fadeOut(4e3))},this))},saveEditLabel:function(){this.model.save({domain:t(this.el).find(".editLabelInput").val()},{success:e.bind(function(){this.render()},this),error:e.bind(function(){this.render()},this)})},cancelEditLabel:function(){t(this.el).find(".editLabelInput").val(this.model.attributes.domain),t(this.el).find(".showLabel").show(),t(this.el).find(".editLabel").hide()},showEditLabel:function(){t(this.el).find(".showLabel").hide(),t(this.el).find(".editLabel").show()},openDeactivateModal:function(){t(this.el).find("#holdOnPayment"+this.model.getID()).modal(),t(this.el).find("#loadingAmount"+this.model.getID()).show(),t(this.el).find("#amountLeft"+this.model.getID()).hide(),h.paymentsModule.retrieveDisposableCardBalance({guid:this.model.get("guid")},e.bind(function(e,n){if(e)t(this.e).find("#amountLeft"+this.model.getID()).html("Failed to load amount");else if(null!=n.available_balance){t(this.el).find("#loadingAmount"+this.model.getID()).hide();var i="$"+(n.available_balance/100).toFixed(2);t(this.el).find("#amountLeft"+this.model.getID()).html(i),t(this.el).find("#amountLeft"+this.model.getID()).show()}else t(this.e).find("#amountLeft"+this.model.getID()).html("Failed to load amount")},this))},nevermind:function(){t(this.el).find(".deactivateError").hide(),t(this.el).find(".deactivateLoading").hide()},deactivateCard:function(){this.children.cowboy.children.loadingDisplay.reset(),t(this.el).find(".deactivateError").hide(),t(this.el).find(".cowboyOptions").hide(),t(this.el).find(".deactivateLoading").show(),this.model.deactivateCard({success:e.bind(function(e){this.model.set({amount_refunded:e.amount_refunded}),this.model.set({active:0}),t(this.el).find(".deactivateLoading").hide(),t(this.el).find(".cowboyOptions").show(),t(this.el).find("#holdOnPayment"+this.model.getID()).modal("hide"),this.render();var n=(this.model.attributes.amount_refunded/100).toFixed(2);t(this.el).find("#cardDeactivated"+this.model.getID()).html("Refunded $"+n).show().fadeOut(4e3)},this),error:e.bind(function(n){t(this.el).find(".deactivateLoading").hide(),t(this.el).find(".cowboyOptions").show(),n.errorCode==v.NO_CARD_FOUND_ERROR_CODE||n.errorCode==v.REQUEST_ALREADY_EXISTS_ERROR_CODE||n.errorCode==v.NO_BILLING_TRANSACTION_FOUND_ERROR_CODE?t(this.el).find(".deactivateError").html(c.getText("mm_payment_error_deactivate_abine")).show():n.errorCode==v.PROVIDER_CANCEL_FAILED_ERROR_CODE?t(this.el).find(".deactivateError").html(c.getText("mm_payment_error_deactivate_provider")).show():n.errorCode==v.REFUND_FAILED_ERROR_CODE||n.errorCode==v.PROVIDER_READ_FAILED_ERROR_CODE?t(this.el).find(".deactivateError").html(c.getText("mm_payment_error_deactivate_refund")).show():t(this.el).find(".deactivateError").html(c.getText("mm_payment_serverError")).show(),t(this.el).find(".deactivateCardBtn").hide(),t(this.el).find(".nevermindBtn").hide(),t(this.el).find("#okBtn").show(),t(this.el).find("#holdOnPayment"+this.model.getID()).on("hidden",e.bind(function(){t(this.el).find("#okBtn").hide(),t(this.el).find(".deactivateCardBtn").show(),t(this.el).find(".nevermindBtn").show(),this.model.collection.trigger("error:deactivateCard")},this))},this)})},afterInitialize:function(){},createChildren:function(){return{cowboy:new f({model:this.model}),giftCardResendCowboy:new g({model:this.model})}}}),M=i.ListView.extend({tagName:"tbody",viewClass:E,afterInitialize:function(){}}),_=i.View.extend({templateName:"payments_view_shielded",events:{},afterInitialize:function(){}}),w=i.View.extend({templateName:"payments_recurly_card",afterInitialize:function(){}}),S=i.View.extend({templateName:"payments_enable",events:{"click #activatePaymentsBtn":"activatePayments"},activatePayments:function(){t(this.el).find("#terms").is(":checked")&&t(this.el).find("#beta").is(":checked")?(t(this.el).find("#activatePaymentsBtn").attr("disabled","disabled"),t(this.el).find("#ajaxSpinner").show(),t(this.el).find("#activateError").hide(),h.licenseModule.activatedCards({},e.bind(function(n){t(this.el).find("#ajaxSpinner").hide(),n?(t(this.el).find("#activatePaymentsBtn").removeAttr("disabled"),t(this.el).find("#activateError").show()):(e(ABINEMASKME.user.preferences.models).each(function(e){"suggestProtectedCard"==e.get("key")?e.save({category:"forms"}):"hasEnabledPayments"==e.get("key")?(e.set({value:"true"}),e.save()):"confirmProtectedCard"==e.get("key")&&e.save({category:"forms"})}),t(this.el).find("#activePayments").hide(),ABINEMASKME.App.navigate("helpCardsIndex",!0))},this))):t(this.el).find("#termsError").show()},createChildren:function(){var n=new w({collection:ABINEMASKME.user.shieldedCards,model:ABINEMASKME.user.shieldedCard}),i=new u({pageName:"enable_cards"});return this.children={loadingDisplay:i,recurlyCardInformation:n},n.collection.fetchAll({success:e.bind(function(){0==n.collection.length?(n.model.bind("sync:success",function(){n.render(),i.hide(),t(n.el).find("#shieldedCardInfo").show()},this),n.model.save()):(n.model=n.collection.models[0],n.render(),i.hide(),t(n.el).find("#shieldedCardInfo").show()),ABINEMASKME.user.shieldedCard.on("change",e.bind(function(){this.render()},this))},this)}),this.children},afterInitialize:function(){this.messenger=this.messenger||new y.ContentMessenger,this.messenger.on("background:updated:shieldedcard",function(e){this.children.recurlyCardInformation.model.set(e),this.render()},this)}}),k=i.View.extend({templateName:"payments_payment",events:{"click #getStarted":"getStarted","click #createPersonalCard":"createPersonalCard","click #createGiftCard":"createGiftCard","click .confirmCardBtn":"createCallback","click #refreshCardsBtn":"refreshCards","click #helpActiveToDateIcon":"showHelpActiveToDateModal","click #helpActiveIcon":"showHelpActiveModal","click #faqLink":"openFaq"},refreshCards:function(){t(this.el).find("#refreshCardsBtn").attr("disabled","disabled"),this.children.refreshLoadingDisplay.reset(),t(this.el).find("#refreshLoading").show(),t(this.el).find("#refreshedMsg").hide(),this.children.disposableCards.collection.fetchAllFromServer({success:e.bind(function(){this.children.disposableCards.render(),this.children.disposableCards.collection.models.length>0?(t(this.el).find("#cardData").show(),t(this.el).find("#emailTableWell").show(),t(this.el).find("#noMaskedCards").hide(),this.children.shieldedCardView.render()):t(this.el).find("#noMaskedCards").show(),t(this.el).find("#refreshedMsg").html("Refreshed!"),t(this.el).find("#refreshedMsg").css("color","green"),t(this.el).find("#refreshedMsg").css("display","inline-block").show().fadeOut(2e3),t(this.el).find("#refreshCardsBtn").removeAttr("disabled"),t(this.el).find("#refreshLoading").hide()},this),error:e.bind(function(){t(this.el).find("#refreshedMsg").html(c.getText("mm_payment_error_refresh")),t(this.el).find("#refreshedMsg").css("color","red"),t(this.el).find("#refreshedMsg").css("display","inline-block").show(),t(this.el).find("#refreshCardsBtn").removeAttr("disabled"),t(this.el).find("#refreshLoading").hide()},this)})},showHelpActiveToDateModal:function(){t("#helpActiveToDateModal").modal("show")},showHelpActiveModal:function(){t("#helpActiveModal").modal("show")},createCallback:function(){t("#holdOnGift").modal("hide"),t("#createCard").find("input, textarea, button, select").attr("disabled","disabled"),this.wrappedCallback()},checkForValidAmount:function(){var e=t(this.el).find("#cardAmount").val(),n=/[^\d\.]/g;return e=e.replace(n,""),e=parseFloat(parseFloat(e).toFixed(2)),isNaN(e)?(t(this.el).find("#cardAmount").val(""),t(this.el).find("#amountError").html(c.getText("mm_payment_error_validation_input")),!1):(t(this.el).find("#cardAmount").val(e.toFixed(2)),t(this.el).find("#amountError").html(""),e)},checkForValidDomain:function(){var e=t(this.el).find("#cardFor").val();return 0===e.length?(t(this.el).find(".maskedCardErrorMsg").html(c.getText("mm_payment_error_no_card_for")),!1):(t(this.el).find(".maskedCardErrorMsg").html(""),e)},checkForValidReceiverDetails:function(){var e=t.trim(this.$("#firstName").val()),n=t.trim(this.$("#lastName").val()),a=t.trim(this.$("#giftEmail").val()),s=this.$(".maskedCardError"),r=this.$(".maskedCardErrorMsg");return s.hide(),""==e||""==n?(r.html(c.getText("mm_payment_gift_name_required")),s.show(),!1):i.forms.validators.email(a)?!0:(r.html(c.getText("mm_payment_gift_email_required")),s.show(),!1)},convertCentsToString:function(e){return"$"+(e/100).toFixed(2)},createCard:function(e){var i=new n.DisposableCard({domain:e.domain,amount:n.DisposableCard.convertStringToCents(t(this.el).find("#cardAmount").val()),shielded_card_id:this.children.shieldedCardView.model.id,gift:e.gift,firstName:e.firstName,senderName:this.children.shieldedCardView.model.getName(),lastName:e.lastName,recipient_email:e.email});i.bind("sync:success",function(){t(this.el).find(".loadingMaskedCard").hide(),this.children.disposableCards.collection.add(i),t(this.el).find("#cardAmount").val(""),t(this.el).find("#createPersonalCard").show(),t(this.el).find("#createGiftCard").show(),t(this.el).find("#step2").hide(),t(this.el).find("#step1").show(),t(this.el).find("input[type='radio']").each(function(e){e.checked=!1}),this.render(),this.bindRadioButtons(),t("#createCard").find("input, textarea, button, select").removeAttr("disabled")},this),i.bind("sync:error",function(e){t(this.el).find(".loadingMaskedCard").hide(),e.errorCode==v.NO_BILLING_ACCOUNT_FOR_USER_ERROR_CODE||e.errorCode==v.BILLING_FAILED_ERROR_CODE?t(this.el).find(".maskedCardErrorMsg").html(c.getText("mm_payment_error_billing")):e.errorCode==v.BILLING_DECLINED_ERROR_CODE?t(this.el).find(".maskedCardErrorMsg").html(c.getText("mm_payment_error_declined")):e.errorCode==v.NO_CARDS_AVAILABLE_ERROR_CODE||e.errorCode==v.PROVIDER_READ_FAILED_ERROR_CODE||e.errorCode==v.PROVIDER_CARD_CREATION_FAILED_ERROR_CODE?t(this.el).find(".maskedCardErrorMsg").html(c.getText("mm_payment_error_provider")):e.errorCode==v.REQUESTED_AMOUNT_OVER_LIMIT_ERROR_CODE?"verified"==e.responseJSON.data.category?t(this.el).find(".maskedCardErrorMsg").html(c.getText("mm_payment_error_validation_verified",[this.convertCentsToString(e.responseJSON.data.min),this.convertCentsToString(e.responseJSON.data.max)])):t(this.el).find(".maskedCardErrorMsg").html(c.getText("mm_payment_error_validation_max",[this.convertCentsToString(e.responseJSON.data.max)])+"<a href="+A.protocol+A.licenseServerHost+"/fraud_verification?auth_token="+ABINEMASKME.user.getAuthToken()+" target=_blank "+"> verify your card.</a>"):e.errorCode==v.REQUESTED_AMOUNT_BELOW_MINIMUM_ERROR_CODE?t(this.el).find(".maskedCardErrorMsg").html(c.getText("mm_payment_error_validation_min",[this.convertCentsToString(e.responseJSON.data.min)])):e.errorCode==v.REQUESTED_AMOUNT_INVALID_ERROR_CODE?t(this.el).find(".maskedCardErrorMsg").html(c.getText("mm_payment_error_validation_input")):e.errorCode==v.REQUEST_ALREADY_EXISTS_ERROR_CODE||e.errorCode==v.NO_CARD_FOUND_ERROR_CODE||e.errorCode==v.NO_BILLING_TRANSACTION_FOUND_ERROR_CODE?t(this.el).find(".maskedCardErrorMsg").html(c.getText("mm_payment_error_abine")):e.errorCode==v.REFUND_FAILED_ERROR_CODE?t(this.el).find(".maskedCardErrorMsg").html(c.getText("mm_payment_error_refund")):e.errorCode==v.FRAUD_SOFT_LIMIT_REACHED?t(this.el).find(".maskedCardErrorMsg").html(c.getText("mm_payment_error_soft_limit")+"<a href="+A.protocol+A.licenseServerHost+"/fraud_verification?auth_token="+ABINEMASKME.user.getAuthToken()+" target=_blank "+"> verify your card.</a>"):e.errorCode==v.FRAUD_HARD_LIMIT_REACHED?t(this.el).find(".maskedCardErrorMsg").html(c.getText("mm_payment_error_hard_limit")):e.errorCode==v.FRAUD_VERIFIED_SOFT_LIMIT_REACHED?t(this.el).find(".maskedCardErrorMsg").html(c.getText("mm_payment_error_verified_soft_limit")):e.errorCode==v.FRAUD_HIGH_RISK_COUNTRY_ERROR_CODE?t(this.el).find(".maskedCardErrorMsg").html(c.getText("mm_payment_error_high_risk_country")):e.errorCode==v.GREY_LISTED_ERROR_CODE?t(this.el).find(".maskedCardErrorMsg").html(c.getText("mm_payment_error_grey_listed")+"<a href="+A.protocol+A.licenseServerHost+"/fraud_verification?auth_token="+ABINEMASKME.user.getAuthToken()+" target=_blank "+"> verify your card.</a>"):t(this.el).find(".maskedCardErrorMsg").html(c.getText("mm_payment_error")),t(this.el).find(".maskedCardError").show(),t(this.el).find("#createPersonalCard").show(),t(this.el).find("#createGiftCard").show(),t("#createCard").find("input, textarea, button, select").removeAttr("disabled")},this),t(this.el).find("#createPersonalCard").hide(),t(this.el).find("#createGiftCard").hide(),this.children.cardLoadingDisplay.reset(),this.children.giftCardLoadingDisplay.reset(),t(this.el).find(".loadingMaskedCard").show(),i.save()},createPersonalCard:function(){if(this.checkForValidAmount()&&this.checkForValidDomain()){var n=t(this.el).find("#cardFor").val();this.wrappedCallback=e.bind(function(){t(this.el).find(".maskedCardError").hide(),this.createCard({domain:n})},this),this.children.giftCowboy.model.attributes.msg=c.getText("mm_payment_giftCowboy",[this.children.shieldedCardView.model.attributes.last_four]),this.children.giftCowboy.render(),t("#holdOnGift").modal("show")}else t(this.el).find(".maskedCardError").show()},createGiftCard:function(){if(this.checkForValidAmount()&&this.checkForValidReceiverDetails()){var n=this.$("#firstName").val(),i=this.$("#lastName").val(),a=this.$("#giftEmail").val();this.wrappedCallback=e.bind(function(){this.createCard({domain:n+" "+i,firstName:n,lastName:i,email:a,gift:!0})},this),this.children.giftCowboy.model.attributes.msg=c.getText("mm_payment_giftCowboy_email",[a,this.children.shieldedCardView.model.attributes.last_four]),this.children.giftCowboy.render(),t("#holdOnGift").modal("show")}},getStarted:function(){t(this.el).find("#step1").hide(),t(this.el).find("#step2").show()},bindRadioButtons:function(){t(this.el).find("input[name='cardUse']").change(e.bind(function(){t(this.el).find("#personal_radio").is(":checked")?(t(this.el).find("#step2_gift").hide(),t(this.el).find("#step2_personal").show()):(t(this.el).find("#step2_gift").show(),t(this.el).find("#step2_personal").hide())},this))},openFaq:function(){ABINEMASKME.App.loadView(b,{activationFlow:!1})},afterInitialize:function(){t(this.el).show(),this.bindRadioButtons()},shieldedCardChanged:function(){var e=this.children.shieldedCardView;e.collection.models.length>0&&(e.model=e.collection.models[0],t(this.el).find(".lastFourSpan").html(e.model.attributes.last_four)),this.init||this.children.disposableCards.collection.fetchAll()},disposableCardsChanged:function(){var e=this.children.disposableCards,n=this.children.shieldedCardView;e.collection.models.length>0?(t(this.el).find("#cardData").show(),t(this.el).find("#emailTableWell").show(),n.render()):t(this.el).find("#noMaskedCards").show(),this.children.loadingDisplay.hide()},createChildren:function(){var e=new M({collection:ABINEMASKME.user.disposableCards});e.collection.bind("error:deactivateCard",function(){this.refreshCards()},this);var t=new _({collection:ABINEMASKME.user.shieldedCards,model:ABINEMASKME.user.shieldedCard}),i=new u({customMessages:["mm_loading_display_Crunching","mm_loading_display_Clouds","mm_loading_display_Tubes","mm_loading_display_HangOn","mm_loading_display_Whoops"],pageName:"manage_cards_create"}),a=new u({customMessages:["mm_loading_display_Crunching","mm_loading_display_Clouds","mm_loading_display_Tubes","mm_loading_display_HangOn","mm_loading_display_Whoops"],pageName:"manage_cards_gift_create"}),s=new u({pageName:"manage_cards"}),r=new u({pageName:"manage_cards_refresh"});return this.children={loadingDisplay:s,shieldedCardView:t,disposableCards:e,refreshLoadingDisplay:r,cardLoadingDisplay:i,giftCardLoadingDisplay:a,giftCowboy:new m({model:new n.BaseModel})},this.init=!0,this.shieldedCardChanged(),this.disposableCardsChanged(),delete this.init,this.weakBindTo(t.collection,"sync:read",function(){s.startRefreshing()},this),this.weakBindTo(t.collection,"sync",this.shieldedCardChanged,this),this.weakBindTo(e.collection,"sync:read",function(){r.startRefreshing()},this),this.weakBindTo(e.collection,"sync",this.disposableCardsChanged,this),t.collection.fetchAll(),this.children}},{routeName:"payments",routeAction:function(){r.payments&&(ABINEMASKME.user.hasEnabledPayments()?ABINEMASKME.App.loadView(k,{}):ABINEMASKME.user.isEntitledToPayments()?ABINEMASKME.App.loadView(S,{model:ABINEMASKME.user}):(ABINEMASKME.App.navigate("home",!0),h.securityManager.openPage(ABINEMASKME.user.getUpgradeLink({feature:"cards"}),!1)))}});return i.Security.showBlankWhenLocked(k),k}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/payments/recurly_card"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s="",r="function",o=n.helperMissing,l=void 0,c=this.escapeExpression;return s+=' <ul id="shieldedCardInfo" style="display:none;list-style:none;">\n    <li>',a=n.getName,i=a||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getName"),typeof i===r?i=i.call(t,{hash:{}}):i===l&&(i=o.call(t,"getName",{hash:{}})),s+=c(i)+"</li>\n    <li>xxxx xxxx xxxx ",a=n.getLastFour,i=a||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getLastFour"),typeof i===r?i=i.call(t,{hash:{}}):i===l&&(i=o.call(t,"getLastFour",{hash:{}})),s+=c(i)+"</li>\n    <li>Expires ",a=n.getExpiry,i=a||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getExpiry"),typeof i===r?i=i.call(t,{hash:{}}):i===l&&(i=o.call(t,"getExpiry",{hash:{}})),s+=c(i)+"</li>\n</ul>\n"}),ABINEMASKME.CompiledTemplates["views/payments/recurly_card"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/payments/view_shielded"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<div class="real-card">\n  ',i="mm_payment_maskingCard",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+':\n  <p class="actualDisplay">xxxx xxxx xxxx ',s=n.getLastFour,i=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getLastFour"),typeof i===o?i=i.call(t,{hash:{}}):i===c&&(i=l.call(t,"getLastFour",{hash:{}})),r+=d(i)+"</p>\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/payments/view_shielded"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/phone_helper/panel"]=e.template(function(e,t,n,i,a){function s(e,t){var i,a,s="";return s+='\n          <!-- Logo and Panel Buttons -->\n          <div class="header">\n              <div class="buttons-panel close-header-margin">\n                  <span class="close-icon close-header" id="paneHover"></span>\n              </div>\n              <div class="buttons-panel question-header-margin">\n                  <a href="https://www.abine.com/maskme/faq/#aliasphone" target="_blank"><span class="question-icon" id="paneHover"></span></a>\n              </div>\n              <img class="panel-icon" src="',i="/pages/images/manage/maskme_logo_short_green.png",g=n.assetUrl,a=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),i=typeof a===A?a.call(e,i,{hash:{}}):a===M?E.call(e,"assetUrl",i,{hash:{}}):a,s+=_(i)+'"/>\n          </div>\n\n          ',g=n.primaryPhone,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"primaryPhone"),i=null===i||void 0===i||i===!1?i:ABINEMASKME.Duckbone.Handlebars.getAttr(i,"isValidated"),a=n["if"],b=v.program(2,r,t),b.hash={},b.fn=b,b.inverse=v.program(4,o,t),i=a.call(e,i,b),(i||0===i)&&(s+=i),s+='\n          <!--Disclose My Phone-->\n          <a href="#" class="mmKeyOption primaryPhone"><div class="element" id="disclose">\n              <span class="panelLeft">\n                  <img class="iconPos" src="',i="/pages/images/disclosephone-icon.png",g=n.assetUrl,a=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),i=typeof a===A?a.call(e,i,{hash:{}}):a===M?E.call(e,"assetUrl",i,{hash:{}}):a,s+=_(i)+'"/>\n                  ',i="mm_phone_helper_disclosePhone",g=n.intl,a=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),i=typeof a===A?a.call(e,i,{hash:{}}):a===M?E.call(e,"intl",i,{hash:{}}):a,s+=_(i)+'\n              </span>\n              <span class="panelRight">\n                  <span class="overflowText">',g=n.primaryPhone,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"primaryPhone"),i=null===i||void 0===i||i===!1?i:ABINEMASKME.Duckbone.Handlebars.getAttr(i,"getPrettyNumber"),typeof i===A?i=i.call(e,{hash:{}}):i===M&&(i=E.call(e,"primaryPhone.getPrettyNumber",{hash:{}})),s+=_(i)+"</span>\n              </span>\n          </div></a>\n    "}function r(e){var t,i,a="";return a+='\n              <!--Mask My Phone-->\n              <a href="#" class="mmKeyOption disposablePhone"><div class="element" id="mask">\n                  <span class="panelLeft">\n                      <img class="iconPos" src="',t="/pages/images/maskphone-icon.png",g=n.assetUrl,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===A?i.call(e,t,{hash:{}}):i===M?E.call(e,"assetUrl",t,{hash:{}}):i,a+=_(t)+'"/>\n                      ',t="mm_phone_helper_maskPhone",g=n.intl,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===A?i.call(e,t,{hash:{}}):i===M?E.call(e,"intl",t,{hash:{}}):i,a+=_(t)+'\n                  </span>\n                  <span class="panelRight">\n                      <img class="loading" style="display:none;" src="',t="/pages/images/ajax_loader.gif",g=n.assetUrl,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===A?i.call(e,t,{hash:{}}):i===M?E.call(e,"assetUrl",t,{hash:{}}):i,a+=_(t)+'"/>\n                      <span class="overflowText">',t="mm_phone_helper_usesPhone",g=n.intl,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===A?i.call(e,t,{hash:{}}):i===M?E.call(e,"intl",t,{hash:{}}):i,a+=_(t)+"</span>\n                  </span>\n              </div></a>\n          "}function o(e){var t,i,a="";return a+='\n              <!-- Setup your Masked Phone -->\n              <a href="#" class="mmKeyOption setupPhone"><div class="element" id="mask">\n                  <span class="panelLeft">\n                      ',g=n.idMeAppName,t=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"idMeAppName"),typeof t===A?t=t.call(e,{hash:{}}):t===M&&(t=E.call(e,"idMeAppName",{hash:{}})),a+=_(t)+" ",t="mm_phone_helper_pleaseValidate",g=n.intl,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===A?i.call(e,t,{hash:{}}):i===M?E.call(e,"intl",t,{hash:{}}):i,a+=_(t)+"\n                  </span>\n              </div></a>\n          "}function l(e,t){var i,a,s="";return s+="\n\n        ",g=n.dynamicPanel,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"dynamicPanel"),a=n["if"],b=v.program(7,c,t),b.hash={},b.fn=b,b.inverse=v.program(10,u,t),i=a.call(e,i,b),(i||0===i)&&(s+=i),s+="\n    "}function c(e,t){var i,a,s="";return s+="\n            ",g=n.panelSections,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"panelSections"),a=n.each,b=v.program(8,d,t),b.hash={},b.fn=b,b.inverse=v.noop,i=a.call(e,i,b),(i||0===i)&&(s+=i),s+="\n        "}function d(e){var t,n="";return n+='\n                <div id="',t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"id"),typeof t===A?t=t.call(e,{hash:{}}):t===M&&(t=E.call(e,"this.id",{hash:{}})),n+=_(t)+'" style="height:',t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"height"),typeof t===A?t=t.call(e,{hash:{}}):t===M&&(t=E.call(e,"this.height",{hash:{}})),n+=_(t)+'" class="panelSection ',t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"class_name"),typeof t===A?t=t.call(e,{hash:{}}):t===M&&(t=E.call(e,"this.class_name",{hash:{}})),n+=_(t)+'">\n                    ',t=ABINEMASKME.Duckbone.Handlebars.getAttr(e,"body"),typeof t===A?t=t.call(e,{hash:{}}):t===M&&(t=E.call(e,"this.body",{hash:{}})),(t||0===t)&&(n+=t),n+="\n                </div>\n            "}function u(e,t){var i,a,s="";return s+='\n            <div class="header">\n                <div class="buttons-panel close-header-margin">\n                    <span class="close-icon close-header" id="paneHover"></span>\n                </div>\n                <div class="buttons-panel question-header-margin">\n                    <a href="https://www.abine.com/maskme/faq/#aliasemail" target="_blank"><span class="question-icon" id="paneHover"></span></a>\n                </div>\n                <img class="panel-icon" src="',i="/pages/images/manage/maskme_logo_short_green.png",g=n.assetUrl,a=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),i=typeof a===A?a.call(e,i,{hash:{}}):a===M?E.call(e,"assetUrl",i,{hash:{}}):a,s+=_(i)+'"/>\n            </div>\n\n            ',g=n.entitledToPhone,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"entitledToPhone"),a=n["if"],b=v.program(11,h,t),b.hash={},b.fn=b,b.inverse=v.program(13,p,t),i=a.call(e,i,b),(i||0===i)&&(s+=i),s+="\n        "}function h(e){var t,i,a="";return a+='\n                <a href="#" class="mmKeyOption upgradeToPhone">\n                    <div class="element" id="mask">\n                        <span class="panelLeft">\n                            ',t="mm_phone_helper_setupMasked",g=n.intl,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===A?i.call(e,t,{hash:{}}):i===M?E.call(e,"intl",t,{hash:{}}):i,a+=_(t)+"\n                        </span>\n                    </div>\n                </a>\n            "}function p(e){var t,i,a="";return a+='\n                <a href="#" class="mmKeyOption upgradeToPhone">\n                    <div class="element" id="mask">\n                        <span class="panelLeft" style="width:100%;">\n                            ',t="mm_phone_helper_upgradeMaskedPhone",g=n.intl,i=g||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===A?i.call(e,t,{hash:{}}):i===M?E.call(e,"intl",t,{hash:{}}):i,a+=_(t)+"\n                        </span>\n                    </div>\n                </a>\n            "}n=n||e.helpers;var f,m,g,b,y="",v=this,A="function",E=n.helperMissing,M=void 0,_=this.escapeExpression;return y+='<div class="panel">\n    ',g=n.primaryPhone,f=g||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"primaryPhone"),m=n["if"],b=v.program(1,s,a),b.hash={},b.fn=b,b.inverse=v.program(6,l,a),f=m.call(t,f,b),(f||0===f)&&(y+=f),y+="\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/phone_helper/panel"]}),ABINEMASKME.define("abine/views/phoneHelperPanel",["documentcloud/underscore","jquery","duckbone/core","models","abine/views/panelBase","abine/timer"],function(e,t,n,i,a,s){var r=a.extend({templateName:"phone_helper_panel",events:{"click a.primaryPhone":"fillWithPrimaryPhone","click a.disposablePhone":"fillWithDisposablePhone","click a.getStarted":"getStarted","click a.setupPhone":"setupPhone","click a.upgradeToPhone":"getStartedWithPhone","click .panelSection":"performActions"},afterInitialize:function(){this.field=this.options.field,this.numMenuOptions=2,this.bindBaseEvents(),this.applyFadingStyle(),this.fadeIn(),this.model={primaryPhone:!1,hasRegistered:this.options.hasRegistered,entitledToPhone:this.options.entitledToPhone,dynamicPanel:this.options.dynamicPanel},this.options.dynamicPanel&&(this.setupDynamicPanel(),this.model.panelSections=this.panelSections),this.contentManager=this.options.contentManager,this.contentManager.loadUserPreferences(e.bind(function(){this.model.hasRegistered=this.contentManager.preferences.getPref("hasRegistered")?!0:!1,this.model.hasRegistered?(this.model.shieldedPhones=new i.ShieldedPhoneCollection,this.model.shieldedPhones.bind("sync:success",function(){this.model.shieldedPhones.length>0&&(this.model.primaryPhone=this.model.shieldedPhones.at(0)),this.model.primaryPhone?(this.bind("enter0",function(e){this.fillWithDisposablePhone(e)}),this.bind("enter1",function(e){this.fillWithPrimaryPhone(e)})):this.model.dynamicPanel?this.contentManager.messenger.send("update:panelActivity:impression",{panelId:this.model.dynamicPanel.id}):this.bind("enter0",function(e){this.setupPhone(e)},this),this.render()},this),this.model.shieldedPhones.fetchAll()):(this.model.dynamicPanel?this.contentManager.messenger.send("update:panelActivity:impression",{panelId:this.model.dynamicPanel.id}):this.bind("enter0",function(e){this.getStarted(e)},this),this.render())},this))},fillWithPrimaryPhone:function(e){e&&e.preventDefault();var t=this.fillPhoneFieldsWith(this.options.fields,this.model.primaryPhone.get("country_code"),this.model.primaryPhone.get("number"));this.triggerPanelFillEvent({domain:this.options.domain,origin:"primary",field:{name:"/contact/phone"==this.field.dataType?this.field.name:"dynamic",value:"/contact/phone"==this.field.dataType?this.field.value:t,dataType:"/contact/phone",origin:this.field.origin}}),this.closePanel()},fillWithDisposablePhone:function(t){t&&t.preventDefault(),this.$(".loading").show();var n=this.model.primaryPhone.generateDisposable();n.save({},{success:e.bind(function(){var t=this.fillPhoneFieldsWith(this.options.fields,n.get("country_code"),n.get("number"));this.triggerPanelFillEvent({domain:this.options.domain,origin:"disposable",field:{name:"/contact/phone"==this.field.dataType?this.field.name:"dynamic",disposableGUID:n.get("id"),value:"/contact/phone"==this.field.dataType?this.field.value:t,dataType:"/contact/phone",origin:this.field.origin}}),s.setTimeout(e.bind(function(){this.options.contentManager.showNotification({msg:"Click here to view your Masked Phone usage.",targetUrl:"pages/index.html#home/phones",targetId:""})},this),1e3),this.closePanel()},this)})}});return r}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/preferences/one"]=e.template(function(e,t,n,i,a){function s(e,t){var i,a,s="";return s+='\n    <div class="checkbox-group">\n      ',i="value",d=n.form_checkbox,a=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"form_checkbox"),i=typeof a===f?a.call(e,i,{hash:{}}):a===g?m.call(e,"form_checkbox",i,{hash:{}}):a,s+=b(i)+"\n      ",i="something",d=n.form_label,a=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"form_label"),u=p.program(2,r,t),u.hash={},u.fn=u,u.inverse=p.noop,i=d&&typeof a===f?a.call(e,i,u):y.call(e,a,i,u),(i||0===i)&&(s+=i),s+="\n        ",d=n.isBlacklist,i=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"isBlacklist"),u=p.program(4,o,t),u.hash={},u.fn=u,u.inverse=p.noop,i=d&&typeof i===f?i.call(e,u):y.call(e,i,u),(i||0===i)&&(s+=i),s+="\n    </div>\n    "}function r(e){var t,i,a="";return a+="\n        ",t="description",d=n.attr,i=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"attr"),t=typeof i===f?i.call(e,t,{hash:{}}):i===g?m.call(e,"attr",t,{hash:{}}):i,a+=b(t)+"\n      "}function o(e){var t,i,a="";return a+='\n        <div class="extraStuff"><button class="btn" id="blacklist_btn">',t="mm_preferences_ignore",d=n.intl,i=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===f?i.call(e,t,{hash:{}}):i===g?m.call(e,"intl",t,{hash:{}}):i,a+=b(t)+"</button></div>\n        "}n=n||e.helpers;var l,c,d,u,h="",p=this,f="function",m=n.helperMissing,g=void 0,b=this.escapeExpression,y=n.blockHelperMissing;
return h+='<div class="preference">\n  ',l="preference",d=n.form,c=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"form"),u=p.program(1,s,a),u.hash={},u.fn=u,u.inverse=p.noop,l=d&&typeof c===f?c.call(t,l,u):y.call(t,c,l,u),(l||0===l)&&(h+=l),h+="\n</div>\n\n"}),ABINEMASKME.CompiledTemplates["views/preferences/one"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/preferences/preferences"]=e.template(function(e,t,n,i,a){function s(){return'\n                <label style="color:grey;display:inline-block" class="checkbox">\n                    <input disabled="disabled" type="checkbox" id="autoLockOnRestart" class="trackChanges">\n                    Auto-lock MaskMe when I restart my browser. <a href="https://www.abine.com/maskme/faq/#locking" target="_blank">What is this?</a>\n                </label>\n                <a href="javascript:void(0);" style="vertical-align:top;" class="btn btn-mini btn-primary setupPasswordBtn">Setup Password</a>\n            '}function r(){return'\n                <label class="checkbox">\n                    <input type="checkbox" id="autoLockOnRestart" class="trackChanges">\n                    Auto-lock MaskMe when I restart my browser. <a href="https://www.abine.com/maskme/faq/#locking" target="_blank">What is this?</a>\n                </label>\n            '}function o(){return'\n                <label style="color:grey;display:inline-block" class="checkbox">\n                    <input disabled="disabled" type="checkbox" id="requirePasswordToShowPassword" class="trackChanges">\n                    Prompt for my MaskMe password before showing sensitive account information.\n                </label>\n                <a href="javascript:void(0);" style="vertical-align:top;" class="btn btn-mini btn-primary setupPasswordBtn">Setup Password</a>\n            '}function l(){return'\n                <label class="checkbox">\n                    <input type="checkbox" id="requirePasswordToShowPassword" class="trackChanges">\n                    Prompt for my MaskMe password before showing sensitive account information.\n                </label>\n            '}n=n||e.helpers;var c,d,u,h,p="",f=this,m="function",g=n.helperMissing,b=void 0,y=this.escapeExpression,v=n.blockHelperMissing;return p+=" <h2>",c="mm_preferences_preferences",u=n.intl,d=u||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),c=typeof d===m?d.call(t,c,{hash:{}}):d===b?g.call(t,"intl",c,{hash:{}}):d,p+=y(c)+'</h2>\n\n<div class="well">\n    <form>\n        <fieldset>\n            <legend>',c="mm_preferences_logins",u=n.intl,d=u||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),c=typeof d===m?d.call(t,c,{hash:{}}):d===b?g.call(t,"intl",c,{hash:{}}):d,p+=y(c)+'</legend>\n            <p>MaskMe can store your login accounts for safer & easier logins. <a target="_blank" href="https://www.abine.com/maskme/faq/#syncsafety">(Don\'t worry, it\'s super secure)</a></p>\n            <label class="radio">\n                <input type="radio" name="loginsRadio" id="dontStore" class="trackChanges" />\n                Don\'t store any of my login accounts.\n            </label>\n            <label class="radio">\n                <input type="radio" name="loginsRadio" id="storeMaskme" class="trackChanges"/>\n                Store only logins I create with MaskMe.\n            </label>\n            <label class="radio">\n                <input type="radio" name="loginsRadio" id="storeAll" class="trackChanges" />\n                Store all my login accounts.\n            </label>\n\n            <input type="checkbox" id="rememberAccounts" class="trackChanges" style="display:none;" />\n            <input type="checkbox" id="rememberOnlyMaskMe" class="trackChanges" style="display:none;" />\n\n            <label class="checkbox">\n                <input type="checkbox" id="helpMeLogin" class="trackChanges">\n                Automatically fill in my login information when I visit websites.\n            </label>\n\n        </fieldset>\n\n        <fieldset>\n            <legend>',c="mm_preferences_privacy",u=n.intl,d=u||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),c=typeof d===m?d.call(t,c,{hash:{}}):d===b?g.call(t,"intl",c,{hash:{}}):d,p+=y(c)+"</legend>\n            <p></p>\n\n            ",c="hasRegPassword",u=n.ifUser,d=u||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"ifUser"),h=f.program(1,s,a),h.hash={},h.fn=h,h.inverse=f.program(3,r,a),c=u&&typeof d===m?d.call(t,c,h):v.call(t,d,c,h),(c||0===c)&&(p+=c),p+="\n\n            ",c="hasRegPassword",u=n.ifUser,d=u||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"ifUser"),h=f.program(5,o,a),h.hash={},h.fn=h,h.inverse=f.program(7,l,a),c=u&&typeof d===m?d.call(t,c,h):v.call(t,d,c,h),(c||0===c)&&(p+=c),p+='\n\n            <label class="checkbox">\n                <input type="checkbox" id="shouldSendErrorReports" class="trackChanges">\n                Send anonymous error & usage data to MaskMe servers.\n            </label>\n\n            <label class="checkbox">\n                <input type="checkbox" id="enablePrivacyTimeline" class="trackChanges">\n                Enable Privacy Timeline. <a href="https://www.abine.com/maskme/faq/#whatistimeline" target="_blank">What is this?</a>\n            </label>\n\n        </fieldset>\n\n        <fieldset>\n            <legend>Ignore List</legend>\n            <p>You can disable MaskMe entirely for certain websites. <button class="btn" id="blacklist_btn">',c="mm_preferences_ignore",u=n.intl,d=u||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),c=typeof d===m?d.call(t,c,{hash:{}}):d===b?g.call(t,"intl",c,{hash:{}}):d,p+=y(c)+"</button></p>\n        </fieldset>\n\n        <fieldset>\n            <legend>",c="mm_preferences_websiteForms",u=n.intl,d=u||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),c=typeof d===m?d.call(t,c,{hash:{}}):d===b?g.call(t,"intl",c,{hash:{}}):d,p+=y(c)+'</legend>\n            <p>As you browse the web, MaskMe will appear to assist you when websites ask for your information (such as for emails and passwords).</p>\n\n            <label class="checkbox">\n                <input type="checkbox" id="suggestProtectedEmail" class="trackChanges">\n                Show "Mask My Email" for email fields.\n            </label>\n\n            <label class="checkbox">\n                <input type="checkbox" id="suggestProtectedPhone" class="trackChanges">\n                Show "Mask My Phone" for phone fields.\n            </label>\n\n            <label class="checkbox">\n                <input type="checkbox" id="suggestStrongPassword" class="trackChanges">\n                Show "Generate A Strong Password" for password fields.\n            </label>\n\n            <label class="premium checkbox">\n                <input type="checkbox" id="suggestProtectedCard" class="trackChanges">\n                Show "Mask My Card" for credit card fields.\n            </label>\n\n        </fieldset>\n\n        <fieldset>\n            <legend>',c="mm_preferences_notifications",u=n.intl,d=u||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),c=typeof d===m?d.call(t,c,{hash:{}}):d===b?g.call(t,"intl",c,{hash:{}}):d,p+=y(c)+'</legend>\n            <p></p>\n\n            <label class="checkbox">\n                <input type="checkbox" id="showNotifications" class="trackChanges">\n                Show MaskMe notifications (at top right of screen) as I browse the web.\n            </label>\n\n            <label class="premium checkbox">\n                <input type="checkbox" id="confirmProtectedCard" class="trackChanges">\n                Prompt me for confirmation when I am about to create a Masked Card.\n            </label>\n\n        </fieldset>\n\n        <input type="button" class="btn btn-primary" value="Save" id="savePreferences" disabled="true"/> <input type="button" class="btn btn-notice" value="Restore Defaults" id="restoreDefaults" />\n        <span id="savedSuccess" style="display:none;color:green;">Saved Preferences</span>\n        <span id="restoredDefaults" style="display:none;color:green;">Restored Defaults</span>\n\n    </form>\n</div>\n\n'}),ABINEMASKME.CompiledTemplates["views/preferences/preferences"]}),ABINEMASKME.define("abine/views/preferences",["documentcloud/underscore","jquery","models","duckbone/core","abine/proxies","abine/views/recheck","abine/intl"],function(e,t,n,i,a,s,r){var o=i.View.extend({templateName:"preferences_preferences",events:{"click #savePreferences":"savePreferences","click #restoreDefaults":"restoreDefaults","click #blacklist_btn":"goToBlacklist","click .setupPasswordBtn":"goToChangePass","click .trackChanges":"trackChanges"},restoreDefaults:function(n){var i=e.bind(function(){this.model.preferences.restoreDefaults(e.bind(function(){this.afterInitialize(),t(this.el).find("#enablePrivacyTimeline").is(":checked")?t(".timeline").show():t(".timeline").hide(),t(this.el).find("#restoredDefaults").show().fadeOut(3e3)},this))},this);ABINEMASKME.user.preferences.isPrefTrue("autoLockOnRestart")?this.recheckPassword(n.target,e.bind(function(e){a.securityManager.setAutoUnlockPassword(e,function(){}),i()},this)):i()},recheckPassword:function(e,n){var i=new s({element:e,callback:n,label:r.getText("mm_recheck_edit")});t("body").append(i.el)},goToChangePass:function(){ABINEMASKME.App.renderPage("editUser/password")},goToBlacklist:function(t){return a.securityManager.passwordValidationRequired(e.bind(function(n){n?this.recheckPassword(t.target,e.bind(function(){ABINEMASKME.App.navigate("blacklist",!0)},this)):ABINEMASKME.App.navigate("blacklist",!0)},this)),!1},savePreferences:function(n){function i(e){l&&a.securityManager.setAutoUnlockPassword(e,function(){}),c&&a.securityManager.clearAutoUnlockPassword(function(){}),this.persistChanges(s)}t(this.el).find("#dontStore").is(":checked")?(t(this.el).find("#rememberAccounts").removeAttr("checked"),t(this.el).find("#rememberOnlyMaskMe").removeAttr("checked")):t(this.el).find("#storeAll").is(":checked")?(t(this.el).find("#rememberAccounts").attr("checked","checked"),t(this.el).find("#rememberOnlyMaskMe").removeAttr("checked")):t(this.el).find("#storeMaskme").is(":checked")&&(t(this.el).find("#rememberAccounts").attr("checked","checked"),t(this.el).find("#rememberOnlyMaskMe").attr("checked","checked"));var s={};e.each(t(".trackChanges",this.el),e.bind(function(n){var i=t(n),a=e(this.model.preferences.models).find(function(e){return e.get("key")===n.id});if(!i.attr("disabled")){var r=i.is(":checked");a&&a.isTrue("value")!=r&&(a.set("value",r?"true":"false"),s[a.get("key")]=a)}},this));var r=s.autoLockOnRestart,o=s.requirePasswordToShowPassword,l=r&&!r.isTrue("value"),c=r&&r.isTrue("value");o&&!o.isTrue("value"),r||o?a.securityManager.passwordValidationRequired(e.bind(function(t){t||l?this.recheckPassword(n.target,e.bind(function(e){i.call(this,e)},this)):i.call(this,null)},this)):i.call(this,null)},persistChanges:function(n){var i=e.keys(n).length,a=0,s=e.bind(function(){a++,a>=i&&(t(this.el).find("#savedSuccess").show().fadeOut(3e3),this.initTrackChanges())},this);e.each(e.keys(n),function(e){n[e].save(null,{success:function(){s()}})}),ABINEMASKME.user.hasTimelineEnabled()?t(t(this.el)[0].ownerDocument).find(".timeline").show():t(t(this.el)[0].ownerDocument).find(".timeline").hide()},trackChanges:function(n){n.target.id in this.model.changedPreferences?delete this.model.changedPreferences[n.target.id]:"radio"==n.target.type?n.target.id in this.model.radioSelections?delete this.model.changedPreferences[n.target.name]:this.model.changedPreferences[n.target.name]="radioOptionChanged":"radio"!=n.target.type&&(this.model.changedPreferences[n.target.id]=t(this.el).find("#"+n.target.id).attr("checked")),e.isEmpty(this.model.changedPreferences)?t(this.el).find("#savePreferences").attr("disabled",!0):t(this.el).find("#savePreferences").removeAttr("disabled")},initTrackChanges:function(){this.model.changedPreferences={},this.model.radioSelections={},t(this.el).find("#savePreferences").attr("disabled",!0),e.each(t(this.el).find("input.trackChanges:radio:checked"),e.bind(function(e){this.model.radioSelections[e.id]=t(this.el).find("#"+e.id).attr("checked","checked")},this))},afterInitialize:function(){this.model.hasEnabledPayments()&&t(this.el).find(".premium").show(),e.each(this.model.preferences.models,e.bind(function(e){var n=t(this.el).find("#"+e.get("key"));n.length>0&&"none"!==t(n).css("display")&&(e.isTrue("value")?n.attr("checked","checked"):n.removeAttr("checked"))},this)),this.model.preferences.isPrefTrue("rememberAccounts")?this.model.preferences.isPrefTrue("rememberOnlyMaskMe")?t(this.el).find("#storeMaskme").attr("checked","checked"):t(this.el).find("#storeAll").attr("checked","checked"):t(this.el).find("#dontStore").attr("checked","checked"),this.initTrackChanges()}});return i.Security.showLoginWhenLocked(o),o}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/print_accounts/one"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s="",r="function",o=n.helperMissing,l=void 0,c=this.escapeExpression;return s+='<td class="domain">\n  ',a=n.getDomain,i=a||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getDomain"),typeof i===r?i=i.call(t,{hash:{}}):i===l&&(i=o.call(t,"getDomain",{hash:{}})),s+=c(i)+'\n</td>\n<td class="email">\n  ',a=n.getEmail,i=a||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getEmail"),typeof i===r?i=i.call(t,{hash:{}}):i===l&&(i=o.call(t,"getEmail",{hash:{}})),s+=c(i)+'\n</td>\n<td class="username">\n  ',a=n.getUsername,i=a||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getUsername"),typeof i===r?i=i.call(t,{hash:{}}):i===l&&(i=o.call(t,"getUsername",{hash:{}})),s+=c(i)+'\n</td>\n<td class="password">\n  ',a=n.getPassword,i=a||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getPassword"),typeof i===r?i=i.call(t,{hash:{}}):i===l&&(i=o.call(t,"getPassword",{hash:{}})),s+=c(i)+'\n</td>\n<td class="phone">\n  ',a=n.getPhone,i=a||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getPhone"),typeof i===r?i=i.call(t,{hash:{}}):i===l&&(i=o.call(t,"getPhone",{hash:{}})),s+=c(i)+"\n</td>\n\n"}),ABINEMASKME.CompiledTemplates["views/print_accounts/one"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/print_accounts/print_accounts"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r,o="",l="function",c=n.helperMissing,d=void 0,u=this.escapeExpression;return o+='<ul class="breadcrumb">\n  <li><a href="#/home">',i="mm_print_accounts_home",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'</a> <span class="divider">/</span></li>\n  <li><a href="#/sites">',i="mm_sites_accountList",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'</a> <span class="divider">/</span></li>\n  <li class="active">',i="mm_print_accounts_printAccountsList",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'</li>\n</ul>\n<div class="loading" style="display:none">\n  <p><img src="',i="/pages/images/ajax_loader.gif",r=n.assetUrl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"assetUrl",i,{hash:{}}):a,o+=u(i)+'"/>&nbsp;&nbsp;',i="mm_print_accounts_loading",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'</p>\n</div>\n<div class="alert alert-info noSites" style="display:none">\n  ',i="mm_print_accounts_noAccounts",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'\n</div>\n<div class="alert alert-info numSites" style="display:none">\n  <span class="numSitesMessage"/>\n  <input type="button" class="btn btn-mini" id="showAccountsBtn" value="',i="mm_print_accounts_show",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'" style="display:none" />\n  <input type="button" class="btn btn-mini" id="printAccountsBtn" value="',i="mm_print_accounts_print",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'" style="display:none"/>\n</div>\n<div id="accountsList" style="display:none">\n    <table class="table table-striped">\n     <thead>\n              <tr>\n                <th>Site</th>\n                <th>Email</th>\n                <th>Username</th>\n                <th>Password</th>\n                <th>Phone</th>\n              </tr>\n          </thead>\n      ',i="tbody",a="printAccounts",r=n.child,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"child",a,i,{hash:{}}):s,o+=u(i)+"\n    </table>\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/print_accounts/print_accounts"]}),ABINEMASKME.define("abine/views/printAccounts",["documentcloud/underscore","jquery","models","duckbone/core","wycats/handlebars","abine/assets","abine/config","abine/url","abine/intl","abine/proxies","abine/views/recheck"],function(e,t,n,i,a,s,r,o,l,c,d){var u,h=i.View.extend({tagName:"tr",templateName:"print_accounts_one",events:{},afterInitialize:function(){}}),p=i.ListView.extend({tagName:"tbody",viewClass:h}),f=i.View.extend({templateName:"print_accounts_print_accounts",events:{"click #showAccountsBtn":"showAccountsCheck","click #printAccountsBtn":"printAccounts"},afterInitialize:function(){},createChildren:function(){return u=new p({collection:new n.AccountCollection}),t(this.el).find(".loading").show(),u.collection.fetchAllForPrinting(e.bind(function(){t(this.el).find(".loading").hide(),u.collection.length>0?(t(this.el).find(".numSitesMessage").text(u.collection.length+" "+l.getText("mm_print_accounts_number")),t(this.el).find(".numSites").show(),t(this.el).find("#showAccountsBtn").show()):t(this.el).find(".noSites").show()},this)),{printAccounts:u}},recheckPassword:function(e,n,i){var a=new d({element:e,callback:n,label:i});t("body").append(a.el)},showAccounts:function(){t(this.el).find("#showAccountsBtn").hide(),t(this.el).find("#printAccountsBtn").show(),t(this.el).find("#accountsList").show()},showAccountsCheck:function(t){c.securityManager.passwordValidationRequired(e.bind(function(n){n?this.recheckPassword(t.target,e.bind(function(){this.showAccounts()},this),l.getText("mm_recheck_view")):this.showAccounts()},this))},printAccounts:function(){t(".navbar").hide(),window.print(),t(".navbar").show()}},{routeName:"printAccounts",routeAction:function(){ABINEMASKME.App.loadView(f)}});return i.Security.showBlankWhenLocked(f),f}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/recheck/panel"]=e.template(function(e,t,n,i,a){function s(e){var t,i,a="";return a+='\n <div class="control-group">\n   <i class="icon-lock icon-white"></i>\n  ',l=n.label,t=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"label"),typeof t===h?t=t.call(e,{hash:{}}):t===f&&(t=p.call(e,"label",{hash:{}})),a+=m(t)+", ",t="mm_recheck_pleaseEnter",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,a+=m(t)+"<br/>\n  ",t="password",l=n.form_password,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"form_password"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"form_password",t,{hash:{}}):i,a+=m(t)+'\n  <button class="unlockButton btn btn-mini btn-success">',t="mm_recheck_verify",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,a+=m(t)+'</button>\n  <a class="showHintButton btn btn-mini btn-info">',t="mm_recheck_hint",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,a+=m(t)+'</a>\n  <div class="passwordHint"></div>\n  <div class="errorText" style="display:none;">',t="mm_recheck_wrong",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,a+=m(t)+"</div>\n </div>\n"}n=n||e.helpers;var r,o,l,c,d="",u=this,h="function",p=n.helperMissing,f=void 0,m=this.escapeExpression,g=n.blockHelperMissing;return r="unlock",l=n.form,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"form"),c=u.program(1,s,a),c.hash={},c.fn=c,c.inverse=u.noop,r=l&&typeof o===h?o.call(t,r,c):g.call(t,o,r,c),(r||0===r)&&(d+=r),d+="\n\n"}),ABINEMASKME.CompiledTemplates["views/recheck/panel"]}),ABINEMASKME.define("abine/views/recheck",["documentcloud/underscore","jquery","duckbone/core","models","abine/proxies","abine/timer","abine/intl"],function(e,t,n,i,a,s,r){var o=n.View.extend({templateName:"recheck_panel",events:{"submit .unlock":"verifyPassword","click .unlockButton":"verifyPassword","keyup .form_password":"closeOnEscape","click .showHintButton":"showHint"},model:{password:"",label:""},afterInitialize:function(){this.callback=this.options.callback,this.model.label=this.options.label?this.options.label:"To view",this.render(),this.passwordField=t(".form_password",this.el),this.bindBlurClose();var e=t(this.options.element).offset();t(this.el).css({top:e.top+this.options.element.offsetHeight+2,left:e.left})},bindBlurClose:function(){t("button.unlockButton",this.el).bind("mousedown",e.bind(function(){this.ignoreBlur=!0},this)),t("a.showHintButton",this.el).bind("mousedown",e.bind(function(){this.ignoreBlur=!0},this)),t(this.passwordField).bind("blur",e.bind(function(){this.ignoreBlur?delete this.ignoreBlur:this.closeTimer=s.setTimeout(e.bind(this.cleanClose,this),100)},this)),s.setTimeout(e.bind(this.passwordField.focus,this.passwordField),100),this.routeChangeHandler&&ABINEMASKME.App.unbind("all",this.routeChangeHandler),this.routeChangeHandler=e.bind(this.routeChanged,this),ABINEMASKME.App.bind("all",this.routeChangeHandler)},verifyPassword:function(t){t.preventDefault(),s.clearTimeout(this.closeTimer);var n=this.passwordField.val();return a.securityManager.recheckPassword(n,e.bind(function(t){t?(this.cleanClose(),s.setTimeout(e.bind(function(){this.callback(n)},this),100)):this.invalidPassword()},this)),!1},showHint:function(){t(this.el).find(".errorText").hide(),null!=ABINEMASKME.user.getPasswordHint()?t(this.el).find(".passwordHint").html(r.getText("mm_unlock_Hint")+" "+ABINEMASKME.user.getPasswordHint()):t(this.el).find(".passwordHint").html(r.getText("mm_unlock_HintNull")),t(this.el).find(".passwordHint").show()},closeOnEscape:function(e){27==e.keyCode&&this.cleanClose()},invalidPassword:function(){t(this.el).find(".passwordHint").hide(),t(this.el).find(".errorText").show(),this.passwordField.focus(),delete this.ignoreBlur},routeChanged:function(){this.cleanClose()},cleanClose:function(){ABINEMASKME.App.unbind("all",this.routeChangeHandler),this.remove()}});return o}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/reset_password/reset_password"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+="<div>\n    <h2>",i="mm_reset_password_Forgot",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+="</h2>\n    <p>",i="mm_reset_password_Forgetting",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+="</p>\n\n    <p>",i="mm_reset_password_Enter",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</p>\n    <div>\n        <div class="alert alert-info" id="emailSending" style="display:none;">\n        ',i="mm_reset_password_SendingLink",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'\n        <img id="ajaxSpinner" src="',i="/pages/images/ajax_loader.gif",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" />\n        </div>\n        <div class="alert alert-success" id="emailSentSuccess" style="display:none;">\n        </div>\n        <div class="alert alert-error" id="emailSentError" style="display:none;">\n        </div>\n        <form class="form-inline" id="emailForm">\n            <input type="text" class="input-large" id="emailAddress" placeholder="',i="mm_reset_password_EmailPlaceholder",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'" />\n            <input type="button" class="btn btn-primary" id="resetPasswordBtn" value="',i="mm_reset_password_SendLink",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'" />\n            <input type="button" class="btn btn-danger" id="backBtn" value="',i="mm_reset_password_GoBack",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'" />\n        </form>\n    </div>\n</div>\n'}),ABINEMASKME.CompiledTemplates["views/reset_password/reset_password"]}),ABINEMASKME.define("abine/views/resetPassword",["documentcloud/underscore","jquery","models","duckbone/core","abine/eventLogger","abine/intl"],function(e,t,n,i,a,s){var r=i.View.extend({tagName:"div",templateName:"reset_password_reset_password",events:{"click #resetPasswordBtn":"sendResetPasswordEmail","click #backBtn":"goBack","click #resendLink":"sendResetPasswordEmail","submit form":"sendResetPasswordEmail"},afterInitialize:function(){this.model.bind("resetPasswordEmailSent",e.bind(function(){t(this.el).find("#emailSending").hide(),t(this.el).find("#emailSentSuccess").html(s.getText("mm_reset_password_Success")),t(this.el).find("#emailSentSuccess").show(),t(this.el).find("#emailSentError").hide(),t(this.el).find("#emailForm").hide()},this)),this.model.bind("resetPasswordEmailFailed",e.bind(function(){t(this.el).find("#emailSending").hide(),t(this.el).find("#emailSentSuccess").hide(),t(this.el).find("#emailSentError").html(s.getText("mm_reset_password_ServerError")),t(this.el).find("#emailSentError").show()},this)),this.model.bind("resetPasswordBadEmail",e.bind(function(){t(this.el).find("#emailSending").hide(),t(this.el).find("#emailSentSuccess").hide(),t(this.el).find("#emailSentError").html(s.getText("mm_reset_password_BadEmail")),t(this.el).find("#emailSentError").show()},this))},sendResetPasswordEmail:function(e){e.preventDefault(),t(this.el).find("#emailSentSuccess").hide(),t(this.el).find("#emailSentError").hide(),t(this.el).find("#emailSending").show();var n=t(this.el).find("#emailAddress").val();this.model.sendPasswordResetEmail(n)},goBack:function(){ABINEMASKME.App.back()}},{routeName:"resetPassword",routeAction:function(){ABINEMASKME.App.loadView(r,{model:ABINEMASKME.user})}});return r}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/site/history"]=e.template(function(e,t,n,i,a){function s(e){var t,i,a="";return a+="\n        <p><strong>",t="mm_site_historyTitle",u=n.intl,i=u||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===m?i.call(e,t,{hash:{}}):i===b?g.call(e,"intl",t,{hash:{}}):i,a+=y(t)+"</strong></p>\n        ",t="mm_site_historySubTitle",u=n.intl,i=u||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===m?i.call(e,t,{hash:{}}):i===b?g.call(e,"intl",t,{hash:{}}):i,a+=y(t)+"\n      "}function r(e){var t,i,a,s="";return s+="\n        ",u=n.domain,t=u||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"domain"),i="mm_site_historySubTitleEmpty",u=n.intl,a=u||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof a===m?a.call(e,i,t,{hash:{}}):a===b?g.call(e,"intl",i,t,{hash:{}}):a,s+=y(t)+"\n      "}function o(e){var t,i,a="";return a+="\n        <p><strong>",t="mm_site_historyCopyMessage",u=n.intl,i=u||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===m?i.call(e,t,{hash:{}}):i===b?g.call(e,"intl",t,{hash:{}}):i,a+=y(t)+"</strong></p>\n      "}function l(e){var t,i,a,s="";return s+="\n        <p>",u=n.domain,t=u||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"domain"),i="mm_site_historyCopyMessageEmpty",u=n.intl,a=u||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof a===m?a.call(e,i,t,{hash:{}}):a===b?g.call(e,"intl",i,t,{hash:{}}):a,s+=y(t)+"</p>\n      "}n=n||e.helpers;var c,d,u,h,p="",f=this,m="function",g=n.helperMissing,b=void 0,y=this.escapeExpression;return p+='<div class="site_history">\n  <br>\n  <div class="alert alert-info">\n    <div id="hiddenHistory">\n      ',u=n.hasAccounts,c=u||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"hasAccounts"),d=n["if"],h=f.program(1,s,a),h.hash={},h.fn=h,h.inverse=f.program(3,r,a),c=d.call(t,c,h),(c||0===c)&&(p+=c),p+='\n      <span class="btn btn-mini showHistoryBtn">',c="mm_site_historyShowBtn",u=n.intl,d=u||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),c=typeof d===m?d.call(t,c,{hash:{}}):d===b?g.call(t,"intl",c,{hash:{}}):d,p+=y(c)+'</span>\n    </div>\n    <div id="shownHistory" style="display:none">\n      ',u=n.hasAccounts,c=u||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"hasAccounts"),d=n["if"],h=f.program(5,o,a),h.hash={},h.fn=h,h.inverse=f.program(7,l,a),c=d.call(t,c,h),(c||0===c)&&(p+=c),p+="\n      ",c="historyList",u=n.child,d=u||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),c=typeof d===m?d.call(t,c,{hash:{}}):d===b?g.call(t,"child",c,{hash:{}}):d,p+=y(c)+'\n      <span class="hideHistoryBtn"><span class="btn btn-mini">',c="mm_site_historyHideBtn",u=n.intl,d=u||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),c=typeof d===m?d.call(t,c,{hash:{}}):d===b?g.call(t,"intl",c,{hash:{}}):d,p+=y(c)+'</span><br><span class="noHistory" style="display:none">',c="mm_site_historyNoHistory",u=n.intl,d=u||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),c=typeof d===m?d.call(t,c,{hash:{}}):d===b?g.call(t,"intl",c,{hash:{}}):d,p+=y(c)+"</span><br></span>\n    </div>\n  </div>\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/site/history"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/site/history_field"]=e.template(function(e,t,n,i,a){function s(e){var t,i,a="";return a+='\n<td><span class="btn btn-mini copyField">',t="mm_site_historyCopyField",c=n.intl,i=c||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===p?i.call(e,t,{hash:{}}):i===m?f.call(e,"intl",t,{hash:{}}):i,a+=g(t)+'</span></td>\n<td><span class="btn btn-mini deleteField">',t="mm_site_historyDeleteField",c=n.intl,i=c||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===p?i.call(e,t,{hash:{}}):i===m?f.call(e,"intl",t,{hash:{}}):i,a+=g(t)+"</span></td>\n"}function r(e){var t,i,a="";return a+='\n<td></td>\n<td><span class="btn btn-mini disabled">',t="mm_site_historyUsedInLogin",c=n.intl,i=c||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===p?i.call(e,t,{hash:{}}):i===m?f.call(e,"intl",t,{hash:{}}):i,a+=g(t)+"</span></td>\n"}n=n||e.helpers;var o,l,c,d,u="",h=this,p="function",f=n.helperMissing,m=void 0,g=this.escapeExpression;return u+='<td style="padding-right:10px">',o="modifiedAt",c=n.live_timestamp,l=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"live_timestamp"),o=typeof l===p?l.call(t,o,{hash:{}}):l===m?f.call(t,"live_timestamp",o,{hash:{}}):l,u+=g(o)+'</td>\n<td style="padding-right:10px">',c=n.prettyFieldName,o=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"prettyFieldName"),typeof o===p?o=o.call(t,{hash:{}}):o===m&&(o=f.call(t,"prettyFieldName",{hash:{}})),u+=g(o)+'</td>\n<td id="valueField" style="padding-right:10px">',c=n.value,o=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"value"),typeof o===p?o=o.call(t,{hash:{}}):o===m&&(o=f.call(t,"value",{hash:{}})),u+=g(o)+"</td>\n",c=n.canBeDeleted,o=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"canBeDeleted"),l=n["if"],d=h.program(1,s,a),d.hash={},d.fn=d,d.inverse=h.program(3,r,a),o=l.call(t,o,d),(o||0===o)&&(u+=o),u+="\n"
}),ABINEMASKME.CompiledTemplates["views/site/history_field"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/site/one_site_nav"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s="",r="function",o=n.helperMissing,l=void 0,c=this.escapeExpression;return s+='<td class="domain">\n  <i class="icon-globe"></i>&nbsp;<a href="#sites/',a=n.id,i=a||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"id"),typeof i===r?i=i.call(t,{hash:{}}):i===l&&(i=o.call(t,"id",{hash:{}})),s+=c(i)+'">',a=n.domain,i=a||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"domain"),typeof i===r?i=i.call(t,{hash:{}}):i===l&&(i=o.call(t,"domain",{hash:{}})),s+=c(i)+"</a>\n</td>\n"}),ABINEMASKME.CompiledTemplates["views/site/one_site_nav"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/site/site"]=e.template(function(e,t,n,i,a){function s(e){var t,i,a,s="";return s+="\n      ",d=n.domain,t=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"domain"),i="mm_site_accountsListTitleYour",d=n.intl,a=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof a===f?a.call(e,i,t,{hash:{}}):a===g?m.call(e,"intl",i,t,{hash:{}}):a,s+=b(t)+"\n    "}function r(e){var t,i,a,s="";return s+="\n      ",d=n.domain,t=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"domain"),i="mm_site_accountsListTitleEmpty",d=n.intl,a=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof a===f?a.call(e,i,t,{hash:{}}):a===g?m.call(e,"intl",i,t,{hash:{}}):a,s+=b(t)+"\n    "}function o(e){var t,i,a="";return a+='\n  <div class="row">\n    <div class="span8 accountsRow">\n      ',t="accountsList",d=n.child,i=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"child"),t=typeof i===f?i.call(e,t,{hash:{}}):i===g?m.call(e,"child",t,{hash:{}}):i,a+=b(t)+"\n    </div>\n  </div>\n"}n=n||e.helpers;var l,c,d,u,h="",p=this,f="function",m=n.helperMissing,g=void 0,b=this.escapeExpression;return h+='<div class="page-header">\n  <ul class="breadcrumb">\n    <li><a href="#/home">',l="mm_site_home",d=n.intl,c=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),l=typeof c===f?c.call(t,l,{hash:{}}):c===g?m.call(t,"intl",l,{hash:{}}):c,h+=b(l)+'</a> <span class="divider">/</span></li>\n    <li><a href="#sites">',l="mm_site_accountList",d=n.intl,c=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),l=typeof c===f?c.call(t,l,{hash:{}}):c===g?m.call(t,"intl",l,{hash:{}}):c,h+=b(l)+'</a> <span class="divider">/</span></li>\n    <li class="active">',d=n.domain,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"domain"),typeof l===f?l=l.call(t,{hash:{}}):l===g&&(l=m.call(t,"domain",{hash:{}})),h+=b(l)+'</li>\n  </ul>\n</div>\n\n<div class="pageContent">\n  <h4>\n    <img src="http://g.etfv.co/http://www.',d=n.domain,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"domain"),typeof l===f?l=l.call(t,{hash:{}}):l===g&&(l=m.call(t,"domain",{hash:{}})),h+=b(l)+'" width="16" height="16"/>\n    ',d=n.hasAccounts,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"hasAccounts"),c=n["if"],u=p.program(1,s,a),u.hash={},u.fn=u,u.inverse=p.program(3,r,a),l=c.call(t,l,u),(l||0===l)&&(h+=l),h+='\n  </h4>\n  <div class="trust"><a href="https://www.abine.com/products/maskme/support/datause.php" target="_blank">',l="mm_site_dataSecurity",d=n.intl,c=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),l=typeof c===f?c.call(t,l,{hash:{}}):c===g?m.call(t,"intl",l,{hash:{}}):c,h+=b(l)+'</a></div>\n</div>\n<div class="errorDiv alert alert-error" style="display:none;">\n    ',l="mm_site_serverError",d=n.intl,c=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),l=typeof c===f?c.call(t,l,{hash:{}}):c===g?m.call(t,"intl",l,{hash:{}}):c,(l||0===l)&&(h+=l),h+="\n</div>\n",d=n.hasAccounts,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"hasAccounts"),c=n["if"],u=p.program(5,o,a),u.hash={},u.fn=u,u.inverse=p.noop,l=c.call(t,l,u),(l||0===l)&&(h+=l),h+='\n<div id="history" class="row" style="display:none;">\n  <div class="span8 historyRow">\n    ',l="historyView",d=n.child,c=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),l=typeof c===f?c.call(t,l,{hash:{}}):c===g?m.call(t,"child",l,{hash:{}}):c,h+=b(l)+"\n  </div>\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/site/site"]}),ABINEMASKME.define("abine/views/site",["documentcloud/underscore","jquery","models","duckbone/core","abine/views/account","abine/views/sites","abine/views/recheck","abine/proxies","abine/views/holdOnCowboyView","abine/eventLogger","abine/clipboard","abine/intl"],function(e,t,n,i,a,s,r,o,l,c,d,u){var h=i.ListView.extend({viewClass:a,editAll:function(){e.each(this.collection.models,function(e){var t=this.getViewByModel(e);t.showEdit()},this)},cancelAll:function(){e.each(this.collection.models,function(e){var t=this.getViewByModel(e);t.cancelEdit()},this)}}),p=i.View.extend({templateName:"site_history_field",tagName:"tr",events:{"dblclick #valueField":"highlightValue","click .copyField":"copyField","click .deleteField":"deleteField"},afterInitialize:function(){},highlightValue:function(){var e=t(this.el).find("#valueField").get(0),n=e.ownerDocument.createRange();n.selectNode(e);var i=e.ownerDocument.defaultView.getSelection();i.removeAllRanges(),i.addRange(n)},copyField:function(){d.copyToClipboard(this.model.get("value"))},deleteField:function(){this.model.destroy()}}),f=i.ListView.extend({viewClass:p,tagName:"table"}),m=i.View.extend({templateName:"site_history",events:{"click .showHistoryBtn":"showHistory","click .hideHistoryBtn":"hideHistory"},afterInitialize:function(){},createChildren:function(){var e=new f({collection:new n.AccountFieldCollection});return e.collection.comparator=function(e){return-1*new Date(e.get("modifiedAt")).getTime()},{historyList:e}},recheckPassword:function(e,n,i){var a=new r({element:e,callback:n,label:i});t("body").append(a.el)},renderHistory:function(e){t(this.children.historyList.el).show(),t("#shownHistory").show(),t("#hiddenHistory").hide(),this.children.historyList.collection.reset(e),this.children.historyList.collection.removeUnwantedFields(),this.children.historyList.collection.sort(),0===this.children.historyList.collection.length&&t(this.el).find(".noHistory").show(),this.trigger("history:editAll")},showHistory:function(t){this.historyData.length>0?o.securityManager.passwordValidationRequired(e.bind(function(n){n?this.recheckPassword(t.target,e.bind(this.renderHistory,this,this.historyData),u.getText("mm_recheck_view")):this.renderHistory(this.historyData)},this)):this.renderHistory(this.historyData)},hideHistory:function(){this.renderHistory([]),t("#shownHistory").hide(),t("#hiddenHistory").show(),t(this.children.historyList.el).hide(),this.trigger("history:cancelAll")}}),g=i.View.extend({templateName:"site_site",afterInitialize:function(){this.$("span.field-tip").tooltip()},beforeRemove:function(){this.children&&this.children.accountsList&&this.children.accountsList.cancelAll()},createChildren:function(){var n=new h({collection:this.model.accounts}),i=new m({model:this.model});i.bind("history:editAll",function(){n.editAll(),t("html, body").animate({scrollTop:t("html, body").height()-i.el.scrollHeight-60},100)},this),i.bind("history:cancelAll",function(){n.cancelAll()},this),this.model.getHistory(e.bind(function(e){i.historyData=e,null===e||0===e.length?t(this.el).find("#history").hide():t(this.el).find("#history").show()},this));var a=new l({model:this.model});return{accountsList:n,historyView:i,cowboy:a}}},{routeName:"site",routeAction:function(e){var t=new n.Site({id:e});t.fetch({success:function(){ABINEMASKME.App.loadView(g,{model:t})}})}});return i.Security.showLoginWhenLocked(g),g}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/sites/one"]=e.template(function(e,t,n,i,a){function s(e){var t,i,a="";return a+='\n    <span class="label label-success protected" rel="tooltip" title="',c=n.protections,t=c||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"protections"),c=n.siteProtections,i=c||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"siteProtections"),t=typeof i===p?i.call(e,t,{hash:{}}):i===m?f.call(e,"siteProtections",t,{hash:{}}):i,a+=g(t)+'">\n      ',t="mm_sites_masked",c=n.intl,i=c||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===p?i.call(e,t,{hash:{}}):i===m?f.call(e,"intl",t,{hash:{}}):i,a+=g(t)+"\n    </span>\n  "}n=n||e.helpers;var r,o,l,c,d,u="",h=this,p="function",f=n.helperMissing,m=void 0,g=this.escapeExpression;return u+='<td class="domain">\n  <img class="favicon" src="',c=n.domain,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"domain"),c=n.favicon,o=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"favicon"),r=typeof o===p?o.call(t,r,{hash:{}}):o===m?f.call(t,"favicon",r,{hash:{}}):o,u+=g(r)+'" height="16" width="16">&nbsp;<a href="#sites/',c=n.id,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"id"),typeof r===p?r=r.call(t,{hash:{}}):r===m&&(r=f.call(t,"id",{hash:{}})),u+=g(r)+'" class="domain-anchor">',c=n.domain,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"domain"),typeof r===p?r=r.call(t,{hash:{}}):r===m&&(r=f.call(t,"domain",{hash:{}})),u+=g(r)+"</a>\n  ",c=n.isFullyProtected,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"isFullyProtected"),o=n["if"],d=h.program(1,s,a),d.hash={},d.fn=d,d.inverse=h.noop,r=o.call(t,r,d),(r||0===r)&&(u+=r),u+='\n  <div class="right-objects">\n    <span class="dropdown">\n      <a id="deleteBtn" class="close dropdown-toggle" data-toggle="dropdown" href="#"><i class="icon-trash"></i></a>\n      <ul class="dropdown-menu sites-dropdown">\n        <li><a href="#holdOnSite',c=n.getId,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getId"),typeof r===p?r=r.call(t,{hash:{}}):r===m&&(r=f.call(t,"getId",{hash:{}})),u+=g(r)+'" data-toggle="modal">',c=n.getDomain,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getDomain"),o="mm_account_removeSite",c=n.intl,l=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),r=typeof l===p?l.call(t,o,r,{hash:{}}):l===m?f.call(t,"intl",o,r,{hash:{}}):l,(r||0===r)&&(u+=r),u+='</a></li>\n        <li><a href="#holdOnCowboy',c=n.getId,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getId"),typeof r===p?r=r.call(t,{hash:{}}):r===m&&(r=f.call(t,"getId",{hash:{}})),u+=g(r)+'" data-toggle="modal">',c=n.getDomain,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getDomain"),o="mm_account_hideSite",c=n.intl,l=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),r=typeof l===p?l.call(t,o,r,{hash:{}}):l===m?f.call(t,"intl",o,r,{hash:{}}):l,(r||0===r)&&(u+=r),u+="</a></li>\n      </ul>\n    </span>\n  </div>\n  ",r="cowboy",c=n.child,o=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),r=typeof o===p?o.call(t,r,{hash:{}}):o===m?f.call(t,"child",r,{hash:{}}):o,u+=g(r)+"\n  ",r="siteCowboy",c=n.child,o=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),r=typeof o===p?o.call(t,r,{hash:{}}):o===m?f.call(t,"child",r,{hash:{}}):o,u+=g(r)+"\n</td>\n"}),ABINEMASKME.CompiledTemplates["views/sites/one"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/sites/sites"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r,o="",l="function",c=n.helperMissing,d=void 0,u=this.escapeExpression;return o+='<ul class="breadcrumb">\n  <li><a href="#/home">',i="mm_sites_home",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'</a> <span class="divider">/</span></li>\n  <li class="active">',i="mm_sites_accountList",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+"</li>\n</ul>\n\n",i="loadingDisplay",r=n.child,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"child",i,{hash:{}}):a,o+=u(i)+'\n\n<div class="data-display" style="display:none;">\n  <div class="errorDiv alert alert-error" style="display:none;">\n    ',i="mm_sites_serverError",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='\n  </div>\n  <div class="alert alert-info noSites" style="display:none">\n    ',i="mm_sites_noSitesYet",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='\n  </div>\n  <div class="savedSites">\n      <form class="headerOpts">\n        <span class="print"><input type="button" value="',i="mm_sites_printAccounts",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'" class="btn" id="printBtn"/></span>\n        <span class="searchAndSort">\n          <input type="text" class="search-query" placeholder="quick site search">\n            <div class="dropdown">\n              <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">\n                <!--<i class="icon-random"></i>-->\n                ',i="mm_sites_sort",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'\n                <span class="caret"></span>\n              </a>\n              <ul class="dropdown-menu">\n                <li><a class="sort-column" id="sortby-asc-domain" href=#>',i="mm_sites_sortByName",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'</a></li>\n                <li><a class="sort-column" id="sortby-asc-modifiedAt" href=#>',i="mm_sites_sortByMostRecent",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'</a></li>\n              </ul>\n            </div>\n        </span>\n        </br>\n      </form>\n      <div id="sites_div" class="site_list_container">\n        <table id="padded-table" class="table table-striped">\n          ',i="tbody",a="sitesList",r=n.child,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"child",a,i,{hash:{}}):s,o+=u(i)+'\n        </table>\n      </div>\n      <div class="sites-stats">\n          ',i="stats",r=n.child,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"child",i,{hash:{}}):a,o+=u(i)+"\n      </div>\n  </div>\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/sites/sites"]}),ABINEMASKME.define("abine/views/sites",["documentcloud/underscore","jquery","models","duckbone/core","wycats/handlebars","abine/assets","abine/config","abine/url","abine/views/holdOnCowboyView","abine/views/holdOnSiteView","abine/intl","abine/pluralizer","abine/views/loading_display","abine/proxies"],function(e,t,n,i,a,s,r,o,l,c,d,u,h,p){var f={email:"a masked email",phone:"a masked phone",password:"a unique password"},m=function(e,t){result=[];for(var n=["r","g","b"],i=0;n.length>i;i++){for(var a=0;e.length-1>a&&!(t>=e[a].anchor&&e[a+1].anchor>=t);a++);var s=e[a][n[i]],r=e[a+1][n[i]],o=e[a+1].anchor-e[a].anchor,l=1;o>0&&(l=(t-e[a].anchor)/o),result.push(Math.ceil(s-(s-r)*l))}return result};a.registerHelper("getProtectionColor",function(e,t){var n=e.getProtectionRatio(t),i={r:157,g:38,b:29,anchor:0},a=i,s={r:255,g:196,b:13,anchor:.5},r={r:70,g:165,b:70,anchor:1},o=m([a,s,r],n),l="rgb("+o.join(",")+")";return l}),a.registerHelper("siteProtections",function(e){for(var t="This site has ",n=["phone","email","password"],i=["totalPhones","totalEmails","totalPasswords"],s=[],o=0;n.length>o;o++){var l=n[o],c=i[o];e[l]&&e[c]&&s.push(f[l])}return s.length>0?t+=s.join(" and "):t="All clear so far! No exposed contact information detected by "+r.appName,a.Utils.escapeExpression(t)});var g=i.View.extend({tagName:"tr",templateName:"sites_one",events:{"click .domain-anchor":"clickOnDomain","click .favicon":"clickOnDomain","click #deleteBtn":"scrollDown","click #deleteSiteAndAccountBtn":"deleteSite","click #deleteEverythingBtn":"blacklistSite"},afterInitialize:function(){this.$("img").error(function(e){var n=s.assetUrl("pages/images/globe.png");t(e.target).attr("src",n)}),this.$("span.protected").tooltip(),this.$("a.domain-anchor").each(function(){var e=t(this).text();if(e=e.toUpperCase(),!e.match(/^[0-9\.\:]+$/)){var n=e.indexOf(".");e=e.slice(0,n)}t(this).text(e)})},createChildren:function(){var e=new l({model:this.model}),t=new c({model:this.model});return{cowboy:e,siteCowboy:t}},clickOnDomain:function(e){e.preventDefault(),this.$("span.protected").tooltip("hide");var t=this.$("a.domain-anchor").attr("href").replace("#","");ABINEMASKME.App.navigate(t,!0)},scrollDown:function(){t(this.el).offset().top>590&&t("#sites_div").animate({scrollTop:t("#sites_div").scrollTop()+t(this.el).offset().top-590},100)},deleteSite:function(){t(this.el).find("#holdOnSite"+this.model.getId()).modal("hide"),this.model.destroy({success:e.bind(function(){location.reload()},this),error:e.bind(function(){t(".errorDiv").show(),t("body").scrollTop(0)},this)})},blacklistSite:function(){t(this.el).find("#holdOnCowboy"+this.model.getId()).modal("hide");var n=this.model;n.blacklist({success:e.bind(function(){ABINEMASKME.App.navigate("blacklist",!0)},this),error:e.bind(function(){t(".errorDiv").show(),t("body").scrollTop(0)},this)})}}),b=i.ListView.extend({tagName:"tbody",viewClass:g}),y=i.View.extend({templateName:"sites_stats",events:{"click div.phone-page":"showUpgradeOrPhonePage"},afterInitialize:function(){this.model.bind("change",function(){this.render()},this)},render:function(){this.renderTemplate();var e=this,n=function(e){var t=parseInt(e.css("font-size"),10);e.css("font-size",t-1+"px")};setTimeout(function(){e.$("span.stat-total").filter(function(){return t(this).height()>22}).each(function(){for(var e=t(this);e.height()>22;)n(e),e.height()>22&&n(e.prev("span.stat-number"))})},500),0===this.model.sites.length?t(this.el).hide():t(this.el).show()},showUpgradeOrPhonePage:function(){ABINEMASKME.user.isEntitledToPhone()?ABINEMASKME.App.navigate("home/phones",!0):p.securityManager.openPage(ABINEMASKME.user.getUpgradeLink({feature:"phone"}),!1)}}),v=i.View.extend({templateName:"sites_sites",events:{"keyup input.search-query":"filterListByKey","click a.sort-column":"sortByColumn","click div.stat":"visitDetailForStat","click #printBtn":"viewAccountForPrinting"},siteComparator:{domain:function(e){return e.get("domain")},createdDescending:function(e){var t=e.get("createdAt");return new Date-new Date(t)},modifiedAt:function(e){var t=e.get("modifiedAt");return new Date-new Date(t)}},afterInitialize:function(){t(".dropdown-toggle").dropdown(),t(this.el).show()},dataChanged:function(){this.children.loadingDisplay.hide(),t(this.el).find(".data-display").show(),this.showBlankOrSites()},createChildren:function(){var e=new h({pageName:"sites"});this.collection=ABINEMASKME.user.sites;var t=new b({collection:this.collection}),i=new n.SiteStatistics({sites:this.collection}),a=new y({model:i});this.children={sitesList:t,stats:a,loadingDisplay:e};var s=ABINEMASKME.user.getAccountSortPref("modifiedAt");return s in this.siteComparator||(s="modifiedAt"),t.collection.comparator=this.siteComparator[s],t.collection.length>0&&this.dataChanged(),this.weakBindTo(t.collection,"sync:read",function(){e.startRefreshing()},this),this.weakBindTo(t.collection,"sync",this.dataChanged,this),t.collection.fetchAll(),this.children},showBlankOrSites:function(){this.showSitesState(),0===this.collection.length?(t(this.el).find(".noSites").show(),t(this.el).find(".savedSites").hide()):(t(this.el).find(".noSites").hide(),t(this.el).find(".savedSites").show())},showSitesState:function(){t(this.el).find("form, table").show(),t(this.el).find(".sites-stats").show(),t(this.el).find(".site_list_container").css("overflow","-moz-scrollbars-vertical"),t(this.el).find(".site_list_container").css("overflow-y","scroll")},applyDomainFilter:function(n){var i=new RegExp(n,"i");e.each(this.children.sitesList.children,function(e){var n=e.model.get("domain");n=n.substring(0,n.indexOf(".")),i.test(n)?t(e.el).show():t(e.el).hide()})},filterListByKey:function(e){var n=t(e.currentTarget).val();this.applyDomainFilter(n)},sortByColumn:function(e){var n=e.currentTarget.id.split("-"),i=n[n.length-1];ABINEMASKME.user.setAccountSortPref(i);var a="desc"==n[n.length-2];this.children.sitesList.collection.comparator=this.siteComparator[i],this.children.sitesList.collection.sort({silent:!0}),a&&this.children.sitesList.collection.models.reverse(),this.children.sitesList.collection.trigger("reset");var s=t("input.search-query").val();s&&this.applyDomainFilter(s)},visitDetailForStat:function(e){var n=/(email|password)/,i=n.exec(e.target.className)[0];"email"==i?window.location=t("#visitEmail").attr("href"):"password"==i&&(window.location=t("#visitPassword").attr("href"))},viewAccountForPrinting:function(){ABINEMASKME.App.navigate("printAccounts",!0)}},{routeName:"sites",routeAction:function(){ABINEMASKME.App.loadView(v)}});return i.Security.showBlankWhenLocked(v),v}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/sites/stats"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r,o="",l="function",c=n.helperMissing,d=void 0,u=this.escapeExpression;return o+='<div class="stat stat-email">\n    <a id="visitEmail" href="#home/emails"></a>\n    <div class="stat-icon stat-email" style=\'background-color: ',i="protectedEmails",a=t,r=n.getProtectionColor,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getProtectionColor"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"getProtectionColor",a,i,{hash:{}}):s,o+=u(i)+';\'>\n        <i class="icon-envelope icon-white stat-email"></i>\n    </div>\n    <div class="stat-label stat-email">',i="mm_sites_statsEmailsMasked",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'</div>\n        <div class="stat-span stat-email"><span class="stat-number stat-email" style=\'color: ',i="protectedEmails",a=t,r=n.getProtectionColor,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getProtectionColor"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"getProtectionColor",a,i,{hash:{}}):s,o+=u(i)+";'> ",r=n.protectedEmails,i=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"protectedEmails"),typeof i===l?i=i.call(t,{hash:{}}):i===d&&(i=c.call(t,"protectedEmails",{hash:{}})),o+=u(i)+'</span><span class="stat-total stat-email"> ',r=n.totalEmails,i=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"totalEmails"),a="mm_sites_statsOf",r=n.intl,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"intl",a,i,{hash:{}}):s,o+=u(i)+'</span></div>\n</div>\n\n<div class="stat-spacer"></div>\n<div class="stat stat-phone phone-page">\n    <div class="stat-icon stat-phone" style=\'background-color: ',i="protectedPhones",a=t,r=n.getProtectionColor,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getProtectionColor"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"getProtectionColor",a,i,{hash:{}}):s,o+=u(i)+';\'>\n        <i class="icon-bell icon-white stat-phone"></i>\n    </div>\n    <div class="stat-label stat-phone">',i="mm_sites_statsPhonesMasked",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'</div>\n        <div class="stat-span stat-phone"><span class="stat-number stat-phone" style=\'color: ',i="protectedPhones",a=t,r=n.getProtectionColor,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getProtectionColor"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"getProtectionColor",a,i,{hash:{}}):s,o+=u(i)+";'> ",r=n.protectedPhones,i=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"protectedPhones"),typeof i===l?i=i.call(t,{hash:{}}):i===d&&(i=c.call(t,"protectedPhones",{hash:{}})),o+=u(i)+'</span><span class="stat-total stat-phone"> ',r=n.totalPhones,i=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"totalPhones"),a="mm_sites_statsOf",r=n.intl,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"intl",a,i,{hash:{}}):s,o+=u(i)+'</span></div>\n</div>\n\n<div class="stat-spacer"></div>\n<div class="stat stat-password">\n    <a id="visitPassword" href="#home/passwords"></a>\n    <div class="stat-icon stat-password" style=\'background-color: ',i="uniquePasswords",a=t,r=n.getProtectionColor,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getProtectionColor"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"getProtectionColor",a,i,{hash:{}}):s,o+=u(i)+';\'>\n        <i class="icon-lock icon-white stat-password"></i>\n    </div>\n    <div class="stat-label stat-password">',i="mm_sites_statsUniquePasswords",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'</div>\n        <div class="stat-span stat-password"><span class="stat-number stat-password" style=\'color: ',i="uniquePasswords",a=t,r=n.getProtectionColor,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getProtectionColor"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"getProtectionColor",a,i,{hash:{}}):s,o+=u(i)+";'> ",r=n.uniquePasswords,i=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"uniquePasswords"),typeof i===l?i=i.call(t,{hash:{}}):i===d&&(i=c.call(t,"uniquePasswords",{hash:{}})),o+=u(i)+'</span><span class="stat-total stat-password"> ',r=n.totalPasswords,i=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"totalPasswords"),a="mm_sites_statsOf",r=n.intl,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"intl",a,i,{hash:{}}):s,o+=u(i)+'</span></div>\n</div>\n<div class="stat-spacer"></div>\n'}),ABINEMASKME.CompiledTemplates["views/sites/stats"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/timeline/one"]=e.template(function(e,t,n,i,a){function s(e){var t,n="";return n+='<p class="extraActivity">',t=e,typeof t===p?t=t.call(e,{hash:{}}):t===m&&(t=f.call(e,"this",{hash:{}})),n+=g(t)+"</p>"}n=n||e.helpers;var r,o,l,c,d,u="",h=this,p="function",f=n.helperMissing,m=void 0,g=this.escapeExpression,b=n.blockHelperMissing;return u+='<td class="icon ',c=n.getHighlightedClass,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getHighlightedClass"),typeof r===p?r=r.call(t,{hash:{}}):r===m&&(r=f.call(t,"getHighlightedClass",{hash:{}})),u+=g(r)+'">\n    <div class="',c=n.getProtectedClass,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getProtectedClass"),typeof r===p?r=r.call(t,{hash:{}}):r===m&&(r=f.call(t,"getProtectedClass",{hash:{}})),u+=g(r)+'"><a href="#accounts/',c=n.accountId,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"accountId"),typeof r===p?r=r.call(t,{hash:{}}):r===m&&(r=f.call(t,"accountId",{hash:{}})),u+=g(r)+'"><i class="',c=n.getIcon,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getIcon"),typeof r===p?r=r.call(t,{hash:{}}):r===m&&(r=f.call(t,"getIcon",{hash:{}})),u+=g(r)+' icon-white"></i></a></div>\n</td>\n<td class="activityDomain ',c=n.getHighlightedClass,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getHighlightedClass"),typeof r===p?r=r.call(t,{hash:{}}):r===m&&(r=f.call(t,"getHighlightedClass",{hash:{}})),u+=g(r)+'">\n    <a href="#sites/',c=n.getSiteId,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getSiteId"),typeof r===p?r=r.call(t,{hash:{}}):r===m&&(r=f.call(t,"getSiteId",{hash:{}})),u+=g(r)+'">',c=n.getDomain,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getDomain"),typeof r===p?r=r.call(t,{hash:{}}):r===m&&(r=f.call(t,"getDomain",{hash:{}})),u+=g(r)+'</a>\n</td>\n<td class="activityDesc ',c=n.getHighlightedClass,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getHighlightedClass"),typeof r===p?r=r.call(t,{hash:{}}):r===m&&(r=f.call(t,"getHighlightedClass",{hash:{}})),u+=g(r)+'">\n    <p class="mainActivity">',c=n.getPrettyDescription,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getPrettyDescription"),typeof r===p?r=r.call(t,{hash:{}}):r===m&&(r=f.call(t,"getPrettyDescription",{hash:{}})),u+=g(r)+"</p>\n    ",c=n.getExtraActivities,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getExtraActivities"),d=h.program(1,s,a),d.hash={},d.fn=d,d.inverse=h.noop,r=c&&typeof r===p?r.call(t,d):b.call(t,r,d),(r||0===r)&&(u+=r),u+='\n</td>\n<td class="timeago ',c=n.getHighlightedClass,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getHighlightedClass"),typeof r===p?r=r.call(t,{hash:{}}):r===m&&(r=f.call(t,"getHighlightedClass",{hash:{}})),u+=g(r)+'">\n    <span class="time-ago"><i class="icon-time"></i>&nbsp;',r="createdAt",c=n.live_timestamp,o=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"live_timestamp"),r=typeof o===p?o.call(t,r,{hash:{}}):o===m?f.call(t,"live_timestamp",r,{hash:{}}):o,u+=g(r)+'</span>\n</td>\n<td class="delete ',c=n.getHighlightedClass,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getHighlightedClass"),typeof r===p?r=r.call(t,{hash:{}}):r===m&&(r=f.call(t,"getHighlightedClass",{hash:{}})),u+=g(r)+'">\n    <div class="dropdown">\n        <a class="close dropdown-toggle" data-toggle="dropdown" href="#"><i class="icon-trash"></i></a>\n\n        <ul class="dropdown-menu">\n            <li><a id="item-hide-activity" href=#>',r="mm_timeline_hideActivity",c=n.intl,o=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),r=typeof o===p?o.call(t,r,{hash:{}}):o===m?f.call(t,"intl",r,{hash:{}}):o,u+=g(r)+'</a></li>\n            <li><a href="#holdOnCowboy',c=n.getId,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getId"),typeof r===p?r=r.call(t,{hash:{}}):r===m&&(r=f.call(t,"getId",{hash:{}})),u+=g(r)+'" data-toggle="modal">',c=n.getDomain,r=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getDomain"),o="mm_timeline_hideSite",c=n.intl,l=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),r=typeof l===p?l.call(t,o,r,{hash:{}}):l===m?f.call(t,"intl",o,r,{hash:{}}):l,u+=g(r)+"</a></li>\n        </ul>\n    </div>\n    ",r="cowboy",c=n.child,o=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),r=typeof o===p?o.call(t,r,{hash:{}}):o===m?f.call(t,"child",r,{hash:{}}):o,u+=g(r)+"\n</td>\n\n\n\n\n"}),ABINEMASKME.CompiledTemplates["views/timeline/one"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/timeline/timeline"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r,o="",l="function",c=n.helperMissing,d=void 0,u=this.escapeExpression;return o+='<span class="deleteAll dropdown">\n    <a class="btn btn-small dropdown-toggle" data-toggle="dropdown" href="#">\n        <i class="icon-trash"></i>\n        &nbsp;',i="mm_timeline_clear",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'\n    </a>\n    <ul class="dropdown-menu">\n        <li><a id="clearYes" href=#>',i="mm_timeline_clearAll",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+"</a></li>\n        <li><a href=#>",i="mm_timeline_nevermind",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+"</a></li>\n    </ul>\n</span>\n<h2>",i="mm_timeline_privacyTimeline",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+" ",i="whatistimeline",a="mm_help_link_whatIsThis",r=n.helpLink,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"helpLink"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"helpLink",a,i,{hash:{}}):s,(i||0===i)&&(o+=i),o+='</h2>\n\n\n<div class="empty-notice alert alert-info" style="display: none">\n  ',i="mm_timeline_privacyTimelineDesc",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+'\n</div>\n<div class="errorDiv alert alert-error" style="display:none;">\n  ',i="mm_timeline_serverError",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='\n</div>\n\n<div class="alert alert-inverse" id="disableNotifications" style="margin-top:10px;display: none;text-align:center;">\n    <table width="100%"><tr>\n      <td width="3%">\n        <img src="',i="/images/Icon.png",r=n.assetUrl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"assetUrl",i,{hash:{}}):a,o+=u(i)+'" style="margin:-5px 0px 0px -10px;"/>\n      </td>\n      <td width="96%">\n        <div>\n            <span style="margin:0px 20px 0px -1px;">',i="mm_manage_disableNotificationsTitle",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</span>\n            <a class="btn" id="disableNotificationsBtn" style="margin-right:20px;">',i="mm_manage_disableNotificationsBtn",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</a>\n            <a class="btn btn-primary" id="keepItUpBtn">',i="mm_manage_keepItUp",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(o+=i),o+='</a>\n        </div>\n      </td>\n      <td>\n        <div style="height:40px;">\n          <button id="dismissAlert" class="close close-notification" style="color:white;">&times;</button>\n        </div>\n      </td>\n    </tr></table>\n</div>\n\n',i="loadingDisplay",r=n.child,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"child",i,{hash:{}}):a,o+=u(i)+'\n\n<table class="table table-striped">\n  ',i="tbody",a="activityList",r=n.child,s=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),i=typeof s===l?s.call(t,a,i,{hash:{}}):s===d?c.call(t,"child",a,i,{hash:{}}):s,o+=u(i)+'\n</table>\n<a class="btn btn-small seeMore" href="#"><i class="icon-eye-open"></i> ',i="mm_timeline_seeMore",r=n.intl,a=r||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===l?a.call(t,i,{hash:{}}):a===d?c.call(t,"intl",i,{hash:{}}):a,o+=u(i)+"</a>\n"
}),ABINEMASKME.CompiledTemplates["views/timeline/timeline"]}),ABINEMASKME.define("abine/views/timeline",["documentcloud/underscore","jquery","models","duckbone/core","wycats/handlebars","abine/assets","abine/views/sites","abine/eventLogger","abine/views/holdOnCowboyView","abine/views/loading_display"],function(e,t,n,a,s,r,o,l,c,d){var u=35,h=35,p=a.View.extend({tagName:"tr",className:"activityRow",templateName:"timeline_one",events:{"click #item-hide-activity":"deleteActivity","click #deleteEverythingBtn":"blacklistSite"},afterInitialize:function(){},createChildren:function(){var e=new c({model:this.model});return{cowboy:e}},deleteActivity:function(){this.model.destroy(function(){t(this.el).hide()})},blacklistSite:function(){t(this.el).find("#holdOnCowboy"+this.model.getId()).modal("hide");var n=this.model.account;n.site.blacklist({success:e.bind(function(){ABINEMASKME.App.navigate("blacklist",!0)},this),error:e.bind(function(){t(".errorDiv").show(),t("body").scrollTop(0)},this)})}}),f=a.ListView.extend({tagName:"tbody",viewClass:p,afterInitialize:function(){this.collection.bind("reset",function(){var e=Math.min(this.collection.length,u);for(i=e;this.collection.length>i;i++){var n=this.collection.at(i),a=this.getViewByModel(n);t(a.el).hide()}this.numVisible=e,this.trigger("lengthChange")},this)},showMore:function(){var e=Math.min(this.collection.length,this.numVisible+h);for(i=this.numVisible;e>i;i++){var n=this.collection.at(i),a=this.getViewByModel(n);t(a.el).show(),i==this.collection.length-1&&this.trigger("allShown"),this.numVisible+=1}}}),m=a.View.extend({templateName:"timeline_timeline",events:{"click #clearYes":"deleteAllActivity","click .seeMore":"seeMoreActivity","click #keepItUpBtn":"dismissAlert","click #dismissAlert":"dismissAlert","click #disableNotificationsBtn":"disableNotifications"},afterInitialize:function(){this.options.accountId&&!ABINEMASKME.user.hasSeenNotificationsGrowl()&&t(this.el).find("#disableNotifications").show()},createChildren:function(){var i=new d({pageName:"timeline"}),a=new f({collection:new n.AccountActivityCollection});return a.collection.fetchAll({success:e.bind(function(){i.hide(),0===a.collection.length?(t(this.el).find("div.empty-notice").show(),t(this.el).find(".deleteAll").hide()):this.options.accountId&&e.each(a.children,e.bind(function(e){e.model.get("accountId")==this.options.accountId&&(e.model.set({highlighted:!0}),e.render())},this))},this)}),a.bind("allShown",function(){t(this.el).find(".seeMore").hide()},this),a.bind("lengthChange",function(){if(0===a.collection.length?(this.$("div.empty-notice").show(),this.$(".deleteAll").hide()):(this.$("div.empty-notice").hide(),this.$(".deleteAll").show()),a.collection.length>u){var e=this.$(".seeMore").get(0);t(e).show()}},this),a.collection.bindBroadcasts(),{activityList:a,loadingDisplay:i}},beforeRemove:function(){this.children.activityList.collection.unbindBroadcasts()},deleteAllActivity:function(){var n=[];e.each(this.children.activityList.collection.models,function(e){n.push(e)}),e.each(n,function(e){e.destroy(function(){t(e).hide()})}),this.children.activityList.collection.fetchAll()},seeMoreActivity:function(){return this.children.activityList.showMore(),!1},dismissAlert:function(){t(this.el).find("#disableNotifications").hide(),ABINEMASKME.user.setSeenNotificationsGrowlPref()},disableNotifications:function(){ABINEMASKME.user.turnOffNotifications(),this.dismissAlert()}},{routeName:"timeline",routeAction:function(e){ABINEMASKME.App.loadView(m,{accountId:e})}});return a.Security.showLoginWhenLocked(m),m}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/transactions/one"]=e.template(function(e,t,n,i,a){function s(){return'<a href="#" id="helpTestAuthIcon"><i class="icon-question-sign"></i></a>'}function r(e){var t,i="";return i+='\n<span style="color:#d9534f;">',d=n.status,t=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"status"),typeof t===f?t=t.call(e,{hash:{}}):t===g&&(t=m.call(e,"status",{hash:{}})),i+=b(t)+'<a href="#" id="helpCanceledIcon"><i class="icon-question-sign"></i></a>\n'}function o(e){var t,i="";return i+="\n",d=n.status,t=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"status"),typeof t===f?t=t.call(e,{hash:{}}):t===g&&(t=m.call(e,"status",{hash:{}})),i+=b(t)+"\n"}n=n||e.helpers;var l,c,d,u,h="",p=this,f="function",m=n.helperMissing,g=void 0,b=this.escapeExpression,y=n.blockHelperMissing;return h+="<td>",d=n.merchant,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"merchant"),typeof l===f?l=l.call(t,{hash:{}}):l===g&&(l=m.call(t,"merchant",{hash:{}})),h+=b(l)+"</td>\n<td>",d=n.getDate,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getDate"),typeof l===f?l=l.call(t,{hash:{}}):l===g&&(l=m.call(t,"getDate",{hash:{}})),h+=b(l)+"</td>\n<td>",d=n.amount,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"amount"),typeof l===f?l=l.call(t,{hash:{}}):l===g&&(l=m.call(t,"amount",{hash:{}})),h+=b(l),d=n.amount,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"amount"),d=n.ifTestAuth,c=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"ifTestAuth"),u=p.program(1,s,a),u.hash={},u.fn=u,u.inverse=p.noop,l=d&&typeof c===f?c.call(t,l,u):y.call(t,c,l,u),(l||0===l)&&(h+=l),h+="\n</td>\n<td>\n",d=n.status,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"status"),d=n.ifCanceledStatus,c=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"ifCanceledStatus"),u=p.program(3,r,a),u.hash={},u.fn=u,u.inverse=p.program(5,o,a),l=d&&typeof c===f?c.call(t,l,u):y.call(t,c,l,u),(l||0===l)&&(h+=l),h+="\n</td>\n"}),ABINEMASKME.CompiledTemplates["views/transactions/one"]}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/transactions/transactions"]=e.template(function(e,t,n,i,a){function s(e){var t,i="";return i+='\n    <h4><span id="balance"></span> balance remaining out of ',d=n.getOriginalValue,t=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getOriginalValue"),typeof t===f?t=t.call(e,{hash:{}}):t===g&&(t=m.call(e,"getOriginalValue",{hash:{}})),i+=b(t)+" limit.</h4>\n  "}function r(e){var t,i="";return i+="\n    <h4>This card has been deactivated, no further charges will be authorized. You have been refunded ",d=n.getAmountRefunded,t=d||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getAmountRefunded"),typeof t===f?t=t.call(e,{hash:{}}):t===g&&(t=m.call(e,"getAmountRefunded",{hash:{}})),i+=b(t)+".</h4>\n  "}n=n||e.helpers;var o,l,c,d,u,h="",p=this,f="function",m=n.helperMissing,g=void 0,b=this.escapeExpression;return h+='<ul class="breadcrumb">\n  <li><a href="#/home">',o="mm_transactions_Home",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,h+=b(o)+'</a> <span class="divider">/</span></li>\n  <li><a href="#/payments">',o="mm_payment_card",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,h+=b(o)+'</a> <span class="divider">/</span></li>\n  <li class="active">',o="mm_transactions_Transactions",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,h+=b(o)+'</li>\n</ul>\n\n<div>\n\n<div id="maskedCard" class="creditcardfont" style="color:rgb(80,80,80);height:181px;width:336px;margin:auto;padding:10px;">\n    <div style="border-radius:8px;padding:10px;padding-top:0px;background-repeat:no-repeat;width:336px;height:181px;background-image:url(\'',o="/pages/images/maskedcard.png",d=n.assetUrl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"assetUrl",o,{hash:{}}):l,h+=b(o)+'\');">\n         <br style="clear:both;"/>\n         <div style="text-align:center;margin-top:10px;">\n            <h3 id="cardNumber">',d=n.getCardNumber,o=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getCardNumber"),typeof o===f?o=o.call(t,{hash:{}}):o===g&&(o=m.call(t,"getCardNumber",{hash:{}})),h+=b(o)+'</h3>\n         </div>\n         <div style="font-size:15px;">\n            <span style="float:left;">Exp Date: <span id="expiration">',d=n.getExpiry,o=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getExpiry"),typeof o===f?o=o.call(t,{hash:{}}):o===g&&(o=m.call(t,"getExpiry",{hash:{}})),h+=b(o)+'</span></span> <span style="float:right;margin-right:25px;">CVC: <span id="cvc">',d=n.getCVC,o=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getCVC"),typeof o===f?o=o.call(t,{hash:{}}):o===g&&(o=m.call(t,"getCVC",{hash:{}})),h+=b(o)+'</span></span>\n            <br style="clear:both;"/>\n            <span id="street" style="margin-left: 100px;">280 SUMMER STREET</span><br><span id="cityStateZip" style="margin-left: 106px;">BOSTON MA 02210</span>\n            <br style="clear:both;"/>\n         </div>\n    </div>\n</div>\n<div id="balanceDiv" style="text-align:center;display:none;">\n  ',d=n.isActive,o=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"isActive"),l=n["if"],u=p.program(1,s,a),u.hash={},u.fn=u,u.inverse=p.program(3,r,a),o=l.call(t,o,u),(o||0===o)&&(h+=o),h+="\n</div>\n</div>\n\n",o="loadingDisplay",d=n.child,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"child",o,{hash:{}}):l,h+=b(o)+'\n\n<div>\n\n  <div class="errorDiv alert alert-error" style="display:none;">\n    ',o="mm_transactions_serverError",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,(o||0===o)&&(h+=o),h+='\n  </div>\n  <div class="empty-notice alert alert-info" style="display:none;">\n    ',o="mm_transactions_noTransactions",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,h+=b(o)+'\n  </div>\n\n  <table class="table table-striped data-display" style="display:none;">\n    <thead>\n      <tr>\n          <th>',o="mm_transactions_Merchant",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,h+=b(o)+"</th>\n          <th>",o="mm_transactions_Date",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,h+=b(o)+"</th>\n          <th>",o="mm_transactions_Amount",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,h+=b(o)+"</th>\n          <th>",o="mm_transactions_Status",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,h+=b(o)+'<a href="#" id="helpStatusIcon"><i class="icon-question-sign"></i></a></th>\n      </tr>\n    </thead>\n    ',o="tbody",l="transactionsList",d=n.child,c=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),o=typeof c===f?c.call(t,l,o,{hash:{}}):c===g?m.call(t,"child",l,o,{hash:{}}):c,h+=b(o)+'\n  </table>\n</div>\n\n\n<a href="javascript:void(0)" id="showFeedbackForm"  style="display:none;" class="btn btn-mini btn-info"><i class="icon-envelope icon-white"></i> Contact support about this card</a>\n<div style="display:none;" id="feedbackForm">\n   ',o="feedbackForm",d=n.child,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"child",o,{hash:{}}):l,h+=b(o)+'\n</div>\n\n<div class="modal hide" id="helpTestAuthModal">\n  <div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal">&times;</button>\n    <h3 id="modalLabel">',o="mm_help_active_to_date_modal_Label",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,(o||0===o)&&(h+=o),h+='</h3>\n  </div>\n  <div class="modal-body">\n    <p>',o="mm_help_test_auth_modal_Body",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,(o||0===o)&&(h+=o),h+='</p>\n  </div>\n  <div class="modal-footer">\n    <button id="ok" class="btn btn-primary" data-dismiss="modal">',o="mm_help_active_to_date_modal_Ok",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,(o||0===o)&&(h+=o),h+='</button>\n  </div>\n</div>\n\n<div class="modal hide" id="helpStatusModal">\n  <div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal">&times;</button>\n    <h3 id="modalLabel">',o="mm_help_status_modal_Title",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,(o||0===o)&&(h+=o),h+='</h3>\n  </div>\n  <div class="modal-body">\n    <p>',o="mm_help_status_modal_Body",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,(o||0===o)&&(h+=o),h+='</p>\n  </div>\n  <div class="modal-footer">\n    <button id="ok" class="btn btn-primary" data-dismiss="modal">',o="mm_help_active_to_date_modal_Ok",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,(o||0===o)&&(h+=o),h+='</button>\n  </div>\n</div>\n\n<div class="modal hide" id="helpCanceledModal">\n  <div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal">&times;</button>\n    <h3 id="modalLabel">',o="mm_help_active_to_date_modal_Label",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,(o||0===o)&&(h+=o),h+='</h3>\n  </div>\n  <div class="modal-body">\n    <p>',o="mm_help_canceled_modal_Body",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,(o||0===o)&&(h+=o),h+='</p>\n  </div>\n  <div class="modal-footer">\n    <button id="ok" class="btn btn-primary" data-dismiss="modal">',o="mm_help_active_to_date_modal_Ok",d=n.intl,l=d||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===f?l.call(t,o,{hash:{}}):l===g?m.call(t,"intl",o,{hash:{}}):l,(o||0===o)&&(h+=o),h+="</button>\n  </div>\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/transactions/transactions"]}),ABINEMASKME.define("abine/views/transactions",["wycats/handlebars","documentcloud/underscore","jquery","models","duckbone/core","abine/intl","abine/views/loading_display","abine/config","abine/views/feedback","abine/responseCodes","abine/proxies"],function(e,t,n,i,a,s,r,o,l,c,d){e.registerHelper("ifTestAuth",function(e,t){return"0.00"===e||"1.00"===e?t.fn(this):t.inverse(this)}),e.registerHelper("ifCanceledStatus",function(e,t){return"Canceled"===e?t.fn(this):t.inverse(this)});var u=a.View.extend({tagName:"tr",className:"transactionRow",templateName:"transactions_one",events:{},afterInitialize:function(){this.model.bind("sync:success",this.render,this)}}),h=a.ListView.extend({tagName:"tbody",viewClass:u}),p=a.View.extend({templateName:"transactions_transactions",events:{"click #showFeedbackForm":"showFeedbackForm","click #helpTestAuthIcon":"showTestAuthModal","click #helpStatusIcon":"showStatusModal","click #helpCanceledIcon":"showCanceledModal"},showFeedbackForm:function(){n(this.el).find("#showFeedbackForm").hide(),n(this.el).find("#feedbackForm").show()},showTestAuthModal:function(){n(this.el).find("#helpTestAuthModal").modal()},showStatusModal:function(){n(this.el).find("#helpStatusModal").modal()},showCanceledModal:function(){n(this.el).find("#helpCanceledModal").modal()},afterInitialize:function(){n(this.el).find("#helpTestAuthIcon").tooltip()},createChildren:function(){var e=new r({pageName:"card_details"}),a=this.model.toJSON();a.number=a.number.substr(a.number.length-4);var s=new l({model:new i.Feedback({leadMsg:"Thanks for contacting us!",successMsg:"We will get back to you as soon as possible.",messagePlaceholder:"Please describe your issue here",buttonText:"Get Support"}),source:"card_details",cardInfo:JSON.stringify(a)}),o=new h({collection:new i.CardTransactionCollection});return d.paymentsModule.retrieveDisposableCardBalance({guid:this.model.get("guid")},t.bind(function(e,t){e||n(this.el).find("#balance").html("$"+(parseFloat(t.available_balance)/100).toFixed(2))},this)),o.collection.fetchAllByCardId(this.model.get("guid"),{success:t.bind(function(){e.hide(),n(this.el).find("#showFeedbackForm").show(),0===o.collection.length?(n(this.el).find("div.empty-notice").show(),n(this.el).find(".data-display").hide(),n(this.el).find("#balance").html("$"+parseFloat(this.model.get("original_amount")/100).toFixed(2))):n(this.el).find(".data-display").show(),n(this.el).find("#balanceDiv").show()},this),error:t.bind(function(){e.hide(),n(this.el).find(".data-display").show(),n(".errorDiv").show()},this)}),{transactionsList:o,loadingDisplay:e,feedbackForm:s}}},{routeName:"transactions",routeAction:function(e){function t(){ABINEMASKME.App.loadView(p,{model:n})}var n=ABINEMASKME.user.disposableCards.get({id:e});n?t():(n=new i.DisposableCard({id:e}),n.fetch({success:t}))}});return a.Security.showLoginWhenLocked(p),p}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/uninstall/uninstall"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+="<h2>",i="mm_uninstall_sorry",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+"</h2>\n<br>\n<div>\n  <p>\n    ",i="mm_uninstall_noLongerWant",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'\n  </p>\n</div>\n\n<div class="alert alert-error" id="uninstallErrorDiv" style="display:none;">\n  ',i="mm_uninstall_serverError",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'\n</div>\n\n<div class="uninstallBtnDiv">\n  <a href="#uninstall" class="btn btn-primary" id="uninstall">\n   ',i="mm_uninstall_deleteAccount",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'\n  </a>\n  <img id="ajaxSpinner" style="display:none;" src="',i="/pages/images/ajax_loader.gif",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" />\n</div>\n\n<div class="alert alert-info">\n  <h3>',i="mm_uninstall_soYouKnow",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+"</h3>\n\n  <p>\n    ",i="mm_uninstall_storing",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'\n  </p>\n  <a href="https://www.abine.com/products/maskme/support/datause.php" target="_blank">\n    ',i="mm_uninstall_readStoring",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+"\n  </a>\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/uninstall/uninstall"]}),ABINEMASKME.define("abine/views/uninstall",["documentcloud/underscore","jquery","models","duckbone/core","wycats/handlebars","abine/assets","abine/eventLogger","abine/proxies","abine/views/recheck"],function(e,t,n,i,a,s,r,o,l){var c=i.View.extend({templateName:"uninstall_uninstall",events:{"click #uninstall":"uninstallBtn"},recheckPassword:function(e,n){var i=new l({element:e,callback:n,label:"To delete MaskMe"});t("body").append(i.el)},uninstall:function(){t("#uninstallErrorDiv").hide(),t("#ajaxSpinner").show(),ABINEMASKME.user.loadMin(function(){o.licenseModule.deleteUser(ABINEMASKME.user.getGUIDs(),function(e){t("#ajaxSpinner").hide(),e?t("#uninstallErrorDiv").show():ABINEMASKME.user.loadPreferences(function(){ABINEMASKME.App.navigate("uninstalled",!0)})})})},uninstallBtn:function(t){o.securityManager.passwordValidationRequired(e.bind(function(n){n?this.recheckPassword(t.target,e.bind(function(){this.uninstall()},this)):this.uninstall()},this))}},{routeName:"uninstall",routeAction:function(){ABINEMASKME.App.loadView(c)}});return i.Security.showLoginWhenLocked(c),c}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/uninstall/uninstalled"]=e.template(function(e,t,n,i,a){function s(e){var t,i,a="";return a+='\n      <a href="http://support.google.com/chrome/bin/answer.py?hl=en&answer=113907" target="_blank">',t="mm_uninstall_seeHowChrome",c=n.intl,i=c||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===p?i.call(e,t,{hash:{}}):i===m?f.call(e,"intl",t,{hash:{}}):i,a+=g(t)+"</a>\n    "}function r(e){var t,i,a="";return a+='\n      <a href="http://support.mozilla.org/en-US/kb/disable-or-remove-add-ons#w_how-to-remove-extensions-and-themes" target="_blank">',t="mm_uninstall_seeHowFirefox",c=n.intl,i=c||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===p?i.call(e,t,{hash:{}}):i===m?f.call(e,"intl",t,{hash:{}}):i,a+=g(t)+"</a>\n    "}n=n||e.helpers;var o,l,c,d,u="",h=this,p="function",f=n.helperMissing,m=void 0,g=this.escapeExpression;return u+="<h1>",o="mm_uninstall_accountDelete",c=n.intl,l=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===p?l.call(t,o,{hash:{}}):l===m?f.call(t,"intl",o,{hash:{}}):l,u+=g(o)+"</h1>\n</br>\n<div>\n  <p>",o="mm_uninstall_infoRemoved",c=n.intl,l=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===p?l.call(t,o,{hash:{}}):l===m?f.call(t,"intl",o,{hash:{}}):l,u+=g(o)+'</p>\n  <br>\n  <div class="alert alert-error">\n    ',o="mm_uninstall_extensionUninstall",c=n.intl,l=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===p?l.call(t,o,{hash:{}}):l===m?f.call(t,"intl",o,{hash:{}}):l,u+=g(o)+"\n    ",c=n.isChrome,o=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"isChrome"),l=n["if"],d=h.program(1,s,a),d.hash={},d.fn=d,d.inverse=h.noop,o=l.call(t,o,d),(o||0===o)&&(u+=o),u+="\n    ",c=n.isFirefox,o=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"isFirefox"),l=n["if"],d=h.program(3,r,a),d.hash={},d.fn=d,d.inverse=h.noop,o=l.call(t,o,d),(o||0===o)&&(u+=o),u+="\n  </div>\n</div>\n</br>\n<h3>",o="mm_uninstall_whatBetter",c=n.intl,l=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),o=typeof l===p?l.call(t,o,{hash:{}}):l===m?f.call(t,"intl",o,{hash:{}}):l,u+=g(o)+"</h3>\n  ",o="feedback",c=n.child,l=c||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),o=typeof l===p?l.call(t,o,{hash:{}}):l===m?f.call(t,"child",o,{hash:{}}):l,u+=g(o)+"\n"}),ABINEMASKME.CompiledTemplates["views/uninstall/uninstalled"]}),ABINEMASKME.define("abine/views/uninstalled",["documentcloud/underscore","jquery","models","duckbone/core","abine/eventLogger","abine/views/feedback","abine/intl"],function(e,t,n,i,a,s,r){var o=i.View.extend({templateName:"uninstall_uninstalled",afterInitialize:function(){t("div.navbar-inner").hide()},createChildren:function(){var e=new s({model:new n.Feedback({leadMsg:r.getText("mm_feedback_thanks"),successMsg:r.getText("mm_feedback_workingHard"),messagePlaceholder:"Your truly appreciated feedback goes here.",buttonText:r.getText("mm_feedback_sendFeedback")}),source:"uninstall"});return e.hideMaskEmail(),{feedback:e}}},{routeName:"uninstalled",routeAction:function(){ABINEMASKME.App.loadView(o)}});return o}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/unlock/fakeunlock"]=e.template(function(e,t,n,i,a){function s(e){var t,i,a="";return a+='\n        <div style="position:absolute;bottom:5px;right:5px;font-size:12px;" class="sign-in">',t="mm_user_registration_haveAccount",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,a+=m(t)+' <a href="#userLogin/fakeunlock">',t="mm_user_registration_login",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,a+=m(t)+"</a></div>\n    "}n=n||e.helpers;var r,o,l,c,d="",u=this,h="function",p=n.helperMissing,f=void 0,m=this.escapeExpression,g=n.blockHelperMissing;return d+='<div style="text-align:center;margin-top:75px;padding:20px;position:relative;" class="well">\n    <div class="lock-image" style="float:left;">\n        <img src="',r="pages/images/lock.png",l=n.assetUrl,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),r=typeof o===h?o.call(t,r,{hash:{}}):o===f?p.call(t,"assetUrl",r,{hash:{}}):o,d+=m(r)+'" />\n    </div>\n    <div style="float:left;margin-left:25px;margin-top:20px;text-align:left;">\n        <h4>Lock allows you to restrict access to your MaskMe data.</h4>\n        <div>\n            It is perfect for anyone who shares a computer with family, or when you have a guest over.\n        </div>\n        <div>\n            To use \'Lock\', <a id="changePassword" href="javascript:void(0);">setup your password</a>.\n        </div>\n    </div>\n    <br style="clear: both;"/>\n    ',r="hasRegEmail",l=n.ifUser,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"ifUser"),c=u.program(1,s,a),c.hash={},c.fn=c,c.inverse=u.noop,r=l&&typeof o===h?o.call(t,r,c):g.call(t,o,r,c),(r||0===r)&&(d+=r),d+="\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/unlock/fakeunlock"]}),ABINEMASKME.define("abine/views/fakeunlock",["documentcloud/underscore","jquery","models","duckbone/core","wycats/handlebars","abine/assets","abine/proxies","abine/eventLogger","abine/intl"],function(e,t,n,i){var a=i.View.extend({tagName:"div",className:"clearfix",templateName:"unlock_fakeunlock",events:{"click #fakeUnlock":"goToHome","click #changePassword":"goToChangePassword"},afterInitialize:function(){},goToHome:function(){ABINEMASKME.App.renderPage("home")},goToChangePassword:function(){ABINEMASKME.App.renderPage("editUser/password")}},{routeAction:function(){ABINEMASKME.App.loadView(a)}});return a}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/unlock/panel"]=e.template(function(e,t,n,i,a){function s(e){var t,i,a="";return a+='\n         <div class="control-group">\n           <i class="icon-lock"></i>\n          ',t="mm_unlock_panel_LockedEnterPass",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,a+=m(t)+'<br/>\n          <span class="pad">',t="password",l=n.form_password,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"form_password"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"form_password",t,{hash:{}}):i,a+=m(t)+'</span>\n          <button id="unlockButton" class="unlockButton btn btn-mini btn-success">',t="mm_unlock_panel_Unlock",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,a+=m(t)+'</button>\n          <span class="errorText" style="display:none;">',t="mm_unlock_panel_WrongPass",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,a+=m(t)+'</span>\n         </div>\n         <div style="margin-left:15px;" id="autoUnlockOption">\n            <input type="checkbox" id="autoUnlockPref" /> <span id="prefLabel" style="display:inline;vertical-align:middle;font-size:11px;" for="autoUnlockPref">',t="mm_unlock_AutoLockPref",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,(t||0===t)&&(a+=t),a+='</span>\n         </div><div style="height:8px;">&nbsp;</div>\n    '}n=n||e.helpers;var r,o,l,c,d="",u=this,h="function",p=n.helperMissing,f=void 0,m=this.escapeExpression,g=n.blockHelperMissing;return d+='<div class="panel">\n\n    <!-- Logo and Panel Buttons -->\n    <div class="header">\n        <img class="panel-icon" src="',r="/pages/images/manage/maskme_logo_short_green.png",l=n.assetUrl,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),r=typeof o===h?o.call(t,r,{hash:{}}):o===f?p.call(t,"assetUrl",r,{hash:{}}):o,d+=m(r)+'"/>\n        <div class="buttons-panel close-dd close-header">\n            <span class="close-icon close-header" id="paneHover"></span>\n        </div>\n    </div>\n\n    ',r="unlock",l=n.form,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"form"),c=u.program(1,s,a),c.hash={},c.fn=c,c.inverse=u.noop,r=l&&typeof o===h?o.call(t,r,c):g.call(t,o,r,c),(r||0===r)&&(d+=r),d+="\n</div>\n\n"}),ABINEMASKME.CompiledTemplates["views/unlock/panel"]}),ABINEMASKME.define("abine/views/unlockPanel",["documentcloud/underscore","jquery","duckbone/core","models","abine/views/panelBase","abine/proxies","abine/timer","abine/eventLogger"],function(e,t,n,i,a,s,r){var o=a.extend({templateName:"unlock_panel",events:{"submit .unlock":"verifyPassword","click #prefLabel":"checkBox"},checkBox:function(){"checked"==t(this.el).find("#autoUnlockPref").attr("checked")?t(this.el).find("#autoUnlockPref").removeAttr("checked"):t(this.el).find("#autoUnlockPref").attr("checked","checked")},afterInitialize:function(){this.unlockHook=e.bind(this.unlocked,this),s.securityManager.on("background:securityManager:unlocked",this.unlockHook),this.field=this.options.field,this.previousClick=this.field.id,this.applyFadingStyle(),this.fadeIn(),this.model={password:""},this.render(),this.contentManager=this.options.contentManager,this.passwordField=t(".form_password",this.el),this.options.preferences.getPrefFromStorage("autoLockOnRestart",e.bind(function(e){e&&"true"!=e.get("value")?t(this.el).find("#autoUnlockPref").removeAttr("checked"):t(this.el).find("#autoUnlockPref").attr("checked","checked")},this)),this.bindBlurClose()},bindBlurClose:function(){this.field=this.field||this.options.field,t(this.el).bind("mousedown",e.bind(function(t){var n=t.target.className.split(" ");e.contains(n,"close-header")?this.closeHeader():("close-icon"==t.target.className||"close-dd"==t.target.className)&&this.closePanel(),this.ignoreBlur=!0},this)),t(this.field.element).add(this.passwordField).bind("blur",e.bind(function(n){this.ignoreBlur?(delete this.ignoreBlur,n.target.element!==this.field.element&&r.setTimeout(e.bind(function(){t(this.passwordField).focus()},this),1)):(this.cleanupPanel(),this.closePanel())},this)),t(this.field.element).bind("keydown",e.bind(function(){this.cleanupPanel(),this.closePanel()},this))},cleanupPanel:function(){s.securityManager.off("background:securityManager:unlocked",this.unlockHook)},verifyPassword:function(n){n.preventDefault(),t(this.el).find(".unlockButton").attr("disabled","disabled");var i=this.passwordField.val(),a=t(this.el).find("#autoUnlockPref").is(":checked");s.securityManager.unlock(i,a,e.bind(function(e){e?this.invalidPassword():this.unlocked()},this))},invalidPassword:function(){t(this.el).find(".unlockButton").removeAttr("disabled"),this.passwordField.parent().addClass("error"),t(this.el).find(".errorText").show(),this.passwordField.focus(),delete this.ignoreBlur},unlocked:function(){this.cleanupPanel(),this.closePanel();var e=this.options.field;r.setTimeout(function(){t(e.element)[0].focus()},1e3)}});return o}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/unlock/password"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<form>\n  <div class="lock-image">\n    <img src="',i="pages/images/lock.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" />\n  </div>\n  \n  <div class="control-group lock-fields">\n    <p>\n        <b>',i="mm_unlock_password_LockedNoOneCan",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+"</b><br/>\n        ",i="mm_unlock_password_ToUnlock",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+"\n    </p>\n\n    ",i="password",s=n.form_password,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"form_password"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"form_password",i,{hash:{}}):a,r+=d(i)+'\n    <button class="unlockButton btn btn-success">',i="mm_unlock_panel_Unlock",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+' </button>&nbsp;<a class="showHint btn btn-info">',i="mm_unlock_password_Hint",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</a>\n    <div class="help-block"></div>\n    <div id="decrypting" style="display:none;">\n        ',i="mm_unlock_password_Decrypting",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'\n        <img src="',i="/pages/images/ajax_loader.gif",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" />\n    </div>\n  </div>\n  <br style="clear:both;"/>\n</form>\n\n<div class="please-wait" style="display:none;">\n  <p>',i="mm_unlock_password_SomethingWrong",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</p>\n</div>\n\n<div style="float:right;width:75%;">\n    <input type="checkbox" id="autoUnlockPref" /> <label style="vertical-align:middle;display:inline;font-size:12px;padding-right:20px;" for="autoUnlockPref">',i="mm_unlock_AutoLockPref",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+="</label>\n    ",i="mm_user_login_forgotPassword",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+='\n</div>\n<br style="clear:both;"/>\n'
}),ABINEMASKME.CompiledTemplates["views/unlock/password"]}),ABINEMASKME.define("abine/views/unlock",["documentcloud/underscore","jquery","models","duckbone/core","wycats/handlebars","abine/assets","abine/proxies","abine/eventLogger","abine/intl"],function(e,t,n,i,a,s,r,o,l){var c=i.View.extend({tagName:"div",templateName:"unlock_password",className:"well clearfix",events:{"submit .unlock":"verifyPassword","click .unlockButton":"verifyPassword","click .showHint":"showHint"},afterInitialize:function(){ABINEMASKME.user.preferences.getPrefFromStorage("autoLockOnRestart",e.bind(function(e){e&&"true"!=e.get("value")&&1!=e.get("value")?t(this.el).find("#autoUnlockPref").removeAttr("checked"):t(this.el).find("#autoUnlockPref").attr("checked","checked")},this))},render:function(){this.renderTemplate();var e=t(this.el).find('input[name="password"]').get(0);return setTimeout(function(){t(e).focus()},100),this},showDecrypting:function(){t(this.el).find("#decrypting").show()},hideDecrypting:function(){t(this.el).find("#decrypting").hide()},invalidPassword:function(){t(this.el).find(".form_password").parent().addClass("error"),t(this.el).find(".help-block").html(l.getText("mm_unlock_InvalidPassword"))},clearErrors:function(){t(this.el).find(".form_password").parent().removeClass("error"),t(this.el).find(".help-block").html("")},verifyPassword:function(n){n.preventDefault();var i=t(this.el).find("#autoUnlockPref").is(":checked"),a=t(this.el).find(".form_password").val();this.clearErrors(),this.showDecrypting(),r.securityManager.unlock(a,i,e.bind(function(t){this.hideDecrypting(),t?this.invalidPassword():(ABINEMASKME.App._locked=!1,ABINEMASKME.user.loadMin(e.bind(function(){ABINEMASKME.App.renderPage("home")},this)))},this))},showHint:function(){t(this.el).find(".form_password").parent().removeClass("error"),null!=ABINEMASKME.user.getPasswordHint()?t(this.el).find(".help-block").html(l.getText("mm_unlock_Hint")+" "+ABINEMASKME.user.getPasswordHint()):t(this.el).find(".help-block").html(l.getText("mm_unlock_HintNull"))}},{routeAction:function(){ABINEMASKME.App.loadView(c)}});return c}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/user/info"]=e.template(function(e,t,n,i,a){function s(e){var t,i,a,s="";return s+="\n<h2>",l=n.getPrivacySuiteAddonName,t=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getPrivacySuiteAddonName"),i="mm_privacy_suite_title",l=n.intl,a=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof a===h?a.call(e,i,t,{hash:{}}):a===f?p.call(e,"intl",i,t,{hash:{}}):a,s+=m(t)+'</h2>\n<div class="well">\n  ',t="mm_privacy_suite_description",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,s+=m(t)+'<br/><br/>\n  <a href="#import" class="btn">',t="mm_privacy_suite_import",l=n.intl,i=l||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===h?i.call(e,t,{hash:{}}):i===f?p.call(e,"intl",t,{hash:{}}):i,s+=m(t)+"</a>\n</div>\n"}n=n||e.helpers;var r,o,l,c,d="",u=this,h="function",p=n.helperMissing,f=void 0,m=this.escapeExpression;return d+='<h2>Personal Information\n    <span class="security">\n        <a href="https://www.abine.com/products/maskme/support/datause.php" target="_blank">',r="mm_manage_passwords_dataSecurity",l=n.intl,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),r=typeof o===h?o.call(t,r,{hash:{}}):o===f?p.call(t,"intl",r,{hash:{}}):o,d+=m(r)+"</a>\n    </span>\n</h2>\n\n\n\n",r="showUser",l=n.child,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),r=typeof o===h?o.call(t,r,{hash:{}}):o===f?p.call(t,"child",r,{hash:{}}):o,d+=m(r)+"\n\n\n",r="preferences",l=n.child,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"child"),r=typeof o===h?o.call(t,r,{hash:{}}):o===f?p.call(t,"child",r,{hash:{}}):o,d+=m(r)+'\n\n<h2>Delete MaskMe</h2>\n\n<div class="well">\n    <a href="#uninstall" class="btn">',r="mm_user_info_DeleteMyAccount",l=n.intl,o=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),r=typeof o===h?o.call(t,r,{hash:{}}):o===f?p.call(t,"intl",r,{hash:{}}):o,d+=m(r)+"</a>\n</div>\n\n",l=n.canImportFromPrivacySuite,r=l||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"canImportFromPrivacySuite"),o=n["if"],c=u.program(1,s,a),c.hash={},c.fn=c,c.inverse=u.noop,r=o.call(t,r,c),(r||0===r)&&(d+=r),d+="\n"}),ABINEMASKME.CompiledTemplates["views/user/info"]}),ABINEMASKME.define("abine/views/userInfo",["jquery","duckbone/core","models","abine/views/showUser","abine/views/preferences","abine/eventLogger"],function(e,t,n,i,a){var s=t.View.extend({render:function(){}}),r=t.View.extend({templateName:"user_info",createChildren:function(){this.weakBindTo(ABINEMASKME.user.preferences,"sync",function(){ABINEMASKME.App.loadView(r,{model:ABINEMASKME.user})});var e={};return"undefined"==typeof this.options.forLock&&"lock"!==this.options.forLock?(e.showUser=new i({model:this.model}),e.preferences=new a({model:this.model})):(e.showUser=new s,e.preferences=new s),e}},{routeName:"userInfo",routeAction:function(){ABINEMASKME.App.loadView(r,{model:ABINEMASKME.user})}});return t.Security.showLoginWhenLocked(r),r}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/user/show_user"]=e.template(function(e,t,n,i,a){function s(e,t){var i,a,s="";return s+="\n            ",v=n.hasShieldedPhone,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"hasShieldedPhone"),a=n["if"],A=M.program(2,r,t),A.hash={},A.fn=A,A.inverse=M.program(4,o,t),i=a.call(e,i,A),(i||0===i)&&(s+=i),s+="\n        "}function r(e){var t,i,a,s="";return s+='\n                <tr>\n                    <td class="span2 field"><img  style="height:32px;" src="',t="/pages/images/manage/PhoneOFF.png",v=n.assetUrl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"assetUrl",t,{hash:{}}):i,s+=k(t)+'"/> ',t="mm_user_show_PhoneLabel",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,s+=k(t)+'</td>\n                    <td class="span5 value">\n                        <input type="text" name="phone" value="',v=n.getShieldedPhoneNumber,t=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getShieldedPhoneNumber"),typeof t===_?t=t.call(e,{hash:{}}):t===S&&(t=w.call(e,"getShieldedPhoneNumber",{hash:{}})),s+=k(t)+'" readonly/>\n                        <p>',v=n.getDisposablePhoneNumber,t=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getDisposablePhoneNumber"),i="mm_user_show_MaskedPhoneLabel",v=n.intl,a=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof a===_?a.call(e,i,t,{hash:{}}):a===S?w.call(e,"intl",i,t,{hash:{}}):a,(t||0===t)&&(s+=t),s+='</p>\n                    </td>\n                    <td class="span2"><a id="managePhoneBtn" class="btn btn-primary"><i class="icon-pencil icon-white"></i> ',v=n.getPhoneButtonTxt,t=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getPhoneButtonTxt"),typeof t===_?t=t.call(e,{hash:{}}):t===S&&(t=w.call(e,"getPhoneButtonTxt",{hash:{}})),s+=k(t)+"</a></td>\n                </tr>\n            "}function o(e){var t,i,a="";return a+='\n                <tr>\n                    <td class="span2 field"><img  style="height:32px;" src="',t="/pages/images/manage/PhoneOFF.png",v=n.assetUrl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"assetUrl",t,{hash:{}}):i,a+=k(t)+'"/> ',t="mm_user_show_PhoneLabel",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,a+=k(t)+'</td>\n                    <td class="span5 value">',t="mm_user_show_TimeToSetUp",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,a+=k(t)+'</td>\n                    <td class="span2"><a id="managePhoneBtn" class="btn btn-primary"><i class="icon-pencil icon-white"></i> ',v=n.getPhoneButtonTxt,t=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getPhoneButtonTxt"),typeof t===_?t=t.call(e,{hash:{}}):t===S&&(t=w.call(e,"getPhoneButtonTxt",{hash:{}})),a+=k(t)+"</a></td>\n                </tr>\n            "}function l(e){var t,i,a="";return a+='\n            <tr>\n                <td class="span2 field"><img  style="height:32px;" src="',t="/pages/images/manage/PhoneOFF.png",v=n.assetUrl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"assetUrl",t,{hash:{}}):i,a+=k(t)+'"/> ',t="mm_user_show_PhoneLabel",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,a+=k(t)+'</td>\n                <td class="span5 value">',t="mm_user_show_LikeMaskedMailsTryPhones",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,a+=k(t)+'</td>\n                <td class="span2"><a class="btn btn-warning" id="upgradePhoneLink"><i class="icon-plus icon-white"></i> ',t="mm_user_show_Upgrade",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,a+=k(t)+"</a></td>\n            </tr>\n        "}function c(e){var t,i,a="";return a+='\n            <tr>\n                <td class="span2 field"><img  style="height:32px;" src="',t="/pages/images/manage/MailOFF.png",v=n.assetUrl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"assetUrl",t,{hash:{}}):i,a+=k(t)+'"/> ',t="mm_user_show_EmailLabel",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,a+=k(t)+'</td>\n                <td class="span5 value">\n                    Want more options for Masked Emails?\n                </td>\n                <td class="span2"><a id="changeEmailBtn" class="btn btn-primary"><i class="icon-pencil icon-white"></i> Setup</a></td>\n            </tr>\n        '}function d(e){var t,i,a="";return a+='\n            <tr>\n                <td class="span2 field"><img  style="height:32px;" src="',t="/pages/images/manage/MailOFF.png",v=n.assetUrl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"assetUrl",t,{hash:{}}):i,a+=k(t)+'"/> ',t="mm_user_show_EmailLabel",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,a+=k(t)+'</td>\n                <td class="span5 value">\n                    <input type="text" name="email" value="',v=n.getEmailAddress,t=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getEmailAddress"),typeof t===_?t=t.call(e,{hash:{}}):t===S&&(t=w.call(e,"getEmailAddress",{hash:{}})),a+=k(t)+'" readonly/>\n                    <p>',t="mm_user_show_MaskedMails",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,(t||0===t)&&(a+=t),a+='</p>\n                </td>\n                <td class="span2"><a id="changeEmailBtn" class="btn btn-primary"><i class="icon-pencil icon-white"></i> ',t="mm_user_show_Change",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,a+=k(t)+"</a></td>\n            </tr>\n        "}function u(e){var t,i,a="";return a+='\n            <tr>\n                <td class="span2 field"><img  style="height:32px;" src="',t="/pages/images/manage/PasswordOFF.png",v=n.assetUrl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"assetUrl",t,{hash:{}}):i,a+=k(t)+'"/> ',t="mm_user_show_PasswordLabel",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,a+=k(t)+'</td>\n                <td class="span5 value">\n                    Want more security for your MaskMe account?\n                </td>\n                <td class="span2"><a id="changePasswordBtn" class="btn btn-primary"><i class="icon-pencil icon-white"></i> Setup</a></td>\n            </tr>\n        '}function h(e){var t,i,a="";return a+='\n            <tr>\n                <td class="span2 field"><img  style="height:32px;" src="',t="/pages/images/manage/PasswordOFF.png",v=n.assetUrl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"assetUrl",t,{hash:{}}):i,a+=k(t)+'"/> ',t="mm_user_show_PasswordLabel",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,a+=k(t)+'</td>\n                <td class="span5 value">\n                    <input type="text" name="password" value="************" readonly/>\n                    <p>',t="mm_user_show_SecurelyEncrypt",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,a+=k(t)+'</p>\n                </td>\n                <td class="span2"><a id="changePasswordBtn" class="btn btn-primary"><i class="icon-pencil icon-white"></i> ',t="mm_user_show_Change",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,a+=k(t)+"</a></td>\n            </tr>\n        "}function p(e,t){var i,a,s="";return s+="\n            ",v=n.hasEnabledPayments,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"hasEnabledPayments"),a=n["if"],A=M.program(17,f,t),A.hash={},A.fn=A,A.inverse=M.program(19,m,t),i=a.call(e,i,A),(i||0===i)&&(s+=i),s+="\n        "}function f(e){var t,i,a="";return a+='\n                <tr>\n                    <td class="span2 field"><img  style="height:32px;" src="',t="/pages/images/manage/CardOff.png",v=n.assetUrl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"assetUrl",t,{hash:{}}):i,a+=k(t)+'"/> ',t="mm_user_show_CreditCard",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,a+=k(t)+'</td>\n                    <td class="span5 value">\n                        <input type="text" name="card" value="xxxx xxxx xxxx ',v=n.getShieldedCardLastFour,t=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getShieldedCardLastFour"),typeof t===_?t=t.call(e,{hash:{}}):t===S&&(t=w.call(e,"getShieldedCardLastFour",{hash:{}})),a+=k(t)+'" readonly/>\n                        <p>',t="mm_user_show_MaskedCardLabel",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,(t||0===t)&&(a+=t),a+='</p>\n                    </td>\n                    <td class="span2"><a href="',v=n.getUpdateCardLink,t=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"getUpdateCardLink"),typeof t===_?t=t.call(e,{hash:{}}):t===S&&(t=w.call(e,"getUpdateCardLink",{hash:{}})),a+=k(t)+'" class="btn btn-primary" target="_blank" ><i class="icon-pencil icon-white"></i> Change</a></td>\n                </tr>\n            '}function m(e){var t,i,a="";return a+='\n                <tr>\n                    <td class="span2 field"><img  style="height:32px;" src="',t="/pages/images/manage/CardOff.png",v=n.assetUrl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"assetUrl",t,{hash:{}}):i,a+=k(t)+'"/> ',t="mm_user_show_CreditCard",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,a+=k(t)+'</td>\n                    <td class="span5 value">',t="mm_user_show_TimeToSetUpCard",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,a+=k(t)+'</td>\n                    <td class="span2"><a id="activateCardBtn" class="btn btn-primary"><i class="icon-pencil icon-white"></i> Activate</a></td>\n                </tr>\n            '}function g(e){var t,i,a="";return a+='\n            <tr>\n                <td class="span2 field"><img  style="height:32px;" src="',t="/pages/images/manage/CardOff.png",v=n.assetUrl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"assetUrl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"assetUrl",t,{hash:{}}):i,a+=k(t)+'"/> ',t="mm_user_show_CreditCard",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,a+=k(t)+'</td>\n                <td class="span5 value">',t="mm_user_show_LikeMaskedMailsTryCards",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,a+=k(t)+'</td>\n                <td class="span2"><a class="btn btn-warning" id="upgradeCardsLink"><i class="icon-plus icon-white"></i> ',t="mm_user_show_Upgrade",v=n.intl,i=v||ABINEMASKME.Duckbone.Handlebars.getAttr(e,"intl"),t=typeof i===_?i.call(e,t,{hash:{}}):i===S?w.call(e,"intl",t,{hash:{}}):i,a+=k(t)+"</a></td>\n            </tr>\n        "}n=n||e.helpers;var b,y,v,A,E="",M=this,_="function",w=n.helperMissing,S=void 0,k=this.escapeExpression,I=n.blockHelperMissing;return E+='<div class="well">\n    <table>\n        <tr>\n            <td class="span3 field"><img  style="height:27px;padding:2.6px" src="',b="/pages/images/Icon-16.png",v=n.assetUrl,y=v||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),b=typeof y===_?y.call(t,b,{hash:{}}):y===S?w.call(t,"assetUrl",b,{hash:{}}):y,E+=k(b)+'"/> ',b="mm_user_show_MaskMeSubscription",v=n.intl,y=v||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),b=typeof y===_?y.call(t,b,{hash:{}}):y===S?w.call(t,"intl",b,{hash:{}}):y,E+=k(b)+'</td>\n            <td class="span5 value">\n                <a href="',v=n.getSubscriptionLink,b=v||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getSubscriptionLink"),typeof b===_?b=b.call(t,{hash:{}}):b===S&&(b=w.call(t,"getSubscriptionLink",{hash:{}})),E+=k(b)+'" target="_blank">',v=n.getSubscriptionText,b=v||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"getSubscriptionText"),typeof b===_?b=b.call(t,{hash:{}}):b===S&&(b=w.call(t,"getSubscriptionText",{hash:{}})),E+=k(b)+'</a>\n            </td>\n\n            <td class="span1"></td>\n        </tr>\n        ',v=n.isEntitledToPhone,b=v||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"isEntitledToPhone"),y=n["if"],A=M.program(1,s,a),A.hash={},A.fn=A,A.inverse=M.program(6,l,a),b=y.call(t,b,A),(b||0===b)&&(E+=b),E+="\n\n        ",b="hasRegEmail",v=n.ifUser,y=v||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"ifUser"),A=M.program(8,c,a),A.hash={},A.fn=A,A.inverse=M.program(10,d,a),b=v&&typeof y===_?y.call(t,b,A):I.call(t,y,b,A),(b||0===b)&&(E+=b),E+="\n\n        ",b="hasRegPassword",v=n.ifUser,y=v||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"ifUser"),A=M.program(12,u,a),A.hash={},A.fn=A,A.inverse=M.program(14,h,a),b=v&&typeof y===_?y.call(t,b,A):I.call(t,y,b,A),(b||0===b)&&(E+=b),E+="\n\n        ",v=n.isEntitledToPayments,b=v||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"isEntitledToPayments"),y=n["if"],A=M.program(16,p,a),A.hash={},A.fn=A,A.inverse=M.program(21,g,a),b=y.call(t,b,A),(b||0===b)&&(E+=b),E+="\n    </table>\n</div>\n"}),ABINEMASKME.CompiledTemplates["views/user/show_user"]}),ABINEMASKME.define("abine/views/showUser",["documentcloud/underscore","jquery","duckbone/core","abine/proxies"],function(e,t,n,i){var a=n.View.extend({templateName:"user_show_user",events:{"click a#changeEmailBtn":"showChangeEmail","click a#changePasswordBtn":"showChangePassword","click a#managePhoneBtn":"showManagePhone","click a#activateCardBtn":"showActivateCard","click a#upgradePhoneLink":"doUpgradePhoneLink","click a#upgradeCardsLink":"doUpgradeCardsLink"},afterInitialize:function(){},showActivateCard:function(){ABINEMASKME.App.navigate("payments",!0)},showChangeEmail:function(){ABINEMASKME.App.navigate("editUser/email",!0)},showChangePassword:function(){ABINEMASKME.App.navigate("editUser/password",!0)},showManagePhone:function(){ABINEMASKME.App.navigate("editUser/phone",!0)},doUpgradePhoneLink:function(){ABINEMASKME.user.refreshEntitlements(e.bind(function(){ABINEMASKME.user.isEntitledToPhone()?this.render():i.securityManager.openPage(ABINEMASKME.user.getUpgradeLink({feature:"phone"}),!1)},this))},doUpgradeCardsLink:function(){ABINEMASKME.user.refreshEntitlements(e.bind(function(){ABINEMASKME.user.isEntitledToPhone()?this.render():i.securityManager.openPage(ABINEMASKME.user.getUpgradeLink({feature:"cards"}),!1)},this))}});return a}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/user_login/login"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<!-- Step 1 -->\n\n<div style="margin-left:auto;margin-right:auto;width:600px" class="userLoginForm">\n    <div class="row">\n        <div class="span1">\n            <img  src="',i="/pages/images/manage/maskme_full.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" width="75px"/>\n        </div>\n        <div style="margin-top:15px;" class="span6">\n            <h3>',i="mm_user_login_signIn",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</h3>\n        </div>\n    </div>\n\n    <div style="margin-top:20px;" class="row">\n        <p class="lostAuth alert alert-info" style="display:none;">',i="mm_user_login_weNoticed",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+"\n            ",i="mm_user_login_pleaseLogin",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'\n        </p>\n        <p id="syncUserLogin" class="alert alert-info" style="display:none;">\n            You need to setup your email address and password on the first computer you installed MaskMe on.\n        </p>\n        <p class="regUserLogin alert alert-info" style="display:none;">\n            ',i="mm_user_login_regUserLogin",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'\n        </p>\n\n        <div style="margin-top:20px;padding:25px;position:relative;" class="well">\n\n            <div class="alert alert-error" id="loginError" style="display:none;">\n                ',i="mm_user_login_error",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'\n            </div>\n\n            <div class="alert alert-notice" id="unlockTokenSent" style="display:none;"></div>\n\n            <form class="form-horizontal" id="loginFrm">\n                <fieldset>\n                  <div class="control-group">\n                    <label class="control-label" for="email">',i="mm_user_login_emailAddress",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</label>\n                    <div class="controls">\n                        <input type="email" id="email" />\n                    </div>\n                  </div>\n\n                  <div class="control-group">\n                    <label class="control-label" for="password">',i="mm_user_login_password",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</label>\n\n                    <div class="controls">\n                      <input type="password" id="password" />\n                    </div>\n                  </div>\n\n                  <div class="control-group">\n                    <div class="controls">\n                        <input type="submit" id="loginBtn" class="btn btn-large btn-primary" value=\'',i="mm_user_login_login",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'\' />\n                        <input type="button" id="backButton" class="btn" style="display:none;" value="Back" />\n                        <img src="',i="/pages/images/ajax_loader.gif",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" style="display:none;" id="loginSpinner" />\n                    </div>\n\n                  </div>\n                </fieldset>\n             </form>\n             <div style="position:absolute;bottom:5px;right:5px;" class="registerLink">',i="mm_user_login_forgotPassword",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+='</div>\n        </div>\n    </div>\n\n\n\n</div>\n\n<!-- Step 2 -->\n\n<div class="successPage" style="display: none">\n\n  <div class="page-header">\n    <h2>',i="mm_user_login_wohoo",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+"</h2>\n  </div>\n\n  <p>",i="mm_user_login_allAccounts",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</p>\n\n  <p>&nbsp;</p>\n\n  <p>\n    <a href="http://vimeo.com/channels/staffpicks" class="btn">',i="mm_user_login_backTo",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</a>\n    <a href="#home" class="btn btn-primary">',i="mm_user_login_takeMe",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</a>\n  </p>\n\n</div>\n\n<div class="upsellPage" style="display: none">\n\n  <div class="page-header">\n    <h2>',i="mm_user_login_wohoo",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+"</h2>\n  </div>\n\n  <p>",i="mm_user_login_consider",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,(i||0===i)&&(r+=i),r+='</p>\n\n  <p>&nbsp;</p>\n\n  <p>\n    <a href="http://vimeo.com/channels/staffpicks" class="btn">',i="mm_user_login_backTo",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</a>\n    <input type="button" class="btn btn-primary home" value="',i="mm_user_login_takeMe",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'" />\n    <input type="button" class="btn btn-warning upgrade" value="',i="mm_user_login_upgrade",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'"/>\n  </p>\n\n</div>\n'}),ABINEMASKME.CompiledTemplates["views/user_login/login"]}),ABINEMASKME.define("abine/views/userLogin",["documentcloud/underscore","jquery","models","duckbone/core","abine/eventLogger","abine/config","abine/intl","abine/proxies","abine/responseCodes","abine/browserSyncStorage"],function(e,t,n,i,a,s,r,o,l,c){var d=i.View.extend({tagName:"div",templateName:"user_login_login",events:{"submit #loginFrm":"signIn","click .upgrade":"openPlansPage","click .home":"openHome","click #backButton":"backButton","click #resendLink":"resendUnlockToken"},backButton:function(){this.options.backTo?ABINEMASKME.App.navigate(this.options.backTo,!0):ABINEMASKME.App.navigate("home",!0)},afterInitialize:function(){(ABINEMASKME.user.hasRegistered()||ABINEMASKME.user.resetPasswordInProgress())&&(ABINEMASKME.user.hasRegEmail()?(t(this.el).find(".regUserLogin").show(),t(this.el).find("#backButton").show()):t(this.el).find(".lostAuth").show()),c.get(["hasRegistered","regEmail","regPassword"],e.bind(function(e){e.hasRegistered&&(e.regEmail||e.regPassword)&&!ABINEMASKME.user.hasRegistered()&&t(this.el).find("#syncUserLogin").show()},this))},clearErrors:function(){t(this.el).find("#loginError").hide(),t(this.el).find("#unlockTokenSent").hide()},signIn:function(n){n.preventDefault(),this.clearErrors(),t(this.el).find("#loginSpinner").show();var i={email:t(this.el).find("#email").val(),password:t(this.el).find("#password").val()};o.licenseModule.signIn(i,e.bind(function(n){if(t(this.el).find("#loginSpinner").hide(),n){if(n.errorCode==l.UNKNOWN_ERROR)t(this.el).find("#loginError").html(r.getText("mm_ServerDown"));else if(n.errorCode==l.NO_ACCOUNT_FOUND_FOR_EMAIL)t(this.el).find("#loginError").html(r.getText("mm_user_login_NoAccountForEmail"));else if(n.errorCode==l.ACCOUNT_MARKED_FOR_DELETION)t(this.el).find("#loginError").html(r.getText("mm_user_login_MarkedForDelete"));else if(n.errorCode==l.FAILED_CREATING_TARGET_EMAIL)t(this.el).find("#loginError").html(r.getText("mm_ServerDown"));else if(n.errorCode==l.WRONG_PASSWORD){var i=n.responseJSON.data.password_hint;i=!i||0!=i.length&&"null"!==i.toLowerCase()?i:null,t(this.el).find("#loginError").html(r.getText("mm_user_login_WrongPassword")+" "+(i||r.getText("mm_user_login_NullPasswordHint")))}else n.errorCode==l.ACCOUNT_HAS_BEEN_LOCKED?t(this.el).find("#loginError").html(r.getText("mm_user_login_LockedAccount1")):t(this.el).find("#loginError").html(r.getText("mm_user_login_InvalidLogin"));t(this.el).find("#loginError").show()}else ABINEMASKME.user.loadMin(e.bind(function(){t(this.el).find(".userLoginForm").hide(),ABINEMASKME.user.isEntitledToSync()?t(this.el).find(".successPage").show():t(this.el).find(".upsellPage").show()},this))},this))},openHome:function(){ABINEMASKME.App.navigate("home",!0)},openPlansPage:function(){o.securityManager.openPage(ABINEMASKME.user.getUpgradeLink(),!1)},resendUnlockToken:function(){this.clearErrors(),o.licenseModule.resendUnlockEmail({email:t(this.el).find("#email").val()},e.bind(function(e){e?t(this.el).find("#loginError").html(r.getText("mm_user_login_ResendEmailFailed")).show():t(this.el).find("#unlockTokenSent").html(r.getText("mm_user_login_ResendEmailSuccessful")).show()},this))}},{routeName:"userLogin",routeAction:function(e){e=e?e.replace("_","/"):"home",ABINEMASKME.App.loadView(d,{backTo:e})}});return d}),ABINEMASKME.require(["wycats/handlebars"],function(e){return ABINEMASKME.CompiledTemplates||(ABINEMASKME.CompiledTemplates={}),ABINEMASKME.CompiledTemplates["views/user_registration/registration"]=e.template(function(e,t,n){n=n||e.helpers;var i,a,s,r="",o="function",l=n.helperMissing,c=void 0,d=this.escapeExpression;return r+='<div id="loadingPage" style="display: none;">\n    <div class="row pull-right">\n        <div class="sign-in">',i="mm_user_registration_haveAccount",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+' <a href="#userLogin">',i="mm_user_registration_login",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</a></div>\n    </div>\n    <div class="row">\n        <div class="span2 offset1">\n            <img src="',i="/pages/images/manage/maskme_full.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" width="75px" />\n        </div>\n        <div class="span6">\n            <div id="loadingMaskMe" style="margin-left:15px;padding-top:50px;">\n                <img src="',i="/pages/images/ajax_loader.gif",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" /> Please wait while MaskMe sets up for the first time...\n            </div>\n            <div id="registerError" style="display:none;margin-top:25px;" class="alert alert-error">\n                <strong>Oops there were problems setting up MaskMe</strong>.  Please try checking your connection and refreshing the page, or try again later.  If you keep seeing this message please contact support@abine.com\n            </div>\n        </div>\n    </div>\n</div>\n\n<div id="faqPage" style="display: none;">\n    <div class="row" style="clear:both;margin-bottom:25px;">\n        <div class="span1">\n            <img  src="',i="/pages/images/manage/maskme_full.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" width="75px"/>\n        </div>\n        <div class="span9">\n            <h2>We know you still have some questions.</h2>\n        </div>\n    </div>\n    <div class="row" style="margin-top:20px;">\n        <div class="accordion" id="faqAccordion">\n            <div class="accordion-group">\n                <div class="accordion-heading">\n                    <a class="accordion-toggle collapsed" data-toggle="collapse" data-target="#collapseOne" data-parent="#faqAccordion" href="javascript:void(0);">\n                        Where do I get my Masked Emails (if I want to see them)?\n                    </a>\n                </div>\n                <div id="collapseOne" class="accordion-body collapse">\n                    <div class="accordion-inner">\n                        Masked Emails can forward straight to your personal inbox (set it up below). Sometimes you\'ll\n                        only want the first message sent to your Masked Email, like a confirmation link or an order\n                        confirmation, and then you never want to hear from that website again. The beauty of Masked\n                        Emails is that you can easily block that specific email at any time. Don\'t want to set up email\n                        forwarding? That\'s ok, you can still find your messages within MaskMe.\n                    </div>\n                </div>\n            </div>\n            <div class="accordion-group">\n                <div class="accordion-heading">\n                    <a class="accordion-toggle collapsed" data-toggle="collapse" data-target="#collapseTwo" data-parent="#faqAccordion" href="javascript:void(0);">\n                        Do I have to remember these Masked Emails?\n                    </a>\n                </div>\n                <div id="collapseTwo" class="accordion-body collapse">\n                    <div class="accordion-inner">\n                        You don\'t have to! MaskMe remembers your Masked Emails for you.  Since you\'ll sometimes use\n                        these to login to websites, MaskMe will remember it all for you.  When you go back to the\n                        website later, everything is filled in automatically.\n                        <br/>\n                        <br/>\n                        Go ahead. Try creating a new account on one of these sites:\n                        <a href="https://vimeo.com/join" target="_blank"><img src="',i="/pages/images/vimeo.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" /></a>\n                        <a href="https://secure.imdb.com/register-imdb/form-v2" target="_blank"><img src="',i="/pages/images/imdb.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" /></a>\n                        <a href="https://login.livingsocial.com/signup" target="_blank"><img src="',i="/pages/images/livingsocial.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" /></a>\n                    </div>\n                </div>\n            </div>\n            <div class="accordion-group">\n                <div class="accordion-heading">\n                    <a class="accordion-toggle collapsed" data-toggle="collapse" data-target="#collapseThree" data-parent="#faqAccordion" href="javascript:void(0);">\n                        Will this work on all websites?\n                    </a>\n                </div>\n                <div id="collapseThree" class="accordion-body collapse">\n                    <div class="accordion-inner">\n                        Yes. MaskMe works all across the web.  So any time a site asks for your email address, mask it instead.\n                        <br/>\n                        <br/>Go ahead. Try creating an account on one of these sites:\n                        <a href="https://nytimes.com/gst/regi.html" target="_blank"><img src="',i="/pages/images/nytimes.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" /></a>\n                        <a href="https://twitter.com" target="_blank"><img src="',i="/pages/images/twitter.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" /></a>\n                        <a href="https://pinterest.com/join/register/email/" target="_blank"><img src="',i="/pages/images/pinterest.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" /></a>\n                    </div>\n                </div>\n            </div>\n            <div class="accordion-group">\n                <div class="accordion-heading">\n                    <a class="accordion-toggle collapsed" data-toggle="collapse" data-target="#collapseFour" data-parent="#faqAccordion" href="javascript:void(0);">\n                        Why is this better than using my "other spam email"?\n                    </a>\n                </div>\n                <div id="collapseFour" class="accordion-body collapse">\n                    <div class="accordion-inner">\n                        With Masked Emails you can decide at any time who gets to contact you.  If a website sends you\n                        stuff you like, keep forwarding.  If they spam you, block them.  You\'ll never need to check your\n                        "other inbox" again.  Plus, once you start using MaskMe, you\'ll realize it is actually\n                        <a href="http://www.youtube.com/watch?v=5rj8HQXzhlk" target="_blank">faster and easier</a>\n                        to mask your email rather than doing anything else. So, in summary: Masked Emails are easier to\n                        manage, and you\'ll get things done faster.  What\'s not to like?\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div id="plansPage" style="margin-bottom:100px;">\n        <div class="row" style="clear:both;margin-left:75px;margin-bottom:10px;">\n            <h2>To unlock more features, select a plan:</h2>\n        </div>\n        <div class="row" style="">\n            <div id=error style="display:none;" class="alert alert-error"></div>\n        </div>\n        <div class="row">\n            <div id="freePlan" class="span5 disabled">\n\n                <div class="planHeader">\n                    <div class="whitebox"><img style="display:none" src="',i="/pages/images/checkmark.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" /></div>\n                    <span>MaskMe Free</span>\n                </div>\n                <div class="planBody">\n                    <div class="planFeatures">\n                        <img src="',i="/pages/images/manage/MailOFF.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" width="35px" />\n                        <img src="',i="/pages/images/manage/PasswordOFF.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" width="35px" />\n                        <img src="',i="/pages/images/manage/AccountsOFF.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" width="35px" />\n                        <p style="font-size:11px;"> email forwarding &bull; passwords &bull; autofill </p>\n                    </div>\n                    <form id=regForm>\n                        <div class="planForm">\n                            <input type="text" class="long" id="email" placeholder="Primary Email Address" /> <br/>\n                            <input type="password" class="short" id="password" placeholder="Create Password" />\n                            <input type="password" class="short" id="password_confirmation" placeholder="Confirm Password" /><br/>\n                            <input type="text" class="long" id="password_hint" placeholder="Password Hint (we can\'t help if you forget)" autocomplete="off" />\n                        </div>\n\n                        <div class="planAction">\n                            <input type="submit" class="btn btn-large green" id="freePlanFinish" value="Finish" />\n                        </div>\n                    </form>\n                </div>\n\n            </div>\n\n            <div id="premiumPlan" class="span5">\n                <div class="planHeader">\n                    <div class="whitebox"><img style="display:none" src="',i="/pages/images/checkmark.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" /></div>\n                    <span>MaskMe Premium</span>\n                </div>\n                <div class="planBody">\n                    <div class="planFeatures">\n                        <img src="',i="/pages/images/manage/MailOFF.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" width="35px" />\n                        <img src="',i="/pages/images/manage/PasswordOFF.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" width="35px" />\n                        <img src="',i="/pages/images/manage/AccountsOFF.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" width="35px" />\n                        <img src="',i="/pages/images/manage/PhoneOFF.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" width="35px" />\n                        <img src="',i="/pages/images/manage/CardOFF.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" width="35px" />\n                        <p style="font-size:11px;"> email forwarding &bull; passwords &bull; autofill &bull; phone &bull; credit card &bull; sync</p>\n                    </div>\n\n                    <form id="premiumForm">\n                        <div class="planForm" style="display:none;">\n                            <input type="text" class="long" id="premium_email" placeholder="Primary Email Address" /> <br/>\n                            <input type="password" class="short" id="premium_password" placeholder="Create Password" />\n                            <input type="password" class="short" id="premium_password_confirmation" placeholder="Confirm Password" /><br/>\n                            <input type="text" class="long" id="premium_password_hint" placeholder="Password Hint (we can\'t help if you forget)" autocomplete="off" />\n                        </div>\n\n                        <div class="planUpsell">\n                            <div class="left line-one">Get a</div>\n                            <div class="center orange line-two">premium account</div>\n                            <div class="right line-three">for $5 a month</div>\n                        </div>\n\n                        <div class="mobile">\n                            <div style="padding-top:15px;font-size:20px;" class="orange">Plus</div>\n                            <div><img src="',i="/pages/images/mobilephone.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" /></div>\n                            <div style="padding-top:10px;"><strong>MaskMe on your phone!</strong> <br/> Get mobile privacy with our app</div>\n                            <br style="clear:both;"/>\n                        </div>\n\n                        <div class="planAction">\n                            <input type="button" class="btn btn-large orange" id="showPremiumReg" value="Go Premium" />\n                            <input type="submit" class="btn btn-large orange" style="display:none;" id="premiumPlanReg" value="Continue" />\n                        </div>\n                    </form>\n\n                    <br style="clear:both;"/>\n                </div>\n            </div>\n\n        </div>\n\n        <div class="center">\n            <input type="button" class="btn btn-link" id="skipFeaturesPage" style="margin-top:15px;margin-right:75px;" value="No thanks, just emails for me." />\n        </div>\n\n    </div>\n</div>\n\n<div class="successPage" style="display: none;">\n    <div class="row pull-right">\n        <div class="sign-in">',i="mm_user_registration_haveAccount",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+' <a href="#userLogin/userRegistration">',i="mm_user_registration_login",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'</a></div>\n    </div>\n    <div class="row" style="clear:both;margin-bottom:25px;">\n        <div class="span1">\n            <img  src="',i="/pages/images/manage/maskme_full.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" width="75px"/>\n        </div>\n        <div class="span9">\n            <h2>Welcome to MaskMe! <img src="',i="/pages/images/manage/MailOFF.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" width="35px" />\n                <img src="',i="/pages/images/manage/PasswordOFF.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" width="35px" />\n                <img src="',i="/pages/images/manage/AccountsOFF.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" width="35px" />\n                <img src="',i="/pages/images/manage/PhoneOFF.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" width="35px" />\n                <img src="',i="/pages/images/manage/CardOFF.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" width="35px" /></h2>\n            <p><b>Easily make disposable emails, phones, and credit cards that forward right to your existing accounts</b></p>\n        </div>\n    </div>\n    <div class="row" style="margin-top:40px;">\n        <div id="letsPractice" style="margin-left:100px;">\n            <h2 class="how-it-works">Let\'s Practice</h2>\n            <p>Let\'s say you want to use a website, but you know they\'re just going to send you spam. <br/> You can give them a Masked Email instead!</p>\n        </div>\n        <div style="margin-left:100px;height: 364px;width:866px;background:url(',i="/pages/images/practice_bg.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+');z-index:1;">\n            <div style="margin-top: 10px;position: relative;">\n              <div style="background-color:white; border: 2px solid #739600; width:200px;height:90px; z-index:10;padding:10px;border-radius:10px;position:absolute;left:-150px;top:156px;">\n                <div style="position:relative;height:100%;">\n                    <p class="step1">Watch what happens when you click into an email field</p>\n                    <p class="step2" style="display:none;">Now click "Mask My Email"</p>\n                    <p class="step3" style="display:none;">You made a Masked Email! Nice try, spammers!</p>\n                    <input type="button" class="btn btn-large btn-primary" style="display:none;position:absolute;bottom:0px;right:0px;" value="Got it!" id="finishMaskEmailDemo" />\n                    <img style="position:absolute;bottom:10px;right:5px;" id="maskEmailDemoArrow" src="',i="pages/images/arrow.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'" />\n                </div>\n              </div>\n\n             <input type="email" id="demoEmail" style="position:absolute;top:217px;left:90px;width:360px;" autocomplete="off"/>\n\n              <div class="email_helper">\n                <div class="demo_email_helper" style="display:none;opacity:0;">\n                    <div class="header">\n                        <div class="buttons-panel close-header-margin">\n                            <span class="close-icon close-header" id="paneHover"></span>\n                        </div>\n                        <div class="buttons-panel question-header-margin">\n                            <a href="https://www.abine.com/maskme/faq/#aliasemail" target="_blank"><span class="question-icon" id="paneHover"></span></a>\n                        </div>\n                        <img class="panel-icon" src="',i="/pages/images/manage/maskme_logo_short_green.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'"/>\n                    </div>\n\n                    <!--Mask My Email-->\n                    <a href="#" class="mmKeyOption disposableEmail"><div class="element" id="mask">\n                    <span class="panelLeft">\n                        <img class="iconPos" src="',i="/pages/images/maskmail-icon.png",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'"/>\n                      ',i="mm_email_helper_maskMyEmail",s=n.intl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"intl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"intl",i,{hash:{}}):a,r+=d(i)+'\n                    </span>\n                    <span class="panelRight">\n                        <img class="loading" style="display:none;" src="',i="/pages/images/ajax_loader.gif",s=n.assetUrl,a=s||ABINEMASKME.Duckbone.Handlebars.getAttr(t,"assetUrl"),i=typeof a===o?a.call(t,i,{hash:{}}):a===c?l.call(t,"assetUrl",i,{hash:{}}):a,r+=d(i)+'"/>\n                    </span>\n                    </div></a>\n                </div>\n              </div>\n              </div>\n            </div>\n\n        </div>\n    </div>\n</div>\n'
}),ABINEMASKME.CompiledTemplates["views/user_registration/registration"]}),ABINEMASKME.define("abine/views/userRegistration",["documentcloud/underscore","jquery","models","duckbone/core","abine/eventLogger","abine/proxies","abine/intl","abine/passwordScore","abine/responseCodes"],function(e,t,n,i,a,s,r,o){var l=9,c=i.View.extend({tagName:"div",templateName:"user_registration_registration",events:{"click #showHome":"showHome","click .create":"clickCreate","click #learnMore":"openPlansPage","click #showPremiumReg":"showPremiumReg","focus #demoEmail":"showHelper","blur #demoEmail":"hideHelper","click .linkToSetupEmailPage":"openSetupEmailPage","click .linkToManageEmailPage":"openManageEmailPage","click .linkToTempInboxPage":"openTempInboxPage","click #finishMaskEmailDemo":"finishMaskEmailDemo","mousedown .disposableEmail":"helperMouseDown","click .disposableEmail":"fillDisposable","submit #regForm":"freePlanFinish","submit #premiumForm":"premiumPlanFinish","click .disabled":"togglePlan","click #skipFeaturesPage":"showHome"},afterInitialize:function(){ABINEMASKME.user.hasRegistered()||ABINEMASKME.user.resetPasswordInProgress()?ABINEMASKME.user.resetPasswordInProgress()?ABINEMASKME.App.navigate("userLogin",!0):ABINEMASKME.user.hasRegistered()&&!ABINEMASKME.user.hasPostinstallFlowNotCompleted()?(this.planSelected="premium",this.updatePlanSelected(),t(this.el).find(".successPage").hide(),t(this.el).find("#faqPage").show()):(t(this.el).find(".successPage").show(),t(this.el).find("#loadingPage").hide()):(t(this.el).find(".successPage").hide(),t(this.el).find("#loadingPage").show(),ABINEMASKME.App.contentMessenger.onceAny(["broadcast:register:failed",this.waitAutoRegisterResponse,this],["broadcast:register:success",this.waitAutoRegisterResponse,this]))},clearErrors:function(){t(this.el).find("#error").html("").hide()},showPremiumReg:function(){t(this.el).find("#showPremiumReg").hide(),t(this.el).find("#premiumPlanReg").show(),t(this.el).find("#premiumPlan .planUpsell").hide(),t(this.el).find("#premiumPlan .mobile").hide(),t(this.el).find("#premiumPlan .planForm").show()},waitAutoRegisterResponse:function(n){n.err?(t(this.el).find("#registerError").show(),t(this.el).find("#loadingMaskMe").hide()):(ABINEMASKME.user.loadShieldedEmails(),ABINEMASKME.user.loadPreferences(function(){ABINEMASKME.App.renderNav()}),ABINEMASKME.user.loadDisposableEmails(e.bind(function(){t(this.el).find(".successPage").show(),t(this.el).find("#loadingPage").hide()},this)))},finishMaskEmailDemo:function(){t(this.el).find(".successPage").hide(),t(this.el).find("#faqPage").show(),this.planSelected="premium",this.updatePlanSelected(),s.licenseModule.postInstallCompleted({},function(){ABINEMASKME.user.loadPreferences()})},openSetupEmailPage:function(){ABINEMASKME.App.navigate("editUser/email",!0)},openManageEmailPage:function(){ABINEMASKME.App.navigate("home/emails",!0)},openTempInboxPage:function(){ABINEMASKME.App.navigate("home/inbox",!0)},togglePlan:function(){this.planSelected="premium"==this.planSelected?"free":"premium",this.updatePlanSelected()},updatePlanSelected:function(){"premium"==this.planSelected?(t(this.el).find("#freePlan").addClass("disabled"),t(this.el).find("#premiumPlan").removeClass("disabled")):(t(this.el).find("#premiumPlan").addClass("disabled"),t(this.el).find("#freePlan").removeClass("disabled")),t(this.el).find("input").removeAttr("disabled"),t(this.el).find(".planHeader img").show(),t(this.el).find(".disabled .planHeader img").hide(),t(this.el).find(".disabled input").attr("disabled","disabled")},processRegistration:function(n,i,a){if(this.clearErrors(),n){ABINEMASKME.App.closeCriticalProcess();var s="Unknown error while registering your account.",o=n.responseJSON&&n.responseJSON.data?n.responseJSON.data.errors:null;o&&o.email&&("has already been taken"==o.email[0]?s=r.getText("mm_user_email_EmailAlreadyTakenError"):"is invalid"==o.email[0]&&(s=r.getText("mm_user_registration_EmailError"))),t("#error",this.el).text(s).show(),a(s)}else ABINEMASKME.user.loadShieldedEmails(),ABINEMASKME.user.loadPreferences(function(){ABINEMASKME.App.renderNav()}),ABINEMASKME.user.loadDisposableEmails(e.bind(function(){a()},this))},premiumPlanFinish:function(n){if(n.preventDefault(),!t(this.el).find("#premiumPlanReg").attr("disabled")){this.clearErrors();var i={email:t(this.el).find("#premium_email").val(),current_password:ABINEMASKME.user.getRegPassword(),password:t(this.el).find("#premium_password").val(),password_confirmation:t(this.el).find("#premium_password_confirmation").val(),password_hint:t(this.el).find("#premium_password_hint").val()},a=t(this.el).find("#error");if(""==i.email)return a.text(r.getText("mm_user_registration_EmailEmpty")).show(),void 0;if(""==i.password||i.password!=i.password_confirmation)return a.text(r.getText("mm_user_registration_passwordsDoNotMatch")).show(),void 0;if(""==i.password_hint)return a.text(r.getText("mm_user_registration_passwordHintInvalid")).show(),void 0;t(this.el).find("#premiumPlanReg").attr("disabled","disabled"),s.licenseModule.changeEmailPassword(i,e.bind(function(t,n){this.processRegistration(t,n,e.bind(function(e){e||this.openPlansPage()},this))},this))}},freePlanFinish:function(n){if(n.preventDefault(),!t(this.el).find("#freePlanRegister").attr("disabled")){this.clearErrors();var i={email:t(this.el).find("#email").val(),current_password:ABINEMASKME.user.getRegPassword(),password:t(this.el).find("#password").val(),password_confirmation:t(this.el).find("#password_confirmation").val(),password_hint:t(this.el).find("#password_hint").val()},a=t(this.el).find("#error");if(""==i.email)return a.text(r.getText("mm_user_registration_EmailEmpty")).show(),void 0;if(""==i.password||i.password!=i.password_confirmation)return a.text(r.getText("mm_user_registration_passwordsDoNotMatch")).show(),void 0;if(""==i.password_hint)return a.text(r.getText("mm_user_registration_passwordHintInvalid")).show(),void 0;t(this.el).find("#freePlanRegister").attr("disabled","disabled"),s.licenseModule.changeEmailPassword(i,e.bind(function(t,n){this.processRegistration(t,n,e.bind(function(e){e||ABINEMASKME.App.navigate("home",!0)},this))},this))}},clickCreate:function(){t(this.el).find("#benefitsPage").hide(),t(this.el).find(".userRegistrationForm").show()},openPlansPage:function(){ABINEMASKME.App.closeCriticalProcess(),ABINEMASKME.App.navigate("home",!0),s.securityManager.openPage(ABINEMASKME.user.getPremiumLink(),!1)},showHome:function(){ABINEMASKME.App.navigate("home",!0)},recalculateStrength:function(e){if(e.keyCode!==l){var n=t(this.el).find(".passwordsDiv");n.html("");var i=o.calculateScore(this.fields.password.el.value);n.append(o.calculateProgressForContent(i)+r.getText("mm_user_registration_passwordPopoverContent")),n.show();var a=t(this.el).find(".passwordsTrigger");a.addClass("transparent");var s=t(this.el).find(".passwords");s.find(".error").remove()}},showHelper:function(){var n=this.$(".demo_email_helper")[0];this.$(".panelRight .loading").hide(),t(n).show(),t("#demoEmail").val(""),t(".step1, .step3",this.el).hide(),t(".step2",this.el).show(),n.style.opacity="0.0",n.style.marginTop="50px",setTimeout(e.bind(function(){n.style.opacity="1.0",n.style.marginTop="0px"},this),100)},hideHelper:function(){return this.ignoreBlur?(this.ignoreBlur=!1,void 0):(this.fadeOut(1),void 0)},helperMouseDown:function(){this.ignoreBlur=!0},fadeOut:function(n){t(".step1, .step2, .step3",this.el).hide(),t(this.el).find(".step"+n).show();var i=this.$(".demo_email_helper")[0];try{i.style.opacity="1.0",i.style.marginTop="0px"}catch(a){}setTimeout(e.bind(function(){try{i.style.opacity="0.0",i.style.marginTop="50px"}catch(e){}},this),100),setTimeout(e.bind(function(){t(i).hide()},this),400)},fillDisposable:function(t){this.$(".panelRight .loading").show(),setTimeout(e.bind(function(){this.fadeOut(3)},this),500),t.preventDefault();var n=null;ABINEMASKME.user.disposableEmails.each(function(e){n&&"MaskMe News"!=e.getDomain()||(n=e)}),n&&setTimeout(e.bind(function(){this.$("#demoEmail").val(n.getAddress()),this.$(".numWebmails").text(1),this.$("#finishMaskEmailDemo").show(),this.$("#letsPractice").hide(),this.$("#maskEmailDemoArrow").hide()},this),600)}},{routeName:"userRegistration",routeAction:function(e){ABINEMASKME.App.loadView(c,{param:e})}});return c}),/*! @license
 // Copyright (c) 2009 pidder <www.pidder.com>
 // Permission to use, copy, modify, and/or distribute this software for any
 // purpose with or without fee is hereby granted, provided that the above
 // copyright notice and this permission notice appear in all copies.
 //
 // THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 // WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 // MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 // ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 // WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 // ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 // OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
*/
/* pidCrypt is pidders JavaScript Crypto Library - www.pidder.com/pidcrypt
 * Version 0.01, 02/2009
 *
 * pidCrypt is a combination of different JavaScript functions for client side
 * encryption technologies with enhancements for openssl compatibility cast into
 * a modular class concept.
 *
 * Client side encryption is a must have for developing host proof applications:
 * There must be no knowledge of the clear text data at the server side, all
 * data is enrycpted prior to being submitted to the server.
 * Client side encryption is mandatory for protecting the privacy of the users.
 * "Dont't trust us, check our source code!"
 *
 * "As a cryptography and computer security expert, I have never understood
 * the current fuss about the open source software movement. In the
 * cryptography world, we consider open source necessary for good security;
 * we have for decades. Public security is always more secure than proprietary
 * security. It's true for cryptographic algorithms, security protocols, and
 * security source code. For us, open source isn't just a business model;
 * it's smart engineering practice."
 * Bruce Schneier, Crypto-Gram 1999/09/15
 * copied form keepassx site - keepassx is a cross plattform password manager
 *
 * pidCrypt comes with modules under different licenses and copyright terms.
 * Make sure that you read and respect the individual module license conditions
 * before using it.
 *
 * The pidCrypt base library contains:
 * 1. pidcrypt.js
 *    class pidCrypt: the base class of the library
 * 2. pidcrypt_util.js
 *    base64 en-/decoding as new methods of the JavaScript String class
 *    UTF8 en-/decoding as new methods of the JavaScript String class
 *    String/HexString conversions as new methods of the JavaScript String class
 *
 * The pidCrypt v0.01 modules and the original authors (see files for detailed
 * copyright and license terms) are:
 *
 * - md5.js:      MD5 (Message-Digest Algorithm), www.webtoolkit.info
 * - aes_core.js: AES (Advanced Encryption Standard ) Core algorithm, B. Poettering
 * - aes-ctr.js:  AES CTR (Counter) Mode, Chis Veness
 * - aes-cbc.js:  AES CBC (Cipher Block Chaining) Mode, pidder
 * - jsbn.js:     BigInteger for JavaScript, Tom Wu
 * - prng.js:     PRNG (Pseudo-Random Number Generator), Tom Wu
 * - rng.js:      Random Numbers, Tom Wu
 * - rsa.js:      RSA (Rivest, Shamir, Adleman Algorithm), Tom Wu
 * - oids.js:     oids (Object Identifiers found in ASN.1), Peter Gutmann
 * - asn1.js:     ASN1 (Abstract Syntax Notation One) parser, Lapo Luchini
 *
 * IMPORTANT:
 * Please report any bugs at http://sourceforge.net/projects/pidcrypt/
 * Vist http://www.pidder.com/pidcrypt for online demo an documentation
 */
ABINEMASKME.define("pidcrypt",[],function(){function e(){function t(e){e||(e=8);for(var t=new Array(e),n=[],i=0;256>i;i++)n[i]=i;for(i=0;t.length>i;i++)t[i]=n[Math.floor(Math.random()*n.length)];return t}this.setDefaults=function(){this.params.nBits=256,this.params.salt=e.convertToHex(e.byteArray2String(t(8))),this.params.blockSize=16,this.params.UTF8=!0,this.params.A0_PAD=!0},this.debug=!0,this.params={},this.params.dataIn="",this.params.dataOut="",this.params.decryptIn="",this.params.decryptOut="",this.params.encryptIn="",this.params.encryptOut="",this.params.key="",this.params.iv="",this.params.clear=!0,this.setDefaults(),this.errors="",this.warnings="",this.infos="",this.debugMsg="",this.setParams=function(e){e||(e={});for(var t in e)this.params[t]=e[t]},this.getParams=function(){return this.params},this.getParam=function(e){return this.params[e]||""},this.clearParams=function(){this.params={}},this.getNBits=function(){return this.params.nBits},this.getOutput=function(){return this.params.dataOut},this.setError=function(e){this.error=e},this.appendError=function(e){return this.errors+=e,""},this.getErrors=function(){return this.errors},this.isError=function(){return this.errors.length>0?!0:!1},this.appendInfo=function(e){return this.infos+=e,""},this.getInfos=function(){return this.infos},this.setDebug=function(e){this.debug=e},this.appendDebug=function(e){return this.debugMsg+=e,""},this.isDebug=function(){return this.debug},this.getAllMessages=function(t){var n={lf:"\n",clr_mes:!1,verbose:15};t||(t=n);for(var i in n)"undefined"==typeof t[i]&&(t[i]=n[i]);var a="",s="";for(var r in this.params){switch(r){case"encryptOut":s=e.toByteArray(this.params[r].toString()),s=e.fragment(s.join(),64,t.lf);break;case"key":case"iv":s=e.formatHex(this.params[r],48);break;default:s=e.fragment(this.params[r].toString(),64,t.lf)}a+="<p><b>"+r+"</b>:<pre>"+s+"</pre></p>"}return this.debug&&(a+="debug: "+this.debug+t.lf),this.errors.length>0&&1==(1&t.verbose)&&(a+="Errors:"+t.lf+this.errors+t.lf),this.warnings.length>0&&2==(2&t.verbose)&&(a+="Warnings:"+t.lf+this.warnings+t.lf),this.infos.length>0&&4==(4&t.verbose)&&(a+="Infos:"+t.lf+this.infos+t.lf),this.debug&&8==(8&t.verbose)&&(a+="Debug messages:"+t.lf+this.debugMsg+t.lf),t.clr_mes&&(this.errors=this.infos=this.warnings=this.debug=""),a},this.getRandomBytes=function(e){return t(e)}}return e}),/*! @license----------------------------------------------------------------------------
 // Copyright (c) 2009 pidder <www.pidder.com>
 // Permission to use, copy, modify, and/or distribute this software for any
 // purpose with or without fee is hereby granted, provided that the above
 // copyright notice and this permission notice appear in all copies.
 //
 // THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 // WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 // MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 // ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 // WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 // ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 // OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 ----------------------------------------------------------------------------
  (c) Chris Veness 2005-2008
* You are welcome to re-use these scripts [without any warranty express or
* implied] provided you retain my copyright notice and when possible a link to
* my website (under a LGPL license). §ection numbers relate the code back to
* sections in the standard.*/
ABINEMASKME.define("pidcrypt/utils",["pidcrypt"],function(e){e.encodeBase64=function(t,n){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n="undefined"==typeof n?!1:n;var a,s,r,o,l,c,d,u,h,p,f,m=[],g="";if(e.toByteArray(t),p=n?e.encodeUTF8(t):t,h=p.length%3,h>0)for(;3>h++;)g+="=",p+="\0";for(h=0;p.length>h;h+=3)a=p.charCodeAt(h),s=p.charCodeAt(h+1),r=p.charCodeAt(h+2),o=a<<16|s<<8|r,l=63&o>>18,c=63&o>>12,d=63&o>>6,u=63&o,m[h/3]=i.charAt(l)+i.charAt(c)+i.charAt(d)+i.charAt(u);return f=m.join(""),f=f.slice(0,f.length-g.length)+g},e.decodeBase64=function(t,n){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n="undefined"==typeof n?!1:n;var a,s,r,o,l,c,d,u,h,p,f=[];p=n?e.decodeUTF8(t):t;for(var m=0;p.length>m;m+=4)o=i.indexOf(p.charAt(m)),l=i.indexOf(p.charAt(m+1)),c=i.indexOf(p.charAt(m+2)),d=i.indexOf(p.charAt(m+3)),u=o<<18|l<<12|c<<6|d,a=255&u>>>16,s=255&u>>>8,r=255&u,f[m/4]=String.fromCharCode(a,s,r),64==d&&(f[m/4]=String.fromCharCode(a,s)),64==c&&(f[m/4]=String.fromCharCode(a));return h=f.join(""),h=n?e.decodeUTF8(h):h,e.toByteArray(h),h},e.encodeUTF8=function(e){var t=e.replace(/[\u0080-\u07ff]/g,function(e){var t=e.charCodeAt(0);return String.fromCharCode(192|t>>6,128|63&t)});return t=t.replace(/[\u0800-\uffff]/g,function(e){var t=e.charCodeAt(0);return String.fromCharCode(224|t>>12,128|63&t>>6,128|63&t)})},e.decodeUTF8=function(e){var t=e.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(e){var t=(31&e.charCodeAt(0))<<6|63&e.charCodeAt(1);return String.fromCharCode(t)});return t=t.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(e){var t=(15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2);return String.fromCharCode(t)})},e.convertToHex=function(e){for(var t="",n="",i=0;e.length>i;i++)n=e.charCodeAt(i).toString(16),t+=1==n.length?"0"+n:n;return t},e.convertFromHex=function(e){for(var t="",n=0;e.length>n;n+=2)t+=String.fromCharCode(parseInt(e.substring(n,n+2),16));return t},e.stripLineFeeds=function(e){var t="";return t=e.replace(/\n/g,""),t=t.replace(/\r/g,"")},e.toByteArray=function(e){for(var t=[],n=0;e.length>n;n++)t[n]=e.charCodeAt(n);return t},e.fragment=function(e,t,n){if(!t||t>=e.length)return e;n||(n="\n");for(var i="",a=0;e.length>a;a+=t)i+=e.substr(a,t)+n;return i},e.formatHex=function(t,n){n||(n=45);for(var i="",a=t.toLowerCase(),s=0;a.length>s;s+=2)i+=a.substr(s,2)+":";return a=e.fragment(i,n)},e.byteArray2String=function(e){for(var t="",n=0;e.length>n;n++)t+=String.fromCharCode(e[n]);return t}}),ABINEMASKME.define("pidcrypt/sha1",["pidcrypt"],function(e){e.SHA1=function(e){function t(e,t){var n=e<<t|e>>>32-t;return n}function n(e){var t,n,i="";for(t=7;t>=0;t--)n=15&e>>>4*t,i+=n.toString(16);return i}function i(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;e.length>n;n++){var i=e.charCodeAt(n);128>i?t+=String.fromCharCode(i):i>127&&2048>i?(t+=String.fromCharCode(192|i>>6),t+=String.fromCharCode(128|63&i)):(t+=String.fromCharCode(224|i>>12),t+=String.fromCharCode(128|63&i>>6),t+=String.fromCharCode(128|63&i))}return t}var a,s,r,o,l,c,d,u,h,p=new Array(80),f=1732584193,m=4023233417,g=2562383102,b=271733878,y=3285377520;e=i(e);var v=e.length,A=new Array;for(s=0;v-3>s;s+=4)r=e.charCodeAt(s)<<24|e.charCodeAt(s+1)<<16|e.charCodeAt(s+2)<<8|e.charCodeAt(s+3),A.push(r);switch(v%4){case 0:s=2147483648;break;case 1:s=8388608|e.charCodeAt(v-1)<<24;break;case 2:s=32768|(e.charCodeAt(v-2)<<24|e.charCodeAt(v-1)<<16);break;case 3:s=128|(e.charCodeAt(v-3)<<24|e.charCodeAt(v-2)<<16|e.charCodeAt(v-1)<<8)}for(A.push(s);14!=A.length%16;)A.push(0);for(A.push(v>>>29),A.push(4294967295&v<<3),a=0;A.length>a;a+=16){for(s=0;16>s;s++)p[s]=A[a+s];for(s=16;79>=s;s++)p[s]=t(p[s-3]^p[s-8]^p[s-14]^p[s-16],1);for(o=f,l=m,c=g,d=b,u=y,s=0;19>=s;s++)h=4294967295&t(o,5)+(l&c|~l&d)+u+p[s]+1518500249,u=d,d=c,c=t(l,30),l=o,o=h;for(s=20;39>=s;s++)h=4294967295&t(o,5)+(l^c^d)+u+p[s]+1859775393,u=d,d=c,c=t(l,30),l=o,o=h;for(s=40;59>=s;s++)h=4294967295&t(o,5)+(l&c|l&d|c&d)+u+p[s]+2400959708,u=d,d=c,c=t(l,30),l=o,o=h;for(s=60;79>=s;s++)h=4294967295&t(o,5)+(l^c^d)+u+p[s]+3395469782,u=d,d=c,c=t(l,30),l=o,o=h;f=4294967295&f+o,m=4294967295&m+l,g=4294967295&g+c,b=4294967295&b+d,y=4294967295&y+u}var h=n(f)+n(m)+n(g)+n(b)+n(y);return h.toLowerCase()}}),ABINEMASKME.require("pidcrypt",function(){}),ABINEMASKME.require("pidcrypt/utils",function(){}),ABINEMASKME.require("pidcrypt/sha1",function(){}),ABINEMASKME.require("abine/assets",function(){}),function(){function e(){ABINEMASKME.startTime=Date.now(),t(function(){n()})}function t(e){ABINEMASKME.requireDuckbone(function(){ABINEMASKME.requireModels(function(){ABINEMASKME.require(["abine/views/commonhelpers"],function(){e()})})})}function n(){ABINEMASKME.require(["abine/contentManager","abine/formSubmitDetector","abine/eventLogger","abine/pageEventsImpl"],function(e,t,n,i){var a=new e.ContentManager({document:document,force:!0});a.start(),new t.FormSubmitContentHelper(a.messenger),i.startup(a.messenger,document),window.addEventListener("beforeunload",function(){a.destroy()},!1)})}function i(){document.webkitHidden||(document.removeEventListener("webkitvisibilitychange",i,!1),e())}var a=document.documentElement;"content.js"!=a.attributes.idmeScript&&(a.attributes.idmeScript="content.js","visible"!=document.webkitVisibilityState?document.addEventListener("webkitvisibilitychange",i,!1):e(),chrome.extension.sendRequest({eventName:"contentScript:init",payload:{}}))}();